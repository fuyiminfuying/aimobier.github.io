{"meta":{"title":"è†æ–‡å¾","subtitle":"å·²è­˜ä¹¾å¤å¤§ï¼ŒçŒ¶æ†è‰æœ¨æ–°ã€‚","description":"æ¬²ä¹°æ¡‚èŠ±åŒè½½é…’<br/>ç»ˆä¸ä¼¼ å°‘å¹´æ¸¸","author":"å°é…’é¦†è€æ¿","url":"http://www.msiter.com"},"pages":[{"title":"","date":"2017-11-28T11:07:04.827Z","updated":"2017-11-28T11:07:04.827Z","comments":true,"path":"404.html","permalink":"http://www.msiter.com/404.html","excerpt":"","text":""},{"title":"","date":"2017-11-28T11:07:04.835Z","updated":"2017-11-28T11:07:04.835Z","comments":true,"path":"themes_config.json","permalink":"http://www.msiter.com/themes_config.json","excerpt":"","text":"{\"override\":false,\"favicon\":{\"small\":\"favicon/favicon.png\",\"medium\":\"favicon/favicon.png\",\"apple_touch_icon\":\"favicon/favicon.png\",\"safari_pinned_tab\":\"favicon/favicon.png\"},\"keywords\":\"IOS,Swift,å¼€å‘,æŠ€æœ¯,è†æ–‡å¾ï¼Œåšå®¢,blog,msiter\",\"rss\":null,\"footer\":{\"icon\":\"user\",\"copyright\":false,\"powered\":false,\"theme\":{\"enable\":false,\"version\":false}},\"canonical\":true,\"seo\":true,\"index_with_subtitle\":true,\"menu\":{\"home\":\"/ || home\",\"tags\":\"/tags/ || tags\",\"categories\":\"/categories/ || th\",\"archives\":\"/archives/ || archive\"},\"menu_icons\":{\"enable\":true},\"scheme\":\"Pisces\",\"social_icons\":{\"enable\":true,\"icons_only\":false,\"transition\":false,\"GitHub\":\"github\",\"Twitter\":\"twitter\",\"Weibo\":\"weibo\"},\"links_icon\":\"link\",\"links_title\":\"Links\",\"links_layout\":\"block\",\"avatar\":\"favicon/avatar.jpg\",\"toc\":{\"enable\":true,\"number\":true,\"wrap\":false},\"sidebar\":{\"position\":\"left\",\"display\":\"post\",\"offset\":12,\"b2t\":true,\"scrollpercent\":false,\"onmobile\":false},\"scroll_to_more\":true,\"save_scroll\":false,\"excerpt_description\":true,\"auto_excerpt\":{\"enable\":false,\"length\":150},\"post_meta\":{\"item_text\":true,\"created_at\":true,\"updated_at\":false,\"categories\":true},\"post_wordcount\":{\"item_text\":true,\"wordcount\":false,\"min2read\":false,\"totalcount\":false,\"separated_meta\":true},\"post_copyright\":{\"enable\":false,\"license\":\"CC BY-NC-SA 3.0\",\"license_url\":\"https://creativecommons.org/licenses/by-nc-sa/3.0/\"},\"mobile_layout_economy\":false,\"android_chrome_color\":\"#222\",\"custom_logo\":{\"enabled\":false,\"image\":null},\"highlight_theme\":\"normal\",\"font\":{\"enable\":false,\"host\":null,\"global\":{\"external\":true,\"family\":\"Lato\",\"size\":null},\"headings\":{\"external\":true,\"family\":null,\"size\":null},\"posts\":{\"external\":true,\"family\":null},\"logo\":{\"external\":true,\"family\":null,\"size\":null},\"codes\":{\"external\":true,\"family\":null,\"size\":null}},\"mathjax\":{\"enable\":false,\"per_page\":false,\"cdn\":\"//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML\"},\"han\":false,\"baidu_analytics\":\"37f9fd734b75f078c1b06452e6c3ccfb\",\"disqus\":{\"enable\":false,\"shortname\":\"msiter\",\"count\":true},\"changyan\":{\"enable\":true,\"appid\":\"cytc1YTze\",\"appkey\":\"4df84c3a0a2bad896b42860f7ed0a300\"},\"valine\":{\"enable\":false,\"appid\":null,\"appkey\":null,\"notify\":false,\"verify\":false,\"placeholder\":\"Comment input placeholder\"},\"gitment\":{\"enable\":false,\"mint\":true,\"count\":true,\"lazy\":false,\"cleanly\":false,\"language\":null,\"github_user\":null,\"github_repo\":null,\"client_id\":null,\"client_secret\":null,\"proxy_gateway\":null,\"redirect_protocol\":null},\"needmoreshare2\":{\"enable\":false,\"postbottom\":{\"enable\":false,\"options\":{\"iconStyle\":\"box\",\"boxForm\":\"horizontal\",\"position\":\"bottomCenter\",\"networks\":\"Weibo,Wechat,Douban,QQZone,Twitter,Facebook\"}},\"float\":{\"enable\":false,\"options\":{\"iconStyle\":\"box\",\"boxForm\":\"horizontal\",\"position\":\"middleRight\",\"networks\":\"Weibo,Wechat,Douban,QQZone,Twitter,Facebook\"}}},\"duoshuo_info\":{\"ua_enable\":true,\"admin_enable\":false,\"user_id\":0},\"facebook_sdk\":{\"enable\":false,\"app_id\":null,\"fb_admin\":null,\"like_button\":null,\"webmaster\":null},\"facebook_comments_plugin\":{\"enable\":false,\"num_of_posts\":10,\"width\":\"100%\",\"scheme\":\"light\"},\"vkontakte_api\":{\"enable\":false,\"app_id\":null,\"like\":true,\"comments\":true,\"num_of_posts\":10},\"rating\":{\"enable\":false,\"id\":null,\"color\":\"fc6423\"},\"leancloud_visitors\":{\"enable\":false,\"app_id\":null,\"app_key\":null},\"busuanzi_count\":{\"enable\":false,\"site_uv\":true,\"site_uv_header\":\"\",\"site_uv_footer\":null,\"site_pv\":true,\"site_pv_header\":\"\",\"site_pv_footer\":null,\"page_pv\":true,\"page_pv_header\":\"\",\"page_pv_footer\":null},\"baidu_push\":false,\"calendar\":{\"enable\":false,\"calendar_id\":\"\",\"api_key\":\"\",\"orderBy\":\"startTime\",\"offsetMax\":24,\"offsetMin\":4,\"timeZone\":null,\"showDeleted\":false,\"singleEvents\":true,\"maxResults\":250},\"algolia_search\":{\"enable\":false,\"hits\":{\"per_page\":10},\"labels\":{\"input_placeholder\":\"Search for Posts\",\"hits_empty\":\"We didn't find any results for the search: ${query}\",\"hits_stats\":\"${hits} results found in ${time} ms\"}},\"local_search\":{\"enable\":true,\"trigger\":\"auto\",\"top_n_per_article\":1},\"exturl\":false,\"note\":{\"style\":\"simple\",\"icons\":false,\"border_radius\":3,\"light_bg_offset\":0},\"label\":true,\"tabs\":{\"enable\":true,\"transition\":{\"tabs\":false,\"labels\":true},\"border_radius\":0},\"motion\":{\"enable\":true,\"async\":false,\"transition\":{\"post_block\":\"fadeIn\",\"post_header\":\"slideDownIn\",\"post_body\":\"slideDownIn\",\"coll_header\":\"slideLeftIn\",\"sidebar\":\"slideUpIn\"}},\"fancybox\":true,\"pace\":false,\"pace_theme\":\"pace-theme-minimal\",\"canvas_nest\":false,\"three_waves\":false,\"canvas_lines\":false,\"canvas_sphere\":false,\"canvas_ribbon\":{\"enable\":false,\"size\":300,\"alpha\":0.6,\"zIndex\":-1},\"vendors\":{\"_internal\":\"lib\",\"jquery\":null,\"fancybox\":null,\"fancybox_css\":null,\"fastclick\":null,\"lazyload\":null,\"velocity\":null,\"velocity_ui\":null,\"ua_parser\":null,\"fontawesome\":null,\"algolia_instant_js\":null,\"algolia_instant_css\":null,\"pace\":null,\"pace_css\":null,\"canvas_nest\":null,\"three\":null,\"three_waves\":null,\"canvas_lines\":null,\"canvas_sphere\":null,\"canvas_ribbon\":null,\"han\":null,\"needMoreShare2\":null},\"css\":\"css\",\"js\":\"js\",\"images\":\"images\",\"version\":\"5.1.3\"}"},{"title":"ç•™è¨€æ¿","date":"2017-11-28T11:07:04.831Z","updated":"2017-11-28T11:07:04.831Z","comments":false,"path":"about/index.html","permalink":"http://www.msiter.com/about/index.html","excerpt":"","text":"I heard, that your settled down. å·²é—»å›ï¼Œè¯¸äº‹å®‰åº·ã€‚That you, found a girl and your married now.é‡ä½³äººï¼Œä¸ä¹…å©šå«ã€‚I heard that your dreams came true. å·²é—»å›ï¼Œå¾—å¿æ‰€æƒ³ã€‚Guess she gave you things, I didnâ€™t give to you. æ–™å¾—æ˜¯ï¼Œå¿è¯†å›æœ›ã€‚Old friend, why are you so shy?æ—§æ—¥çŸ¥å·±ï¼Œä½•æ•…å¼ æƒ¶ï¼ŸIt ainâ€™t like you to hold back or hide from the lie.é®é®æ©æ©ï¼Œæ¬²ç›–å¼¥å½°ã€‚I hate to turn up out of the blue uninvited.å®¢æœ‰ä¸é€Ÿï¼Œå®éæˆ‘æ‰€æƒ³ã€‚ButI couldnâ€™t stay away, I couldnâ€™t fight it. é¿ä¹‹ä¸å¾—ï¼Œé‘è®ºä¸ç›¸æŠ—ã€‚Iâ€™d hoped youâ€™d see my face&amp; that youâ€™d be reminded, å¼‚æ—¥å¶é‡ï¼Œè¯†å¾—ä¾ç¨€é¢œã€‚That for me, it isnâ€™t over.å†æ— æ‰€æ±‚ï¼Œæ¶•é›¶è€Œæ³ªä¸‹ã€‚Never mind, Iâ€™ll find someone like you. æ¯‹é¡»çƒ¦æ¼ï¼Œç»ˆæœ‰å¼±æ°´æ›¿æ²§æµ·ã€‚I wish nothing but the best, for you too. æŠ›å´çº ç¼ ï¼Œå†æŠŠç›¸æ€å¯„å·«å±±ã€‚Donâ€™t forget me, I beg, I remember you said:å‹¿å¿˜æ˜¨æ—¥ï¼Œäº¦å­˜å›è¨€äºè‚ºè…‘ã€‚â€œSometimes it lasts in love but sometimes it hurts insteadâ€ â€œæƒ…å ªéš½æ°¸ï¼Œä¹Ÿå–„å¿ƒæ½®æ€ç‹‚æ¾œã€‚â€Sometimes it lasts in love but sometimes it hurts instead, yeah. æƒ…å ªéš½æ°¸ï¼Œä¹Ÿå–„å¿ƒæ½®æ€ç‹‚æ¾œï¼Œç„¶ã€‚Youâ€™d know, how the time flies.å…‰é˜´å¸¸æ— è¸ªï¼Œè¯ç©·ä¸æ•¢é“èè‹’ã€‚Only yesterday, was the time of our lives. æ¬¢ç¬‘ä»å¦‚æ˜¨ï¼Œä»Šå´å­¤å½±å¿†èŠ±ç¹ã€‚We were born and raised in a summery haze. å½¼æ—¶åˆæ‰§æ‰‹ï¼Œå¤é›¾éƒéƒæ¹¿è¡£è¡«ã€‚Bound by the surprise of our glory days. è‡ªç¼šæ—§å¿µä¸­ï¼Œè¯§å–œè£å…‰æ°¸ä¸é»¯ã€‚I hate to turn up out of the blue uninvited.å®¢æœ‰ä¸é€Ÿï¼Œå®éæˆ‘æ‰€æƒ³ã€‚ButI couldnâ€™t stay away, I couldnâ€™t fight it. é¿ä¹‹ä¸å¾—ï¼Œé‘è®ºä¸ç›¸æŠ—ã€‚Iâ€™d hoped youâ€™d see my face&amp; that youâ€™d be reminded, å¼‚æ—¥å¶é‡ï¼Œè¯†å¾—ä¾ç¨€é¢œã€‚That for me, it isnâ€™t over.å†æ— æ‰€æ±‚ï¼Œæ¶•é›¶è€Œæ³ªä¸‹ã€‚ Nothing compares, no worries or cares. æ— å¯ä¸ä¹‹ç›¸æï¼Œåˆ‡è«å¿§å¿ƒåŒæŒ‚å¿µã€‚Regretâ€™s and mistakes theyâ€™re memories made. ç³Šæ¶‚é—æ¨éš¾å…ï¼Œç™½ç’§å¾®ç‘•æ–¹å¯æ‹ã€‚Who would have known how bittersweet this would taste? æ­¤ä¸­é…¸ç”œè‹¦å’¸ï¼Œä¸–ä¸Šè°äººå ªç›¸è¨€ï¼Ÿ"},{"title":"ç±»åˆ«","date":"2017-11-28T11:07:04.831Z","updated":"2017-11-28T11:07:04.831Z","comments":false,"path":"categories/index.html","permalink":"http://www.msiter.com/categories/index.html","excerpt":"","text":""},{"title":"æ ‡ç­¾","date":"2017-11-28T11:07:04.835Z","updated":"2017-11-28T11:07:04.835Z","comments":false,"path":"tags/index.html","permalink":"http://www.msiter.com/tags/index.html","excerpt":"","text":""}],"posts":[{"title":"å¤©é€šè‹‘åœ°é“ å®‰æ£€æ–¹å¼æ”¹å˜","slug":"ç”Ÿæ´»éšå¤„å¯è§ä¸€æ–‘20171123","date":"2017-11-23T09:18:00.000Z","updated":"2017-11-28T11:07:04.831Z","comments":true,"path":"2017/11/23/ç”Ÿæ´»éšå¤„å¯è§ä¸€æ–‘20171123/","link":"","permalink":"http://www.msiter.com/2017/11/23/ç”Ÿæ´»éšå¤„å¯è§ä¸€æ–‘20171123/","excerpt":"ä»Šå¤©æ—©ä¸Šæ¥åˆ°å¤©é€šè‹‘åœ°é“ç«™å‘ç°å®‰æ£€æ–¹å¼æ”¹å˜äº†ï¼Œä»¥å‰æ˜¯ä¸€ä¸ªå£å®‰æ£€ï¼Œåœ¨å¤§é—¨å£å­˜åœ¨ä¸€ä¸ªå¯ä»¥ä¾›æ²¡å¸¦åŒ…ä¹˜å®¢è¿›å…¥çš„é€šé“ï¼Œç”±äºè¿™ä¸ªå£ç¦»å®‰æ£€äººå‘˜è¾ƒè¿œç”šè‡³å­˜åœ¨ä¸€ä¸ªå¼¯é“ï¼Œæ‰€ä»¥æ ¹æœ¬æ²¡äººä¼šç®¡å¸¦åŒ…ä¹˜å®¢è¿›å…¥è¯¥é€šé“ã€‚åæ¥é€šé“å¹²è„†å°æ‰äº†ï¼Œè¿™æ ·ä¸€æ¥ï¼Œå¸¦åŒ…ä¸å¸¦åŒ…éƒ½éœ€è¦åœ¨ä¸€ä¸ªåœ°æ–¹æ’é˜Ÿç­‰å¾…å®‰æ£€äº†ã€‚ç°åœ¨åœ¨åŸæœ¬é€šé“çš„åœ°æ–¹æ”¾ç½®äº†ä¸¤ä¸ªå®‰æ£€é—¨æŠŠæœ‰åŒ…æ— åŒ…åŒºåˆ†å¼€æ¥ã€‚æˆ‘åªæ˜¯è§‰å¾—è¿™æ ·å­æŒºå¥½çš„ï¼Œæœ¬ç€ç”Ÿæ´»å¤„å¤„çš†å­¦é—®çš„å¿ƒç†è‡ªå·±è§‰å¾—å¤§æ¦‚æœ‰å‡ ç§å¿ƒç†å¯¼è‡´äº†ä»¥ä¸Šæè¿°","text":"ä»Šå¤©æ—©ä¸Šæ¥åˆ°å¤©é€šè‹‘åœ°é“ç«™å‘ç°å®‰æ£€æ–¹å¼æ”¹å˜äº†ï¼Œä»¥å‰æ˜¯ä¸€ä¸ªå£å®‰æ£€ï¼Œåœ¨å¤§é—¨å£å­˜åœ¨ä¸€ä¸ªå¯ä»¥ä¾›æ²¡å¸¦åŒ…ä¹˜å®¢è¿›å…¥çš„é€šé“ï¼Œç”±äºè¿™ä¸ªå£ç¦»å®‰æ£€äººå‘˜è¾ƒè¿œç”šè‡³å­˜åœ¨ä¸€ä¸ªå¼¯é“ï¼Œæ‰€ä»¥æ ¹æœ¬æ²¡äººä¼šç®¡å¸¦åŒ…ä¹˜å®¢è¿›å…¥è¯¥é€šé“ã€‚åæ¥é€šé“å¹²è„†å°æ‰äº†ï¼Œè¿™æ ·ä¸€æ¥ï¼Œå¸¦åŒ…ä¸å¸¦åŒ…éƒ½éœ€è¦åœ¨ä¸€ä¸ªåœ°æ–¹æ’é˜Ÿç­‰å¾…å®‰æ£€äº†ã€‚ç°åœ¨åœ¨åŸæœ¬é€šé“çš„åœ°æ–¹æ”¾ç½®äº†ä¸¤ä¸ªå®‰æ£€é—¨æŠŠæœ‰åŒ…æ— åŒ…åŒºåˆ†å¼€æ¥ã€‚æˆ‘åªæ˜¯è§‰å¾—è¿™æ ·å­æŒºå¥½çš„ï¼Œæœ¬ç€ç”Ÿæ´»å¤„å¤„çš†å­¦é—®çš„å¿ƒç†è‡ªå·±è§‰å¾—å¤§æ¦‚æœ‰å‡ ç§å¿ƒç†å¯¼è‡´äº†ä»¥ä¸Šæè¿° æœ€å¼€å§‹äººä»¬åœ¨æ²¡æœ‰äººæ³¨æ„çš„æ—¶å€™ä¼šèµ°é€šé“ï¼Œå¦å¤–å°±æ˜¯å½“ä¸€ä¸ªå¸¦åŒ…çš„äººèµ°ä¹‹åã€‚æ‰€æœ‰çš„äººéƒ½ä¼šå‡ºç°è¿™ç§æƒ…å†µï¼Œè¿™ç§æƒ…å†µå°±ç±»ä¼¼ä¸€ä¸ªå¾ˆå¹²å‡€çš„åœ°æ–¹ï¼Œè¢«ä¸€ä¸ªäººä¸¢äº†åƒåœ¾ï¼Œé‚£é‡Œå°±ä¼šä¸æ–­è¢«äººä¸¢åƒåœ¾ï¼Œç›´åˆ°å˜æˆåƒåœ¾æ¡¶ã€‚è¿™ç§å¿ƒç†å¾ˆå¤šï¼Œä»ä¼—ï¼Œç¾Šç¾¤ï¼Œæˆ‘è§‰å¾—æœ€å¥½çš„æ˜¯ ç ´çª—å®šå¾‹ã€‚ ç ´çª—æ•ˆåº”ï¼Œæ˜¯å…³äºç¯å¢ƒå¯¹äººä»¬å¿ƒç†é€ æˆæš—ç¤ºæ€§æˆ–è¯±å¯¼æ€§å½±å“çš„ä¸€ç§è®¤è¯†ã€‚æŒ‡å¦‚æœæœ‰äººæ‰“åäº†ä¸€å¹¢å»ºç­‘ç‰©çš„çª—æˆ·ç»ç’ƒï¼Œè€Œè¿™æ‰‡çª—æˆ·åˆå¾—ä¸åˆ°åŠæ—¶çš„ç»´ä¿®ï¼Œåˆ«äººå°±å¯èƒ½å—åˆ°æŸäº›æš—ç¤ºæ€§çš„çºµå®¹å»æ‰“çƒ‚æ›´å¤šçš„çª—æˆ·ã€‚ä¸€ä¸ªæˆ¿å­å¦‚æœçª—æˆ·ç ´äº†ï¼Œæ²¡æœ‰äººå»ä¿®è¡¥ï¼Œéš”ä¸ä¹…ï¼Œå…¶å®ƒçš„çª—æˆ·ä¹Ÿä¼šè«åå…¶å¦™åœ°è¢«äººæ‰“ç ´ï¼›ä¸€é¢å¢™ï¼Œå¦‚æœå‡ºç°ä¸€äº›æ¶‚é¸¦æ²¡æœ‰è¢«æ¸…æ´—æ‰ï¼Œå¾ˆå¿«çš„ï¼Œå¢™ä¸Šå°±å¸ƒæ»¡äº†ä¹±ä¸ƒå…«ç³Ÿã€ä¸å ªå…¥ç›®çš„ä¸œè¥¿ï¼›ä¸€ä¸ªå¾ˆå¹²å‡€çš„åœ°æ–¹ï¼Œäººä»¬ä¸å¥½æ„æ€ä¸¢åƒåœ¾ï¼Œä½†æ˜¯ä¸€æ—¦åœ°ä¸Šæœ‰åƒåœ¾å‡ºç°ä¹‹åï¼Œäººå°±ä¼šæ¯«ä¸çŠ¹è±«åœ°æŠ›ï¼Œä¸æ¯«ä¸è§‰ç¾æ„§ã€‚ä¸€å¹¢æœ‰å°‘è®¸ç ´çª—çš„å»ºç­‘ä¸ºä¾‹ï¼Œå¦‚æœé‚£äº›çª—ä¸è¢«ä¿®ç†å¥½ï¼Œå¯èƒ½å°†ä¼šæœ‰ ç ´åè€… ç ´åæ›´å¤šçš„çª—æˆ·ã€‚æœ€ç»ˆä»–ä»¬ç”šè‡³ä¼šé—¯å…¥å»ºç­‘å†…ï¼Œå¦‚æœå‘ç°æ— äººå±…ä½ï¼Œä¹Ÿè®¸å°±åœ¨é‚£é‡Œå®šå±…æˆ–è€…çºµç«ã€‚ä¸€é¢å¢™ï¼Œå¦‚æœå‡ºç°ä¸€äº›æ¶‚é¸¦æ²¡æœ‰è¢«æ¸…æ´—æ‰ï¼Œå¾ˆå¿«çš„ï¼Œå¢™ä¸Šå°±å¸ƒæ»¡äº†ä¹±ä¸ƒå…«ç³Ÿã€ä¸å ªå…¥ç›®çš„ä¸œè¥¿ï¼›ä¸€æ¡äººè¡Œé“æœ‰äº›è®¸çº¸å±‘ï¼Œä¸ä¹…åå°±ä¼šæœ‰æ›´å¤šåƒåœ¾ï¼Œæœ€ç»ˆäººä»¬ä¼šè§†è‹¥ç†æ‰€å½“ç„¶åœ°å°†åƒåœ¾é¡ºæ‰‹ä¸¢å¼ƒåœ¨åœ°ä¸Šã€‚è¿™ä¸ªç°è±¡ï¼Œå°±æ˜¯çŠ¯ç½ªå¿ƒç†å­¦ä¸­çš„ç ´çª—æ•ˆåº”ã€‚ è€Œç°åœ¨çš„å¤„ç†æ–¹å¼åˆ™æ˜¯åˆ©ç”¨çš„æ˜¯ï¼Œè‡ªæˆ‘ç„¦ç‚¹æ•ˆåº”ï¼Œåœ¨ä¼—ç›®ç½ç½ä¹‹ä¸‹ï¼Œå°¤å…¶æ˜¯åœ¨å®‰æ£€äººå‘˜å’Œä¹˜å®¢ä¸å¤ªå‡ºç°é‚£ç§æ— è§†è§„åˆ™çš„äººï¼Œé™¤éâ€¦ è‡ªæˆ‘ç„¦ç‚¹æ•ˆåº”,spotlight effect ï¼Œä¹Ÿå«åšç¤¾ä¼šç„¦ç‚¹æ•ˆåº”ï¼Œæ˜¯äººä»¬ é«˜ä¼° å‘¨å›´äººå¯¹è‡ªå·±å¤–è¡¨å’Œè¡Œä¸ºå…³æ³¨åº¦çš„ä¸€ç§è¡¨ç°ã€‚ç„¦ç‚¹æ•ˆåº”æ„å‘³ç€äººç±»å¾€å¾€ä¼šæŠŠè‡ªå·±çœ‹ä½œä¸€åˆ‡çš„ä¸­å¿ƒï¼Œå¹¶ä¸”ç›´è§‰åœ°é«˜ä¼°åˆ«äººå¯¹æˆ‘ä»¬çš„æ³¨æ„ç¨‹åº¦ã€‚ç„¦ç‚¹æ•ˆåº”å…¶å®æ˜¯ æ¯ä¸ªäººéƒ½ä¼š æœ‰çš„ä½“éªŒï¼Œè¿™ç§å¿ƒç†çŠ¶æ€è®©æˆ‘ä»¬è¿‡åº¦å…³æ³¨è‡ªæˆ‘ï¼Œè¿‡åˆ†åœ¨æ„èšä¼šæˆ–è€…å·¥ä½œé›†ä¼šæ—¶å‘¨å›´äººä»¬å¯¹æˆ‘ä»¬çš„å…³æ³¨ç¨‹åº¦ã€‚å›½å¤–æœ‰å®éªŒå’Œç»“è®ºçš„,å¤§ä½“å°±æ˜¯é™¤éä½ ä¸ç©¿è¡£æœ,æˆ–è€…åœ¨è®²å’Œåšé‚£äº›å¼•äººæ³¨æ„çš„äº‹(é€šå¸¸è·Ÿæ€§,æ­»äº¡æœ‰å…³)å³ä½¿ä½ ç©¿çš„åƒåªçŒ´å­æˆ–è€…æ¼‚äº®çš„åƒåªå­”é›€,ä¹Ÿä¹ˆæœ‰å‡ ä¸ªäººä¼šç•™æ„ä½ ï¼Œå¤§å®¶éƒ½æ˜¯çœ‹çš„è‡ªå·±,åŒæ—¶å¸Œæœ›åˆ«äººçœ‹è‡ªå·±. ç”Ÿæ´»å¤„å¤„çš†å­¦é—®ï¼Œä¸å¾—ä¸è¯´å…¶å®å‰å®³çš„äººæ— å¤„ä¸åœ¨ã€‚ å¾ˆå¤šäººæœ‰ä»‡è§†ç¤¾ä¼šï¼Œè‡ªå·±å¦‚ä½•åŠªåŠ›éƒ½èƒ½åšåˆ°ä¸€äº›äº‹æƒ…ï¼Œè€Œè§‰å¾—ç¤¾ä¼šä¸å…¬ï¼Œè§‰å¾—è‡ªå·±å°±æ˜¯åŸºäºä¸åˆ°ï¼Œä»¥ä¸‹æ˜¯æˆ‘è¾å­¦å·¥ä½œè¿™ä¹ˆå¤šå¹´ä½“ä¼šå¾—åˆ°ä¸€äº›ç‚¹å¯ä»¥ä¸€èµ·åˆ†äº«ä¸‹ åœ¨äº’è”ç½‘çœ‹åˆ°çš„å†…å®¹æ¥æºäºä½ æƒ³çœ‹åˆ°çš„å†…å®¹ã€‚ ä¸Šå­¦æœ‰æ²¡æœ‰ç”¨æˆ‘ä¸çŸ¥é“ï¼Œæˆ‘åªçŸ¥é“å­¦å†æ¯”æˆ‘é«˜çš„äººä»–çœ‹é—®é¢˜æ¯”æˆ‘å¿«å‡†ç‹ ï¼Œæˆ‘æŒ‡çš„æ˜¯â€œå­¦æˆâ€ æ¥¼ä¸‹ä¸€ä¸ªç”·äººç—…å¾—è¦æ­»ï¼Œé‚£é—´å£çš„ä¸€å®¶å”±ç€ç•™å£°æœºï¼Œå¯¹é¢æ˜¯å¼„å­©å­ã€‚å¢™ä¸Šæœ‰ä¸¤ä¸ªäººç‹‚ç¬‘ï¼Œè¿˜æœ‰æ‰“ç‰Œå£°ã€‚æ²³ä¸­çš„èˆ¹ä¸Šæœ‰å¥³äººå“­ç€å¥¹æ­»å»çš„æ¯äº²ã€‚äººç±»çš„æ‚²æ¬¢å¹¶ä¸ç›¸é€šï¼Œæˆ‘åªæ˜¯è§‰å¾—ä»–ä»¬åµé—¹ã€‚ é²è¿… - ã€Šè€Œå·²é›†ã€‹ å½“ä½ è€äº†ï¼Œå›é¡¾ä¸€ç”Ÿï¼Œå°±ä¼šå‘è§‰ï¼šä»€ä¹ˆæ—¶å€™å‡ºå›½è¯»ä¹¦ï¼Œä»€ä¹ˆæ—¶å€™å†³å®šåšç¬¬ä¸€ä»½èŒä¸šã€ä½•æ—¶é€‰å®šäº†å¯¹è±¡è€Œæ‹çˆ±ã€ä»€ä¹ˆæ—¶å€™ç»“å©šï¼Œå…¶å®éƒ½æ˜¯å‘½è¿çš„å·¨å˜ã€‚åªæ˜¯å½“æ—¶ç«™åœ¨ä¸‰å²”è·¯å£ï¼Œçœ¼è§é£äº‘åƒæ¨¯ï¼Œä½ ä½œå‡ºé€‰æ‹©çš„é‚£ä¸€æ—¥ï¼Œåœ¨æ—¥è®°ä¸Šï¼Œç›¸å½“æ²‰é—·å’Œå¹³å‡¡ï¼Œå½“æ—¶è¿˜ä»¥ä¸ºæ˜¯ç”Ÿå‘½ä¸­æ™®é€šçš„ä¸€å¤©ã€‚ é™¶æ°-ã€Šæ€é¹Œé¹‘çš„å°‘å¥³ã€‹ ä¸€ä¸‹å†ä¹Ÿæƒ³ä¸èµ·æ¥è¿™ä¹ˆå¤šäº† ä»¥åæ…¢æ…¢è¡¥å……å§ã€‚ çƒ­çˆ±ç”Ÿæ´»ï¼Œæœ‰æ—¶å€™ç­‰å¾…å›æŠ¥çš„æ—¶å€™ä¸è¦è‡ªæš´è‡ªå¼ƒï¼Œåœ¨è¿™æ®µæ—¶é—´ä¸å¦‚å¤šå­¦ä¹ ï¼ğŸ‰ğŸ‰ğŸ‰ğŸ‰","categories":[{"name":"ç”Ÿæ´»","slug":"ç”Ÿæ´»","permalink":"http://www.msiter.com/categories/ç”Ÿæ´»/"}],"tags":[{"name":"æ— è¶£ï¼Œå¿ƒç†å­¦","slug":"æ— è¶£ï¼Œå¿ƒç†å­¦","permalink":"http://www.msiter.com/tags/æ— è¶£ï¼Œå¿ƒç†å­¦/"}],"keywords":[{"name":"ç”Ÿæ´»","slug":"ç”Ÿæ´»","permalink":"http://www.msiter.com/categories/ç”Ÿæ´»/"}]},{"title":"ä½¿ç”¨ NodeJS APNS ç»™ä½ çš„åº”ç”¨å‘æ¶ˆæ¯","slug":"ä½¿ç”¨ NodeJS APNS ç»™ä½ çš„åº”ç”¨å‘æ¶ˆæ¯","date":"2017-11-22T17:02:00.000Z","updated":"2017-11-28T11:07:04.831Z","comments":true,"path":"2017/11/22/ä½¿ç”¨ NodeJS APNS ç»™ä½ çš„åº”ç”¨å‘æ¶ˆæ¯/","link":"","permalink":"http://www.msiter.com/2017/11/22/ä½¿ç”¨ NodeJS APNS ç»™ä½ çš„åº”ç”¨å‘æ¶ˆæ¯/","excerpt":"ç”¨åˆ°äº†å°ç±³çš„ MiPushSDK ä»Šå¤©å‡ºç°äº†é—®é¢˜ï¼Œæ€»ä¹‹æ— è®ºå¦‚ä½•å°±åƒé”™è¯¯ã€‚åœ¨è·Ÿä»–ä»¬çš„å¼€å‘äººå‘˜è¿›è¡Œäº¤æµçš„åŒæ—¶ï¼Œæˆ‘æƒ³çœ‹çœ‹æ˜¯è°çš„é—®é¢˜ï¼Œæ‰€ä»¥æœ‰äº†ä»¥ä¸‹çš„ç»å†ã€‚","text":"ç”¨åˆ°äº†å°ç±³çš„ MiPushSDK ä»Šå¤©å‡ºç°äº†é—®é¢˜ï¼Œæ€»ä¹‹æ— è®ºå¦‚ä½•å°±åƒé”™è¯¯ã€‚åœ¨è·Ÿä»–ä»¬çš„å¼€å‘äººå‘˜è¿›è¡Œäº¤æµçš„åŒæ—¶ï¼Œæˆ‘æƒ³çœ‹çœ‹æ˜¯è°çš„é—®é¢˜ï¼Œæ‰€ä»¥æœ‰äº†ä»¥ä¸‹çš„ç»å†ã€‚ åˆ›å»ºæ¨é€è¯ä¹¦åˆ›å»ºæ¨é€è¯ä¹¦ è¿™ä¸ªæ­¥éª¤çœç•¥ å¯¼å‡º è¯ä¹¦.p12 å’Œ key.p12æ¨é€è¯ä¹¦å®‰è£…åœ¨æœ¬åœ°ä¹‹å æ‰“å¼€ åº”ç”¨ é’¥åŒ™ä¸²è®¿é—® æ‰¾åˆ°è‡ªå·±çš„è¯ä¹¦ åœ¨éœ€è¦å¯¼å‡ºçš„è¯ä¹¦ä¸Šå³é”®ç‚¹å‡» å¯¼å‡º è¿™ä¸ªä¸œè¥¿å°±æ˜¯è¯ä¹¦.p12 æœ‰æ²¡æœ‰å¯†ç éƒ½å¯ä»¥ å¯†ç ä¼šç”¨æ¥ä¸€ä¼š openssl çš„æ—¶å€™è¾“å…¥ ç‚¹å‡»è¿™ä¸ªè¯ä¹¦ å±•å¼€ä¹‹åä¼šçœ‹åˆ°ä¸€ä¸ª Key å³é”®å¯¼å‡º è¿™ä¸ªå¯¼å‡ºçš„ p12 å°±æ˜¯ key.p12 å¯†ç è®¾ç½®åŒä¸Š å°†å¯¼å‡ºçš„ p12 ç”Ÿæˆä¸º pemopenssl pkcs12 -clcerts -nokeys -out cert.pem -in cert.p12 # å¯¼å‡º cert.pem openssl pkcs12 -in key.p12 -out key.pem -nodes # å¯¼å‡º key.pem åœ¨è½¬æ¢è¿‡ç¨‹ä¸­ p12 è®¾ç½®äº†å¯†ç å°±è¾“å…¥å¯†ç  æ²¡æœ‰è¾“å…¥ç›´æ¥å›è½¦å°±å¯ä»¥åœ¨è®¾ç½® key.pem çš„è¿‡ç¨‹ä¸­ ä¼šå‘ä½ è¯¢é—®æ˜¯å¦è®¾ç½®å¯†ç ï¼Œè®¾ç½®å¯†ç éœ€è¦è¾“å…¥ä¸¤æ¬¡ åˆ†åˆ«æ˜¯å¯†ç å’Œç¡®è®¤å¯†ç  å¼€å§‹åˆ›å»º Nodejs APNS æœåŠ¡åˆ›å»º NodeJsé¡¹ç›®åˆ›å»ºä¸€ä¸ª NodeJS é¡¹ç›® mkdir APNS cd APNS npm init æŒ‰ç…§æ­¥éª¤å¡«å†™ä¿¡æ¯ï¼Œä¹‹ååœ¨ç”Ÿæˆçš„package.json æ–‡ä»¶ä¸­ å¼•å…¥ å¯¹äº apn çš„æ”¯æŒ \"dependencies\": { \"apn\": \"\" } æ€»ä½“ä¸Šçœ‹èµ·æ¥æ˜¯è¿™ä¸ªæ ·å­çš„ { \"name\": \"apn\", \"version\": \"1.0.0\", \"description\": \"\", \"main\": \"index.js\", \"scripts\": { \"test\": \"echo \\\"Error: no test specified\\\" &amp;&amp; exit 1\" }, \"author\": \"\", \"license\": \"ISC\", \"dependencies\": { \"apn\": \"\" } } å®Œæˆåˆ›å»ºä¸€ä¸ª index.js æ–‡ä»¶ var apn = require(\"apn\"); var tokens = [\"&lt;&lt;you want push device token>>\"]; var service = new apn.Provider({ \"cert\": \"push/cert.pem\", // æ ¹ç›®å½•ä¸‹åˆ›å»º push æ–‡ä»¶å¤¹ å°†æ–‡ä»¶æ”¾ç½®åœ¨å†…ï¼Œå½“ç„¶ä½ å¯ä»¥æ”¾åœ¨è‡ªå·±å–œæ¬¢çš„ä½ç½® \"key\": \"push/key.pem\", \"production\":false }); var note = new apn.Notification({ \"alert\":\"Hello World!\", \"sound\":\"default\" }); // The topic is usually the bundle identifier of your application. note.topic = \"&lt;&lt;you bundle identifier>>\"; note.badge = 0; console.log(`Sending: ${note.compile()} to ${tokens}`); service.send(note, tokens).then( result => { console.log(\"sent:\", result.sent.length); console.log(\"failed:\", result.failed.length); console.log(result.failed); }); // For one-shot notification tasks you may wish to shutdown the connection // after everything is sent, but only call shutdown if you need your // application to terminate. service.shutdown(); è¿™é‡Œé¢åªè¿›è¡Œäº†ä¸€äº›åŸºæœ¬çš„è®¾ç½®ï¼Œåªè®¾ç½®äº†æ ‡é¢˜å…³äºæ¶ˆæ¯å†…å®¹ç­‰è®¾ç½® å¯ä»¥æŸ¥é˜…æ–‡æ¡£æˆ–è€…ç›´æ¥åœ¨ apn/lib/notification/ ç›®å½•ä¸‹æŸ¥çœ‹ è®¾ç½® ç›®å‰çš„ç‰ˆæœ¬æ˜¯å­˜åœ¨è¿™äº›çš„ [\"payload\", \"expiry\", \"priority\", \"alert\", \"body\", \"locKey\", \"locArgs\", \"title\", \"subtitle\", \"titleLocKey\", \"titleLocArgs\", \"action\", \"actionLocKey\", \"launchImage\", \"badge\", \"sound\", \"contentAvailable\", \"mutableContent\", \"mdm\", \"urlArgs\", \"category\", \"threadId\"] æµ‹è¯•node index.js å¤§åŠŸå‘Šæˆ","categories":[{"name":"æœåŠ¡å™¨","slug":"æœåŠ¡å™¨","permalink":"http://www.msiter.com/categories/æœåŠ¡å™¨/"}],"tags":[{"name":"ios","slug":"ios","permalink":"http://www.msiter.com/tags/ios/"},{"name":"NodeJS","slug":"NodeJS","permalink":"http://www.msiter.com/tags/NodeJS/"},{"name":"APNs","slug":"APNs","permalink":"http://www.msiter.com/tags/APNs/"}],"keywords":[{"name":"æœåŠ¡å™¨","slug":"æœåŠ¡å™¨","permalink":"http://www.msiter.com/categories/æœåŠ¡å™¨/"}]},{"title":"IOS10å‰ UITextFiled çš„ placeholder çš„é—®é¢˜","slug":"IOS10å‰ UITextFiled çš„ placeholder çš„é—®é¢˜","date":"2017-11-16T01:16:00.000Z","updated":"2017-11-28T11:07:04.827Z","comments":true,"path":"2017/11/16/IOS10å‰ UITextFiled çš„ placeholder çš„é—®é¢˜/","link":"","permalink":"http://www.msiter.com/2017/11/16/IOS10å‰ UITextFiled çš„ placeholder çš„é—®é¢˜/","excerpt":"The styled string that is displayed when there is no other text in the text field.This property is nil by default. If set, the placeholder string is drawn using system-defined color and the remaining style information (except the text color) of the attributed string. Assigning a new value to this property also replaces the value of the placeholder property with the same string data, albeit without any formatting information. Assigning a new value to this property does not affect any other style-related properties of the text field è¿™æ˜¯å®˜æ–¹çš„ä¸€ç‰‡è§£é‡Šï¼Œçœ‹ç€éƒ½å¾ˆä¸é”™çš„ï½","text":"The styled string that is displayed when there is no other text in the text field.This property is nil by default. If set, the placeholder string is drawn using system-defined color and the remaining style information (except the text color) of the attributed string. Assigning a new value to this property also replaces the value of the placeholder property with the same string data, albeit without any formatting information. Assigning a new value to this property does not affect any other style-related properties of the text field è¿™æ˜¯å®˜æ–¹çš„ä¸€ç‰‡è§£é‡Šï¼Œçœ‹ç€éƒ½å¾ˆä¸é”™çš„ï½ ç„¶è€Œ ä»Šå¤©æˆ‘ä»¬çš„å·¨å¤´è®¾è®¡å¸ˆæ¥æ‰¾æˆ‘ï¼Œè¯´æˆ‘çš„è¾“å…¥æ¡†ä¸å±…ä¸­.æˆ‘ä¸ä»¥ä¸ºç„¶ï¼Œæ€ä¹ˆå¯èƒ½ï½å› ä¸ºæˆ‘çš„è®¾å¤‡ä¸Šæ˜¯å¥½çš„æ‹¿æ¥æ‰‹æœºä¸€çœ‹ï¼Œè¿˜çœŸæ˜¯ï¼Œï¼Œï¼Œå¥½å§ èµ¶ç´§æ‰¾åŸå› å§ï¼Œå› ä¸ºæˆ‘çš„è®¾å¤‡æ˜¯IOS11 æ‰€ä»¥æˆ‘æ€€ç–‘æ˜¯ä¸æ˜¯IOS10çš„é—®é¢˜ã€‚ä¹‹åæ‰¾äº†ä¸€äº›èµ„æ–™å‘ç° Vertically centering a UITextFieldâ€™s attributedPlaceholderuitextfield attributedplaceholder center Google å‘è§‰è¿™ä¸ªé—®é¢˜è¿˜æ˜¯æ™®éå­˜åœ¨çš„ æœ‰ä¸å°‘äººç»™å¤„ç†è‡ªå·±çš„åšæ³•æ¯”å¦‚ï¼š keanåœ¨ Stackflowä¸­çš„å›ç­” NSMutableParagraphStyle *style = [self.addressBar.defaultTextAttributes[NSParagraphStyleAttributeName] mutableCopy]; style.minimumLineHeight = self.addressBar.font.lineHeight - (self.addressBar.font.lineHeight - [UIFont fontWithName:@\"Gotham-BookItalic\" size:14.0].lineHeight) / 2.0; self.addressBar.attributedPlaceholder = [[NSAttributedString alloc] initWithString:@\"Placeholder text\" attributes:@{ NSForegroundColorAttributeName: [UIColor colorWithRed:79/255.0f green:79/255.0f blue:79/255.0f alpha:0.5f], NSFontAttributeName : [UIFont fontWithName:@\"Gotham-BookItalic\" size:14.0], NSParagraphStyleAttributeName : style } ]; å¦å¤–ä»–ä¹Ÿç»™å‡ºäº†å¦ä¸€ç§æ–¹æ³• You could also override a - (CGRect)placeholderRectForBounds:(CGRect)bounds; method in UITextField subclass. Itâ€™s messy, but it works :) è¿˜æœ‰å¾ˆå¤šæœåˆ°çš„æ–¹æ³• æˆ‘å°±ä¸ä¸€ä¸€èµ˜è¿°äº†ã€‚ä»–ä»¬çš„æ–¹æ³•æˆ–å¤šæˆ–å°‘çš„éƒ½æ²¡å¾ˆéº»çƒ¦ï¼Œè€Œä¸”éœ€è¦è¿›è¡Œé€‚é…ï¼Œæ¯”å¦‚è¿™ç§è°ƒæ•´ä½ç½®çš„æ˜¯å¯ä»¥çš„ã€‚ä½†æ˜¯IOS11 ä½ç½®åˆå¥½äº†æ€ä¹ˆåŠå‘¢ï¼Ÿæœ€ç»ˆæ‰¾åˆ°å¦‚ä¸‹çš„æ–¹æ³•ï¼Œç‰¹æ­¤è®°å½•ä¸€ä¸‹ - (CGRect)placeholderRectForBounds:(CGRect)bounds { return CGRectMake(0, 0 , self.bounds.size.width, self.bounds.size.height); } - (void)drawPlaceholderInRect:(CGRect)rect { [super drawPlaceholderInRect:CGRectMake(0, 0 , self.bounds.size.width, self.bounds.size.height)]; }","categories":[{"name":"IOS","slug":"IOS","permalink":"http://www.msiter.com/categories/IOS/"}],"tags":[{"name":"IOS","slug":"IOS","permalink":"http://www.msiter.com/tags/IOS/"}],"keywords":[{"name":"IOS","slug":"IOS","permalink":"http://www.msiter.com/categories/IOS/"}]},{"title":"WebView ä¸ Html Input File ä»¥åŠ Upload File å‡ºç°çš„é—®é¢˜","slug":"WebView ä¸ Html Input Bug","date":"2017-10-26T04:10:00.000Z","updated":"2017-11-28T11:07:04.831Z","comments":true,"path":"2017/10/26/WebView ä¸ Html Input Bug/","link":"","permalink":"http://www.msiter.com/2017/10/26/WebView ä¸ Html Input Bug/","excerpt":"åœ¨é¡¹ç›®ä¸­ä½¿ç”¨äº†WebViewæ¥æ˜¾ç¤ºä¸€äº›å†…å®¹ï¼Œä¹‹åå°±é‡åˆ°äº†ä¸€äº›é—®é¢˜ã€‚æ€»ç»“äº†ä¸€ä¸‹","text":"åœ¨é¡¹ç›®ä¸­ä½¿ç”¨äº†WebViewæ¥æ˜¾ç¤ºä¸€äº›å†…å®¹ï¼Œä¹‹åå°±é‡åˆ°äº†ä¸€äº›é—®é¢˜ã€‚æ€»ç»“äº†ä¸€ä¸‹ é‡åˆ° Input File å‡ºç°çš„ å´©æºƒé—®é¢˜è¿™ä¸ªé—®é¢˜å…¶å®è¿˜æ˜¯æ¯”è¾ƒå¥½è§£å†³ æ— éå°±æ˜¯æƒé™é—®é¢˜ å…·ä½“çš„keyå€¼ è¯·ç›´æ¥è®¿é—® Cocoa Keys Model çš„ViewController åœ¨ä¸Šä¼ æ–‡ä»¶å ä¼šç›´æ¥ dismissæ‰è§£å†³åŠæ³• åœ¨ Model å‡ºæ¥çš„ ViewController åŠ å…¥ UINavigationController ä¹‹åé‡å†™ UINavigationController çš„æ–¹æ³• -(void)dismissViewControllerAnimated:(BOOL)flag completion:(void (^)(void))completion{ if (self.presentedViewController) { [super dismissViewControllerAnimated:flag completion:completion]; } } è‡ªå·±é‡å†™pan dismiss æ–¹æ³•çš„éšœç¢è§£å†³åœ¨æˆ‘ä»¬æƒ³é‡å†™dismissçš„æ–¹æ³•æ—¶ï¼Œä¼šç»‘å®šä¸€ä¸ªæ‰‹åŠ¿ã€‚ä½†æ˜¯åœ¨ WebViewä¸­å·²ç»å­˜åœ¨äº†å¾ˆå¤šæ‰‹åŠ¿äº†ã€‚å…¶ä¸­å°±åŒ…æ‹¬ ä¸¤ä¸ª UIScreenEdgePanGestureRecognizerï¼Œä¸€ä¸ªè¿›è¡Œå‰è¿›æ“ä½œ ä¸€ä¸ªè¿›è¡Œåé€€æ“ä½œ æˆ‘ä»¬æƒ³é‡å†™panæ–¹æ³•è¿›è¡Œå‰è¿›åé€€dismissçš„è¯ï¼Œæš‚æ—¶åªæœ‰ä¸¤ç§åŠæ³•ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬çœ‹çœ‹é‚£ç§æ–¹æ³•å¯ä»¥ä½¿ç”¨å§ ç¬¬ä¸€ç§ è‡ªå·±å»å†™ WebView ä¸­çš„ pan æ‰‹åŠ¿é¦–å…ˆæƒ³åˆ°çš„å°±æ˜¯è¿™ä¸ªæ–¹æ³•ï¼Œå› ä¸ºè¿™ä¸ªæ–¹æ³•å¾ˆçœäº‹å„¿ï¼Œå¯å®šä¹‰ç¨‹åº¦é«˜ï¼Œå½“ç„¶è¿™æ˜¯å¯è¡Œçš„æƒ…å†µä¸‹ äº‹å®è¯æ˜ï¼Œæˆ‘ä»¬åœ¨ç¬¬ä¸€ä¸ªé—®é¢˜å°±è¢«æ‹Œä½äº†ï¼Œæˆ‘ä»¬æ²¡æœ‰åŠæ³•å»æ¸è¿›å¼çš„ å‰è¿›ç½‘é¡µ å’Œ åé€€ æ‰€ä»¥è¿™ä¸ªé—®é¢˜ä¸å¾—ä¸æ”¾å¼ƒ ç¬¬äºŒç§ ä½¿ç”¨ UIGestureRecognizerDelegate æ¥æš‚æ—¶å…³é—­ webviewä¸­çš„æ‰‹åŠ¿è¿™ä¸ªæ–¹æ³•æœ€ç»ˆå®è·µæ˜¯å¯ä»¥çš„ é¦–å…ˆæˆ‘ä»¬è·å–åˆ° åé€€çš„æ‰‹åŠ¿ åœ¨åˆ›å»º WebView ä¹‹åï¼Œæˆ‘ä»¬è¿™æ ·è·å– è·å–åˆ° æ‰‹åŠ¿ å¹¶ä¸”è®¾ç½® delegatefor (UIGestureRecognizer *reconizer in self.wkWebView.gestureRecognizers) { /// å¦‚æœè·å–çš„ æ‰‹åŠ¿ ç±»å‹æ˜¯ ScreenEdgePanGestureRecognizer ç±»å‹ if ([reconizer isKindOfClass:UIScreenEdgePanGestureRecognizer.class] ) { /// å¦‚æœæ‰‹åŠ¿å¯¹è±¡æ˜¯ è¿”å›çš„æ”¶è§†å¯¹è±¡ ä½œå‡ºä»¥ä¸‹å¤„ç† if (((UIScreenEdgePanGestureRecognizer*)reconizer).edges == UIRectEdgeLeft) { reconizer.delegate = self; } /// è¯¥æ‰‹åŠ¿å°±æ˜¯ å‰è¿›æ‰‹åŠ¿ if (((UIScreenEdgePanGestureRecognizer*)reconizer).edges == UIRectEdgeRight) { } } } æ ¹æ®WebView æ˜¯å¦å¯ä»¥è¿”å› æ§åˆ¶æ‰‹åŠ¿æ˜¯å¦å¯ç”¨è·å–åˆ° delegateä¹‹åæˆ‘ä»¬å°±å¯ä»¥è¿›è¡Œæ“ä½œäº† æ¥ä¸‹æ¥å®ç° delegate çš„æ–¹æ³• /// å½“WebView ä¸å¯ä»¥è¿”å›åˆ°æ—¶å€™ï¼Œæˆ‘ä»¬ä¸è®©è¯¥æ‰‹åŠ¿è§¦å‘ -(BOOL)gestureRecognizerShouldBegin:(UIGestureRecognizer *)gestureRecognizer{ return self.wkWebView.canGoBack; } å†™ æ¨å‡ºè§†å›¾çš„æ–¹æ³•-(instancetype)initWithRootViewController:(UIViewController *)rootViewController{ self = [super initWithRootViewController:rootViewController]; if (self) { _presentdAnimation = [[BaseViewControllerPresentdAnimation alloc] init]; _dismissedAnimation = [[BaseViewControllerDismissedAnimation alloc] init]; _interactiveTransitioning = [[BasePresentdAnimationInteractiveTransition alloc]init]; self.navigationBarHidden = true; self.transitioningDelegate = self; self.modalPresentationCapturesStatusBarAppearance = true; /// åœ¨è·å–åˆ° RootViewController å®Œæˆ æ‰‹åŠ¿çš„ç»‘å®š è¿™æ ·åœ¨ Wkwebview æ‰‹åŠ¿ä¸å¯ç”¨çš„æ—¶å€™ è¯¥æ‰‹åŠ¿å°±å¯ä»¥ä½¿ç”¨äº† _panGestureRecognizer = [[UIScreenEdgePanGestureRecognizer alloc] initWithTarget:self action:@selector(handlePanGestureRecognizerMethod:)]; _panGestureRecognizer.edges = UIRectEdgeLeft; [rootViewController.view addGestureRecognizer:_panGestureRecognizer]; } return self; } -(id&lt;UIViewControllerAnimatedTransitioning>)animationControllerForPresentedController:(UIViewController *)presented presentingController:(UIViewController *)presenting sourceController:(UIViewController *)source{ return _presentdAnimation ; } -(id&lt;UIViewControllerAnimatedTransitioning>)animationControllerForDismissedController:(UIViewController *)dismissed{ return _dismissedAnimation; } -(id&lt;UIViewControllerInteractiveTransitioning>)interactionControllerForDismissal:(id&lt;UIViewControllerAnimatedTransitioning>)animator{ if (_dismissedAnimation.isInteraction) { return _interactiveTransitioning; } return nil; } -(void)handlePanGestureRecognizerMethod:(UIPanGestureRecognizer *)pan{ CGPoint point = [pan translationInView:self.view]; switch (pan.state) { case UIGestureRecognizerStateBegan: self.dismissedAnimation.isInteraction = true; [self.viewControllers.firstObject dismissViewControllerAnimated:true completion:nil]; break; case UIGestureRecognizerStateChanged: [_interactiveTransitioning updateInteractiveTransition: (CGFloat)point.x/CGRectGetWidth(self.view.frame)]; break; default: _dismissedAnimation.isInteraction = false; CGFloat locationX = ABS(point.x); CGFloat velocityX = [pan velocityInView:self.view].x; if (velocityX >= 500 || locationX >= CGRectGetWidth(self.view.frame)/2) { [_interactiveTransitioning finishInteractiveTransition]; }else{ [_interactiveTransitioning cancelInteractiveTransition]; } break; } } æ•ˆæœå¦‚ä¸‹ï¼š","categories":[{"name":"IOS","slug":"IOS","permalink":"http://www.msiter.com/categories/IOS/"}],"tags":[{"name":"WKWebView","slug":"WKWebView","permalink":"http://www.msiter.com/tags/WKWebView/"},{"name":"WebView","slug":"WebView","permalink":"http://www.msiter.com/tags/WebView/"},{"name":"UIWebView","slug":"UIWebView","permalink":"http://www.msiter.com/tags/UIWebView/"},{"name":"Input","slug":"Input","permalink":"http://www.msiter.com/tags/Input/"},{"name":"File","slug":"File","permalink":"http://www.msiter.com/tags/File/"},{"name":"Bug","slug":"Bug","permalink":"http://www.msiter.com/tags/Bug/"}],"keywords":[{"name":"IOS","slug":"IOS","permalink":"http://www.msiter.com/categories/IOS/"}]},{"title":"IOS shadowColor åŠ¨ç”» å¡é¡¿","slug":"IOS shadowColor åŠ¨ç”» å¡é¡¿","date":"2017-10-12T18:00:00.000Z","updated":"2017-11-28T11:07:04.827Z","comments":true,"path":"2017/10/12/IOS shadowColor åŠ¨ç”» å¡é¡¿/","link":"","permalink":"http://www.msiter.com/2017/10/12/IOS shadowColor åŠ¨ç”» å¡é¡¿/","excerpt":"æœ€è¿‘å¼€å‘çš„æ—¶å€™é‡è§äº†ä¸€ä»¶æ€ªäº‹å„¿ï¼Œåšäº†ä¸€ä¸ª UIViewControllerContextTransitioning,åœ¨åŒäº‹çš„æ‰‹æœºä¸Šè·³è½¬ä¼šå¡é¡¿ã€‚åœ¨æ­¤ä¹‹å‰å†™çš„è·³è½¬åŠ¨ç”»éƒ½æ²¡æœ‰å¡é¡¿çš„ç°è±¡ã€‚æœ€ç»ˆç»ˆäºå‘ç°äº†é—®é¢˜çš„æ‰€åœ¨åœ¨äº shadowColor ï¼Œåœ¨è·³è½¬çš„æ—¶å€™æˆ‘è®¾ç½®äº†ä¸€ä¸ªé˜´å½±å¢åŠ å±‚çº§å±‚æ¬¡æ•ˆæœã€‚","text":"æœ€è¿‘å¼€å‘çš„æ—¶å€™é‡è§äº†ä¸€ä»¶æ€ªäº‹å„¿ï¼Œåšäº†ä¸€ä¸ª UIViewControllerContextTransitioning,åœ¨åŒäº‹çš„æ‰‹æœºä¸Šè·³è½¬ä¼šå¡é¡¿ã€‚åœ¨æ­¤ä¹‹å‰å†™çš„è·³è½¬åŠ¨ç”»éƒ½æ²¡æœ‰å¡é¡¿çš„ç°è±¡ã€‚æœ€ç»ˆç»ˆäºå‘ç°äº†é—®é¢˜çš„æ‰€åœ¨åœ¨äº shadowColor ï¼Œåœ¨è·³è½¬çš„æ—¶å€™æˆ‘è®¾ç½®äº†ä¸€ä¸ªé˜´å½±å¢åŠ å±‚çº§å±‚æ¬¡æ•ˆæœã€‚ @implementation BaseViewControllerPresentdAnimation -(NSTimeInterval)transitionDuration:(id&lt;UIViewControllerContextTransitioning>)transitionContext { return 0.5; } -(void)animateTransition:(id&lt;UIViewControllerContextTransitioning>)transitionContext{ UIViewController *toViewController = [transitionContext viewControllerForKey:(UITransitionContextToViewControllerKey)]; UIView *containerView = [transitionContext containerView]; UIView *coverView = [UIView.alloc initWithFrame:containerView.bounds]; coverView.backgroundColor = [UIColor.blackColor colorWithAlphaComponent:0]; [containerView addSubview:coverView]; toViewController.view.transform = CGAffineTransformTranslate(toViewController.view.transform, CGRectGetWidth(toViewController.view.frame), 0); [containerView addSubview:toViewController.view]; [self makeShadowMethod:toViewController]; [UIView animateWithDuration:[self transitionDuration:transitionContext] animations:^{ toViewController.view.transform = CGAffineTransformIdentity; coverView.backgroundColor = [UIColor.blackColor colorWithAlphaComponent:0.3]; } completion:^(BOOL finished) { [coverView removeFromSuperview]; [transitionContext completeTransition:true]; }]; } -(void)makeShadowMethod:(UIViewController *)toViewController{ toViewController.view.clipsToBounds = false; /// éœ€è¦æ·»åŠ è¿™å¥è¯ï¼Œå¯ä»¥ä½¿åŠ¨ç”»ä¸å†å¡é¡¿ toViewController.view.layer.shadowPath = [UIBezierPath bezierPathWithRect:toViewController.view.bounds].CGPath; toViewController.view.layer.shadowRadius = 2; toViewController.view.layer.shadowColor = [UIColor.blackColor colorWithAlphaComponent:0.4].CGColor; toViewController.view.layer.shadowOffset = CGSizeMake(-3.0f,0); toViewController.view.layer.shadowOpacity = 0.4; } @end çŸ¥é“è¿™ä¸ªè§£å†³æ–¹æ¡ˆæ˜¯çœ‹åˆ°äº† Lu_Caçš„åšå®¢ ä¹‹åå°±å¾ˆå¥½å¥‡ä¸ºä»€ä¹ˆè¿™ä¸ªä»£ç ä¼šæœ‰è¿™ä¹ˆç¥å¥‡çš„ä½œç”¨å‘¢ï¼Ÿ SpeedBoy007çš„ä¸“æ  åªè¦ä½ æå‰å‘Šè¯‰CoreAnimationä½ è¦æ¸²æŸ“çš„Viewçš„å½¢çŠ¶Shape,å°±ä¼šå‡å°‘ç¦»å±æ¸²æŸ“è®¡ç®— [myView.layer setShadowPathï¼š[[UIBezierPath bezierPathWithRectï¼šmyView.bounds] CGPath]; åŠ ä¸Šè¿™è¡Œä»£ç ï¼Œå°±å‡å°‘ç¦»å±æ¸²æŸ“æ—¶é—´ï¼Œå¤§å¤§æé«˜äº†æ€§èƒ½","categories":[{"name":"IOS","slug":"IOS","permalink":"http://www.msiter.com/categories/IOS/"}],"tags":[{"name":"Objective-C","slug":"Objective-C","permalink":"http://www.msiter.com/tags/Objective-C/"},{"name":"ios","slug":"ios","permalink":"http://www.msiter.com/tags/ios/"}],"keywords":[{"name":"IOS","slug":"IOS","permalink":"http://www.msiter.com/categories/IOS/"}]},{"title":"ä¸€æ¯æ•¬è‡ªç”±ï¼Œä¸€æ¯æ•¬æ­»äº¡","slug":"2017-9-4 æœ‰æ„Ÿ","date":"2017-09-04T03:25:00.000Z","updated":"2017-11-28T11:07:04.827Z","comments":true,"path":"2017/09/04/2017-9-4 æœ‰æ„Ÿ/","link":"","permalink":"http://www.msiter.com/2017/09/04/2017-9-4 æœ‰æ„Ÿ/","excerpt":"","text":"è½¬çœ¼äºŒåå¤šå¹´è¿‡å»äº†ï¼Œä»Šå¹´22å²ï¼Œèº«é«˜178ï¼Œä½“é‡145æ–¤ã€‚è¿™ä¸¤å¹´ï¼Œä½“é‡æ²¡æœ‰å˜é«˜ï¼Œä½†æ˜¯ä½“é‡å’Œå¹´é¾„ç¡®å®å˜å¤§äº†ä¸å°‘ï¼Œèº«ä½“å˜å¼±äº†å¾ˆå¤šï¼Œå‡ºå»ç©çš„æ—¶å€™ï¼Œç¨å¾®è¿åŠ¨ä¸‹ï¼Œç¬¬äºŒå¤©èº«ä½“å°±ä¼šç»™å‡ºéå¸¸æ˜æ˜¾çš„ååº”ï¼Œé…¸ç—›æ„Ÿåè¶³ å¯æ€•çš„ä¸æ˜¯å˜å¤§äº†ï¼Œèº«ä½“å˜å·®äº†ï¼Œè€Œæ˜¯é»˜é»˜çš„æ¥å—äº†è¿™å„ç§è®¾å®šï¼Œç»™è‡ªå·±ä¸€ä¸ªæ”¹å˜ä¸äº†çš„ç†ç”±äº†ã€‚ è¿™äº›å¹´ï¼Œåœ¨åŒ—äº¬ï¼Œä»æœ€å¼€å§‹çš„åˆ›ä¸šå…¬å¸éå¤©ä¸‹ï¼Œåˆ°ç°åœ¨çš„å¯¥å¯¥æ•°å‡ ä¸ªã€‚çœ‹æƒ¯äº†ï¼Œå¤±è´¥ï¼Œçœ‹æƒ¯äº†ï¼Œåˆ«äººçš„æˆåŠŸã€‚çœ‹æƒ¯äº†ä»¥å‰çœ‹ä¸æƒ¯çš„ å˜è€çš„ä¸åªæ˜¯èº«ä½“ï¼Œæ›´å¤šçš„æ˜¯é‚£ä»½å¿ƒã€‚ ä»¥å‰ä¸çŸ¥é“çš„çŸ¥é“ï¼Œä½†æ˜¯å°‘äº†çš„æ˜¯ï¼Œæ—¶é—´ï¼Œæ‹¼ï¼ŒåŠ²å„¿ï¼Œå…¶å®å½’æ ¹ç»“åº•è¿˜æ˜¯å¯¹äºç›®å‰çš„ä¸æ•¢æ”¾å¼ƒï¼Œä»å¤´æ¥ï¼Œä¹Ÿè®¸ä¼šæ›´å¥½ï¼Œä½†æ˜¯ä¸æ•¢å†å»è¯•éªŒäº†ã€‚ å½“ä½ èµ°è¿›è¿™æ¬¢ä¹åœºèƒŒä¸Šæ‰€æœ‰çš„æ¢¦ä¸æƒ³å„è‰²çš„è„¸ä¸Šå„è‰²çš„å¦†æ²¡äººè®°å¾—ä½ çš„æ¨¡æ ·ä¸‰å·¡é…’è¿‡ä½ åœ¨è§’è½å›ºæ‰§çš„å”±ç€è‹¦æ¶©çš„æ­Œå¬ä»–åœ¨å–§åš£é‡Œè¢«æ·¹æ²¡ä½ æ‹¿èµ·é…’æ¯å¯¹è‡ªå·±è¯´ä¸€æ¯æ•¬æœé˜³ï¼Œä¸€æ¯æ•¬æœˆå…‰å”¤é†’æˆ‘çš„å‘å¾€ï¼Œæ¸©æŸ”äº†å¯’çª—äºæ˜¯å¯ä»¥ä¸å›å¤´çš„é€†é£é£ç¿”ä¸æ€•å¿ƒå¤´æœ‰é›¨ï¼Œçœ¼åº•æœ‰éœœä¸€æ¯æ•¬æ•…ä¹¡ï¼Œä¸€æ¯æ•¬è¿œæ–¹å®ˆç€æˆ‘çš„å–„è‰¯ï¼Œå‚¬ç€æˆ‘æˆé•¿æ‰€ä»¥å—åŒ—çš„è·¯ä»æ­¤ä¸å†æ¼«é•¿çµé­‚ä¸å†æ— å¤„å®‰æ”¾ä¸€æ¯æ•¬æ˜å¤©ï¼Œä¸€æ¯æ•¬è¿‡å¾€æ”¯æ’‘æˆ‘çš„èº«ä½“ï¼Œåšé‡äº†è‚©è†€è™½ç„¶ä»ä¸ç›¸ä¿¡æ‰€è°“å±±é«˜æ°´é•¿äººç”Ÿè‹¦çŸ­ä½•å¿…å¿µå¿µä¸å¿˜ä¸€æ¯æ•¬è‡ªç”±ï¼Œä¸€æ¯æ•¬æ­»äº¡å®½æ•æˆ‘çš„å¹³å‡¡ï¼Œé©±æ•£äº†è¿·æƒ˜å¥½å§å¤©äº®ä¹‹åæ€»æ˜¯æ½¦è‰ç¦»åœºæ¸…é†’çš„äººæœ€è’å”å¥½å§å¤©äº®ä¹‹åæ€»æ˜¯æ½¦è‰ç¦»åœºæ¸…é†’çš„äººæœ€è’å” æ˜¯å¯¹è¿˜æ˜¯é”™ï¼Œå…¶å®ä½ çŸ¥é“çš„ï¼Œåªæ˜¯ä¸æ•¢","categories":[{"name":"ç‰¢éªš","slug":"ç‰¢éªš","permalink":"http://www.msiter.com/categories/ç‰¢éªš/"}],"tags":[{"name":"ç”Ÿæ´»","slug":"ç”Ÿæ´»","permalink":"http://www.msiter.com/tags/ç”Ÿæ´»/"},{"name":"æ‚²è§‚","slug":"æ‚²è§‚","permalink":"http://www.msiter.com/tags/æ‚²è§‚/"}],"keywords":[{"name":"ç‰¢éªš","slug":"ç‰¢éªš","permalink":"http://www.msiter.com/categories/ç‰¢éªš/"}]},{"title":"AsyncDisplayKit 2.1 Gifé”™è¯¯ï¼Œä»¥åŠè§£å†³æ–¹æ³•","slug":"AsyncDisplayKit 2.1 Gifé”™è¯¯","date":"2017-08-22T14:45:00.000Z","updated":"2017-11-28T11:07:04.827Z","comments":true,"path":"2017/08/22/AsyncDisplayKit 2.1 Gifé”™è¯¯/","link":"","permalink":"http://www.msiter.com/2017/08/22/AsyncDisplayKit 2.1 Gifé”™è¯¯/","excerpt":"åœ¨ä½¿ç”¨ AsyncDisplayKit é‡åˆ°äº†ä¸€äº›é—®é¢˜ï¼Œå› ä¸ºå·¥ä½œéœ€è¦å¿…é¡»æ”¯æŒIOS7ï¼Œæ‰€ä»¥é€‰æ‹©äº† AsyncDisplayKit 2.1ç‰ˆæœ¬ã€‚ä½†æ˜¯åœ¨ä½¿ç”¨ å…¶ä¸­çš„ å±•ç¤ºgifçš„æ—¶å€™å‡ºç°äº†ä¸€äº›é—®é¢˜ã€‚","text":"åœ¨ä½¿ç”¨ AsyncDisplayKit é‡åˆ°äº†ä¸€äº›é—®é¢˜ï¼Œå› ä¸ºå·¥ä½œéœ€è¦å¿…é¡»æ”¯æŒIOS7ï¼Œæ‰€ä»¥é€‰æ‹©äº† AsyncDisplayKit 2.1ç‰ˆæœ¬ã€‚ä½†æ˜¯åœ¨ä½¿ç”¨ å…¶ä¸­çš„ å±•ç¤ºgifçš„æ—¶å€™å‡ºç°äº†ä¸€äº›é—®é¢˜ã€‚ ç›®å‰çš„ ä¿®æ”¹åº“ ç‰ˆæœ¬ä¸º åœ¨ä½¿ç”¨çš„æ—¶å€™å‡ºç°äº† GIF æœ‰çš„æ—¶å€™å‡ºç°ï¼Œæœ‰çš„æ˜¯ä¸å‡ºç°ï¼Œæœ‰çš„æ—¶å€™å‡ºç°äº†ï¼Œå´ä¸åŠ¨çš„æƒ…å†µã€‚ æœ€ç»ˆæ‰¾åˆ°è§£å†³æ–¹æ¡ˆåœ¨ã€‚ AsyncDisplayKit Pull Request 3057 ä»£ç åœ¨äº AsyncDisplayKit commit d270577f23dca63c69bc6cd0e4cea6652733a376 ä½†æ˜¯ç°åœ¨ AsyncDisokayKit å·²ç»å¼€å§‹æ”¯æŒ IOS8ç‰ˆæœ¬ä»¥ä¸Šäº†ã€‚å¹¶ä¸”å·²ç»ç§»åŠ¨åˆ°äº† Texture æ‰€ä»¥æˆ‘ä»¬åªèƒ½æ‰‹åŠ¨è‡ªå·±åˆ›å»ºäº†ä¸€ä¸ªç‰ˆæœ¬äº†ã€‚ è§£å†³æ–¹æ¡ˆ è‡ªå·±æœ¬åœ° local åº“ ä¿®æ”¹ 2.1 ç‰ˆæœ¬çš„ä»£ç  ä½¿ç”¨æˆ‘å·²ç»ä¿®æ”¹å¥½çš„ä»£ç åº“ å¼•å…¥ pod AsyncDisplayKitFix â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” 2017å¹´9æœˆ4å· å†æ¬¡ä¿®å¤äº†ï¼Œä¸¤ä¸ªé—®é¢˜ï¼Œå½“ç„¶åªæ˜¯æˆ‘çš„é¡¹ç›®ä¸­çš„ã€‚è®°å½•ä¸€ä¸‹ ç¬¬ä¸€ä¸ª. å…³äº ASTableNode åˆ·æ–°æŸä¸€ä¸ªsectionæˆ–è€…æŸä¸€ä¸ªè¡Œçš„æ—¶å€™ï¼Œä¼šå¯åŠ¨ä¸€ä¸ªéªŒè¯æ–¹æ³•ï¼Œä½†æ˜¯è¿™ä¸ªæ–¹æ³•æ˜¯éªŒè¯æ‰€æœ‰çš„sectionï¼Œæˆ‘åˆ†åˆ«æ§åˆ¶ç¬¬ä¸€ä¸ªæˆ–è€…ç¬¬äºŒä¸ªsecrionå°±ä¼šå‡ºç°åˆ·æ–°å‰å’Œåˆ·æ–°åçš„æ•°é‡å¯¹ä¸ä¸Šï¼Œè€Œå¯¼è‡´æŠ¥é”™ã€‚ åœ¨æ–‡ä»¶ _ASHierarchyChangeSet.mm _validateUpdate ä¿®æ”¹éªŒè¯ ç¬¬äºŒä¸ª. åœ¨ASTextNodeèµ‹å€¼çš„æ—¶å€™ï¼Œæˆ‘è®°å¾—æ²¡é”™è¯¯çš„è¯ã€‚å®˜æ–¹çš„ä¾‹å­æ˜¯ å¯ä»¥åˆ¤æ–­ ASTextNodeçš„attritedString æ˜¯å¦ä¸ºç©ºï¼Œæ¥åšä¸€äº›å¸ƒå±€çš„å˜åŒ–ã€‚ä½†æ˜¯åœ¨å®é™…ä½¿ç”¨ä¸­ï¼Œå‘ç°äº†å®ƒçš„æ–¹æ³•ï¼Œå†™çš„ç¡®å® - (void)setAttributedText:(NSAttributedString *)attributedText { if (attributedText == nil) { attributedText = [[NSAttributedString alloc] initWithString:@\"\" attributes:nil]; } // Don't hold textLock for too long. { ASDN::MutexLocker l(__instanceLock__); if (ASObjectIsEqual(attributedText, _attributedText)) { return; } è¿™ç§é—®é¢˜å°±æ˜¯ä¼šä¸€ç›´éƒ½ä¸èƒ½ä¸ºnilã€‚æ•…è€Œä¿®å¤ä¸º - (void)setAttributedText:(NSAttributedString *)attributedText { if (attributedText == nil) { return; } // Don't hold textLock for too long. { ASDN::MutexLocker l(__instanceLock__); if (ASObjectIsEqual(attributedText, _attributedText)) { return; }","categories":[{"name":"IOS","slug":"IOS","permalink":"http://www.msiter.com/categories/IOS/"}],"tags":[{"name":"Objective-C","slug":"Objective-C","permalink":"http://www.msiter.com/tags/Objective-C/"},{"name":"AsyncDisplayKit","slug":"AsyncDisplayKit","permalink":"http://www.msiter.com/tags/AsyncDisplayKit/"},{"name":"ios","slug":"ios","permalink":"http://www.msiter.com/tags/ios/"},{"name":"çº¦æŸæ•™ç¨‹","slug":"çº¦æŸæ•™ç¨‹","permalink":"http://www.msiter.com/tags/çº¦æŸæ•™ç¨‹/"}],"keywords":[{"name":"IOS","slug":"IOS","permalink":"http://www.msiter.com/categories/IOS/"}]},{"title":"Spring boot Mybatis å­¦ä¹ ","slug":"Spring boot Mybatis å­¦ä¹ ","date":"2017-07-21T18:25:00.000Z","updated":"2017-11-28T11:07:04.827Z","comments":true,"path":"2017/07/21/Spring boot Mybatis å­¦ä¹ /","link":"","permalink":"http://www.msiter.com/2017/07/21/Spring boot Mybatis å­¦ä¹ /","excerpt":"å¼€å§‹å‰çš„é—²èŠä¸€ç›´éƒ½æƒ³å›å®¶ï¼ŒåŒ—äº¬å‘†ä¸èµ·ã€‚æƒ³å›å®¶ï¼Œå´å‘ç°ï¼Œå®¶é‡Œçš„å¼€å‘èŒä½éƒ½æ˜¯javaçš„ï¼Œï¼Œï¼Œé‚£æ²¡åŠæ³•ï¼Œæ¡èµ·æ¥å§","text":"å¼€å§‹å‰çš„é—²èŠä¸€ç›´éƒ½æƒ³å›å®¶ï¼ŒåŒ—äº¬å‘†ä¸èµ·ã€‚æƒ³å›å®¶ï¼Œå´å‘ç°ï¼Œå®¶é‡Œçš„å¼€å‘èŒä½éƒ½æ˜¯javaçš„ï¼Œï¼Œï¼Œé‚£æ²¡åŠæ³•ï¼Œæ¡èµ·æ¥å§ åŸºæœ¬è®¾ç½®åœ¨åˆ›å»ºé¡¹ç›®çš„æ—¶å€™ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†æœ€åŸºæœ¬çš„é…ç½®ï¼Œæ‰€ä»¥é¡¹ç›®æ²¡æœ‰ç›®å½•ç­‰ã€‚æˆ‘ä»¬éœ€è¦ä½¿ç”¨mavené»˜è®¤çš„æ–‡ä»¶é…ç½® src main -- å¼€å‘åŒ… java -- ä»£ç åŒ… resources -- èµ„æºåŒ… test -- æµ‹è¯•åŒ… java -- ä»£ç åŒ… resources -- èµ„æºåŒ… gradle é…ç½®åœ¨idea åˆ›å»ºä¸€ä¸ª gradle é¡¹ç›®ã€‚ä½†æ˜¯æœ¬æ¥åœ¨æœ¬åœ°å®‰è£…äº†ä¸€ä¸ª 4.0 ç‰ˆæœ¬çš„ gradleï¼Œæˆ‘åœ¨ideaè®¾ç½®äº†ä¸€ä¸ª local gradleï¼Œä½†æ˜¯å´å‡ºç°äº†ä¸€ä¸ªé—®é¢˜ã€‚ å¯åŠ¨æœåŠ¡å™¨çš„æ—¶å€™ï¼Œå‡ºç°äº†è«åçš„é—®é¢˜æœ€ååœ¨statckflowä¸­å‘ç°äº†è§£å†³åŠæ³•å°±æ˜¯ä½¿ç”¨é»˜è®¤çš„gradleã€‚ ä¹‹åé…ç½® gradle å®‰è£…ä¿¡æ¯ group &#39;Farrom&#39; version &#39;1.0-SNAPSHOT&#39; apply plugin: &#39;java&#39; apply plugin: &#39;war&#39; apply plugin: &#39;idea&#39; sourceCompatibility = 1.8 repositories { jcenter() maven { url &quot;http://repo.spring.io/snapshot&quot; } maven { url &quot;http://repo.spring.io/milestone&quot; } } dependencies { // é˜¿é‡Œå·´å·´ durid æ•°æ®æº compile group: &#39;com.alibaba&#39;, name: &#39;druid&#39;, version: &#39;1.1.1&#39; // æ•°æ® é“¾æ¥ compile group: &#39;mysql&#39;, name: &#39;mysql-connector-java&#39;, version: &#39;6.0.6&#39; // Spring Boot compile group: &#39;org.springframework.boot&#39;, name: &#39;spring-boot-starter-web&#39;, version: &#39;1.5.4.RELEASE&#39; // Mybatis compile group: &#39;org.mybatis&#39;, name: &#39;mybatis&#39;, version: &#39;3.4.4&#39; compile group: &#39;org.mybatis&#39;, name: &#39;mybatis-spring&#39;, version: &#39;1.3.1&#39; compile group: &#39;org.mybatis.spring.boot&#39;, name: &#39;mybatis-spring-boot-starter&#39;, version: &#39;1.3.0&#39; } åˆ›å»º Spring é…ç½®æ–‡ä»¶name: Demo server: port: 8090 datasource: url: jdbc:mysql://localhost:3306/parrom?autoReconnect=true&amp;useSSL=false&amp;useUnicode=true&amp;characterEncoding=utf8 username: root password: 123456 driverClassName: com.mysql.jdbc.Driver mybatis: typeAliasesPackage: com.farrom.domain package com.farrom.config; import com.alibaba.druid.pool.DruidDataSourceFactory; import org.apache.ibatis.session.SqlSessionFactory; import org.mybatis.spring.SqlSessionFactoryBean; import org.springframework.beans.factory.annotation.Value; import org.springframework.context.annotation.Bean; import org.springframework.context.annotation.Configuration; import org.springframework.transaction.annotation.EnableTransactionManagement; import javax.sql.DataSource; import java.util.Properties; @Configuration @EnableTransactionManagement public class MybatisConfig { @Value(\"${datasource.url}\") private String url; @Value(\"${datasource.driverClassName}\") private String driverClassName; @Value(\"${datasource.username}\") private String username; @Value(\"${datasource.password}\") private String password; @Value(\"${mybatis.typeAliasesPackage}\") private String typeAliasesPackage; /** * åˆ›å»ºæ•°æ®æº * @Primary è¯¥æ³¨è§£è¡¨ç¤ºåœ¨åŒä¸€ä¸ªæ¥å£æœ‰å¤šä¸ªå®ç°ç±»å¯ä»¥æ³¨å…¥çš„æ—¶å€™ï¼Œé»˜è®¤é€‰æ‹©å“ªä¸€ä¸ªï¼Œè€Œä¸æ˜¯è®©@autowireæ³¨è§£æŠ¥é”™ */ @Bean public DataSource getDataSource() throws Exception{ Properties props = new Properties(); // props.put(\"driverClassName\", this.driverClassName); ##Loading class `com.mysql.jdbc.Driver'. This is deprecated. The new driver class is `com.mysql.cj.jdbc.Driver'. The driver is automatically registered via the SPI and manual loading of the driver class is generally unnecessary. props.put(\"url\", this.url); props.put(\"username\", this.username); props.put(\"password\", this.password); return DruidDataSourceFactory.createDataSource(props); } /** * æ ¹æ®æ•°æ®æºåˆ›å»ºSqlSessionFactory */ @Bean(name=\"sqlSessionFactory\") public SqlSessionFactory sqlSessionFactory() throws Exception { SqlSessionFactoryBean sqlSessionFactory = new SqlSessionFactoryBean(); sqlSessionFactory.setDataSource(this.getDataSource()); return sqlSessionFactory.getObject(); } } æ•°æ®åº“ emoji mysql é€‚é…ã€‚åœ¨æ ¹ç›®å½•ä¸‹çš„etcåˆ›å»ºä¸€ä¸ªæ–‡ä»¶,my.cnfã€‚åœ¨æ–‡ä»¶ä¸­è®¾ç½®é…ç½® [client] default-character-set=utf8mb4 [mysql] default-character-set=utf8mb4 [mysqld] character-set-client-handshake=FALSE character-set-server=utf8mb4 collation-server=utf8mb4_unicode_ci init-connect=&#39;SET NAMES utf8mb4&#39; åˆ›å»ºDatabaseçš„æ—¶å€™é€‰æ‹© å¯¹ä¸€ä¸ªçš„ç¼–ç  è¯¥é…ç½®ä¸éœ€è¦è®¾ç½®ä»»ä½•ä»£ç ã€‚è¿™ä¸ªæ—¶å€™ sqlsessionå°±å·²ç»åˆ›å»ºå¥½äº† ç›®å‰å°±å­¦ä¹ äº†è¿™ç‚¹ã€‚ã€‚ã€‚","categories":[{"name":"æœåŠ¡å™¨","slug":"æœåŠ¡å™¨","permalink":"http://www.msiter.com/categories/æœåŠ¡å™¨/"}],"tags":[{"name":"java","slug":"java","permalink":"http://www.msiter.com/tags/java/"},{"name":"spring boot","slug":"spring-boot","permalink":"http://www.msiter.com/tags/spring-boot/"},{"name":"mybatis","slug":"mybatis","permalink":"http://www.msiter.com/tags/mybatis/"}],"keywords":[{"name":"æœåŠ¡å™¨","slug":"æœåŠ¡å™¨","permalink":"http://www.msiter.com/categories/æœåŠ¡å™¨/"}]},{"title":"Charles version 4.1 ç ´è§£ ä»¥åŠ Https çš„ç ´è¯‘","slug":"charles 4.1 ç ´è§£","date":"2017-07-10T13:26:00.000Z","updated":"2017-11-28T11:07:04.831Z","comments":true,"path":"2017/07/10/charles 4.1 ç ´è§£/","link":"","permalink":"http://www.msiter.com/2017/07/10/charles 4.1 ç ´è§£/","excerpt":"Charles é™æ—¶ä¼˜æƒ Charles 4 æ­£ç‰ˆé™æ—¶ä¼˜æƒ ä¼˜æƒ æ´»åŠ¨ï¼ˆé™æ—¶ï¼š2016 å¹´ 8 æœˆ 8 æ—¥ - 15 æ—¥ï¼‰ï¼Œä¼˜æƒ  30 å…ƒï¼Œç‚¹å‡»é¢†å–ä¼˜æƒ åˆ¸ã€‚ ç®€ä»‹ Charles æ˜¯åœ¨ Mac ä¸‹å¸¸ç”¨çš„ç½‘ç»œå°åŒ…æˆªå–å·¥å…·ï¼Œåœ¨åšç§»åŠ¨å¼€å‘æ—¶ï¼Œæˆ‘ä»¬ä¸ºäº†è°ƒè¯•ä¸æœåŠ¡å™¨ç«¯çš„ç½‘ç»œé€šè®¯åè®®ï¼Œå¸¸å¸¸éœ€è¦æˆªå–ç½‘ç»œå°åŒ…æ¥åˆ†æã€‚","text":"Charles é™æ—¶ä¼˜æƒ Charles 4 æ­£ç‰ˆé™æ—¶ä¼˜æƒ ä¼˜æƒ æ´»åŠ¨ï¼ˆé™æ—¶ï¼š2016 å¹´ 8 æœˆ 8 æ—¥ - 15 æ—¥ï¼‰ï¼Œä¼˜æƒ  30 å…ƒï¼Œç‚¹å‡»é¢†å–ä¼˜æƒ åˆ¸ã€‚ ç®€ä»‹ Charles æ˜¯åœ¨ Mac ä¸‹å¸¸ç”¨çš„ç½‘ç»œå°åŒ…æˆªå–å·¥å…·ï¼Œåœ¨åšç§»åŠ¨å¼€å‘æ—¶ï¼Œæˆ‘ä»¬ä¸ºäº†è°ƒè¯•ä¸æœåŠ¡å™¨ç«¯çš„ç½‘ç»œé€šè®¯åè®®ï¼Œå¸¸å¸¸éœ€è¦æˆªå–ç½‘ç»œå°åŒ…æ¥åˆ†æã€‚ Charles é€šè¿‡å°†è‡ªå·±è®¾ç½®æˆç³»ç»Ÿçš„ç½‘ç»œè®¿é—®ä»£ç†æœåŠ¡å™¨ï¼Œä½¿å¾—æ‰€æœ‰çš„ç½‘ç»œè®¿é—®è¯·æ±‚éƒ½é€šè¿‡å®ƒæ¥å®Œæˆï¼Œä»è€Œå®ç°äº†ç½‘ç»œå°åŒ…çš„æˆªå–å’Œåˆ†æã€‚ é™¤äº†åœ¨åšç§»åŠ¨å¼€å‘ä¸­è°ƒè¯•ç«¯å£å¤–ï¼ŒCharles ä¹Ÿå¯ä»¥ç”¨äºåˆ†æç¬¬ä¸‰æ–¹åº”ç”¨çš„é€šè®¯åè®®ã€‚é…åˆ Charles çš„ SSL åŠŸèƒ½ï¼ŒCharles è¿˜å¯ä»¥åˆ†æ Https åè®®ã€‚ Charles æ˜¯æ”¶è´¹è½¯ä»¶ï¼Œå¯ä»¥å…è´¹è¯•ç”¨ 30 å¤©ã€‚è¯•ç”¨æœŸè¿‡åï¼Œæœªä»˜è´¹çš„ç”¨æˆ·ä»ç„¶å¯ä»¥ç»§ç»­ä½¿ç”¨ï¼Œä½†æ˜¯æ¯æ¬¡ä½¿ç”¨æ—¶é—´ä¸èƒ½è¶…è¿‡ 30 åˆ†é’Ÿï¼Œå¹¶ä¸”å¯åŠ¨æ—¶å°†ä¼šæœ‰ 10 ç§’ç§çš„å»¶æ—¶ã€‚å› æ­¤ï¼Œè¯¥ä»˜è´¹æ–¹æ¡ˆå¯¹å¹¿å¤§ç”¨æˆ·è¿˜æ˜¯ç›¸å½“å‹å¥½çš„ï¼Œå³ä½¿ä½ é•¿æœŸä¸ä»˜è´¹ï¼Œä¹Ÿèƒ½ä½¿ç”¨å®Œæ•´çš„è½¯ä»¶åŠŸèƒ½ã€‚åªæ˜¯å½“ä½ éœ€è¦é•¿æ—¶é—´è¿›è¡Œå°åŒ…è°ƒè¯•æ—¶ï¼Œä¼šå› ä¸º Charles å¼ºåˆ¶å…³é—­è€Œé‡åˆ°å½±å“ã€‚ Charles ä¸»è¦çš„åŠŸèƒ½åŒ…æ‹¬ï¼š æˆªå– Http å’Œ Https ç½‘ç»œå°åŒ…ã€‚ æ”¯æŒé‡å‘ç½‘ç»œè¯·æ±‚ï¼Œæ–¹ä¾¿åç«¯è°ƒè¯•ã€‚ æ”¯æŒä¿®æ”¹ç½‘ç»œè¯·æ±‚å‚æ•°ã€‚ æ”¯æŒç½‘ç»œè¯·æ±‚çš„æˆªè·å¹¶åŠ¨æ€ä¿®æ”¹ã€‚ æ”¯æŒæ¨¡æ‹Ÿæ…¢é€Ÿç½‘ç»œã€‚ Charles 4 æ–°å¢çš„ä¸»è¦åŠŸèƒ½åŒ…æ‹¬ï¼š æ”¯æŒ Http 2ã€‚ æ”¯æŒ IPv6ã€‚ å®‰è£… Charleså» Charles çš„å®˜æ–¹ç½‘ç«™ï¼ˆhttp://www.charlesproxy.comï¼‰ä¸‹è½½æœ€æ–°ç‰ˆçš„ Charles å®‰è£…åŒ…ï¼Œæ˜¯ä¸€ä¸ª dmg åç¼€çš„æ–‡ä»¶ã€‚æ‰“å¼€åå°† Charles æ‹–åˆ° Application ç›®å½•ä¸‹å³å®Œæˆå®‰è£…ã€‚ å°† Charles è®¾ç½®æˆç³»ç»Ÿä»£ç†ä¹‹å‰æåˆ°ï¼ŒCharles æ˜¯é€šè¿‡å°†è‡ªå·±è®¾ç½®æˆä»£ç†æœåŠ¡å™¨æ¥å®Œæˆå°åŒ…æˆªå–çš„ï¼Œæ‰€ä»¥ä½¿ç”¨ Charles çš„ç¬¬ä¸€æ­¥æ˜¯å°†å…¶è®¾ç½®æˆç³»ç»Ÿçš„ä»£ç†æœåŠ¡å™¨ã€‚ å¯åŠ¨ Charles åï¼Œç¬¬ä¸€æ¬¡ Charles ä¼šè¯·æ±‚ä½ ç»™å®ƒè®¾ç½®ç³»ç»Ÿä»£ç†çš„æƒé™ã€‚ä½ å¯ä»¥è¾“å…¥ç™»å½•å¯†ç æˆäºˆ Charles è¯¥æƒé™ã€‚ä½ ä¹Ÿå¯ä»¥å¿½ç•¥è¯¥è¯·æ±‚ï¼Œç„¶ååœ¨éœ€è¦å°† Charles è®¾ç½®æˆç³»ç»Ÿä»£ç†æ—¶ï¼Œé€‰æ‹©èœå•ä¸­çš„ â€œProxyâ€ -&gt; â€œMac OS X Proxyâ€ æ¥å°† Charles è®¾ç½®æˆç³»ç»Ÿä»£ç†ã€‚å¦‚ä¸‹æ‰€ç¤ºï¼š ä¹‹åï¼Œä½ å°±å¯ä»¥çœ‹åˆ°æºæºä¸æ–­çš„ç½‘ç»œè¯·æ±‚å‡ºç°åœ¨ Charles çš„ç•Œé¢ä¸­ã€‚ éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒChrome å’Œ Firefox æµè§ˆå™¨é»˜è®¤å¹¶ä¸ä½¿ç”¨ç³»ç»Ÿçš„ä»£ç†æœåŠ¡å™¨è®¾ç½®ï¼Œè€Œ Charles æ˜¯é€šè¿‡å°†è‡ªå·±è®¾ç½®æˆä»£ç†æœåŠ¡å™¨æ¥å®Œæˆå°åŒ…æˆªå–çš„ï¼Œæ‰€ä»¥åœ¨é»˜è®¤æƒ…å†µä¸‹æ— æ³•æˆªå– Chrome å’Œ Firefox æµè§ˆå™¨çš„ç½‘ç»œé€šè®¯å†…å®¹ã€‚å¦‚æœä½ éœ€è¦æˆªå–çš„è¯ï¼Œåœ¨ Chrome ä¸­è®¾ç½®æˆä½¿ç”¨ç³»ç»Ÿçš„ä»£ç†æœåŠ¡å™¨è®¾ç½®å³å¯ï¼Œæˆ–è€…ç›´æ¥å°†ä»£ç†æœåŠ¡å™¨è®¾ç½®æˆ 127.0.0.1:8888 ä¹Ÿå¯è¾¾åˆ°ç›¸åŒæ•ˆæœã€‚ Charles ä¸»ç•Œé¢ä»‹ç» Charles ä¸»è¦æä¾›ä¸¤ç§æŸ¥çœ‹å°åŒ…çš„è§†å›¾ï¼Œåˆ†åˆ«åä¸º â€œStructureâ€ å’Œ â€œSequenceâ€ã€‚ Structure è§†å›¾å°†ç½‘ç»œè¯·æ±‚æŒ‰è®¿é—®çš„åŸŸååˆ†ç±»ã€‚ Sequence è§†å›¾å°†ç½‘ç»œè¯·æ±‚æŒ‰è®¿é—®çš„æ—¶é—´æ’åºã€‚ å¤§å®¶å¯ä»¥æ ¹æ®å…·ä½“çš„éœ€è¦åœ¨è¿™ä¸¤ç§è§†å›¾ä¹‹å‰æ¥å›åˆ‡æ¢ã€‚è¯·æ±‚å¤šäº†æœ‰äº›æ—¶å€™ä¼šçœ‹ä¸è¿‡æ¥ï¼ŒCharles æä¾›äº†ä¸€ä¸ªç®€å•çš„ Filter åŠŸèƒ½ï¼Œå¯ä»¥è¾“å…¥å…³é”®å­—æ¥å¿«é€Ÿç­›é€‰å‡º URL ä¸­å¸¦æŒ‡å®šå…³é”®å­—çš„ç½‘ç»œè¯·æ±‚ã€‚ å¯¹äºæŸä¸€ä¸ªå…·ä½“çš„ç½‘ç»œè¯·æ±‚ï¼Œä½ å¯ä»¥æŸ¥çœ‹å…¶è¯¦ç»†çš„è¯·æ±‚å†…å®¹å’Œå“åº”å†…å®¹ã€‚å¦‚æœè¯·æ±‚å†…å®¹æ˜¯ POST çš„è¡¨å•ï¼ŒCharles ä¼šè‡ªåŠ¨å¸®ä½ å°†è¡¨å•è¿›è¡Œåˆ†é¡¹æ˜¾ç¤ºã€‚å¦‚æœå“åº”å†…å®¹æ˜¯ JSON æ ¼å¼çš„ï¼Œé‚£ä¹ˆ Charles å¯ä»¥è‡ªåŠ¨å¸®ä½ å°† JSON å†…å®¹æ ¼å¼åŒ–ï¼Œæ–¹ä¾¿ä½ æŸ¥çœ‹ã€‚å¦‚æœå“åº”å†…å®¹æ˜¯å›¾ç‰‡ï¼Œé‚£ä¹ˆ Charles å¯ä»¥æ˜¾ç¤ºå‡ºå›¾ç‰‡çš„é¢„è§ˆã€‚ è¿‡æ»¤ç½‘ç»œè¯·æ±‚é€šå¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬éœ€è¦å¯¹ç½‘ç»œè¯·æ±‚è¿›è¡Œè¿‡æ»¤ï¼Œåªç›‘æ§å‘æŒ‡å®šç›®å½•æœåŠ¡å™¨ä¸Šå‘é€çš„è¯·æ±‚ã€‚å¯¹äºè¿™ç§éœ€æ±‚ï¼Œä»¥ä¸‹å‡ ç§åŠæ³•ï¼š æ–¹æ³•ä¸€ï¼šåœ¨ä¸»ç•Œé¢çš„ä¸­éƒ¨çš„ Filter æ ä¸­å¡«å…¥éœ€è¦è¿‡æ»¤å‡ºæ¥çš„å…³é”®å­—ã€‚ä¾‹å¦‚æˆ‘ä»¬çš„æœåŠ¡å™¨çš„åœ°å€æ˜¯ï¼šhttp://yuantiku.com , é‚£ä¹ˆåªéœ€è¦åœ¨ Filter æ ä¸­å¡«å…¥ yuantiku å³å¯ã€‚ æ–¹æ³•äºŒï¼šåœ¨ Charles çš„èœå•æ é€‰æ‹© â€œProxyâ€-&gt;â€Recording Settingsâ€ï¼Œç„¶åé€‰æ‹© Include æ ï¼Œé€‰æ‹©æ·»åŠ ä¸€ä¸ªé¡¹ç›®ï¼Œç„¶åå¡«å…¥éœ€è¦ç›‘æ§çš„åè®®ï¼Œä¸»æœºåœ°å€ï¼Œç«¯å£å·ã€‚è¿™æ ·å°±å¯ä»¥åªæˆªå–ç›®æ ‡ç½‘ç«™çš„å°åŒ…äº†ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š é€šå¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä½¿ç”¨æ–¹æ³•ä¸€åšä¸€äº›ä¸´æ—¶æ€§çš„å°åŒ…è¿‡æ»¤ï¼Œä½¿ç”¨æ–¹æ³•äºŒåšä¸€äº›ç»å¸¸æ€§çš„å°åŒ…è¿‡æ»¤ã€‚ æ–¹æ³•ä¸‰ï¼šåœ¨æƒ³è¿‡æ»¤çš„ç½‘ç»œè¯·æ±‚ä¸Šå³å‡»ï¼Œé€‰æ‹© â€œFocusâ€ï¼Œä¹‹ååœ¨ Filter ä¸€æ å‹¾é€‰ä¸Š Focussed ä¸€é¡¹ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š è¿™ç§æ–¹å¼å¯ä»¥ä¸´æ—¶æ€§çš„ï¼Œå¿«é€Ÿåœ°è¿‡æ»¤å‡ºä¸€äº›æ²¡æœ‰é€šè¿‡å…³é”®å­—çš„ä¸€ç±»ç½‘ç»œè¯·æ±‚ã€‚ æˆªå– iPhone ä¸Šçš„ç½‘ç»œå°åŒ…Charles é€šå¸¸ç”¨æ¥æˆªå–æœ¬åœ°ä¸Šçš„ç½‘ç»œå°åŒ…ï¼Œä½†æ˜¯å½“æˆ‘ä»¬éœ€è¦æ—¶ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ç”¨æ¥æˆªå–å…¶å®ƒè®¾å¤‡ä¸Šçš„ç½‘ç»œè¯·æ±‚ã€‚ä¸‹é¢æˆ‘å°±ä»¥ iPhone ä¸ºä¾‹ï¼Œè®²è§£å¦‚ä½•è¿›è¡Œç›¸åº”æ“ä½œã€‚ Charles ä¸Šçš„è®¾ç½®è¦æˆªå– iPhone ä¸Šçš„ç½‘ç»œè¯·æ±‚ï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦å°† Charles çš„ä»£ç†åŠŸèƒ½æ‰“å¼€ã€‚åœ¨ Charles çš„èœå•æ ä¸Šé€‰æ‹© â€œProxyâ€-&gt;â€Proxy Settingsâ€ï¼Œå¡«å…¥ä»£ç†ç«¯å£ 8888ï¼Œå¹¶ä¸”å‹¾ä¸Š â€œEnable transparent HTTP proxyingâ€ å°±å®Œæˆäº†åœ¨ Charles ä¸Šçš„è®¾ç½®ã€‚å¦‚ä¸‹å›¾æ‰€ç¤º: iPhone ä¸Šçš„è®¾ç½®é¦–å…ˆæˆ‘ä»¬éœ€è¦è·å– Charles è¿è¡Œæ‰€åœ¨ç”µè„‘çš„ IP åœ°å€ï¼ŒCharles çš„é¡¶éƒ¨èœå•çš„ â€œHelpâ€-&gt;â€Local IP Addressâ€ï¼Œå³å¯åœ¨å¼¹å‡ºçš„å¯¹è¯æ¡†ä¸­çœ‹åˆ° IP åœ°å€ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š åœ¨ iPhone çš„ â€œ è®¾ç½® â€œ-&gt;â€ æ— çº¿å±€åŸŸç½‘ â€œ ä¸­ï¼Œå¯ä»¥çœ‹åˆ°å½“å‰è¿æ¥çš„ wifi åï¼Œé€šè¿‡ç‚¹å‡»å³è¾¹çš„è¯¦æƒ…é”®ï¼Œå¯ä»¥çœ‹åˆ°å½“å‰è¿æ¥ä¸Šçš„ wifi çš„è¯¦ç»†ä¿¡æ¯ï¼ŒåŒ…æ‹¬ IP åœ°å€ï¼Œå­ç½‘æ©ç ç­‰ä¿¡æ¯ã€‚åœ¨å…¶æœ€åº•éƒ¨æœ‰ã€ŒHTTP ä»£ç†ã€ä¸€é¡¹ï¼Œæˆ‘ä»¬å°†å…¶åˆ‡æ¢æˆæ‰‹åŠ¨ï¼Œç„¶åå¡«ä¸Š Charles è¿è¡Œæ‰€åœ¨çš„ç”µè„‘çš„ IPï¼Œä»¥åŠç«¯å£å· 8888ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š è®¾ç½®å¥½ä¹‹åï¼Œæˆ‘ä»¬æ‰“å¼€ iPhone ä¸Šçš„ä»»æ„éœ€è¦ç½‘ç»œé€šè®¯çš„ç¨‹åºï¼Œå°±å¯ä»¥çœ‹åˆ° Charles å¼¹å‡º iPhone è¯·æ±‚è¿æ¥çš„ç¡®è®¤èœå•ï¼ˆå¦‚ä¸‹å›¾æ‰€ç¤ºï¼‰ï¼Œç‚¹å‡» â€œAllowâ€ å³å¯å®Œæˆè®¾ç½®ã€‚ æˆªå– Https é€šè®¯ä¿¡æ¯å®‰è£…è¯ä¹¦å¦‚æœä½ éœ€è¦æˆªå–åˆ†æ Https åè®®ç›¸å…³çš„å†…å®¹ã€‚é‚£ä¹ˆéœ€è¦å®‰è£… Charles çš„ CA è¯ä¹¦ã€‚å…·ä½“æ­¥éª¤å¦‚ä¸‹ã€‚ é¦–å…ˆæˆ‘ä»¬éœ€è¦åœ¨ Mac ç”µè„‘ä¸Šå®‰è£…è¯ä¹¦ã€‚ç‚¹å‡» Charles çš„é¡¶éƒ¨èœå•ï¼Œé€‰æ‹© â€œHelpâ€ -&gt; â€œSSL Proxyingâ€ -&gt; â€œInstall Charles Root Certificateâ€ï¼Œç„¶åè¾“å…¥ç³»ç»Ÿçš„å¸å·å¯†ç ï¼Œå³å¯åœ¨ KeyChain çœ‹åˆ°æ·»åŠ å¥½çš„è¯ä¹¦ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå³ä½¿æ˜¯å®‰è£…å®Œè¯ä¹¦ä¹‹åï¼ŒCharles é»˜è®¤ä¹Ÿå¹¶ä¸æˆªå– Https ç½‘ç»œé€šè®¯çš„ä¿¡æ¯ï¼Œå¦‚æœä½ æƒ³å¯¹æˆªå–æŸä¸ªç½‘ç«™ä¸Šçš„æ‰€æœ‰ Https ç½‘ç»œè¯·æ±‚ï¼Œå¯ä»¥åœ¨è¯¥è¯·æ±‚ä¸Šå³å‡»ï¼Œé€‰æ‹© SSL proxyï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š è¿™æ ·ï¼Œå¯¹äºè¯¥ Host çš„æ‰€æœ‰ SSL è¯·æ±‚å¯ä»¥è¢«æˆªå–åˆ°äº†ã€‚ æˆªå–ç§»åŠ¨è®¾å¤‡ä¸­çš„ Https é€šè®¯ä¿¡æ¯å¦‚æœæˆ‘ä»¬éœ€è¦åœ¨ iOS æˆ– Android æœºå™¨ä¸Šæˆªå– Https åè®®çš„é€šè®¯å†…å®¹ï¼Œè¿˜éœ€è¦åœ¨æ‰‹æœºä¸Šå®‰è£…ç›¸åº”çš„è¯ä¹¦ã€‚ç‚¹å‡» Charles çš„é¡¶éƒ¨èœå•ï¼Œé€‰æ‹© â€œHelpâ€ -&gt; â€œSSL Proxyingâ€ -&gt; â€œInstall Charles Root Certificate on a Mobile Device or Remote Browserâ€ï¼Œç„¶åå°±å¯ä»¥çœ‹åˆ° Charles å¼¹å‡ºçš„ç®€å•çš„å®‰è£…æ•™ç¨‹ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š æŒ‰ç…§æˆ‘ä»¬ä¹‹å‰è¯´çš„æ•™ç¨‹ï¼Œåœ¨è®¾å¤‡ä¸Šè®¾ç½®å¥½ Charles ä¸ºä»£ç†åï¼Œåœ¨æ‰‹æœºæµè§ˆå™¨ä¸­è®¿é—®åœ°å€ï¼šhttp://charlesproxy.com/getsslï¼Œå³å¯æ‰“å¼€è¯ä¹¦å®‰è£…çš„ç•Œé¢ï¼Œå®‰è£…å®Œè¯ä¹¦åï¼Œå°±å¯ä»¥æˆªå–æ‰‹æœºä¸Šçš„ Https é€šè®¯å†…å®¹äº†ã€‚ä¸è¿‡åŒæ ·éœ€è¦æ³¨æ„ï¼Œé»˜è®¤æƒ…å†µä¸‹ Charles å¹¶ä¸åšæˆªå–ï¼Œä½ è¿˜éœ€è¦åœ¨è¦æˆªå–çš„ç½‘ç»œè¯·æ±‚ä¸Šå³å‡»ï¼Œé€‰æ‹© SSL proxy èœå•é¡¹ã€‚ æ¨¡æ‹Ÿæ…¢é€Ÿç½‘ç»œåœ¨åšç§»åŠ¨å¼€å‘çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¸¸å¸¸éœ€è¦æ¨¡æ‹Ÿæ…¢é€Ÿç½‘ç»œæˆ–è€…é«˜å»¶è¿Ÿçš„ç½‘ç»œï¼Œä»¥æµ‹è¯•åœ¨ç§»åŠ¨ç½‘ç»œä¸‹ï¼Œåº”ç”¨çš„è¡¨ç°æ˜¯å¦æ­£å¸¸ã€‚Charles å¯¹æ­¤éœ€æ±‚æä¾›äº†å¾ˆå¥½çš„æ”¯æŒã€‚ åœ¨ Charles çš„èœå•ä¸Šï¼Œé€‰æ‹© â€œProxyâ€-&gt;â€Throttle Settingâ€ é¡¹ï¼Œåœ¨ä¹‹åå¼¹å‡ºçš„å¯¹è¯æ¡†ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥å‹¾é€‰ä¸Š â€œEnable Throttlingâ€ï¼Œå¹¶ä¸”å¯ä»¥è®¾ç½® Throttle Preset çš„ç±»å‹ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š å¦‚æœæˆ‘ä»¬åªæƒ³æ¨¡æ‹ŸæŒ‡å®šç½‘ç«™çš„æ…¢é€Ÿç½‘ç»œï¼Œå¯ä»¥å†å‹¾é€‰ä¸Šå›¾ä¸­çš„ â€œOnly for selected hostsâ€ é¡¹ï¼Œç„¶ååœ¨å¯¹è¯æ¡†çš„ä¸‹åŠéƒ¨åˆ†è®¾ç½®ä¸­å¢åŠ æŒ‡å®šçš„ hosts é¡¹å³å¯ã€‚ ä¿®æ”¹ç½‘ç»œè¯·æ±‚å†…å®¹æœ‰äº›æ—¶å€™ä¸ºäº†è°ƒè¯•æœåŠ¡å™¨çš„æ¥å£ï¼Œæˆ‘ä»¬éœ€è¦åå¤å°è¯•ä¸åŒå‚æ•°çš„ç½‘ç»œè¯·æ±‚ã€‚Charles å¯ä»¥æ–¹ä¾¿åœ°æä¾›ç½‘ç»œè¯·æ±‚çš„ä¿®æ”¹å’Œé‡å‘åŠŸèƒ½ã€‚åªéœ€è¦åœ¨ä»¥å¾€çš„ç½‘ç»œè¯·æ±‚ä¸Šç‚¹å‡»å³é”®ï¼Œé€‰æ‹© â€œEditâ€ï¼Œå³å¯åˆ›å»ºä¸€ä¸ªå¯ç¼–è¾‘çš„ç½‘ç»œè¯·æ±‚ã€‚å¦‚ä¸‹æ‰€ç¤ºï¼š æˆ‘ä»¬å¯ä»¥ä¿®æ”¹è¯¥è¯·æ±‚çš„ä»»ä½•ä¿¡æ¯ï¼ŒåŒ…æ‹¬ URL åœ°å€ã€ç«¯å£ã€å‚æ•°ç­‰ï¼Œä¹‹åç‚¹å‡» â€œExecuteâ€ å³å¯å‘é€è¯¥ä¿®æ”¹åçš„ç½‘ç»œè¯·æ±‚ï¼ˆå¦‚ä¸‹å›¾æ‰€ç¤ºï¼‰ã€‚Charles æ”¯æŒæˆ‘ä»¬å¤šæ¬¡ä¿®æ”¹å’Œå‘é€è¯¥è¯·æ±‚ï¼Œè¿™å¯¹äºæˆ‘ä»¬å’ŒæœåŠ¡å™¨ç«¯è°ƒè¯•æ¥å£éå¸¸æ–¹ä¾¿ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š ç»™æœåŠ¡å™¨åšå‹åŠ›æµ‹è¯•æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ Charles çš„ Repeat åŠŸèƒ½æ¥ç®€å•åœ°æµ‹è¯•æœåŠ¡å™¨çš„å¹¶å‘å¤„ç†èƒ½åŠ›ï¼Œæ–¹æ³•å¦‚ä¸‹ã€‚ æˆ‘ä»¬åœ¨æƒ³æ‰“å‹çš„ç½‘ç»œè¯·æ±‚ä¸Šï¼ˆPOST æˆ– GET è¯·æ±‚å‡å¯ï¼‰å³å‡»ï¼Œç„¶åé€‰æ‹© ã€ŒRepeat Advancedã€èœå•é¡¹ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š æ¥ç€æˆ‘ä»¬å°±å¯ä»¥åœ¨å¼¹å‡ºçš„å¯¹è¯æ¡†ä¸­ï¼Œé€‰æ‹©æ‰“å‹çš„å¹¶å‘çº¿ç¨‹æ•°ä»¥åŠæ‰“å‹æ¬¡æ•°ï¼Œç¡®å®šä¹‹åï¼Œå³å¯å¼€å§‹æ‰“å‹ã€‚ æ‚„æ‚„è¯´ä¸€å¥ï¼Œä¸€äº›å†™å¾—å¾ˆå¼±çš„æŠ•ç¥¨ç½‘ç«™ï¼Œä¹Ÿå¯ä»¥ç”¨è¿™ä¸ªåŠæ³•æ¥å¿«é€ŸæŠ•ç¥¨ã€‚å½“ç„¶ï¼Œæˆ‘ä¹Ÿæ‹¿ Charles çš„ Repeat åŠŸèƒ½ç»™ä¸€äº›è¯ˆéª—çš„é’“é±¼ç½‘ç«™å–‚äº†ä¸å°‘åƒåœ¾æ•°æ®ï¼Œä¸Šæ¬¡ä¸å°å¿ƒè¿˜æŠŠä¸€ä¸ªé’“é±¼ç½‘ç«™çš„æ•°æ®åº“æ‰“æŒ‚äº†ï¼Œå—¯ï¼Œè¯·å«æˆ‘é›·é”‹ã€‚ ä¿®æ”¹æœåŠ¡å™¨è¿”å›å†…å®¹æœ‰äº›æ—¶å€™æˆ‘ä»¬æƒ³è®©æœåŠ¡å™¨è¿”å›ä¸€äº›æŒ‡å®šçš„å†…å®¹ï¼Œæ–¹ä¾¿æˆ‘ä»¬è°ƒè¯•ä¸€äº›ç‰¹æ®Šæƒ…å†µã€‚ä¾‹å¦‚åˆ—è¡¨é¡µé¢ä¸ºç©ºçš„æƒ…å†µï¼Œæ•°æ®å¼‚å¸¸çš„æƒ…å†µï¼Œéƒ¨åˆ†è€—æ—¶çš„ç½‘ç»œè¯·æ±‚è¶…æ—¶çš„æƒ…å†µç­‰ã€‚å¦‚æœæ²¡æœ‰ Charlesï¼Œè¦æœåŠ¡å™¨é…åˆæ„é€ ç›¸åº”çš„æ•°æ®æ˜¾å¾—ä¼šæ¯”è¾ƒéº»çƒ¦ã€‚è¿™ä¸ªæ—¶å€™ï¼Œä½¿ç”¨ Charles ç›¸å…³çš„åŠŸèƒ½å°±å¯ä»¥æ»¡è¶³æˆ‘ä»¬çš„éœ€æ±‚ã€‚ æ ¹æ®å…·ä½“çš„éœ€æ±‚ï¼ŒCharles æä¾›äº† Map åŠŸèƒ½ã€ Rewrite åŠŸèƒ½ä»¥åŠ Breakpoints åŠŸèƒ½ï¼Œéƒ½å¯ä»¥è¾¾åˆ°ä¿®æ”¹æœåŠ¡å™¨è¿”å›å†…å®¹çš„ç›®çš„ã€‚è¿™ä¸‰è€…åœ¨åŠŸèƒ½ä¸Šçš„å·®å¼‚æ˜¯ï¼š Map åŠŸèƒ½é€‚åˆé•¿æœŸåœ°å°†æŸä¸€äº›è¯·æ±‚é‡å®šå‘åˆ°å¦ä¸€ä¸ªç½‘ç»œåœ°å€æˆ–æœ¬åœ°æ–‡ä»¶ã€‚ Rewrite åŠŸèƒ½é€‚åˆå¯¹ç½‘ç»œè¯·æ±‚è¿›è¡Œä¸€äº›æ­£åˆ™æ›¿æ¢ã€‚ Breakpoints åŠŸèƒ½é€‚åˆåšä¸€äº›ä¸´æ—¶æ€§çš„ä¿®æ”¹ã€‚ Map åŠŸèƒ½Charles çš„ Map åŠŸèƒ½åˆ† Map Remote å’Œ Map Local ä¸¤ç§ï¼Œé¡¾åæ€ä¹‰ï¼ŒMap Remote æ˜¯å°†æŒ‡å®šçš„ç½‘ç»œè¯·æ±‚é‡å®šå‘åˆ°å¦ä¸€ä¸ªç½‘å€è¯·æ±‚åœ°å€ï¼ŒMap Local æ˜¯å°†æŒ‡å®šçš„ç½‘ç»œè¯·æ±‚é‡å®šå‘åˆ°æœ¬åœ°æ–‡ä»¶ã€‚ åœ¨ Charles çš„èœå•ä¸­ï¼Œé€‰æ‹© â€œToolsâ€-&gt;â€Map Remoteâ€ æˆ– â€œMap Localâ€ å³å¯è¿›å…¥åˆ°ç›¸åº”åŠŸèƒ½çš„è®¾ç½®é¡µé¢ã€‚ å¯¹äº Map Remote åŠŸèƒ½ï¼Œæˆ‘ä»¬éœ€è¦åˆ†åˆ«å¡«å†™ç½‘ç»œé‡å®šå‘çš„æºåœ°å€å’Œç›®çš„åœ°å€ï¼Œå¯¹äºä¸éœ€è¦é™åˆ¶çš„æ¡ä»¶ï¼Œå¯ä»¥ç•™ç©ºã€‚ä¸‹å›¾æ˜¯ä¸€ä¸ªç¤ºä¾‹ï¼Œæˆ‘å°†æ‰€æœ‰ ytk1.yuanku.wsï¼ˆæµ‹è¯•æœåŠ¡å™¨ï¼‰çš„è¯·æ±‚é‡å®šå‘åˆ°äº† www.yuantiku.comï¼ˆçº¿ä¸ŠæœåŠ¡å™¨ï¼‰ã€‚ å¯¹äº Map Local åŠŸèƒ½ï¼Œæˆ‘ä»¬éœ€è¦å¡«å†™çš„é‡å®šå‘çš„æºåœ°å€å’Œæœ¬åœ°çš„ç›®æ ‡æ–‡ä»¶ã€‚å¯¹äºæœ‰ä¸€äº›å¤æ‚çš„ç½‘ç»œè¯·æ±‚ç»“æœï¼Œæˆ‘ä»¬å¯ä»¥å…ˆä½¿ç”¨ Charles æä¾›çš„ â€œSave Responseâ€¦â€ åŠŸèƒ½ï¼Œå°†è¯·æ±‚ç»“æœä¿å­˜åˆ°æœ¬åœ°ï¼ˆå¦‚ä¸‹å›¾æ‰€ç¤ºï¼‰ï¼Œç„¶åç¨åŠ ä¿®æ”¹ï¼Œæˆä¸ºæˆ‘ä»¬çš„ç›®æ ‡æ˜ å°„æ–‡ä»¶ã€‚ ä¸‹å›¾æ˜¯ä¸€ä¸ªç¤ºä¾‹ï¼Œæˆ‘å°†ä¸€ä¸ªæŒ‡å®šçš„ç½‘ç»œè¯·æ±‚é€šè¿‡ Map Local åŠŸèƒ½æ˜ å°„åˆ°äº†æœ¬åœ°çš„ä¸€ä¸ªç»è¿‡ä¿®æ”¹çš„æ–‡ä»¶ä¸­ã€‚ Map Local åœ¨ä½¿ç”¨çš„æ—¶å€™ï¼Œæœ‰ä¸€ä¸ªæ½œåœ¨çš„é—®é¢˜ï¼Œå°±æ˜¯å…¶è¿”å›çš„ Http Response Header ä¸æ­£å¸¸çš„è¯·æ±‚å¹¶ä¸ä¸€æ ·ã€‚è¿™ä¸ªæ—¶å€™å¦‚æœå®¢æˆ·ç«¯æ ¡éªŒäº† Http Response Header ä¸­çš„éƒ¨åˆ†å†…å®¹ï¼Œå°±ä¼šä½¿å¾—è¯¥åŠŸèƒ½å¤±æ•ˆã€‚è§£å†³åŠæ³•æ˜¯åŒæ—¶ä½¿ç”¨ Map Local ä»¥ä¸‹é¢æåˆ°çš„ Rewrite åŠŸèƒ½ï¼Œå°†ç›¸å…³çš„ Http å¤´ Rewrite æˆæˆ‘ä»¬å¸Œæœ›çš„å†…å®¹ã€‚ Rewrite åŠŸèƒ½Rewrite åŠŸèƒ½åŠŸèƒ½é€‚åˆå¯¹æŸä¸€ç±»ç½‘ç»œè¯·æ±‚è¿›è¡Œä¸€äº›æ­£åˆ™æ›¿æ¢ï¼Œä»¥è¾¾åˆ°ä¿®æ”¹ç»“æœçš„ç›®çš„ã€‚ ä¾‹å¦‚ï¼Œæˆ‘ä»¬çš„å®¢æˆ·ç«¯æœ‰ä¸€ä¸ª API è¯·æ±‚æ˜¯è·å¾—ç”¨æˆ·æ˜µç§°ï¼Œè€Œæˆ‘å½“å‰çš„æ˜µç§°æ˜¯ â€œtangqiaoboyâ€ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š æˆ‘ä»¬æƒ³è¯•ç€ç›´æ¥ä¿®æ”¹ç½‘ç»œè¿”å›å€¼ï¼Œå°† tangqiaoboy æ¢æˆæˆ iosboyã€‚äºæ˜¯æˆ‘ä»¬å¯ç”¨ Rewrite åŠŸèƒ½ï¼Œç„¶åè®¾ç½®å¦‚ä¸‹çš„è§„åˆ™ï¼š å®Œæˆè®¾ç½®ä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥ä» Charles ä¸­çœ‹åˆ°ï¼Œä¹‹åçš„ API è·å¾—çš„æ˜µç§°è¢«è‡ªåŠ¨ Rewrite æˆäº† iosboyï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š Breakpoints åŠŸèƒ½ä¸Šé¢æä¾›çš„ Rewrite åŠŸèƒ½æœ€é€‚åˆåšæ‰¹é‡å’Œé•¿æœŸçš„æ›¿æ¢ï¼Œä½†æ˜¯å¾ˆå¤šæ—¶å€™ï¼Œæˆ‘ä»¬åªæ˜¯æƒ³ä¸´æ—¶ä¿®æ”¹ä¸€æ¬¡ç½‘ç»œè¯·æ±‚ç»“æœï¼Œè¿™ä¸ªæ—¶å€™ï¼Œä½¿ç”¨ Rewrite åŠŸèƒ½è™½ç„¶ä¹Ÿå¯ä»¥è¾¾åˆ°ç›®çš„ï¼Œä½†æ˜¯è¿‡äºéº»çƒ¦ï¼Œå¯¹äºä¸´æ—¶æ€§çš„ä¿®æ”¹ï¼Œæˆ‘ä»¬æœ€å¥½ä½¿ç”¨ Breakpoints åŠŸèƒ½ã€‚ Breakpoints åŠŸèƒ½ç±»ä¼¼æˆ‘ä»¬åœ¨ Xcode ä¸­è®¾ç½®çš„æ–­ç‚¹ä¸€æ ·ï¼Œå½“æŒ‡å®šçš„ç½‘ç»œè¯·æ±‚å‘ç”Ÿæ—¶ï¼ŒCharles ä¼šæˆªè·è¯¥è¯·æ±‚ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ Charles ä¸­ä¸´æ—¶ä¿®æ”¹ç½‘ç»œè¯·æ±‚çš„è¿”å›å†…å®¹ã€‚ ä¸‹å›¾æ˜¯æˆ‘ä»¬ä¸´æ—¶ä¿®æ”¹è·å–ç”¨æˆ·ä¿¡æ¯çš„ APIï¼Œå°†ç”¨æˆ·çš„æ˜µç§°è¿›è¡Œäº†æ›´æ”¹ï¼Œä¿®æ”¹å®Œæˆåç‚¹å‡» â€œExecuteâ€ åˆ™å¯ä»¥è®©ç½‘ç»œè¯·æ±‚ç»§ç»­è¿›è¡Œã€‚ éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä½¿ç”¨ Breakpoints åŠŸèƒ½å°†ç½‘ç»œè¯·æ±‚æˆªè·å¹¶ä¿®æ”¹è¿‡ç¨‹ä¸­ï¼Œæ•´ä¸ªç½‘ç»œè¯·æ±‚çš„è®¡æ—¶å¹¶ä¸ä¼šæš‚åœï¼Œæ‰€ä»¥é•¿æ—¶é—´çš„æš‚åœå¯èƒ½å¯¼è‡´å®¢æˆ·ç«¯çš„è¯·æ±‚è¶…æ—¶ã€‚ åå‘ä»£ç†Charles çš„åå‘ä»£ç†åŠŸèƒ½å…è®¸æˆ‘ä»¬å°†æœ¬åœ°çš„ç«¯å£æ˜ å°„åˆ°è¿œç¨‹çš„å¦ä¸€ä¸ªç«¯å£ä¸Šã€‚ä¾‹å¦‚ï¼Œåœ¨ä¸‹å›¾ä¸­ï¼Œæˆ‘å°†æœ¬æœºçš„ 61234 ç«¯å£æ˜ å°„åˆ°äº†è¿œç¨‹ï¼ˆwww.yuantiku.comï¼‰çš„80ç«¯å£ä¸Šäº†ã€‚è¿™æ ·ï¼Œå½“æˆ‘è®¿é—®æœ¬åœ°çš„ 61234 ç«¯å£æ—¶ï¼Œå®é™…è¿”å›çš„å†…å®¹ä¼šç”± www.yuantiku.com çš„ 80 ç«¯å£æä¾›ã€‚ è®¾ç½®å¤–éƒ¨ä»£ç†ï¼Œè§£å†³ä¸ç¿»å¢™è½¯ä»¶çš„å†²çªCharles çš„åŸç†æ˜¯æŠŠè‡ªå·±è®¾ç½®æˆç³»ç»Ÿçš„ä»£ç†æœåŠ¡å™¨ï¼Œä½†æ˜¯åœ¨ä¸­å›½ï¼Œç”±äºå·¥ä½œéœ€è¦ï¼Œæˆ‘ä»¬å¸¸å¸¸éœ€è¦ä½¿ç”¨ Google æœç´¢ï¼Œæ‰€ä»¥å¤§éƒ¨åˆ†ç¨‹åºå‘˜éƒ½æœ‰è‡ªå·±çš„ç¿»å¢™è½¯ä»¶ï¼Œè€Œè¿™äº›è½¯ä»¶çš„åŸºæœ¬åŸç†ï¼Œä¹Ÿæ˜¯æŠŠè‡ªå·±è®¾ç½®æˆç³»ç»Ÿçš„ä»£ç†æœåŠ¡å™¨ï¼Œæ¥åšåˆ°é€æ˜çš„ç¿»å¢™ã€‚ ä¸ºäº†ä½¿å¾—ä¸¤è€…èƒ½å¤Ÿå’Œå¹³å…±å¤„ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ Charles çš„ External Proxy Settings ä¸­ï¼Œè®¾ç½®ç¿»å¢™çš„ä»£ç†ç«¯å£ä»¥åŠç›¸å…³ä¿¡æ¯ã€‚åŒæ—¶ï¼Œæˆ‘ä»¬ä¹Ÿè¦å…³é—­ç›¸å…³ç¿»å¢™è½¯ä»¶çš„è‡ªåŠ¨è®¾ç½®ï¼Œä½¿å…¶ä¸ä¸»åŠ¨ä¿®æ”¹ç³»ç»Ÿä»£ç†ï¼Œé¿å… Charles å¤±æ•ˆã€‚ ç ´è§£ ä¸‹è½½ç‰¹å®šçš„ç‰ˆæœ¬çš„Charlesä»¥åŠç ´è§£æ–‡ä»¶ charles.jar åœ¨åº”ç”¨ç¨‹åºä¸­å³é”®Charlesï¼Œé€‰æ‹©â€œæ˜¾ç¤ºåŒ…å†…å®¹â€ã€‚ ä¾æ¬¡æ‰“å¼€ç›®å½•ï¼šContents -&gt; Java ç”¨ä¸‹è½½çš„charles.jaræ›¿æ¢ç›®å½•ä¸­çš„charles.jarã€‚ é‡æ–°æ‰“å¼€åè¿˜æ˜¯ç ´è§£å¤±è´¥çš„æ‰€ä»¥éœ€è¦ ç‚¹å‡» Help -&gt; Register Charles éšä¾¿è¾“å…¥å³å¯ç ´è§£å®Œæˆ æ€»ç»“é€šè¿‡ Charles è½¯ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥å¾ˆæ–¹ä¾¿åœ°åœ¨æ—¥å¸¸å¼€å‘ä¸­ï¼Œæˆªå–å’Œè°ƒè¯•ç½‘ç»œè¯·æ±‚å†…å®¹ï¼Œåˆ†æå°åŒ…åè®®ä»¥åŠæ¨¡æ‹Ÿæ…¢é€Ÿç½‘ç»œã€‚ç”¨å¥½ Charles å¯ä»¥æå¤§çš„æ–¹ä¾¿æˆ‘ä»¬å¯¹äºå¸¦æœ‰ç½‘ç»œè¯·æ±‚çš„ App çš„å¼€å‘å’Œè°ƒè¯•ã€‚ æ„¿æœ¬æ–‡å¸®åŠ©å¤§å®¶æˆä¸º Charles çš„ä¸“å®¶ï¼Œç¥å¤§å®¶ç©å¾—å¼€å¿ƒï½ æœ¬æ–‡å…¨éƒ¨å¼•ç”¨è‡ª å”å·§çš„ Charles ä»å…¥é—¨åˆ°ç²¾é€š","categories":[{"name":"å¼€å‘å¸®åŠ©","slug":"å¼€å‘å¸®åŠ©","permalink":"http://www.msiter.com/categories/å¼€å‘å¸®åŠ©/"}],"tags":[{"name":"ios","slug":"ios","permalink":"http://www.msiter.com/tags/ios/"},{"name":"çº¦æŸæ•™ç¨‹","slug":"çº¦æŸæ•™ç¨‹","permalink":"http://www.msiter.com/tags/çº¦æŸæ•™ç¨‹/"},{"name":"ç ´è§£","slug":"ç ´è§£","permalink":"http://www.msiter.com/tags/ç ´è§£/"},{"name":"æŠ“åŒ…","slug":"æŠ“åŒ…","permalink":"http://www.msiter.com/tags/æŠ“åŒ…/"}],"keywords":[{"name":"å¼€å‘å¸®åŠ©","slug":"å¼€å‘å¸®åŠ©","permalink":"http://www.msiter.com/categories/å¼€å‘å¸®åŠ©/"}]},{"title":"travis-ci æ¥ç»´æŠ¤ Cocoapods","slug":"travis-ci æ¥ç»´æŠ¤ Cocoapods","date":"2017-05-25T18:54:00.000Z","updated":"2017-11-28T11:07:04.831Z","comments":true,"path":"2017/05/25/travis-ci æ¥ç»´æŠ¤ Cocoapods/","link":"","permalink":"http://www.msiter.com/2017/05/25/travis-ci æ¥ç»´æŠ¤ Cocoapods/","excerpt":"","text":"æ•™ç¨‹å¼€å§‹å‰çš„åºŸè¯è¿ç¯‡æˆ‘ä»¬å…¬å¸çš„appï¼Œæ˜¯åœ¨æ˜¯ç«ä¸èŠäº†ã€‚é‚£ä¹ˆåŠæ³•äº†ï¼Œæˆ‘ä»¬æŠ½è±¡å‡ºæ¥ä¸€ä¸ªsdkç»™åˆ«äººæ¥å§ã€‚è¿™æ ·å­çš„è¯ï¼Œæˆ‘ä»¬æ€ä¹ˆä¹Ÿå¯ä»¥æœ‰äº›é‡å•Šã€‚ æœ€å¼€å§‹ä½¿ç”¨çš„Cocoapods å…¨éƒ¨ä»£ç å¼€å‘çš„æ–¹å¼æ¥åˆ¶ä½œçš„ï¼Œåœ¨è·¨è¿‡ä¸€ä¸ªåˆä¸€ä¸ªçš„å¤§å‘ä¹‹åï¼Œç»ˆäºåˆ°äº†ï¼Œè¦æŠŠä»£ç è¾¾æˆ .a åŒ…åœ°æ­¥ï¼Œå…¶å®æ˜¯å¯ä»¥è¾¾æˆ .framework çš„ã€‚ä¸»è¦æ˜¯è¿˜æ˜¯å› ä¸ºä»£ç éœ€è¦å…¼å®¹ ios 7 ã€‚æ‰€ä»¥å¿…é¡»è¦ä½¿ç”¨ è¾¾æˆ static çš„æ–¹å¼ã€‚ æ‰“åŒ…é¦–å…ˆä½¿ç”¨çš„æ‰“åŒ…å‘½ä»¤ï¼Œè‚¯å®šæ˜¯ xcodebuild ä¸è¦é—®æˆ‘ï¼Œå¦‚ä½•ä½¿ç”¨ï¼Œgoogleå§ã€‚ æˆ‘ä»¬ä½¿ç”¨çš„å‘½ä»¤æ—¶ xcodebuild build -project Pods/Pods.xcodeproj -target OddityOcUI è¿™æ ·å­æ‰“ä¸‹æ¥æ˜¯é»˜è®¤ Iphone sdkç‰ˆæœ¬+realese ç‰ˆæœ¬çš„ï¼Œè¿™æ ·å­åªåœ¨çœŸæœºä¸Šè¿è¡Œè‚¯å®šæ˜¯æ²¡é—®é¢˜å•¦ï½ ä½†æ˜¯ä½ æ€ä¹ˆéƒ½å¾—åšåˆ°å¯ä»¥åœ¨æ¨¡æ‹Ÿå™¨ä¸Šè·‘å§ã€‚æ‰€ä»¥å°±éœ€è¦æ¥ä¸‹æ¥çš„è¿™ä¸€å¥äº†ã€‚ xcodebuild build -project Pods/Pods.xcodeproj -target OddityOcUI -sdk iphonesimulator10.3 åé¢çš„æ˜¯ sdk ç‰ˆæœ¬ï¼Œä¸çŸ¥é“ç‰ˆæœ¬çš„å¯ä»¥è¿è¡Œå‘½ä»¤ xcodebuild -showsdks ç°åœ¨å¼€å§‹æ•´åˆ travis-ciæ—¢ç„¶éƒ½æ‰¾åˆ°è¿™é‡Œäº†ï¼Œæˆ‘å°±ä¸è·Ÿä½ bbé‚£ä¹ˆå¤šäº†ã€‚å…¶å®æˆ‘ä»¬æœ€å¤šä¸ä¼šå†™ ymlæ–‡ä»¶å˜›ã€‚ å› ä¸º budild ä¼šé‡è§éå¸¸å¤šçš„logï¼Œæˆ‘ä¸ºäº†è§£å†³ï¼Œå°è¯•ä½¿ç”¨äº†ã€‚xcpretty äº‹å®è¯æ˜â€¦â€¦ æ²¡å•¥ç”¨å¤„ã€‚å…ˆæ”¾ç€å§ã€‚ language: objective-c osx_image: xcode8.3 os: - osx branches: only: - master before_install: - gem install xcpretty install: - pod install --repo-update before_script: - git config --global user.name \"\" - git config --global user.email \"\" - git clone ${CocoaPodsRepo} script: - set -o pipefail &amp;&amp; xcodebuild build -project Pods/Pods.xcodeproj -target OddityOcUI | xcpretty -c - set -o pipefail &amp;&amp; xcodebuild build -project Pods/Pods.xcodeproj -target OddityOcUI -sdk iphonesimulator10.3 | xcpretty -c - lipo -create build/Release-iphoneos/OddityOcUI/libOddityOcUI.a build/Release-iphonesimulator/OddityOcUI/libOddityOcUI.a -output libOddityOcUI.a after_success: - bash operation.sh - cd OddityUI - git add . - git commit -m 'æ›´æ–°é€šç”¨é™æ€åŒ…' - git push --force --quiet \"https://${PersonalAccessTokens}@${GtiHubUrlRepo}\" master:master - git tag ${GtiHubTagVersion} - git push --force --quiet \"https://${PersonalAccessTokens}@${GtiHubUrlRepo}\" ${GtiHubTagVersion}:${GtiHubTagVersion} env: global: - GtiHubTagVersion: 0.3.2 - GtiHubUrlRepo: github.com/OddityUI/OddityUI.git - CocoaPodsRepo : https://github.com/OddityUI/OddityUI","categories":[{"name":"IOS","slug":"IOS","permalink":"http://www.msiter.com/categories/IOS/"}],"tags":[{"name":"ios","slug":"ios","permalink":"http://www.msiter.com/tags/ios/"},{"name":"travis-ci","slug":"travis-ci","permalink":"http://www.msiter.com/tags/travis-ci/"},{"name":"cocoapods","slug":"cocoapods","permalink":"http://www.msiter.com/tags/cocoapods/"}],"keywords":[{"name":"IOS","slug":"IOS","permalink":"http://www.msiter.com/categories/IOS/"}]},{"title":"å¥‡æ€ªçš„ unrecognized selector sent to instance é—®é¢˜","slug":"å¥‡æ€ªçš„ unrecognized selector sent to instance é—®é¢˜","date":"2017-05-18T15:39:00.000Z","updated":"2017-11-28T11:07:04.831Z","comments":true,"path":"2017/05/18/å¥‡æ€ªçš„ unrecognized selector sent to instance é—®é¢˜/","link":"","permalink":"http://www.msiter.com/2017/05/18/å¥‡æ€ªçš„ unrecognized selector sent to instance é—®é¢˜/","excerpt":"","text":"æˆ‘åšäº†ä¸€ä¸ª é»‘å¤œæ¨¡å¼ å’Œ ç™½å¤©æ¨¡å¼çš„åˆ‡æ¢ã€‚åœ¨ios8.3 çš„è®¾å¤‡ä¸Šå‘ç°äº†ä¸€ä¸ªé—®é¢˜ï¼Œä¼šå¯¼è‡´å´©æºƒã€‚æ§åˆ¶å°æ‰“å‡ºå„ç§å¥‡æ€ªçš„é—®é¢˜â€¦â€¦ unrecognized selector sent to instance å„ç§å¯¹è±¡çš„ åŒ…æ‹¬ NSURL,UIView,_FCStringâ€¦ ç­‰ç­‰ï¼Œæˆ‘å½“æ—¶å°±è’™äº†ï¼Œï¼Œæˆ‘åˆ°åº•å†™å‡ºäº†ä»€ä¹ˆæ ·å­çš„ä»£ç â€¦â€¦ ä»–æœ€ç»ˆæŠ¥é”™çš„åœ°æ–¹æˆ‘å‘é€ NSnotifitionçš„åœ°æ–¹ï¼Œä¹Ÿä¸å…·ä½“è·³åˆ°æŸä¸€ä¸ªå´©æºƒçš„ä½ç½®ã€‚ åæ¥æƒ³äº†ä¸€ä¸‹ unrecognized selector sent to instance æ˜¯ç”±äºå·²ç»é”€æ¯äº†ï¼Œè¿˜è°ƒç”¨ã€‚å¹¶ä¸”æˆ‘çš„å´©æºƒå¯¹è±¡åƒå¥‡ç™¾æ€ªçš„ã€‚å´©æºƒåœ¨å‘é€é€šçŸ¥çš„åœ°æ–¹ã€‚é‚£ä¹ˆé—®é¢˜å¤§æ¦‚å°±æ˜¯å‡ºç°åœ¨è¿™é‡Œäº†å§ã€‚æˆ‘å°è¯•åœ¨æ¯ä¸€ä¸ªåœ°æ–¹éƒ½è¿›è¡Œäº† deallocç§»é™¤é€šçŸ¥çš„æ–¹æ³•ã€‚æœç„¶ï¼Œé—®é¢˜æ¶ˆå¤±ã€‚å…¶å®æˆ‘åªç§»é™¤äº†ä¸€ä¸ªæˆ‘è‡ªå®šä¹‰çš„UIViewçš„é€šçŸ¥ï¼Œå…¶ä»–çš„UIViewControolerï¼Œæ²¡æœ‰ç§»é™¤ä¹Ÿæ˜¯æ²¡é—®é¢˜ã€‚åªæ˜¯ä¸ºäº†ä¿è¯ç™¾åˆ†ä¹‹ç™¾â€¦â€¦ çŒœæµ‹ï¼š ios8.3çš„é—®é¢˜ï¼Œåœ¨é”€æ¯åæ²¡æœ‰ç§»é™¤æˆ‘çš„é€šçŸ¥ å¼•èµ·å„ç§å¯¹è±¡çš„å´©æºƒçš„åŸå› ï¼Œä¼°è®¡æ˜¯å› ä¸ºæ–°çš„å¯¹è±¡å æ®äº†ç†è®ºä¸Šé”€æ¯çš„å¯¹è±¡çš„ ç‰©ç†åœ°å€","categories":[{"name":"IOS","slug":"IOS","permalink":"http://www.msiter.com/categories/IOS/"}],"tags":[{"name":"ios","slug":"ios","permalink":"http://www.msiter.com/tags/ios/"},{"name":"error","slug":"error","permalink":"http://www.msiter.com/tags/error/"},{"name":"å¥‡æ€ªçš„é—®é¢˜","slug":"å¥‡æ€ªçš„é—®é¢˜","permalink":"http://www.msiter.com/tags/å¥‡æ€ªçš„é—®é¢˜/"}],"keywords":[{"name":"IOS","slug":"IOS","permalink":"http://www.msiter.com/categories/IOS/"}]},{"title":"å…«çˆªé±¼ è·å–ç”¨æˆ·é¼ æ ‡æ‚¬æµ®å±‚çº§","slug":"å…«çˆªé±¼ è·å–ç”¨æˆ·é¼ æ ‡æ‚¬æµ®å±‚çº§","date":"2017-05-17T14:40:00.000Z","updated":"2017-11-28T11:07:04.831Z","comments":true,"path":"2017/05/17/å…«çˆªé±¼ è·å–ç”¨æˆ·é¼ æ ‡æ‚¬æµ®å±‚çº§/","link":"","permalink":"http://www.msiter.com/2017/05/17/å…«çˆªé±¼ è·å–ç”¨æˆ·é¼ æ ‡æ‚¬æµ®å±‚çº§/","excerpt":"å…¬å¸ä¸€ç›´å†åšæ–°é—»èšåˆï¼Œå¯¼è‡´æˆ‘ä»¬å…¬å¸ä¸€ç›´åœ¨çˆ¬å–æ–°é—»ï¼Œçˆ¬å–å„ç§è½¯ä»¶çš„æ–°é—»èµ„è®¯ã€‚ åæ¥è€æ¿çªå‘å¥‡æƒ³ï¼Œæˆ‘ä»¬ä¸å¦‚åšä¸€ä¸ªå…«æŠ“é±¼æŠŠâ€¦â€¦ é‚£ä¹ˆæ‰¾äº†ä¸¤ä¸ªåŒäº‹ï¼Œé¢„è¨€äº†ä¸€ä¸‹ã€‚é‚£å°±åšå§ï¼Œä¹‹ååŒæ—¶qtå¼€å‘ï¼Œç´§é”£å¯†é¼“çš„å±•å¼€äº†ã€‚","text":"å…¬å¸ä¸€ç›´å†åšæ–°é—»èšåˆï¼Œå¯¼è‡´æˆ‘ä»¬å…¬å¸ä¸€ç›´åœ¨çˆ¬å–æ–°é—»ï¼Œçˆ¬å–å„ç§è½¯ä»¶çš„æ–°é—»èµ„è®¯ã€‚ åæ¥è€æ¿çªå‘å¥‡æƒ³ï¼Œæˆ‘ä»¬ä¸å¦‚åšä¸€ä¸ªå…«æŠ“é±¼æŠŠâ€¦â€¦ é‚£ä¹ˆæ‰¾äº†ä¸¤ä¸ªåŒäº‹ï¼Œé¢„è¨€äº†ä¸€ä¸‹ã€‚é‚£å°±åšå§ï¼Œä¹‹ååŒæ—¶qtå¼€å‘ï¼Œç´§é”£å¯†é¼“çš„å±•å¼€äº†ã€‚ ä¸­é€”ï¼Œæˆ‘ä»¬ä¸€èµ·èŠå¤©çš„æ—¶å€™ï¼Œå°±è¯´åˆ°äº†å…«æŠ“é±¼ï¼Œæ˜¯å°ç™½ç”¨æˆ·ä½¿ç”¨çš„ï¼Œæ‰€ä»¥ä»–ä»¬æƒ³çˆ¬å–çš„å†…å®¹å±‚çº§ï¼Œéƒ½æ˜¯é¼ æ ‡é€‰ä¸­çš„ã€‚æ‰€ä»¥æƒ³åšä¸€ä¸ªé¼ æ ‡é€‰æ‹©domçš„jsã€‚è·Ÿæˆ‘åäº†ä¸€ä¼šè‹¦æ°´ã€‚é‚£ä¸ªæ—¶å€™ä¸å¤ªå¿™ï¼Œå†åŠ ä¸Šé‚£ä¼šå„¿æˆ‘åˆšåšå®Œ æ–°é—»è¯¦æƒ…é¡µçš„jsï¼Œè§‰çš„æœ‰äº›ç»éªŒã€‚ç«‹é©¬æ‹èƒ¸è„¯ï¼Œæˆ‘æ¥ã€‚å°±æœ‰äº†æ¥ä¸‹æ¥çš„ä»£ç ã€‚ /** * Created by Administrator on 2016/11/2. */ /* æ–¹æ³•è¯´æ˜ * @method æ–¹æ³•å * @for æ‰€å±ç±»å * @param {å‚æ•°ç±»å‹} å‚æ•°å å‚æ•°è¯´æ˜ * @return {è¿”å›å€¼ç±»å‹} è¿”å›å€¼è¯´æ˜ */ // window.onload=function(){ // // var p = CreateShowDomXmlLabel(); // // document.body.onmousemove = function(e) { // // var dom = e.target; // // HandleSuspendViewMethod(dom); // // p.innerText = GetDomObjectAllFatherDomName(dom); // // RemoveSuspendView(); // ç§»é™¤ä¹‹å‰çš„æ˜¾ç¤ºé®æŒ¡å±‚ // // var div = CreateSuspendView(dom); // åˆ›å»ºç°åœ¨çš„é®æŒ¡å±‚ // // document.body.insertBefore(div,p); // } // } var p = CreateShowDomXmlLabel(); document.body.onmousemove = function (e) { var dom = e.target; HandleSuspendViewMethod(dom); RemoveSuspendView(); // ç§»é™¤ä¹‹å‰çš„æ˜¾ç¤ºé®æŒ¡å±‚ var div = CreateSuspendView(dom) document.body.insertBefore(div, p); updateLabelLocationMethod(GetDomObjectAllFatherDomName(dom), div) } /// ç”¨æˆ·å½“å‰æ“ä½œçš„ dom ç»“æ„ä½“ var CurrentDomXML; /// ç”¨æˆ·åˆ›å»ºçš„é®æŒ¡å±‚çš„id åç§° var SuspendViewID = \"OddityUISuspendView\"; /* * å¤„ç†ç”¨æˆ·æ»‘åŠ¨æ—¶é—´çš„å¼€å§‹ï¼Œå¦‚æœç”¨æˆ·æ›´æ¢äº†é¼ æ ‡çš„å¯¹è±¡åˆ™ è¿›è¡Œæ¥ä¸‹æ¥çš„æ“ä½œã€‚å¦åˆ™å°±ç›´æ¥è¿”å› * @method HandleSuspendViewMethod * @param {HTMLElment} e ç”¨æˆ·å½“å‰æ»‘åŠ¨ä½ç½®çš„domç»“æ„å¯¹è±¡ */ function HandleSuspendViewMethod(e) { if (e == CurrentDomXML) { return } CurrentDomXML = e }; /* ç§»é™¤ä¹‹å‰åˆ›å»ºçš„ SuspendView * @method RemoveSuspendView */ function RemoveSuspendView() { var removeStr = document.getElementById(SuspendViewID); if (removeStr != null) { removeStr.parentNode.removeChild(removeStr); } }; //è·å–æ§ä»¶å·¦ç»å¯¹ä½ç½® function getAbsoluteLeft(o) { oLeft = o.offsetLeft while (o.offsetParent != null) { oParent = o.offsetParent oLeft += oParent.offsetLeft o = oParent } return oLeft } //è·å–æ§ä»¶ä¸Šç»å¯¹ä½ç½® function getAbsoluteTop(o) { oTop = o.offsetTop; while (o.offsetParent != null) { oParent = o.offsetParent; oTop += oParent.offsetTop; o = oParent } return oTop } /* åˆ›å»ºé®æŒ¡å±‚ æ ¹æ® ä¼ å…¥çš„ å¯¹è±¡çš„ ç»å¯¹å®šä½ è®¾ç½® é®æŒ¡å±‚çš„ ä½ç½®ã€‚ä»¥åŠ é®æŒ¡å±‚çš„ é€æ˜åº¦ã€‚ç©¿é€å±æ€§ * @method CreateSuspendView * @param {HTMLElment} e ç”¨æˆ·å½“å‰æ»‘åŠ¨ä½ç½®çš„domç»“æ„å¯¹è±¡ */ function CreateSuspendView(dom) { var div = document.createElement(\"div\"); div.id = SuspendViewID; /// è®¾ç½®divçš„ é»‘è‰² å’Œé€æ˜ div.style.opacity = 0.4; div.style.backgroundColor = \"black\"; div.style.display = \"block\"; div.style.position = \"absolute\"; div.style.borderColor = \"red\" div.style.width = dom.offsetWidth + \"px\"; div.style.height = dom.offsetHeight + \"px\"; div.style.zIndex = 99999 div.style.borderStyle = \"solid\" div.style.top = getAbsoluteTop(dom) + \"px\"; div.style.left = getAbsoluteLeft(dom) + \"px\"; /// è®¾ç½®é¼ æ ‡çš„ç©¿é€ æ•ˆæœ div.style.pointerEvents = \"none\"; return div } /// åˆ›å»º æ˜¾ç¤º DOM ç»“æ„çš„ Label function CreateShowDomXmlLabel() { var p = document.createElement(\"p\"); p.innerText = \"\"; p.style.textAlign = \"center\"; p.style.backgroundColor = \"black\"; p.style.lineHeight = \"30px\"; p.style.color = \"white\"; p.style.opacity = 1; p.style.position = \"absolute\"; p.style.height = \"30px\"; p.style.zIndex = 999991 p.style.top = \"0px\"; /// è®¾ç½®é¼ æ ‡çš„ç©¿é€ æ•ˆæœ p.style.pointerEvents = \"none\"; document.body.appendChild(p); return p } /// æ ¹æ®ä¼ å…¥çš„ dom è¿”å› dom æ ‘ å­—ç¬¦ä¸² function GetDomObjectAllFatherDomName(dom) { var domName = \"[ - \" + dom.nodeName; while (dom.parentNode) { domName = dom.parentNode.nodeName + \" > \" + domName; dom = dom.parentNode; } return domName.toLocaleLowerCase() + \" - ]\" } function updateLabelLocationMethod(str, div) { p.innerText = str; var topLocation = div.offsetTop-40 var leftLocation = div.offsetLeft if (topLocation &lt; 10) { topLocation = div.offsetHeight + div.offsetTop + 10 } p.style.top = topLocation + \"px\"; p.style.left = leftLocation + \"px\"; return div } æµ‹è¯•æ–¹æ³•ï¼Œæ‰¾åˆ°ä»»æ„æµè§ˆå™¨ï¼Œæ‰“å¼€å¼€å‘è€…æ¨¡å¼ã€‚åœ¨consoleæ§åˆ¶å°ï¼Œå¤åˆ¶ç²˜è´´è¿™äº›ä»£ç å°±å¯ä»¥çœ‹åˆ°æ•ˆæœäº†ã€‚ å…¶å®çœŸçš„æ˜¯ä¸ºäº†å‡‘åšå®¢æ•°çš„â€¦â€¦","categories":[{"name":"Web å‰ç«¯","slug":"Web-å‰ç«¯","permalink":"http://www.msiter.com/categories/Web-å‰ç«¯/"}],"tags":[{"name":"å…«çˆªé±¼","slug":"å…«çˆªé±¼","permalink":"http://www.msiter.com/tags/å…«çˆªé±¼/"},{"name":"html","slug":"html","permalink":"http://www.msiter.com/tags/html/"},{"name":"js","slug":"js","permalink":"http://www.msiter.com/tags/js/"},{"name":"Javascript","slug":"Javascript","permalink":"http://www.msiter.com/tags/Javascript/"},{"name":"é¼ æ ‡æ‚¬æµ®","slug":"é¼ æ ‡æ‚¬æµ®","permalink":"http://www.msiter.com/tags/é¼ æ ‡æ‚¬æµ®/"}],"keywords":[{"name":"Web å‰ç«¯","slug":"Web-å‰ç«¯","permalink":"http://www.msiter.com/categories/Web-å‰ç«¯/"}]},{"title":"WKWebView IOS8 ä¸‹ loadHtmlStringé”™è¯¯","slug":"WKWebView IOS8 ä¸‹ loadHtmlStringé”™è¯¯","date":"2017-05-17T14:40:00.000Z","updated":"2017-11-28T11:07:04.827Z","comments":true,"path":"2017/05/17/WKWebView IOS8 ä¸‹ loadHtmlStringé”™è¯¯/","link":"","permalink":"http://www.msiter.com/2017/05/17/WKWebView IOS8 ä¸‹ loadHtmlStringé”™è¯¯/","excerpt":"","text":"åšé¡¹ç›®çš„æ—¶å€™ï¼Œéœ€è¦å±•ç¤ºæ–°é—»è¯¦æƒ…ã€‚ç»è¿‡ä¸€ç³»åˆ—çš„è°ƒç ”ï¼Œæœ€ç»ˆé€‰å®šä¸ºä½¿ç”¨ webviewã€‚å› ä¸ºéœ€è¦æ”¯æŒios7ï¼Œæ‰€ä»¥æˆ‘åœ¨è¯¦æƒ…é¡µå°±éœ€è¦åŒæ—¶å…·å¤‡ UIWebView å’Œ WKWebViewï¼Œä¸¤ç§ã€‚ç”±äºIOS8æ‰å¼€å§‹å‡ºç°çš„WKWebViewï¼Œæ‰€ä»¥è‡ªç„¶è€Œç„¶çš„æˆ‘å½“ç„¶æƒ³ä»ios8å°±æ˜¯ç”¨WkwebVIewã€‚æ¯•ç«Ÿæ€§èƒ½å¥½ï¼Œï¼Œï¼Œå„ç§å¤¸ä½†æ˜¯å¾ˆå¿«å°±é‡è§ä¸€ä¸ªé—®é¢˜ï¼Œæœ¬æ¥å‘¢ï¼Œåœ¨ios9ï¼Œios10 ï¼Œæˆ‘ç›´æ¥è°ƒç”¨æ–¹æ³•å°±å¯ä»¥ã€‚ [_wkWebView loadHTMLString:htmlStr baseURL:[NSBundle oddity_shareBundle].bundleURL]; åœ¨htmlStr é‡Œé¢ï¼Œæˆ‘æœ‰è®¾ç½®çš„ æœ¬åœ°å›¾ç‰‡ï¼Œæœ¬åœ°jsï¼Œæœ¬åœ°cssã€‚åœ¨ ios9-10 ä¸€åˆ‡OKã€‚ä½†æ˜¯ååios8ä¸è¡Œï¼ŒåŠ è½½å‡ºæ¥æœ¬åœ°å›¾ç‰‡ï¼Œä½†æ˜¯æœ¬åœ°jsæœ¬åœ°cssåŠ è½½ä¸å‡ºæ¥â€¦â€¦ ä¸€é¡¿è°·æ­Œï¼Œæ²¡æ‰¾åˆ°â€¦â€¦ æœ€ç»ˆå¿ƒæ€ï¼Œé‚£æˆï¼Œæ”¾å¼ƒå§â€¦â€¦ ç›´æ¥ios7-8 éƒ½æ˜¯ç”¨ UIWebViewå§ã€‚ æ‰¾åˆ°äº†ä¸€äº›å‚è€ƒ ä½†æ˜¯ï¼Œåæ¥æœ‰æ¬¡æ— èŠçš„æ—¶å€™ï¼Œæƒ³åˆ°äº†ï¼ŒæŠŠjså’Œcsså…¨éƒ¨æ”¾åœ¨htmlå­—ç¬¦ä¸²ä¸å°±å¥½äº†å—ï¼Ÿ äºæ˜¯ä¹ï¼Œæœ‰äº†è¿™æ ·å­çš„ä¸€æ®µä»£ç  if ([[[UIDevice currentDevice] systemVersion] floatValue] >= 8.0 &amp;&amp; [[[UIDevice currentDevice] systemVersion] floatValue] &lt; 9.0) { NSString *file1 = [[NSBundle oddity_shareBundle] pathForResource:@\"jquery\" ofType:@\"js\"]; NSString *file2 = [[NSBundle oddity_shareBundle] pathForResource:@\"bootstrap.min\" ofType:@\"css\"]; NSString *file3 = [[NSBundle oddity_shareBundle] pathForResource:@\"content\" ofType:@\"css\"]; if (file1 &amp;&amp; file2 &amp;&amp; file3) { NSString *fileStr1 = [NSString stringWithContentsOfFile:file1 encoding:(NSUTF8StringEncoding) error:nil]; NSString *fileStr2 = [NSString stringWithContentsOfFile:file2 encoding:(NSUTF8StringEncoding) error:nil]; NSString *fileStr3 = [NSString stringWithContentsOfFile:file3 encoding:(NSUTF8StringEncoding) error:nil]; topHeader = [NSString stringWithFormat:@\"&lt;script type=\\\"text/javascript\\\">%@&lt;/script>&lt;style type=\\\"text/css\\\">%@&lt;/style>&lt;style type=\\\"text/css\\\">%@&lt;/style>\",fileStr1,fileStr2,fileStr3]; } } å…¶å®è¿˜å¯ä»¥ä¼˜åŒ–çš„ï¼Œæ¯”å¦‚è¿™ä¸ªæ–‡ä»¶å…¶å®ç¤¼ç‰©ä¸Šåªéœ€è¦è¯»å–ä¸€æ¬¡å°±å¯ä»¥çš„ï¼Œä½†æ˜¯æˆ‘ç°åœ¨ä¼šæ¯æ¬¡éƒ½è¯»å–ï¼Œè¿™ä¸ªæ—¶å€™å°±å¯ä»¥åšä¸€ä¸ªç¼“å­˜ã€‚æˆ–è€…å…¶ä»–äº‘äº‘ã€‚ æˆ‘è¿™é‡Œåªæ˜¯æä¾›ä¸€ä¸ªæ€è·¯ã€‚ã€‚ã€‚","categories":[{"name":"IOS","slug":"IOS","permalink":"http://www.msiter.com/categories/IOS/"}],"tags":[{"name":"WKWebView","slug":"WKWebView","permalink":"http://www.msiter.com/tags/WKWebView/"},{"name":"Systematic distinction","slug":"Systematic-distinction","permalink":"http://www.msiter.com/tags/Systematic-distinction/"}],"keywords":[{"name":"IOS","slug":"IOS","permalink":"http://www.msiter.com/categories/IOS/"}]},{"title":"Html å­—ç¬¦ä¸²è½¬æ¢æˆ AttributedString iosç‰ˆæœ¬ä¸‹çš„é”™è¯¯","slug":"Html å­—ç¬¦ä¸²è½¬æ¢æˆ AttributedString iosç‰ˆæœ¬ä¸‹çš„é”™è¯¯","date":"2017-05-17T14:31:00.000Z","updated":"2017-11-28T11:07:04.827Z","comments":true,"path":"2017/05/17/Html å­—ç¬¦ä¸²è½¬æ¢æˆ AttributedString iosç‰ˆæœ¬ä¸‹çš„é”™è¯¯/","link":"","permalink":"http://www.msiter.com/2017/05/17/Html å­—ç¬¦ä¸²è½¬æ¢æˆ AttributedString iosç‰ˆæœ¬ä¸‹çš„é”™è¯¯/","excerpt":"åœ¨iosä¸­æƒ³è¦æŠŠhtmlå­—ç¬¦ä¸²è½¬æ¢æˆ AttributedString ï¼Œéœ€è¦ä½¿ç”¨ä»¥ä¸‹æ–¹æ³•","text":"åœ¨iosä¸­æƒ³è¦æŠŠhtmlå­—ç¬¦ä¸²è½¬æ¢æˆ AttributedString ï¼Œéœ€è¦ä½¿ç”¨ä»¥ä¸‹æ–¹æ³• NSMutableAttributedString *attributedString = [[NSMutableAttributedString alloc] initWithData:[title dataUsingEncoding:NSUnicodeStringEncoding] options:@{ NSDocumentTypeDocumentAttribute: NSHTMLTextDocumentType } documentAttributes:nil error:nil]; è¿™æ ·å­çš„è¯,htmlå­—ç¬¦ä¸²å°±å¯ä»¥è½¬æ¢ä¸º NSMutableAttributedString å¯¹è±¡ï¼Œå¯ä»¥å±•ç¤ºåœ¨å¯ä»¥å±•ç¤º AttributedStringçš„ç©ºé—´ä¸Šï¼Œä½†æ˜¯è¿™ä¸ªä¸œè¥¿æ˜¯æœ‰ä¸€å®šæ—¶é—´çš„è€—æ—¶çš„ã€‚å°¤å…¶æ˜¯åœ¨ tableviewä¸Šä¼šæ¶ˆè€—å¾ˆå¤§çš„è®¡ç®—æ—¶é—´ï¼Œä½¿æ»‘åŠ¨å‡ºç°é—®é¢˜ã€‚é‚£ä¹ˆæˆ‘ä»¬å°±éœ€è¦è¿›è¡Œä¸€ä¸ªä¸€æ­¥è®¡ç®—ï¼Œå¹¶ä¸”ä¸ºäº†æ›´å¥½çš„èŠ‚çœæ€§èƒ½ï¼Œæˆ‘ä»¬æœ€å¥½åšä¸€ä¸ªç¼“å­˜ã€‚æ¥ä¸‹æ¥å°±æ˜¯æˆ‘çš„åˆ¶ä½œæ–¹å¼ @interface OddityHtmlTitleCache() @property(nonatomic,strong) NSCache *sharedCache; @end @implementation OddityHtmlTitleCache // åˆ›å»ºä¸€ä¸ª å•åˆ©çš„ ç®¡ç†å™¨ +(OddityHtmlTitleCache *)sharedCache{ static OddityHtmlTitleCache *sharedManager; static dispatch_once_t onceToken; dispatch_once(&amp;onceToken, ^{ sharedManager = [[OddityHtmlTitleCache alloc]init]; sharedManager.sharedCache = [[NSCache alloc] init];; }); return sharedManager; } // æ ¹æ® htmlå­—ç¬¦ä¸²è·å– NSAttributedString -(NSAttributedString *)htmlTitleByString:(NSString *)title{ // åœ¨cache æå– id viewController = [self.sharedCache objectForKey:title]; if ( viewController) { return viewController; } NSMutableAttributedString *attributedString = [[NSMutableAttributedString alloc] initWithData:[title dataUsingEncoding:NSUnicodeStringEncoding] options:@{ NSDocumentTypeDocumentAttribute: NSHTMLTextDocumentType } documentAttributes:nil error:nil]; [attributedString addAttributes:@{ NSFontAttributeName:[UIFont oddity_font3], } range:[attributedString.string fullRange]]; if (attributedString) { [self.sharedCache setObject:attributedString forKey:title]; } return attributedString; } @end æœ€å¼€å§‹ï¼Œæˆ‘æ˜¯åœ¨ios10ï¼Œæµ‹è¯•çš„ï¼Œæ²¡æœ‰é—®é¢˜ï¼Œä½†æ˜¯æˆ‘çš„åŒæ—¶åé¦ˆç»™æˆ‘ã€‚ä»–æœ‰å´©æºƒã€‚æœ€ç»ˆæˆ‘æŸ¥åˆ°äº†,åœ¨stackoverflowï¼Œè¿™ä¸ªè½¬çš„æ–¹æ³•ï¼Œåœ¨ios9.2ä¹‹å‰ï¼Œå¼‚æ­¥æ‰§è¡Œè¯¥æ–¹æ³•éƒ½ä¼šé”™è¯¯çš„ã€‚ä¸”è¡Œä¸”çæƒœæŠŠâ€¦â€¦","categories":[{"name":"IOS","slug":"IOS","permalink":"http://www.msiter.com/categories/IOS/"}],"tags":[{"name":"AttributedString","slug":"AttributedString","permalink":"http://www.msiter.com/tags/AttributedString/"},{"name":"iOS8 html2AttributedString error","slug":"iOS8-html2AttributedString-error","permalink":"http://www.msiter.com/tags/iOS8-html2AttributedString-error/"}],"keywords":[{"name":"IOS","slug":"IOS","permalink":"http://www.msiter.com/categories/IOS/"}]},{"title":"WebKit WkwebView dealloc Crashé”™è¯¯","slug":"WebKit WkwebView dealloc Crashé”™è¯¯","date":"2017-05-17T14:19:00.000Z","updated":"2017-11-28T11:07:04.827Z","comments":true,"path":"2017/05/17/WebKit WkwebView dealloc Crashé”™è¯¯/","link":"","permalink":"http://www.msiter.com/2017/05/17/WebKit WkwebView dealloc Crashé”™è¯¯/","excerpt":"","text":"ä»Šå¤©é‡åˆ°ä¸€ä¸ªå¥‡æ€ªçš„é—®é¢˜ï¼Œåœ¨æˆ‘ dismiss UIViewControlleråï¼Œæˆ‘çš„UIViewControlleræ²¡æœ‰é”€æ¯ï¼Œè¿™å¯¼è‡´å†…å­˜åœ¨æ…¢æ…¢çš„å¢é•¿ï¼Œæ²¡æœ‰é”€æ¯ã€‚æŸ¥äº†ä¸€ä¼šå„¿ï¼ŒæŠŠé—®é¢˜é”å®šåœ¨äº† WKWebViewä¸Šäº†ï¼Œæˆ‘å¼€å§‹æ…¢æ…¢çš„æ³¨é‡Šï¼Œè°ƒè¯•ï¼Œæœ€åå‘ç°ã€‚æ˜¯æˆ‘çš„ä»¥ä¸‹ä»£ç çš„é—®é¢˜ã€‚ self.configuration = [[WKWebViewConfiguration alloc] init]; [self.configuration.userContentController addScriptMessageHandler:self name: OddityWkWebViewConfiguration]; _wkWebView = [[OddityCustomWkWebView alloc]initWithFrame:(CGRectZero) configuration:self.configuration]; åœ¨æˆ‘æ³¨é‡Šäº†ï¼ŒaddScriptMessageHandleræ–¹æ³•ä¹‹åï¼Œdeallocè°ƒç”¨äº†ã€‚é‚£ä¹ˆå°±çŸ¥é“äº†é—®é¢˜äº†ã€‚åœ¨ ViewDidDisapper æ–¹æ³•ï¼ŒremoveScriptMessageHandlerForName å°±å¥½äº† -(void)viewDidDisappear:(BOOL)animated{ [super viewDidDisappear:animated]; [self.configuration.userContentController removeScriptMessageHandlerForName: OddityWkWebViewConfiguration]; } å†åæ¥æˆ‘å‘ç°åœ¨iosçš„æµ‹è¯•æœºä¸Šï¼Œæˆ‘æ¨å‡ºå»ä¹‹åä¼šç›´æ¥å´©æºƒã€‚æ§åˆ¶å°æ‰“å°å‡ºï¼Œé‡æŒ‡é’ˆçš„é—®é¢˜ï¼Œæœ€åç¡®è®¤ä¸ºé‡æŒ‡é’ˆå°±æ˜¯ WkWebViewã€‚åæ¥åœ¨ stackoverflowæ‰¾åˆ°äº†è¿™ä¸ªé—®é¢˜çš„è§£å†³ã€‚æœ€åæ›´æ–°ä¸º -(void)viewDidDisappear:(BOOL)animated{ [super viewDidDisappear:animated]; self.wkWebView.scrollView.delegate = nil; [self.configuration.userContentController removeScriptMessageHandlerForName: OddityWkWebViewConfiguration]; } å¥½äº†ï¼Œä¸å´©æºƒäº†ã€‚","categories":[{"name":"IOS","slug":"IOS","permalink":"http://www.msiter.com/categories/IOS/"}],"tags":[{"name":"Systematic distinction","slug":"Systematic-distinction","permalink":"http://www.msiter.com/tags/Systematic-distinction/"},{"name":"WebKit","slug":"WebKit","permalink":"http://www.msiter.com/tags/WebKit/"}],"keywords":[{"name":"IOS","slug":"IOS","permalink":"http://www.msiter.com/categories/IOS/"}]},{"title":"Autolayout å’Œ size-class ç®€æ˜æ•™ç¨‹","slug":"Autolayout å’Œ size-class ç®€æ˜æ•™ç¨‹","date":"2016-11-21T03:25:00.000Z","updated":"2017-11-28T11:07:04.827Z","comments":true,"path":"2016/11/21/Autolayout å’Œ size-class ç®€æ˜æ•™ç¨‹/","link":"","permalink":"http://www.msiter.com/2016/11/21/Autolayout å’Œ size-class ç®€æ˜æ•™ç¨‹/","excerpt":"æ•™ç¨‹å¼€å§‹å‰çš„åºŸè¯è¿ç¯‡åœ¨iphone5å‡ºç°ä¹‹åï¼Œä¹Ÿå°±æ˜¯ios6çš„æ—¶å€™ã€‚çº¦æŸ(autolayout)å‡ºç°äº†ï¼Œå…¶å®æœ€å¼€å§‹çš„æ—¶å€™ï¼Œios deverä»¬éƒ½è¿˜æ˜¯åšæŒæ‰‹å†™ä»£ç ï¼Œæ¯•ç«Ÿè‡ªå·±ç”¨äº†å¥½å‡ å¹´äº†ï¼Œä½ è¯´æ¢å°±æ¢ï¼Œç°åœ¨çš„éœ€æ±‚ä½ å¸®æˆ‘å†™å•Šï¼Ÿæ‰€ä»¥å¯¼è‡´å½“æ—¶ä½¿ç”¨çº¦æŸçš„å°‘ä¹‹åˆå°‘ï¼Œç›´è‡³åæ¥å‡ºç°äº†æ¨ªå±å’Œç«–å±ä¹‹ç±»é€‚é…ï¼Œè€Œä¸”å±å¹•æ›´å¤šç¹å¤šçš„æ—¶å€™ï¼Œæ‰‹å†™ä»£ç å·²ç»è¶Šæ¥è¶Šä¸å¤ªèƒ½æ‹…ä»»è¿™ä¸ªä»»åŠ¡çš„æ—¶å€™ï¼Œæ‰å¼€å§‹æ…¢æ…¢çš„è¿›å…¥äº†è¿™ä¸ªå¤§æ½®","text":"æ•™ç¨‹å¼€å§‹å‰çš„åºŸè¯è¿ç¯‡åœ¨iphone5å‡ºç°ä¹‹åï¼Œä¹Ÿå°±æ˜¯ios6çš„æ—¶å€™ã€‚çº¦æŸ(autolayout)å‡ºç°äº†ï¼Œå…¶å®æœ€å¼€å§‹çš„æ—¶å€™ï¼Œios deverä»¬éƒ½è¿˜æ˜¯åšæŒæ‰‹å†™ä»£ç ï¼Œæ¯•ç«Ÿè‡ªå·±ç”¨äº†å¥½å‡ å¹´äº†ï¼Œä½ è¯´æ¢å°±æ¢ï¼Œç°åœ¨çš„éœ€æ±‚ä½ å¸®æˆ‘å†™å•Šï¼Ÿæ‰€ä»¥å¯¼è‡´å½“æ—¶ä½¿ç”¨çº¦æŸçš„å°‘ä¹‹åˆå°‘ï¼Œç›´è‡³åæ¥å‡ºç°äº†æ¨ªå±å’Œç«–å±ä¹‹ç±»é€‚é…ï¼Œè€Œä¸”å±å¹•æ›´å¤šç¹å¤šçš„æ—¶å€™ï¼Œæ‰‹å†™ä»£ç å·²ç»è¶Šæ¥è¶Šä¸å¤ªèƒ½æ‹…ä»»è¿™ä¸ªä»»åŠ¡çš„æ—¶å€™ï¼Œæ‰å¼€å§‹æ…¢æ…¢çš„è¿›å…¥äº†è¿™ä¸ªå¤§æ½®è€Œæˆ‘æ¯”è¾ƒå¹¸è¿ï¼Œåœ¨iphone5çš„æ—¶å€™ç¬¬ä¸€æ¬¡æ‹¥æœ‰äº†iphoneæ‰‹æœºï¼Œåœ¨æˆ‘å­¦ä¹ iosçš„æ—¶å€™ï¼Œiphone6å’Œswiftè¿™ä¸¤ä¸ªä¸œè¥¿å‡ºç°äº†ã€‚æ‰€ä»¥æˆ‘æœ€å¼€å§‹å­¦ä¹ çš„æ—¶å€™å°±æ˜¯ä½¿ç”¨ storyboardå’Œçº¦æŸä¸€èµ·å­¦ä¹ çš„å¥½äº†åºŸè¯ä¸å¤šè¯´äº†ã€‚çº¦æŸåˆ°åº•æ˜¯ä»€ä¹ˆä¸œè¥¿å‘¢ï¼Ÿå…¶å®è¯´ç™½äº†ä»–æ˜¯ä¸€ç§æè¿°æ€§çš„å¸ƒå±€æ–¹å¼ã€‚ä»€ä¹ˆæ˜¯æè¿°ï¼Ÿæ¯”å¦‚è¯´ã€‚â€œå’³å’³ï¼Œè¿™ä¸ªå›¾ç‰‡è·ç¦»è¿™ä¸ªæŒ‰é’®çš„å³è¾¹10åƒç´ ï¼Œè·ç¦»å±å¹•ä¸Šæ–¹10åƒç´ ï¼å›¾ç‰‡çš„å¤§å°æ˜¯80x80â€ã€‚è¿™å°±å«åšæè¿°ï¼Œè¿™æ ·æˆ‘ä»¬çš„å‰è¾ˆä»¬(appleçš„å¼€å‘äººå‘˜ä»¬)ï¼Œå°±ä¼šæŠŠæˆ‘ä»¬çš„æè¿°è§£ææˆç›¸å¯¹åº”çš„å¸ƒå±€æ–¹å¼ï¼Œå®Œæˆå›¾ç‰‡ä½ç½®çš„æ”¾ç½®ã€‚å…¶å®è¯´åˆ°å¸ƒå±€ï¼Œæ— è®ºæ‰‹å†™ä»£ç è¿˜æ˜¯xib,sb(storyboard)éƒ½å¯ä»¥è¿›è¡Œçº¦æŸçš„ç¼–ç çš„ã€‚ æˆ‘ä»¬æ•™ç¨‹é¦–å…ˆå­¦ä¹  sb,xibè¿™ä¸€ç±»çš„å¸ƒå±€ï¼Œå› ä¸ºè¿™æ ·å’±ä»¬å¯ä»¥å¾ˆç›´è§‚çš„çœ‹åˆ°çº¦æŸå¯¹äºviewçš„å¸ƒå±€å½±å“ã€‚å½“æˆ‘ä»¬è¶³å¤Ÿç†Ÿæ‚‰å¸ƒå±€çš„æ—¶å€™ï¼Œå†è½¬å…¥æ‰‹å†™å¸ƒå±€ä¼šæ–¹ä¾¿å¾ˆå¤šè¿™ç¯‡æ•™ç¨‹å°†ä»¥è¿™å‡ ä¸ªæ–¹é¢è¿›è¡Œè®²è§£ XIB StoryBoard çº¦æŸè®¾ç½® NSLayoutConstraint çº¦æŸè®¾ç½® VFL çº¦æŸè®¾ç½® NSLayoutAnchor çº¦æŸè®¾ç½® ç¬¬ä¸‰æ–¹çº¦æŸè®¾ç½® ä¾‹å­æ€»ç»“ ï¼ å®ä¾‹ æ€»ç»“ XIB StoryBoard çº¦æŸè®¾ç½®åœ¨æˆ‘ä»¬å­¦ä¹ ä¹‹å‰ï¼Œè¯·ä½ ä»¬è‡ªå·±å»ºç«‹ä¸€ä¸ªé¡¹ç›®ã€‚æ‰“å¼€storyboardçš„é¢„è§ˆç•Œé¢ï¼Œå’±ä»¬åœ¨ç•Œé¢çš„æœ€ä¸‹æ–¹ ä¸‹æ–¹æœ‰ä¸‰ä¸ªbuttonï¼Œåˆ†åˆ«æ˜¯ align pin resole auto layout issues align:è‹±æ–‡è§£é‡Šçš„æ„æ€ä¸ºæ’åºï¼Œé‚£ä¹ˆæˆ‘ä»¬å³å¯ä»¥ç†è§£ä¸ºï¼Œæ’åºâ€¦ç‚¹å‡»å±•å¼€é€‰é¡¹ï¼Œæˆ‘ä¼šæŒ¨ä¸ªè§£é‡Šä¸€ä¸‹ã€‚ psé€‰é¡¹ä¸€å…±æœ‰4ä¸ªç±»åˆ«ã€‚ç¬¬ä¸€ç±»å’Œç¬¬äºŒç±»æ˜¯éœ€è¦é€‰ä¸­ä¸¤ä¸ªæˆ–è€…å¤šä¸ªçš„viewçš„æ—¶å€™ï¼Œæ‰å¯ä»¥æ“ä½œ Leading Edges é€‰ä¸­çš„viewsä»¬ å·¦ å¯¹é½ Trailing Edges é€‰ä¸­çš„viewsä»¬ å³ å¯¹é½ Top Edges é€‰ä¸­çš„viewsä»¬ ä¸Š å¯¹é½ Bottom Edges é€‰ä¸­çš„viewsä»¬ ä¸‹ å¯¹é½ Horizontal Centers é€‰ä¸­çš„viewsä»¬ æ°´å¹³æ–¹å‘ ä¸­å¿ƒå¯¹é½ Vertical Centers é€‰ä¸­çš„viewsä»¬ å‚ç›´æ–¹å‘ ä¸­å¿ƒå¯¹é½ Baselines é€‰ä¸­çš„viewsä»¬åŸºäº åŸºçº¿ å¯¹é½ Horizontally in Container é€‰ä¸­çš„è§†å›¾ ç›¸å¯¹äº çˆ¶è§†å›¾ è¿›è¡Œ æ°´å¹³æ–¹å‘ å¯¹é½ Vertical in Container é€‰ä¸­çš„è§†å›¾ ç›¸å¯¹äº çˆ¶è§†å›¾ è¿›è¡Œ å‚ç›´æ–¹å‘ å¯¹é½ Update Frames None å†è®¾ç½®äº†è¿™äº›çº¦æŸä¹‹åä¸è¿›è¡ŒFrameçš„æ›´æ”¹ Update Frames Items of New Constraints è®¾ç½®äº†è¿™äº›çº¦æŸä¹‹å åªæ›´æ”¹é€‰ä¸­çš„è¿™äº›viewsçš„Frame Update Frames All Frames in Container æ›´æ”¹è¯¥ vc é‡Œæ‰€æœ‰Viewçš„çº¦æŸ (æ…ç”¨!!!!!!) pin:è‹±æ–‡è§£é‡Šä¸º å¤§å¤´é’ˆï¼Œå…¶å®æˆ‘ä»¬å°±å¯ä»¥ä¸ºï¼Œè¿™ä¸ªå±•å¼€é¡¹å†…çš„æ‰€æœ‰çš„ç°è±¡éƒ½æ˜¯ä¸ºäº†å°†è§†å›¾è®¢åœ¨æŸä¸€ä¸ªä½ç½®çš„ã€‚é‚£ä¹ˆæˆ‘ä»¬å†æ¬¡å±•å¼€é€‰é¡¹ ä¸Šæ–¹çš„è¾“å…¥æ¡† è¿™ä¸ªè¾“å…¥æ¡†æ—¶è¡¨ç¤ºå½“å‰é€‰ä¸­çš„viewsæˆ–è€…viewè·ç¦»çˆ¶è§†å›¾çš„ä¸Šæ–¹è·ç¦»ä¸ºå¤šå°‘ï¼Œå·¦å³ä¸‹åŒç†ï¼Œä¸ä¸€ä¸€èµ˜è¿°äº† è€Œç‚¹å‡»è¿™ä¸ªå€’ä¸‰è§’å¼€å¯çš„é€‰é¡¹ä¸­ User Standard Value æ˜¯è¯´ä½¿ç”¨æ ‡å‡†çš„çš„å€¼ï¼Œè€Œä¸”è¿™ä¸ªå€¼åªæœ‰åœ¨æ˜¯è®¾ç½®ä¸Šä¸‹æ–¹å‘çš„æ—¶å€™æ‰æœ‰ç”¨ã€‚é»˜è®¤çš„å€¼å…¶å®å°±æ˜¯è·ç¦» Bottom Layout Guideï¼Œä¹Ÿå°±æ˜¯ä¸Šä¸‹åŸºçº¿ã€‚ä¸‹åŸºçº¿å°±æ˜¯è·ç¦»è§†å›¾æœ€åº•éƒ¨ã€‚ä¸ŠåŸºçº¿å°±æ˜¯è·ç¦»StatusViewä¸‹æ–¹çš„ä½ç½®ã€‚è€Œè¿™é‡Œçš„é»˜è®¤å€¼å…¶å®æ˜¯8 User Current Canvas Value ä½¿ç”¨å½“å‰ä½ç½®è®¾ç½®ã€‚é»˜è®¤ä¸ºå½“å‰è®¾ç½®æ–¹å‘æœ€è¿‘çš„ä¸€ä¸ªVIewï¼Œä¸”æ²¡æœ‰è¦†ç›–é®æŒ¡çš„è§†å›¾ å‰©ä¸‹çš„é€‰é¡¹ï¼Œä¼šæ ¹æ®å½“å‰è§†å›¾çš„å¸ƒç½®æƒ…å†µæœ‰æ‰€ä¸åŒï¼Œä½†æ˜¯é“ç†ç›¸å½“ï¼Œè¿™ä¸ªé€‰é¡¹æ˜¯è®©ä½ è®¾ç½®ä½ è¦æ ¹æ®é‚£ä¸ªè§†å›¾è¿›è¡Œå½“å‰ä½ç½®è·ç¦»çš„è®¾ç½®çš„ Width å’Œ Height è¿™ä¸ªä¸éœ€è¦æˆ‘èµ˜è¿°äº†å§ã€‚åˆ†åˆ«æ˜¯ å®½åº¦å’Œé«˜åº¦ çš„è®¾ç½® Constarain to Margins. è¿™ä¸ªæ˜¯å¦éœ€è¦å¤–è¾¹è· é»˜è®¤ä¸º 8 ã€‚ä¸€èˆ¬æ²¡å•¥åµç”¨ï¼Œéƒ½ä¼šå»æ‰ Equal Widths å’Œ Equal Heights è¿™ä¸¤ä¸ªé€‰é¡¹éœ€è¦é€‰æ‹©ä¸¤ä¸ªè§†å›¾ã€‚æ¯”å¦‚é€‰ä¸­View1å’ŒView2ï¼Œé‚£ä¹ˆå¯ä»¥åˆ†åˆ«è®¾ç½®è¿™ä¸ªä¸¤ä¸ªè§†å›¾å®½åº¦å’Œé«˜åº¦ç›¸ç­‰ Aspect Ratio è¿™ä¸ªå±æ€§æ˜¯è®¾ç½®é€‰ä¸­Viewçš„æ¯”ä¾‹ã€‚å½“ä½ ç‚¹å‡»è®¾ç½®çš„æ—¶å€™ï¼Œé»˜è®¤ä»–ä¼šè®¾ç½®å½“å‰è§†å›¾çš„æ¯”ä¾‹ã€‚æ¯”å¦‚ä½ çš„Viewé«˜åº¦ä¸º40å®½åº¦ä¸º30ã€‚é‚£ä¹ˆä½ çš„æ¯”ä¾‹å°±å°†è®¾ç½®ä¸º3:4. å¦‚æœä½ å¸Œæœ›ä¿®æ”¹è¿™ä¸ªæ¯”ä¾‹çš„å±æ€§ï¼Œå’±ä»¬åœ¨è®²å®Œè¿™ä¸‰ä¸ªä¸œè¥¿ä¹‹åï¼Œæˆ‘ä¼šè®²è§£ Align è¿™ä¸ªä¸œè¥¿ä½ ä¸å¾—ä¸æ‰¿è®¤è¿™ä¸ªä¸œè¥¿å’Œå’±ä»¬å­¦ä¹ çš„ç¬¬ä¸€ä¸ªAligné‡å¤çš„â€¦ åœ¨è¿™é‡Œå°±ä¸èµ˜è¿°äº† Update Frames è¿™ä¸ªæŸ¥çœ‹ä¸Šé¢ Aligné€‰é¡¹çš„è¿™ä¸ªå±æ€§å°±å¥½äº† resole auto layout issuesä»–çš„è¿™ä¸ªè§£é‡Šå·²ç»å¾ˆå¥½ç†è§£äº†ï¼Œè‡ªåŠ¨å¸ƒå±€é—®é¢˜çš„è§£å†³ã€‚å°±æ˜¯å¦‚æœä½ åœ¨å¸ƒå±€çš„æ—¶å€™å‡ºç°äº†ä¸€äº›é—®é¢˜ã€‚æ¯”å¦‚ï¼Œå’±ä»¬å†è®¾ç½®çº¦æŸä¹‹åï¼Œå‡ºç°é»„è‰²æˆ–è€…çº¢è‰²çš„çš„é¢œè‰²çš„æ—¶å€™ã€‚å°±éœ€è¦ä½¿ç”¨ä»¥ä¸‹æ–¹å¼ä¿®æ”¹ã€‚çº¢è‰²è¯´æ˜å’±ä»¬è®¾ç½®çš„çº¦æŸæœ‰ç¼ºå¤±æˆ–è€…æœ‰å†²çªçš„é—®é¢˜ï¼Œé»„è‰²åˆ™è¯´æ˜ï¼Œçº¦æŸæ­£ç¡®ï¼Œä½†æ˜¯å½“å‰Viewçš„Frameå’Œçº¦æŸæè¿°çš„Frameä¸ä¸€è‡´ çœ‹åˆ°ä»¥ä¸Šè§†å›¾å’±ä»¬å¯ä»¥çœ‹å‡ºå®ƒåˆ†ä¸ºä¸¤ä¸ªè€Œä¸”è¿™ä¸¤ç§é™¤äº†åå­—ä¸ä¸€æ ·ï¼Œé€‰é¡¹æ˜¯ä¸€æ‘¸ä¸€æ ·çš„é¢ã€‚Selected Views è¿™ä¸ªè¯´çš„å°±æ˜¯ä½ è¦å¤„ç†çš„çº¦æŸé—®é¢˜æ˜¯å½“å‰ä½ é€‰ä¸­çš„Viewï¼Œè€ŒAll Views in View Controllerï¼Œåˆ™æ˜¯è¯´æ˜è¦è§£å†³çš„çº¦æŸé—®é¢˜æ˜¯è¿™ä¸ªViewControlleræ‰€æœ‰çš„VIewçš„(è¿™ä¸ªå¯å¾—æ…é‡çš„)ã€‚ Update Frames ä¿®æ”¹Frameï¼Œå½“ä½ çš„çº¦æŸè®¾ç½®æ­£ç¡®ä½†æ˜¯Frameä¸å¯¹çš„æ—¶å€™ä½¿ç”¨è€…é€‰é¡¹å¯ä»¥è®²Viewçš„Frameå±•ç¤ºæˆä¸ºçº¦æŸæ‰€æè¿°çš„æ ·å­ Update Constaints è€Œè¿™ä¸ªé€‰é¡¹ï¼Œè¯´å®è¯æˆ‘æ²¡ç”¨è¿‡ã€‚ä»–çš„æ„æ€å’±ä»¬ä¹Ÿå¯ä»¥çŸ¥é“ä»–æ˜¯é€šè¿‡Frame å»ä¿®æ”¹ çº¦æŸâ€¦â€¦ Add Missing Constraints æ·»åŠ ç¼ºå¤±çš„çº¦æŸï¼Œè¿™ä¸ªé€‰é¡¹æˆ‘ä¹Ÿæ²¡ä½¿ç”¨è¿‡ï¼Œå› ä¸ºè¿™ä¸ªæ–¹æ³•æ·»åŠ çš„ç¼ºå¤±çš„çº¦æŸä¸ä¸€å®šå°±æ˜¯æ­£ç¡®çš„çº¦æŸï¼Œåœ¨å®é™…è¿è¡Œä¸­è‚¯å®šä¼šå‡ºç°é—®é¢˜æ‰€ä»¥å°½é‡è‡ªå·±æŠŠç¼ºå¤±çš„çº¦æŸè‡ªå·±æ·»åŠ äº†ã€‚ Reset to Suggested Constaints é‡æ–°è®¾ç½®å»ºè®®çš„çº¦æŸï¼Ÿæ²¡ä½¿ç”¨è¿‡ï¼Œä¸çŸ¥é“ä»€ä¹ˆæ„æ€ Clear Constraints æ¸…é™¤çº¦æŸï¼Œä¼šåˆ é™¤é€‰ä¸­çš„è§†å›¾çš„æ‰€æœ‰çš„çº¦æŸã€‚åœ¨All Views in View Controller ä½ è¦æ˜¯åšè¿™ä¸ªé€‰é¡¹çš„æ—¶å€™å¯å¾—æ…é‡ï¼Œä½¿ç”¨äº†å°±è¯´æ˜ä½ è¦åˆ é™¤å½“å‰VCæ‰€æœ‰çš„çº¦æŸã€‚å½“ç„¶ä½ å¯ä»¥ ctrl-z åé¢çš„è¯åœ¨è¯´äº†è¿™äº›ä¹‹åï¼Œå…¶å®å’±ä»¬åº”è¯¥å·²ç»å¯ä»¥è¿›è¡Œçº¦æŸçš„è®¾ç½®äº†ï¼Œä½†æ˜¯è¿˜æœ‰å¾ˆå¤šé—®é¢˜ï¼Œå…¶ä¸­æˆ‘ç°åœ¨è¯´ä¸€ä¸‹å¿«é€Ÿè®¾ç½®çš„é—®é¢˜ã€‚å½“ä½ åœ¨è¿™ä¸ªå±‚æ¬¡viewé€‰æ‹©å™¨ä¸­ï¼ˆå›¾1ï¼‰ã€‚ å¿«é€Ÿè®¾ç½®çš„é—®é¢˜ã€‚æˆ‘ä»¬å¯ä»¥åœ¨Viewä¸ŠæŒ‰ä½Ctrl é”®ä¹‹åå·¦é”®æ‹–æ‹½åˆ°viewæœ¬èº«æˆ–è€…å…¶ä»–Viewæ¥å¿«é€Ÿçš„è®¾ç½®ä¸€äº›å±æ€§ï¼Œå…·ä½“çš„å±æ€§ï¼Œå’±ä»¬è‡ªå·±çœ‹å§ã€‚ä»–åªæ˜¯ä¸€ç§å¿«æ·æ–¹å¼ï¼Œåœ¨å±æ€§è®¾ç½®ä¸Šæ²¡æœ‰ä»»ä½•åŒºåˆ«çš„ï¼Œè¿™é‡Œå°±ä¸ä¸€ä¸€èµ˜è¿°äº† å¿«é€Ÿè§£å†³çº¦æŸé—®é¢˜çš„å¿«æ·é”®ã€‚å½“æˆ‘ä»¬çš„Viewçš„çº¦æŸæ­£ç¡®çš„è€Œframæ²¡æœ‰æ˜¾ç¤ºæ­£ç¡®çš„ä½ç½®çš„æ—¶å€™æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ resole auto layout issues è¿›è¡Œä¿®æ”¹ï¼Œä½†æ˜¯æ¯æ¬¡éƒ½è¦æ‰“å¼€è¿™é€‰é¡¹å®åœ¨æ˜¯å¤ªéº»çƒ¦äº†ã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥é€‰æ‹©ä¸€ä¸ªå¿«æ·é”®ã€‚å°±æ˜¯ osx ï¼š comment+alt+= è€Œwindow åˆ™ä¸º window+alt+= å¿«é€Ÿä¿®æ”¹çº¦æŸ è®¾ç½®UIScrollViewçš„æ—¶å€™ï¼Œå› ä¸ºç‰µæ‰¯åˆ°è¦è®¾ç½®ScrollView ContainView çš„é«˜åº¦å®½åº¦çš„é—®é¢˜ï¼Œæ‰€ä»¥å†è®¾ç½® ScrollView å­View çš„æ—¶å€™ä¸€å®šè¦æ˜ç¡®ä¸€ä¸ªé“ç†ï¼ å°±æ˜¯æ¯”å¦‚ä¿è¯ å­è§†å›¾çš„çº¦æŸç»“åˆèµ·æ¥ä¹‹åå¯ä»¥è®© containViewçŸ¥é“è‡ªå·±çš„é«˜åº¦å’Œå®½åº¦ï¼Œå¦‚æœç¼ºå¤±ï¼Œå°†å¯¼è‡´çº¦æŸå¤±è´¥ã€‚ ä¿®æ”¹çº¦æŸçš„é—®é¢˜ï¼Œå’±ä»¬åœ¨ä¿®æ”¹çº¦æŸçš„æ—¶å€™ä¹Ÿæ˜¯åœ¨viewçš„é€‰æ‹©å™¨ä¸­ã€‚é€‰ä¸­ä½ è¦ä¿®æ”¹çš„VIewä¹‹ååœ¨æœ€å·¦ä¾§çš„å·¥å…·ç®±ä¸­ï¼ˆå›¾2ï¼‰ã€‚å¯ä»¥çœ‹åˆ°æˆ‘ä»¬é»„æ¡†æ ‡æ³¨å‡ºçš„çº¦æŸã€‚ç‚¹å‡»Editå°±å¯ä»¥ä¿®æ”¹å’±ä»¬çº¦æŸçš„å±æ€§äº† Constant è¿™ä¸ªè¾“å…¥æ¡†å°±æ˜¯çº¦æŸçš„å€¼ï¼Œè€Œå¤§äºç­‰äºï¼Œå°äºç­‰äºä»¥åŠç­‰äºéœ€è¦å’±ä»¬æ ¹æ®å®é™…æƒ…å†µè¿›è¡Œè‡ªå·±åˆ†è¾¨è®¾ç½® Priority ä¼˜å…ˆçº§åˆ«ï¼Œè¿™ä¸ªåˆ†åˆ«ä¸º 1000(æœ€é«˜)ï¼Œ 750(ä¸­),250(ä½)ã€‚ä¸‰ä¸ªé€‰é¡¹ï¼Œè¿™ä¸ªæˆ‘æ²¡æœ‰ä½¿ç”¨è¿‡ï¼Œä¸è¿‡ä¼°è®¡æ˜¯æƒ³ä¸¤ä¸ªçº¦æŸå‘ç”Ÿå®é™…è¿è¡Œä¸­çš„å†²çªçš„æ—¶å€™ è¿›è¡Œä¼˜å…ˆçº§æ˜¾ç¤ºçš„æ–¹æ³•å§ Multiplier è¿™ä¸ªå°±æ˜¯è®¾ç½®æ¯”ä¾‹çš„åœ°æ–¹ï¼Œå°±æ˜¯å’±ä»¬ä¹‹å‰è¯´çš„ã€‚è€Œè¿™ä¸ªè®¾ç½®æ˜¯éå¸¸å¥½ç©çš„ä¸€ä¸ªè®¾ç½®ï¼Œå½“ç„¶ä»–ä¹Ÿæœ‰ä½¿ç”¨çš„å±€é™ï¼Œåœ¨è®¾ç½®è§†å›¾çš„å®½åº¦å’Œé«˜åº¦çš„æ—¶å€™è¿™ä¸ªæ˜¯ç”¨ä¸äº†çš„ï¼Œæ˜¯è®¾ç½®æ¯”å¦‚ è·ç¦»å››å‘¨çš„ä½ç½®ï¼Ÿå±…ä¸­ï¼Œæˆ–è€…ä¸¤ä¸ªè§†å›¾çš„å®½åº¦é«˜åº¦ç›¸ç­‰çš„æ—¶å€™,æˆ–è€…æ¯”ä¾‹è®¾ç½®çš„æ—¶å€™ï¼Œæ‰ä¼šå¯ä»¥è®¾ç½®ã€‚è¿™ä¸ªæˆ‘è¿˜æ²¡æœ‰å¾ˆå¤šç–‘é—®ã€‚æ‰€ä»¥åœ¨æˆ‘æµ‹è¯•å®Œæˆåï¼Œä¼šè¿›è¡Œä¿®æ”¹ NSLayoutConstraint çº¦æŸè®¾ç½®ä½¿ç”¨NSLayoutConstraintæ˜¯Appleåœ¨å‡ºçº¦æŸçš„æ—¶å€™å‡ºç°çš„ï¼Œä¹Ÿå°±æ˜¯å®˜æ–¹æ¨èç”¨æˆ·ä½¿ç”¨è¿™ä¸ªä¸œè¥¿ï¼Œæˆ–è€…sbå’Œxibã€‚è‡³å°‘å½“æ—¶æ˜¯è¿™æ ·çš„é¢ã€‚ä½†æ˜¯â€¦è¿™ä¸ªä¸œè¥¿çš„è´¹äº‹å„¿æˆéƒ½è¶…å‡ºä½ çš„æƒ³è±¡ æ–¹æ³•ä»‹ç»public enum NSLayoutAttribute : Int { case left case right case top case bottom case leading case trailing case width case height case centerX case centerY case lastBaseline @available(iOS 8.0, *) case firstBaseline @available(iOS 8.0, *) case leftMargin @available(iOS 8.0, *) case rightMargin @available(iOS 8.0, *) case topMargin @available(iOS 8.0, *) case bottomMargin @available(iOS 8.0, *) case leadingMargin @available(iOS 8.0, *) case trailingMargin @available(iOS 8.0, *) case centerXWithinMargins @available(iOS 8.0, *) case centerYWithinMargins case notAnAttribute } åœ¨ç½‘ä¸Šçœ‹åˆ°ä¸€å¼ å›¾å¯ä»¥å¾ˆå¥½çš„è¯´æ˜é—®é¢˜ã€‚ ä»¥ä¸Šçš„å±æ€§å¾ˆå¤šå¤§å®¶è‚¯å®šéƒ½è‡ªå·±å¯ä»¥çœ‹æ‡‚ï¼Œæˆ‘ä¹Ÿå°±ä¸è¯´äº†ã€‚æˆ‘è¿™é‡Œå°±è¯´å‡ ä¸ªæ¯”è¾ƒè®©äººè§‰çš„ä¸è§£çš„åœ°æ–¹ã€‚ æœ‰ Margins å’Œ æ²¡æœ‰ Margins çš„åŒºåˆ«åœ¨äºï¼Œå’±ä»¬åœ¨SB å’Œ xib ä¸­è®¾ç½®çš„ Constarain to Margins æ˜¯ä¸€ä¸ªæ•ˆæœ Leading åœ¨ä¹ æƒ¯ä»å³è‡³å·¦çœ‹çš„åœ°åŒºï¼Œç›¸å½“äºNSLayoutAttributeRight; Trailing: åœ¨ä¹ æƒ¯ç”±å·¦å‘å³çœ‹çš„åœ°åŒºï¼Œç›¸å½“äºNSLayoutAttributeRightï¼›åœ¨ä¹ æƒ¯ä»å³è‡³å·¦çœ‹çš„åœ°åŒºï¼Œç›¸å½“äºNSLayoutAttributeLeft lastBaseline æ–‡å­—çš„ä¸‹åŸºçº¿ firstBaseline æ–‡å­—çš„ä¸ŠåŸºçº¿ é¦–å…ˆä»–çš„æ–¹æ³•å¦‚ä¸‹ï¼š /// è·å¾—ä¸€ä¸ªçº¦æŸ /// /// - parameter view1: ç¬¬ä¸€ä¸ªå¯¹è±¡ï¼Œé€šå¸¸å°±æ˜¯å’±ä»¬è¦è®¾ç½®çš„ç”¨æˆ·çš„View /// - parameter attr1: ä½ è¦æ˜¯è®¾ç½®ä»–çš„é‚£ä¸ªå±æ€§ æŸ¥é˜…ä¸Šæ–¹ NSLayoutAttribute è§£é‡Š /// - parameter relation: ä¸€ä¸ªEnumå¯¹è±¡ï¼Œ å¤§äºç­‰äº å°äºç­‰äº ç­‰äºï¼Œè‡ªå·±çœ‹çœ‹å§ï¼Œ ä¸èµ˜è¿°äº† /// - parameter view2: ç¬¬äºŒä¸ªå¯¹è±¡ ä¸€èˆ¬æ˜¯ä½ è¦è®¾ç½®çš„Viewçš„SuperViewã€‚å¦‚æœä½ åªè®¾ç½®Viewçš„å®½åº¦æˆ–è€…é«˜åº¦è¿™äº›åªéœ€è¦ä¸€ä¸ªVIewå°±å¯ä»¥åšçš„è¿™ä¸ªå‚æ•°å°±ä¸ºnil /// - parameter attr2: ç¬¬äºŒä¸ªå¯¹è±¡çš„ å±æ€§ã€‚ å¦‚æœç¬¬äºŒä¸ªå¯¹è±¡ä¸º nilã€‚åˆ™è¯¥å¯¹è±¡ä¸º notAnAttribute /// - parameter multiplier: å€æ•°ã€‚ è¿™é‡Œä¸èµ˜è¿°äº†ï¼ŒæŸ¥çœ‹ SB xib æ•™ç¨‹å°±å¥½äº† /// - parameter constant: çº¦æŸçš„å€¼ /// /// - returns: NSLayoutConstraint public convenience init(item view1: Any, attribute attr1: NSLayoutAttribute, relatedBy relation: NSLayoutRelation, toItem view2: Any?, attribute attr2: NSLayoutAttribute, multiplier: CGFloat, constant c: CGFloat) æˆ–è€…è¿™æ ·è¯´å¯èƒ½æ›´å¥½ç†è§£ä¸€ç‚¹view1.attr1 [= , &gt;= , &lt;=] view2.attr2 * multiplier + constant åœ¨è·å–çº¦æŸå®Œæˆä¹‹åä½¿ç”¨æ¯ä¸ªView æä¾›çš„æ–¹æ³• extension UIView { @available(iOS 6.0, *) open var constraints: [NSLayoutConstraint] { get } @available(iOS 6.0, *) open func addConstraint(_ constraint: NSLayoutConstraint) // This method will be deprecated in a future release and should be avoided. Instead, set NSLayoutConstraint's active property to YES. @available(iOS 6.0, *) open func addConstraints(_ constraints: [NSLayoutConstraint]) // This method will be deprecated in a future release and should be avoided. Instead use +[NSLayoutConstraint activateConstraints:]. @available(iOS 6.0, *) open func removeConstraint(_ constraint: NSLayoutConstraint) // This method will be deprecated in a future release and should be avoided. Instead set NSLayoutConstraint's active property to NO. @available(iOS 6.0, *) open func removeConstraints(_ constraints: [NSLayoutConstraint]) // This method will be deprecated in a future release and should be avoided. Instead use +[NSLayoutConstraint deactivateConstraints:]. } è¿™äº›å¤§å®¶æ ¹æ®åå­—å°±å¯ä»¥çœ‹æ‡‚çš„æˆ‘å°±ä¸è§£é‡Šäº†ã€‚è¿˜éœ€è¦æ³¨æ„çš„ä¸€ç‚¹å°±æ˜¯ï¼Œä¸€å®šè¦è®¾ç½®Viewçš„ translatesAutoresizingMaskIntoConstraints å±æ€§ä¸ºfalseã€‚å¦åˆ™ä¼šå‡ºç°é—®é¢˜ã€‚äººå®¶è¯´çš„ä¹Ÿå¾ˆæ˜ç™½ã€‚æˆ‘è¦ä¸è¦è‡ªå·±ç»™ä½ è°ƒæ•´ä½ç½®å‘¢ï¼Ÿå¦‚æœä½ æƒ³è‡ªå·±è°ƒæ•´çº¦æŸæ¥è°ƒæ•´ä½ç½®ï¼Œå°±æŠŠæˆ‘è®¾ç½®ä¸ºfalseå§ã€‚é»˜è®¤ä¸ºtrue VFL çº¦æŸè®¾ç½®ç»ˆäºè¿˜æ˜¯åˆ°äº†è¿™é‡Œäº†ï¼Œä¹‹å‰å­¦ä¹ è¿™ä¸ªçš„æ—¶å€™çœŸæ˜¯åƒéš¾ä¸‡éš¾ï¼Œè¿™ä¸ªä¸œè¥¿çœŸå¿ƒçš„ä¸æ€ä¹ˆå‹å¥½â€¦â€¦åºŸè¯ä¸å¤šè¯´äº† VFLï¼ˆVisual Format Languageï¼‰è¢«ç§°ä¸º â€œå¯è§†åŒ–æ ¼å¼è¯­è¨€â€ï¼Œæ˜¯è‹¹æœå…¬å¸ä¸ºäº†ç®€åŒ–autolayoutçš„ç¼–ç è€Œæ¨å‡ºçš„æŠ½è±¡è¯­è¨€ã€‚ åŠŸèƒ½ å†™æ³• å«ä¹‰ æ°´å¹³æ–¹å‘ H: æˆ– V: H è¯´æ˜ä¹‹åçš„å¥å­éƒ½æ˜¯åœ¨æ°´å¹³æ–¹å‘è®¾ç½®çº¦æŸçš„ V åˆ™æ˜¯å‚ç›´æ–¹å‘ã€‚é»˜è®¤æ–¹å‘ä¸º H æ°´å¹³æ–¹å‘ Views [view] è¦è®¾ç½®çš„viewä»¬ SuperView &#124; viewä»¬æ‰€åœ¨çš„çˆ¶è§†å›¾ å…³ç³» &gt;=,==,&lt;= NSLayoutRelation ç©ºé—´ï¼Œé—´éš™ - -30- è¯´æ˜ä¹‹é—´çš„ç©ºéš™ä¸º30 ä¼˜å…ˆçº§ @ ä¸º250 750 1000 ä¸‰ä¸ªçº§åˆ«ï¼Œä¹‹å‰å’±ä»¬è¯´è¿‡äº† è®¾ç½®å®½åº¦é«˜åº¦ () [view(30)] é…åˆæ–¹å‘ æ°´å¹³æ–¹å‘å°±æ˜¯ä¸ºå®½åº¦ å‚ç›´åˆ™ä¸ºé«˜åº¦ ä¸‹é¢å’±ä»¬æ¥ä¸¾å‡ ä¸ªä¾‹å­ï¼š ä»£ç  å«ä¹‰ &#124;[view]&#124; å’Œçˆ¶è§†å›¾çš„å·¦å³å¯¹é½ &#124;-(&gt;=100)-[view] è·çˆ¶è§†å›¾çš„å·¦è¾¹è·ç¦»å¤§äºç­‰äº100 [view] å®½åº¦å¤§äºç­‰äº100 V:&#124;-(&gt;=100)-[view(&gt;=100)] è·çˆ¶è§†å›¾çš„ä¸Šè¾¹è·ç¦»å¤§äºç­‰äº100å¹¶ä¸”é«˜åº¦åº¦å¤§äºç­‰äº100 çº¦æŸç±»å‹public struct NSLayoutFormatOptions : OptionSet { public init(rawValue: UInt) public static var alignAllLeft: NSLayoutFormatOptions { get } public static var alignAllRight: NSLayoutFormatOptions { get } public static var alignAllTop: NSLayoutFormatOptions { get } public static var alignAllBottom: NSLayoutFormatOptions { get } public static var alignAllLeading: NSLayoutFormatOptions { get } public static var alignAllTrailing: NSLayoutFormatOptions { get } public static var alignAllCenterX: NSLayoutFormatOptions { get } public static var alignAllCenterY: NSLayoutFormatOptions { get } public static var alignAllLastBaseline: NSLayoutFormatOptions { get } @available(iOS 8.0, *) public static var alignAllFirstBaseline: NSLayoutFormatOptions { get } public static var alignmentMask: NSLayoutFormatOptions { get } /* choose only one of these three */ public static var directionLeadingToTrailing: NSLayoutFormatOptions { get } // default public static var directionLeftToRight: NSLayoutFormatOptions { get } public static var directionRightToLeft: NSLayoutFormatOptions { get } public static var directionMask: NSLayoutFormatOptions { get } } ä¸è®²è§£äº†ï¼Œæˆ‘ä¸æ˜¯ç”¨è¿™ä¸ªVFLæ‰€ä»¥ä¸ä¼šå°±ä¸è§£é‡Šäº†ã€‚é»˜è®¤ä½¿ç”¨ ï¼Œinit(0). å°±å¥½äº†ã€‚ æ–¹æ³•è§£é‡Š/// è·å¾—ä¸€ç»„çº¦æŸ /// /// - parameter format: vfl æ ¼å¼åŒ–string /// - parameter opts: NSLayoutFormatOptions Opt /// - parameter metrics: æ•°æ®çš„æ•°æ® æ¯”å¦‚ [view(height)] é‚£ä¹ˆæ­¤æ—¶ metrics å°±ä¸º [\"height\":100]. ä¸éœ€è¦åˆ™ä¸º nil /// - parameter views: views [\"view1\":self.backView] /// /// - returns: NSLayoutConstraints open class func constraints(withVisualFormat format: String, options opts: NSLayoutFormatOptions = [], metrics: [String : Any]?, views: [String : Any]) -> [NSLayoutConstraint] å¦‚æœæ²¡æœ‰å£°æ˜æ–¹å‘é»˜è®¤ä¸ºæ°´å¹³H:ï¼ˆåŸæ–‡å†™çš„V:ï¼‰ å¦ˆçš„ï¼ŒçœŸå¿ƒä¸èƒ½ä½¿ç”¨vflï¼Œç®€ç›´åäººç±»ã€‚è€Œä¸”å¾ˆå¤šé—®é¢˜ã€‚æ¯”å¦‚ç­‰äºçˆ¶è§†å›¾çš„å®½é«˜ï¼Œå‰§ä¸­é—®é¢˜â€¦â€¦ ç­‰åˆ°è¿™äº›é—®é¢˜è§£å†³äº†ï¼Œæˆ‘åœ¨ç”¨å§ï¼Œç°åœ¨è¿˜æ˜¯å°½é‡ä¸ä½¿ç”¨â€¦â€¦ è€Œä¸”ä¸ºäº†ä½¿ç”¨vflï¼Œè¿˜å¾—æ˜¯ç”¨å…¶ä»–æ–¹å¼çº¦æŸå»çº¦æŸä»–ä¸èƒ½çº¦æŸï¼Œæˆ–è€…æˆ‘ä¸ä¼šçº¦æŸçš„åœ°æ–¹ï¼ŒçœŸå¿ƒäº†ç´¯ã€‚è€Œä¸”ä»–çš„å®½é«˜é—®é¢˜åœ¨æ¨ªå±çš„æ—¶å€™ä¹Ÿæ˜¯ä¸€ä¸ªå‘ã€‚ NSLayoutAnchor çº¦æŸè®¾ç½®åœ¨ios9 ä¹‹åï¼Œä¹Ÿè®¸æ˜¯å—åˆ°äº†ç¬¬ä¸‰æ–¹çº¦æŸæ¡†æ¶çš„é¼“èˆï¼Œå’±ä»¬çš„è‹¹æœå…¬å¸æ›´æ–°äº†å¯¹äº autolayoutçš„å¸ƒå±€apiã€‚ NSLayoutAnchor ã€‚æ¯ä¸€ä¸ªUIViewéƒ½ä¼šæœ‰è‡ªå·±çš„è¿™äº›å±æ€§ extension UIView { /* Constraint creation conveniences. See NSLayoutAnchor.h for details. */ @available(iOS 9.0, *) open var leadingAnchor: NSLayoutXAxisAnchor { get } @available(iOS 9.0, *) open var trailingAnchor: NSLayoutXAxisAnchor { get } @available(iOS 9.0, *) open var leftAnchor: NSLayoutXAxisAnchor { get } @available(iOS 9.0, *) open var rightAnchor: NSLayoutXAxisAnchor { get } @available(iOS 9.0, *) open var topAnchor: NSLayoutYAxisAnchor { get } @available(iOS 9.0, *) open var bottomAnchor: NSLayoutYAxisAnchor { get } @available(iOS 9.0, *) open var widthAnchor: NSLayoutDimension { get } @available(iOS 9.0, *) open var heightAnchor: NSLayoutDimension { get } @available(iOS 9.0, *) open var centerXAnchor: NSLayoutXAxisAnchor { get } @available(iOS 9.0, *) open var centerYAnchor: NSLayoutYAxisAnchor { get } @available(iOS 9.0, *) open var firstBaselineAnchor: NSLayoutYAxisAnchor { get } @available(iOS 9.0, *) open var lastBaselineAnchor: NSLayoutYAxisAnchor { get } } å¤§å®¶çœ‹çœ‹è¿™äº›å•è¯å°±åº”è¯¥çŸ¥é“ä»€ä¹ˆæ„æ€äº†å§ã€‚ å’±ä»¬å¯ä»¥çœ‹åˆ°è¿™é‡Œå¤§æ¦‚æœ‰ä¸‰ä¸ªç±»å‹ã€‚ NSLayoutXAxisAnchor , NSLayoutYAxisAnchor , NSLayoutDimension åˆ†åˆ«å·¦å³è¾¹è·ä¸Šä¸‹è¾¹è·ï¼Œä»¥åŠæœ€åçš„ å®½åº¦å’Œé«˜åº¦ è€Œè¿™äº›ç±»å‹éƒ½å®ç° NSLayoutAnchor,ä»–ä»¬æœ‰å…±åŒçš„æ–¹æ³• /* These methods return an inactive constraint of the form thisAnchor = otherAnchor. */ open func constraint(equalTo anchor: NSLayoutAnchor&lt;AnchorType>) -> NSLayoutConstraint open func constraint(greaterThanOrEqualTo anchor: NSLayoutAnchor&lt;AnchorType>) -> NSLayoutConstraint open func constraint(lessThanOrEqualTo anchor: NSLayoutAnchor&lt;AnchorType>) -> NSLayoutConstraint /* These methods return an inactive constraint of the form thisAnchor = otherAnchor + constant. */ open func constraint(equalTo anchor: NSLayoutAnchor&lt;AnchorType>, constant c: CGFloat) -> NSLayoutConstraint open func constraint(greaterThanOrEqualTo anchor: NSLayoutAnchor&lt;AnchorType>, constant c: CGFloat) -> NSLayoutConstraint open func constraint(lessThanOrEqualTo anchor: NSLayoutAnchor&lt;AnchorType>, constant c: CGFloat) -> NSLayoutConstraint è€Œ é’ˆå¯¹äºé«˜åº¦ä¼šæœ‰æ¯”ä¾‹è¿™ä¸€ä¸ªçº¦æŸï¼Œæ‰€ä»¥åœ¨ NSLayoutDimensionæœ‰è‡ªå·±çš„æ–¹æ³• /* These methods return an inactive constraint of the form thisVariable = constant. */ open func constraint(equalToConstant c: CGFloat) -> NSLayoutConstraint open func constraint(greaterThanOrEqualToConstant c: CGFloat) -> NSLayoutConstraint open func constraint(lessThanOrEqualToConstant c: CGFloat) -> NSLayoutConstraint /* These methods return an inactive constraint of the form thisAnchor = otherAnchor * multiplier. */ open func constraint(equalTo anchor: NSLayoutDimension, multiplier m: CGFloat) -> NSLayoutConstraint open func constraint(greaterThanOrEqualTo anchor: NSLayoutDimension, multiplier m: CGFloat) -> NSLayoutConstraint open func constraint(lessThanOrEqualTo anchor: NSLayoutDimension, multiplier m: CGFloat) -> NSLayoutConstraint /* These methods return an inactive constraint of the form thisAnchor = otherAnchor * multiplier + constant. */ open func constraint(equalTo anchor: NSLayoutDimension, multiplier m: CGFloat, constant c: CGFloat) -> NSLayoutConstraint open func constraint(greaterThanOrEqualTo anchor: NSLayoutDimension, multiplier m: CGFloat, constant c: CGFloat) -> NSLayoutConstraint open func constraint(lessThanOrEqualTo anchor: NSLayoutDimension, multiplier m: CGFloat, constant c: CGFloat) -> NSLayoutConstraint å¤§å®¶è‡ªå·±çœ‹çœ‹æ–¹æ³•å°±çŸ¥é“äº†ï¼Œå¦‚æœä¸çŸ¥é“å°±å»æ–‡ç« ä¸‹æ–¹ä¾‹å­ï¼Œä¸‹è½½æŸ¥çœ‹ã€‚ ç¬¬ä¸‰æ–¹çº¦æŸè®¾ç½® Masonry (githubåœ°å€)[https://github.com/SnapKit/Masonry] SnapKit (githubåœ°å€)[https://github.com/SnapKit/SnapKit] Cartography (githubåœ°å€)[https://github.com/robb/Cartography] å…·ä½“çš„ç”¨æ³•æŸ¥çœ‹ä»–ä»¬çš„æ•™ç¨‹å§ï¼Œæˆ‘å°±ä¸çŒ®ä¸‘äº†ã€‚ ä¾‹å­æ€»ç»“ ï¼ å®ä¾‹ é‚£ä¹ˆæˆ‘ä»¬æ¥åšä¸€ä¸ªä¸ªäººä¸»é¡µçš„å¸ƒå±€å§ï¼Œå› ä¸ºè¿™é‡ŒåŒ…å«çš„çŸ¥è¯†ç‚¹æ¯”è¾ƒå¤šã€‚è€Œä¸”æ¯”è¾ƒå¥½å®ç°â€¦â€¦ XIB StoryBoard æ–¹å¼é‚£ä¹ˆé¦–å…ˆæˆ‘ä»¬åšä¸€ä¸ªä¸ªäººä¸»é¡µçš„èƒŒæ™¯è§†å›¾ï¼Œè®©ä»–è·ç¦»ä¸Šå·¦å³æ–¹ä¸º0ã€‚è€Œé«˜åº¦åˆ™ä¸ºæ•´ä¸ªVCçš„viewçš„1/3ï¼Œæˆ‘å½•åˆ¶ä¸ºäº†åŠ¨æ€å›¾äº†ã€‚ç´§æ¥ç€æˆ‘ä»¬åœ¨ä¸ªäººä¸­å¿ƒçš„èƒŒæ™¯è§†å›¾è®¾ç½®å¤´åƒä»¥åŠåå­—çš„å¸ƒå±€çº¦æŸè®¾ç½®ä¸€ä¸ªtagåˆ†æ è§†å›¾çš„çº¦æŸè®¾ç½®UISCrollViewçš„çº¦æŸ,ä»¥åŠè¿è¡Œæ•ˆæœå®Œæˆæ»‘åŠ¨Progressä¿®æ”¹çº¦æŸå®ç° åˆ‡æ¢ViewControollerçš„å‡è±¡è¿™æ ·æˆ‘ä»¬å°±å®Œæˆäº† xibçš„ å¸ƒå±€ æ€»ç»“é™¤äº†ç¬¬ä¸‰æ–¹çš„çº¦æŸæ¡†æ¶ï¼Œæˆ‘éƒ½å†™äº†ä¸€ä»½ä»£ç ï¼Œå®ç°åŒä¸€ä¸ªæ•ˆæœã€‚å¤§å®¶æœ‰éœ€è¦çš„å¯ä»¥æŸ¥çœ‹githubä¸Šçš„é¡¹ç›®ã€‚ (Github åœ°å€)[https://github.com/AimobierExample/AutoLayout] è¿™æ˜¯æ¡ˆä¾‹çš„githubåœ°å€ï¼Œæˆ‘æŠŠè¿™ä¸ªä¾‹å­åˆ†ä¸ºäº†4ä¸ªåˆ†æ”¯ã€‚å¯ä»¥æŒ‰ä¸ªæŸ¥çœ‹å®ç°çš„çº¦æŸã€‚ å†™åˆ°æœ€åæ‰å‘è§‰å…¶å®å¹¶æ²¡æœ‰å°†åˆ° sizeï¼classã€‚æœ‰æœºä¼šè¡¥ä¸Šå§ï½","categories":[{"name":"IOS","slug":"IOS","permalink":"http://www.msiter.com/categories/IOS/"}],"tags":[{"name":"ios","slug":"ios","permalink":"http://www.msiter.com/tags/ios/"},{"name":"çº¦æŸæ•™ç¨‹","slug":"çº¦æŸæ•™ç¨‹","permalink":"http://www.msiter.com/tags/çº¦æŸæ•™ç¨‹/"},{"name":"swift","slug":"swift","permalink":"http://www.msiter.com/tags/swift/"},{"name":"autolayout","slug":"autolayout","permalink":"http://www.msiter.com/tags/autolayout/"}],"keywords":[{"name":"IOS","slug":"IOS","permalink":"http://www.msiter.com/categories/IOS/"}]},{"title":"åˆ¶ä½œä¸€ä¸ªè‡ªå·±çš„ Cydia æº","slug":"åˆ¶ä½œä¸€ä¸ªè‡ªå·±çš„ Cydia æº","date":"2016-11-12T02:05:43.000Z","updated":"2017-11-28T11:07:04.831Z","comments":true,"path":"2016/11/12/åˆ¶ä½œä¸€ä¸ªè‡ªå·±çš„ Cydia æº/","link":"","permalink":"http://www.msiter.com/2016/11/12/åˆ¶ä½œä¸€ä¸ªè‡ªå·±çš„ Cydia æº/","excerpt":"å¤§å®¶è‚¯å®šéƒ½çŸ¥é“ Cydia å§ï¼Œ iPhoneã€iPod touchã€iPadç­‰è®¾å¤‡ä¸Šçš„ä¸€ç§ç ´è§£è½¯ä»¶ï¼Œç±»ä¼¼è‹¹æœåœ¨çº¿è½¯ä»¶å•†åº—iTunes Store çš„è½¯ä»¶å¹³å°çš„å®¢æˆ·ç«¯ï¼Œåœ¨è¶Šç‹±çš„è¿‡ç¨‹ä¸­è¢«è£…å…¥åˆ°ç³»ç»Ÿä¸­çš„ï¼Œå…¶ä¸­å¤šæ•°ä¸ºiPhoneã€iPod Touchã€ipadçš„ç¬¬ä¸‰æ–¹è½¯ä»¶å’Œè¡¥ä¸ï¼Œä¸»è¦éƒ½æ˜¯å¼¥è¡¥ç³»ç»Ÿä¸è¶³ç”¨ã€‚æ˜¯ç”±Jay Freemanï¼ˆSaurikï¼‰é¢†å¯¼ï¼ŒOkori Groupä»¥åŠUCSBå¤§å­¦åˆä½œå¼€å‘ã€‚ ä¹‹å‰ç”¨äº†å¾ˆå¤šå¥½ç”¨çš„æºï¼Œä½†æ˜¯å¾ˆå¥½å¥‡çš„æ˜¯ï¼Œä»–ä»¬æ˜¯æ€ä¹ˆåˆ¶ä½œçš„å‘¢ï¼Ÿä¸ºä»€ä¹ˆè¶Šç‹±ä¹‹åå°±å¯ä»¥è¿™ä¹ˆå‰å®³å‘¢ï¼Ÿé‚£ä¹ˆæ€ä¹ˆåˆ¶ä½œè¿™ä¹ˆä¸€ä¸ªä¸œè¥¿","text":"å¤§å®¶è‚¯å®šéƒ½çŸ¥é“ Cydia å§ï¼Œ iPhoneã€iPod touchã€iPadç­‰è®¾å¤‡ä¸Šçš„ä¸€ç§ç ´è§£è½¯ä»¶ï¼Œç±»ä¼¼è‹¹æœåœ¨çº¿è½¯ä»¶å•†åº—iTunes Store çš„è½¯ä»¶å¹³å°çš„å®¢æˆ·ç«¯ï¼Œåœ¨è¶Šç‹±çš„è¿‡ç¨‹ä¸­è¢«è£…å…¥åˆ°ç³»ç»Ÿä¸­çš„ï¼Œå…¶ä¸­å¤šæ•°ä¸ºiPhoneã€iPod Touchã€ipadçš„ç¬¬ä¸‰æ–¹è½¯ä»¶å’Œè¡¥ä¸ï¼Œä¸»è¦éƒ½æ˜¯å¼¥è¡¥ç³»ç»Ÿä¸è¶³ç”¨ã€‚æ˜¯ç”±Jay Freemanï¼ˆSaurikï¼‰é¢†å¯¼ï¼ŒOkori Groupä»¥åŠUCSBå¤§å­¦åˆä½œå¼€å‘ã€‚ ä¹‹å‰ç”¨äº†å¾ˆå¤šå¥½ç”¨çš„æºï¼Œä½†æ˜¯å¾ˆå¥½å¥‡çš„æ˜¯ï¼Œä»–ä»¬æ˜¯æ€ä¹ˆåˆ¶ä½œçš„å‘¢ï¼Ÿä¸ºä»€ä¹ˆè¶Šç‹±ä¹‹åå°±å¯ä»¥è¿™ä¹ˆå‰å®³å‘¢ï¼Ÿé‚£ä¹ˆæ€ä¹ˆåˆ¶ä½œè¿™ä¹ˆä¸€ä¸ªä¸œè¥¿ åˆ¶ä½œè‡ªå·±çš„ CydiaæºCydia è¯´ç™½äº†å¯ç¤ºå°±æ˜¯ä¸€ä¸ªäº‘ç›˜ï¼Œä½ ä»¬éœ€è¦çš„å‘¢ï¼Œåªæ˜¯éœ€è¦å‡ ä¸ªæ–‡ä»¶ï¼Œæ¥å‘Šè¯‰è¿‡æ¥è®¿é—®è¿™ä¸ªäº‘ç›˜çš„Cydiaç¨‹åºï¼Œæˆ‘è¿™ä¸ªæºå«å•¥ï¼Ÿè°åˆ¶ä½œçš„è¿™ä¸ªæºï¼Ÿè¿™ä¸ªæºé‡Œéƒ½æœ‰ä»€ä¹ˆè½¯ä»¶ï¼Ÿè¿™äº›æºçš„æ”¾ç½®ä½ç½®éƒ½æ˜¯å•¥ï¼Ÿé‚£ä¹ˆå¦‚ä½•åˆ¶ä½œè‡ªå·±çš„äº‘ç›˜å‘¢ï¼Ÿ å‡ ç§åŠæ³• ç¬¬ä¸€ç§å°±æ˜¯è‡ªå·±åšä¸€ä¸ªæœåŠ¡å™¨ï¼Œæœ¬åœ°è·‘èµ·æ¥ã€‚ github ä»»ä½•ä¸€ä¸ªç›´æ¥è®¿é—®çš„æ–‡ä»¶å­˜å‚¨åœ°æ–¹ æ¯”å¦‚ ä¸ƒç‰›äº‘ã€‚ Cydia æºçš„æ–‡ä»¶ç»“æ„ +- / +- Release +- Packages +- CydiaIcon.png +- debs +- *.deb æ–‡ä»¶è®²è§£/ æœåŠ¡å™¨æ ¹ç›®å½•/Release æ–‡ä»¶è®°å½•è½¯ä»¶æºæœ¬èº«çš„ç›¸å…³ä¿¡æ¯ ï¼Œä¾‹å¦‚ä½œè€… ä¹‹ç±»çš„/Packages è®°å½•å…·ä½“è½¯ä»¶åŒ…çš„å­˜æ”¾ä½ç½®å’Œå®‰è£…ä¿¡æ¯ç­‰æ•°æ®/CydiaIcon.png ICON æ˜¾ç¤ºçš„ICONå›¾ç‰‡/debs å­˜æ”¾æ‰€æœ‰debåŒ…çš„ç›®å½•/debs/*.deb debåŒ…â€¦â€¦ Release æ–‡ä»¶è®²è§£å¿…é¡»Origin: è½¯ä»¶æºåç§°ï¼Œå¯ä»¥ä½¿ç”¨ä¸­æ–‡ï¼ˆCydiaçš„è½¯ä»¶æºåˆ—è¡¨ä¸­æ˜¾ç¤ºçš„æ ‡é¢˜ï¼‰Label: åŒä¸Šï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ä¸­æ–‡Suite: è½¯ä»¶æºçš„ç±»å‹ï¼Œæ¯”å¦‚æ­£å¼æºï¼Œæµ‹è¯•æºç­‰ï¼Œå¯ä»¥åˆ†åˆ«ç”¨stable, beta, unstableç­‰æ¥è¡¨ç¤ºï¼Œä¸€èˆ¬å¡«stableå°±å¯ä»¥äº†Version: ç‰ˆæœ¬å·ï¼Œè¿™ä¸ªå…¶å®ä¸é‡è¦ï¼Œéšä¾¿å¡«ï¼Œä¸€èˆ¬éƒ½æ˜¯å†™1.0Codename: ä»£ç ä»£å·ï¼Œæ¯”å¦‚BigBossçš„å°±å†™BigBossï¼Œå¨é”‹çš„å°±å†™WeiPhoneï¼Œä¹Ÿæ²¡ä»€ä¹ˆé™åˆ¶ï¼Œåªèƒ½ç”¨è‹±æ–‡Architectures: ç»“æ„ã€‚iPhoneå¹³å°ç»Ÿä¸€å†™iphoneos-armComponents: mainDescription: è½¯ä»¶ä»‹ç»ï¼Œå¯ä»¥ä½¿ç”¨ä¸­æ–‡å’Œhtmlä»£ç ï¼Œå…·ä½“èƒ½ä½¿ç”¨å“ªäº›ä»£ç åœ¨ä¸‹é¢ä¼šä»‹ç»ã€‚ å¯é€‰Support: æ”¯æŒï¼Œæ²¡ä»€ä¹ˆä½œç”¨ï¼Œé™¤éç‰¹åˆ«éœ€è¦ï¼Œå¦åˆ™å¯ä»¥ä¸è¦è¿™ä¸ªã€‚MD5Sum: ä¸æ˜¯å¿…é¡»çš„ï¼Œä½†å¦‚æœPackagesæ–‡ä»¶ä½ç½®ä¸ä¸Releaseæ–‡ä»¶åœ¨åŒä¸€ç›®å½•ä¸‹ï¼Œåˆ™å¿…é¡»æœ‰æ­¤é¡¹ã€‚å¦å¤–ï¼Œå¦‚æœéœ€è¦ç­¾åReleaseæ–‡ä»¶ï¼Œä¹Ÿå¿…é¡»æœ‰è¿™ä¸ªã€‚å…³äºMD5Sumçš„æ ¼å¼ï¼Œåœ¨ä¸‹æ–‡ä¹Ÿä¼šä»‹ç»ã€‚ Descriptionæ ¼å¼ æ˜¾ç¤ºåœ¨Cydiaä¸­æ¯ä¸ªè½¯ä»¶é¡µé¢æœ€ä¸‹æ–¹ã€‚ ä¸èƒ½ç›´æ¥æ¢è¡Œï¼Œå¦‚æœè¦å®ç°æ˜¾ç¤ºæ¢è¡Œæ˜¾ç¤ºï¼Œå¯ä»¥ä½¿ç”¨ä»£ç ã€‚ è¦åŠ ç²—æ˜¾ç¤ºï¼Œå¯ä»¥ä½¿ç”¨ä»£ç  å¯ä»¥ä½¿ç”¨htmlä»£ç è®¾ç½®å­—ä½“é¢œè‰²ã€‚ ä¸èƒ½ä½¿ç”¨è¶…é“¾æ¥ä»£ç ã€‚ ä»£ç ï¼š Description: WeiPhone-å¨é”‹ç½‘ä¸ºæ‚¨æä¾›iPhoneæ‰€éœ€è½¯ä»¶/è¡¥ä¸ã€‚&lt;br&gt;è”ç³»æˆ‘ä»¬: &lt;strong&gt;weip.com@ gmail.com&lt;/strong&gt;; ç”ŸæˆPackagesæ–‡ä»¶ å°† deb æ–‡ä»¶æ”¾åœ¨ä¸€ä¸ªæ–‡ä»¶å¤¹ä¸‹ï¼Œæ¯”å¦‚è¯´debsä¸‹ å‘½ä»¤è¡Œé‡Œè¿›å…¥åˆ°debsç›®å½•çš„ä¸Šçº§ç›®å½• Packageså­˜æ”¾äºå½“å‰ç›®å½• æ‰§è¡Œå‘½ä»¤ dpkg-scanpackages debs &gt; Packages æ‰§è¡Œå‘½ä»¤ bzip2 -zfk Packages ç”Ÿæˆ Packages.bz2 æ‰§è¡Œå‘½ä»¤ gzip -fk Packages ç”Ÿæˆ Packages.gz ps 4.5.6 å¯ä»¥ä½¿ç”¨ dpkg-scanpackages debs &gt; Packages &amp;&amp; bzip2 -zfk Packages &amp;&amp; gzip -fk Packages è¿™æ ·ä¼šè‡ªåŠ¨å°†debsæ–‡ä»¶å¤¹ä¸‹çš„æ‰€æœ‰ debæ–‡ä»¶ä¿¡æ¯ æ‰“å°è‡³ Packages æ–‡ä»¶é‡Œ (æ—§) åˆ¶ä½œ è‡ªå·±deb æ–‡ä»¶æ€»ç»“ å…ˆæŠŠæ–‡ä»¶å¤¹ç»“æ„å¼„å¥½ åœ¨ Applications æ–‡ä»¶å¤¹ä¸‹é¢æ”¾å…¥è‡ªå·±çš„ .app æ–‡ä»¶ åœ¨ DEBIAN æ–‡ä»¶å¤¹ä¸‹é¢æ”¾å…¥ controlæè¿°æ–‡ä»¶ï¼Œä»¥åŠæ ¹æ®è‡ªå·±çš„éœ€æ±‚æ”¾å…¥è„šæœ¬æ–‡ä»¶ ä½¿ç”¨ chmod -R 0755 Directory è®¾ç½®æƒé™ ä½¿ç”¨ dpkg-deb -b Directory a.deb å‘½ä»¤æ‰“åŒ… ä½¿ç”¨ dpkg-name a.deb è§„èŒƒå‘½å å„ä¸ªæ–‡ä»¶è®²è§£å…ˆç”Ÿæˆå¦‚ä¸‹çš„æ–‡ä»¶ç›®å½•ç»“æ„ï¼š +- Directory +- Applications | +- Example.app | | +- Info.plist | | +- Example | | +- icon.png +- DEBIAN +- control +- preinst/postinst/prerm/postrm/extrainst_ /Directory : ä»»æ„çš„ä¸€ä¸ªæ–‡ä»¶å¤¹æ”¾ç½®ä¸»è¦çš„æ–‡ä»¶/Directory/Applications : æ”¾ç½®.appæ–‡ä»¶å¤¹/Directory/Applications/Example.app : .appæ–‡ä»¶å¤¹ /DEBIAN : æ”¾ç½®æè¿°çš„æ–‡ä»¶/DEBIAN/control : è®°å½•äº†è½¯ä»¶åŒ…æ ‡è¯†ï¼Œè½¯ä»¶åï¼Œä»‹ç»ï¼Œä½œè€…ï¼Œå†²çªè½¯ä»¶ç­‰ä¿¡æ¯ï¼Œç”¨æ¥æ ‡è¯†ä¸€ä¸ªè½¯ä»¶åŒ… DEBIAN/control æ–‡ä»¶æè¿°ä»¥ä¸‹ä¸ºå¿…é¡»é¡¹ Package : è½¯ä»¶åŒ…æ ‡è¯†ç¬¦ï¼Œç±»ä¼¼äº*ï¼Œä¸€ä¸ªè½¯ä»¶åŒ…å¿…é¡»è¦æœ‰ä¸€ä¸ªå”¯ä¸€çš„æ ‡è¯†ç¬¦ã€‚é€šå¸¸æ˜¯ç”¨com.xxx.abcè¿™æ ·çš„å½¢å¼æ¥å‘½åã€‚Architecture: æ¶æ„ï¼Œç”¨äºæ ‡è¯†è¿è¡Œçš„ç³»ç»Ÿï¼ŒiPhoneä¸Šä¸ºiphoneos-armVersion: ç‰ˆæœ¬å·ï¼Œä¸èƒ½ç”¨ä¸‹åˆ’çº¿å’Œé€—å·å’Œç©ºæ ¼ã€‚æ ¼å¼æœ‰ï¼ˆä»¥é€—å·åˆ†éš”ï¼‰ 1.0ï¼Œ1.0fï¼Œ0-1ï¼Œ1:1.0ï¼Œå…¶ä¸­1:1.0è¿™ç§æ ¼å¼æ¯”è¾ƒç‰¹æ®Šï¼Œåœ¨Cydiaä¸­ï¼Œ1:1.0ä»ç„¶ä¼šæ˜¾ç¤ºä¸º1.0ï¼Œä½†ç‰ˆæœ¬å·å®é™…æ˜¯é«˜äº1.0çš„ã€‚ ä»¥ä¸‹ä¸ºå¯é€‰é¡¹Name: è½¯ä»¶åŒ…åœ¨Cydiaä¸­çš„æ˜¾ç¤ºåç§°ï¼Œä¸­è‹±æ–‡ä¸é™ï¼Œä¹Ÿå¯ä»¥ç”¨ç©ºæ ¼ï¼Œä½†ä¸å®œè¿‡é•¿ï¼ˆé•¿äº†æ˜¾ç¤ºä¸å®Œå…¨ï¼‰ã€‚Author: è½¯ä»¶ä½œè€…ã€‚Maintainer: ç»´æŠ¤è€…ï¼Œä¸€èˆ¬æ˜¯è½¯ä»¶æºçš„æ‹¥æœ‰è€…ã€‚Sponsor: è´Ÿè´£äººï¼Œå¯ä»¥æ˜¯ä¸ªäººä¹Ÿå¯ä»¥æ˜¯ç½‘ç«™ã€‚ Authorï¼ŒMaintainerï¼ŒSponsor çš„æ ¼å¼ç›¸åŒï¼Œå‡ä¸º åç§°+ç©ºæ ¼+&lt;é‚®ä»¶åœ°å€æˆ–ç½‘å€&gt;ï¼Œç»æµ‹è¯•ï¼Œå¦‚æœåç§°ä¸ºä¸­æ–‡çš„è¯ï¼Œå³ä½¿å†™äº†é‚®ä»¶åœ°å€å’Œç½‘å€ï¼Œåœ¨Cydiaä¸­ç‚¹å‡»ä¹Ÿä¸ä¼šè·³è½¬ã€‚ ç¤ºä¾‹ï¼š WEIP.Tech &#119;&#101;&#105;&#112;&#46;&#x63;&#x6f;&#109;&#x40;&#103;&#109;&#97;&#x69;&#x6c;&#44;&#x63;&#x6f;&#x6d; æˆ– WeiPhone.com http://www.weiphone.com å¦‚æœæ²¡æœ‰é‚®ä»¶åœ°å€æˆ–ç½‘å€ï¼Œåˆ™ä¸éœ€è¦ &lt;&gt; åŠ&lt;&gt;ä¸­çš„å†…å®¹ã€‚ä¸­æ–‡åæˆ–æœªæä¾›é‚®ä»¶/ç½‘å€ï¼Œæ—  &gt; ç¬¦å· Icon: æŒ‡å®šè½¯ä»¶åŒ…çš„å›¾æ ‡æ˜¾ç¤ºã€‚å½“æ— Iconè®¾å®šæ—¶ï¼ŒCydiaä¼šæ˜¾ç¤ºè¯¥è½¯ä»¶åŒ…æ‰€åœ¨çš„åˆ†ç±»çš„å›¾æ ‡ã€‚ æ ¼å¼ï¼š åœ¨çº¿åœ°å€ï¼Œå¦‚ http://www.abc.com/abc.png æœ¬åœ°åœ°å€ï¼šfile://+è·¯å¾„ï¼Œå¦‚file:///Applications/Cydia.app/Sources/app.weiphone.com.pngæ³¨ï¼šåœ¨è½¯ä»¶é¡µé¢ï¼ˆéåˆ—è¡¨é¡µé¢ï¼‰ï¼Œè‡ªå®šä¹‰çš„å›¾æ ‡æ˜¯ä¸ä¼šæ˜¾ç¤ºçš„ï¼Œæ˜¾ç¤ºçš„æ˜¯åˆ†ç±»å›¾æ ‡ã€‚ Section: è½¯ä»¶åˆ†ç±»ï¼Œä¸­è‹±æ–‡æ— é™åˆ¶ï¼Œæ’åˆ—é¡ºåºæ˜¯ è‹±æ–‡-&gt;ä¸­æ–‡ã€‚Installed-Size: è§£åŒ…åçš„æ–‡ä»¶å¤§å°ï¼Œå¯ä»¥æœ‰å°æ•°ä½ï¼Œä»¥kbä¸ºå•ä½ï¼Œä¸éœ€è¦æ³¨æ˜kbï¼Œè¿™ä¸ªä¸éœ€è¦å¾ˆç²¾ç¡®ï¼Œè€Œä¸”å°æ•°ä½åœ¨Cydiaé‡Œæ˜¾ç¤ºä¸å‡ºæ¥ï¼ˆä¸æ˜¯å››èˆäº”å…¥ï¼Œå…¨éƒ¨èˆäº†ï¼‰ã€‚è‡³äºæ–‡ä»¶å¤§å°æ˜¯å¦åŒ…å«DEBIANç›®å½•ä¸­çš„å†…å®¹å°±éšæ„äº†ã€‚Priority: ä¼˜å…ˆçº§ï¼Œå¯å¡« Requiredï¼ŒImportantï¼ŒStandardï¼ŒOptionalï¼ŒExtraï¼Œä¾æ¬¡ä¸º å¿…é¡»ï¼Œé‡è¦ï¼Œä¸€èˆ¬ï¼Œå¯é€‰ï¼Œæ¬¡è¦ã€‚è™½ç„¶æ²¡æœ‰ä»€ä¹ˆå®é™…ä½œç”¨ï¼Œä½†ä¼˜å…ˆçº§ä¸ºRequiredå’ŒImportantçš„è½¯ä»¶åŒ…åœ¨å¸è½½æ—¶ä¼šæœ‰è­¦å‘Šï¼Œè¿™æ ·å¯ä»¥é¿å…åˆ é™¤ä¸€äº›ç³»ç»Ÿå¿…é¡»çš„è½¯ä»¶ã€‚ä½†Requiredå’ŒImportantä¸è¦æ»¥ç”¨ï¼Œä¸€èˆ¬ç”¨Standardï¼ŒOptionalæˆ–Extraå³å¯ã€‚ä¼˜å…ˆçº§åœ¨Cydiaä¸­æ˜¯ä¸ä¼šæ˜¾ç¤ºçš„Essential: æ˜¯å¦å¿…é¡»è½¯ä»¶åŒ…ï¼Œå¯å¡« yes å’Œ noï¼Œ å¡«yesåˆ™ä¸ºå¿…é¡»è½¯ä»¶åŒ…ï¼Œå¸è½½æ—¶Cydiaä¼šæœ‰è­¦å‘Šã€‚å¸è½½Essentialæ ‡è®°ä¸ºyesçš„è½¯ä»¶åŒ…å¯èƒ½ä¼šå¯¼è‡´ç³»ç»Ÿé—®é¢˜ã€‚å½“ç„¶æ­¤åŠŸèƒ½éœ€æ…ç”¨ï¼Œä¸è¦å› ä¸ºä¸å¸Œæœ›ç”¨æˆ·åˆ é™¤è‡ªå·±çš„è½¯ä»¶è€ŒåŠ å…¥Essential: yesã€‚å¦‚æœæ²¡æœ‰Essentialè¿™é¡¹çš„è¯é»˜è®¤å°±æ˜¯éå¿…é¡»çš„ï¼Œç›¸å½“äºEssential: noã€‚Depends: Depends å­—æ®µåº”è¯¥åŒ…å«æ‚¨çš„è½¯ä»¶åŒ…æ­£å¸¸å·¥ä½œç»å¯¹å¿…éœ€çš„ä»»ä½•è½¯ä»¶åŒ…çš„åç§°ã€‚Pre-Depends: â€œPre-Dependsâ€æ˜¯ä¸ºç‰¹ä¾‹è€Œä¿ç•™çš„ã€‚å½“æŸä¸ªè½¯ä»¶åŒ…è¢«ä½œä¸ºâ€Pre-Dependsâ€åˆ—å‡ºæ—¶ï¼Œå®ƒå¼ºåˆ¶ç³»ç»Ÿåœ¨è¯•å›¾å®‰è£…æ‚¨çš„è½¯ä»¶åŒ…ä¹‹å‰å®Œå…¨å®‰è£…æ‰€æŒ‡å®šçš„è½¯ä»¶åŒ…ã€‚Conflicts: å†²çªè½¯ä»¶åŒ…ã€‚æ¯”å¦‚è½¯ä»¶åŒ…Aå’ŒBæœ‰å†²çªï¼Œä¸èƒ½åŒæ—¶å®‰è£…ã€‚æ¯”å¦‚è¯´Aå’ŒBå†²çªï¼Œå½“ç³»ç»Ÿå·²ç»å®‰è£…äº†Açš„æ—¶å€™å°è¯•å®‰è£…Bï¼Œåˆ™ä¸èƒ½ç»§ç»­ã€‚Provides: æä¾›çš„è½¯ä»¶åŒ…ï¼Œæ¯”å¦‚è¯´è½¯ä»¶åŒ…AåŒ…å«Bçš„å…¨éƒ¨åŠŸèƒ½ï¼Œé‚£ä¹ˆåˆ™æ˜¯A provides Bï¼Œå› æ­¤å¯ä»¥åœ¨å®‰è£…äº†Açš„å‰æä¸‹ä¸å®‰è£…Bã€‚ä½†æ­¤åŠŸèƒ½åœ¨éCydiaçš„è½¯ä»¶ç®¡ç†å·¥å…·ä¸­å¯èƒ½ä¼šæ— æ³•è¯†åˆ«ï¼ˆå®é™…æ˜¯è¿™äº›è½¯ä»¶ä¸åˆdebæ ‡å‡†ï¼‰Replaces: æ›¿æ¢è½¯ä»¶åŒ…ï¼Œå®‰è£…Aä¼šæ›¿æ¢Bã€‚ ä»¥ä¸Š5é¡¹çš„æ ¼å¼ç›¸åŒï¼Œç›´æ¥å¡«è½¯ä»¶åŒ…çš„Packageæ ‡è¯†å³å¯ï¼Œå¦‚æœéœ€è¦åŠ å…¥ç‰ˆæœ¬å·ï¼Œåˆ™ä¸º è½¯ä»¶è¡¨æ ‡è¯†+ç©ºæ ¼+(åˆ¤æ–­ç¬¦å· ç‰ˆæœ¬å·).æ¯”å¦‚ Depends: apt-key, firmware (&gt;=3.0)ï¼Œ è¿™è¡¨ç¤ºä¾èµ–äºapt-keyï¼Œä¸é™ç‰ˆæœ¬ï¼Œfirmwareï¼Œä¸”ç‰ˆæœ¬å¤§äºæˆ–ç­‰äº3.0ã€‚ åˆ¤æ–­ç¬¦å·ï¼šè¿œè¿œä½äºï¼ˆ&lt;&lt;ï¼‰ã€ä½äº(&lt;)ã€ä½äºæˆ–ç­‰äºï¼ˆ&lt;=ï¼‰ã€ä»…ç­‰äºï¼ˆ=ï¼‰ã€ç­‰äºæˆ–é«˜äºï¼ˆ&gt;=ï¼‰ã€å¤§äºï¼ˆ&gt;ï¼‰ä»¥åŠè¿œè¿œé«˜äºï¼ˆ&gt;&gt;ï¼‰ã€‚ è¡¨ç¤ºå¤šä¸ªè½¯ä»¶åŒ…ï¼Œä»¥è‹±æ–‡é€—å·åˆ†éš”ã€‚ è¡¨ç¤ºâ€œæˆ–â€å…³ç³»ï¼Œç”¨ | åˆ†éš”ã€‚æ¯”å¦‚è½¯ä»¶åŒ…Cä¾èµ–äºAæˆ–Bï¼Œå¯å†™Depends: A | Bã€‚ ä½†â€œæˆ–â€å…³ç³»è¦æ…ç”¨ã€‚åŸå› æ˜¯ï¼Œå½“ä¸å­˜åœ¨â€œæˆ–â€å…³ç³»çš„æ—¶å€™ï¼Œå‡è®¾Bä¾èµ–äºAï¼Œä¸”ç³»ç»Ÿå¹¶æœªå®‰è£…Aï¼Œé‚£ä¹ˆåœ¨Cydiaä¸­å®‰è£…Bçš„æ—¶å€™ä¼šè‡ªåŠ¨ä¸‹è½½å®‰è£…Aã€‚è€Œå‡å¦‚è¯´Cä¾èµ–äºAæˆ–Bï¼Œä¸”Aä¸Béƒ½æœªå®‰è£…ï¼Œé‚£ä¹ˆåœ¨å®‰è£…Cçš„æ—¶å€™å°±ä¼šå¤±è´¥ï¼Œå› ä¸ºç³»ç»Ÿæ— æ³•åˆ¤æ–­æ˜¯åº”è¯¥ä¸‹è½½Aè¿˜æ˜¯Bã€‚é™¤éç³»ç»Ÿå·²ç»å®‰è£…äº†Aæˆ–Bï¼Œå¦åˆ™Cä¸èƒ½å®‰è£…ã€‚ ä¸€ä¸ªç‰¹æ®Šçš„ä¾èµ–ï¼šfirmwareã€‚è¿™ä¸ªPackageè®°å½•äº†å›ºä»¶ç‰ˆæœ¬ï¼Œåœ¨å¯¹å›ºä»¶ç‰ˆæœ¬æœ‰è¦æ±‚çš„è½¯ä»¶åŒ…ä¸Šç‰¹åˆ«é‡è¦ã€‚ å‡è®¾Bä¾èµ–äºAï¼Œé‚£ä¹ˆåœ¨å¸è½½Açš„æ—¶å€™ä¹Ÿä¼šä¸€èµ·å¸è½½B Description: è½¯ä»¶æè¿°ï¼Œä¸èƒ½åœ¨controlé‡Œç›´æ¥æ¢è¡Œï¼Œå¦‚æœéœ€è¦å®ç°æ¢è¡Œæ˜¾ç¤ºï¼Œå¯ä»¥ä½¿ç”¨ä»£ç ã€‚å½“æŒ‡å®šäº†Depictionæ—¶ï¼Œåœ¨è½¯ä»¶æŸ¥çœ‹é¡µé¢ä¸ä¼šæ˜¾ç¤ºDescriptionã€‚Depiction: åŠŸèƒ½ç±»ä¼¼äºè½¯ä»¶æè¿°ï¼Œé“¾æ¥åˆ°ä¸€ä¸ªç½‘é¡µï¼Œä»¥ç½‘é¡µçš„å†…å®¹ä»£æ›¿è½¯ä»¶æè¿°ã€‚åªåœ¨è½¯ä»¶æŸ¥çœ‹é¡µé¢æ˜¾ç¤ºï¼Œåœ¨è½¯ä»¶åŒ…åˆ—è¡¨é¡µé¢ä¸æ˜¾ç¤ºã€‚ å¯ä»¥ä½¿ç”¨æœ¬åœ°ç½‘é¡µï¼Œæ ¼å¼åŒIconã€‚ æ³¨æ„ï¼šæ­¤åŠŸèƒ½å¯èƒ½ä¼šæ¶ˆè€—å¤§é‡ç½‘ç»œæµé‡ã€‚Homepage: é“¾æ¥åˆ°é¡µé¢ï¼ŒCydiaä¸­æ˜¾ç¤ºä¸ºMore Informationã€‚ é¡µé¢ä¸ä¼šä¸»åŠ¨åŠ è½½ã€‚Tag: å¯é€‰é¡¹æœ‰ commercial, console, daemon, extension, library, uikit, xï¼Œå¯¹åº”å›¾æ ‡æ–‡ä»¶åœ¨ /Applications/Cydia.app/Purposes ç›®å½•ä¸‹ã€‚ä¹Ÿå¯ä»¥è‡ªè¡Œæ·»åŠ  purpose åˆ†ç±»ï¼Œå¹¶åŠ å…¥åŒåå›¾æ ‡å³å¯ã€‚ role:: è½¯ä»¶åŒ…ä½¿ç”¨è€…å½’ç±»ã€‚developerå¼€å‘è€…ï¼Œhackeréª‡å®¢ï¼Œenduseræ™®é€šç”¨æˆ·ï¼Œè¯¥æ ‡ç­¾ç”¨äºCydiaä¸­è½¯ä»¶åŒ…æ˜¾ç¤ºè¿‡æ»¤ã€‚ cydia::commercial Cydia Storeè½¯ä»¶ã€‚ ä¾‹å­å¦‚ä¸‹: Package: com.weiphone.source Name: WeiPhoneå¨é”‹ä¸­æ–‡æº Version: 1.0 Essential: no Icon: file:///Applications/Cydia.app/Sources/app.weiphone.com.png Installed-Size: 133.7 Replaces: con.weiphone.logo Conflicts: con.weiphone.logo Provides: con.weiphone.logo Depends: cydia Priority: Standard Maintainer: WEIP.Tech Author: WEIP.Tech Section: Repositories Architecture: iphoneos-arm Description: WeiPhone Chinese Repositoryå¨é”‹ä¸­æ–‡æº HomePage: http://www.weiphone.com/ Sponsor: WeiPhone.com Tag: purpose::repository, role::enduser DEBIAN/preinst/postinst/prerm/postrm/extrainst_ æ–‡ä»¶æè¿°å¾ˆå¤šæ—¶å€™debå®‰è£…å¹¶ä¸æ˜¯æŠŠæ–‡ä»¶å¤åˆ¶åˆ°iPhoneé‡Œå°±å¯ä»¥äº†ï¼Œè¿˜éœ€è¦æ‰§è¡Œä¸€äº›å‘½ä»¤ï¼Œæ¯”å¦‚è®¾ç½®æƒé™ï¼Œå¤‡ä»½æ–‡ä»¶ï¼ŒåŠ è½½å¯åŠ¨è¿›ç¨‹ç­‰ç­‰ï¼Œé‚£ä¹ˆè¿™æ—¶å€™å°±éœ€è¦ä¸€äº›è„šæœ¬æ¥å®ç°è¿™äº›æ“ä½œã€‚ æ ‡å‡†çš„debè„šæœ¬æœ‰4ä¸ªpreinst,postinst,prermå’Œ postrmpreæ˜¯è¡¨ç¤ºXXä¹‹å‰çš„å‰ç¼€ï¼Œpostæ˜¯è¡¨ç¤ºXXä¹‹åçš„å‰ç¼€ï¼Œinstæ˜¯installï¼ˆå®‰è£…ï¼‰çš„ç¼©å†™ï¼Œrmæ˜¯removeï¼ˆç§»é™¤ï¼‰çš„ç¼©å†™ï¼Œæ‰€ä»¥è¿™4ä¸ªè„šæœ¬çš„åŠŸèƒ½å¾ˆæ˜æ˜¾ï¼š preinst: åœ¨å¤åˆ¶æ–‡ä»¶å‰æ‰§è¡Œçš„è„šæœ¬ postinst: åœ¨å¤åˆ¶æ–‡ä»¶ä¹‹åæ‰§è¡Œçš„è„šæœ¬ prerm: åœ¨å¸è½½å‰æ‰§è¡Œçš„è„šæœ¬ postrm: åœ¨å¸è½½ä¹‹åæ‰§è¡Œçš„è„šæœ¬ åœ¨Cydiaä¸­è¿˜å­˜åœ¨ä¸€ä¸ªç‹¬ç«‹çš„è„šæœ¬,extrainst_,ä»å­—é¢ä¸Šæ¥è®²å°±æ˜¯é¢å¤–çš„å®‰è£…è„šæœ¬ã€‚è¿™ä¸ªè„šæœ¬æ˜¯Cydiaçš„ä½œè€…Saurikä¸ºè§£å†³æŸäº›è„šæœ¬åªéœ€è¦åœ¨å®‰è£…æ—¶æ‰§è¡Œï¼Œåœ¨å‡çº§æ—¶ä¸æ‰§è¡Œè€Œä¸“é—¨å¼•å…¥çš„ä¸€ä¸ªè„šæœ¬ï¼ŒåŠŸèƒ½è·Ÿpostinstå·®ä¸å¤šï¼Œå’ŒInstalleræ—¶ä»£çš„â€œahhhhâ€æ¯”è¾ƒç›¸ä¼¼ã€‚å…³äºextrainst_çš„è¯¦æƒ…å¯ä»¥çœ‹çœ‹è¿™ä¸ªï¼šhttp://www.telesphoreo.org/piper â€¦ ptember/000252.html 5ä¸ªè„šæœ¬çš„ç¼–å†™æ–¹æ³•åŸºæœ¬æ˜¯ä¸€æ ·çš„ï¼Œä½†ä¸ºäº†é€‚åº”Cydiaçš„å®‰è£…ï¼Œåœ¨æŸäº›æƒ…å†µä¸‹éœ€è¦è¿›è¡Œç‰¹å®šçš„é…ç½®ã€‚ æŸ¥çœ‹æŸäº›debå¯èƒ½ä¼šå‘ç°è¿™æ ·çš„è¯­å¥ï¼š if [[ $1 == install || $1 == upgrade ]]; then è¿™ç§è¯­å¥æ˜¯ä¸ºäº†åŒºåˆ«å®‰è£…/å‡çº§/å¸è½½è€Œå‡†å¤‡çš„è„šæœ¬ã€‚$1æ˜¯ä¸€ä¸ªå¤–éƒ¨å˜é‡ï¼Œå°†è¿™ä¸ªå¤–éƒ¨å˜é‡ä¼ å…¥è„šæœ¬æ¥æ‰§è¡Œï¼Œè€Œè¿™ä¸ªå¤–éƒ¨å˜é‡æ˜¯ç”±Cydiaè½¯ä»¶è‡ªèº«ç”Ÿæˆçš„ã€‚ ç®€å•æ¥è¯´ï¼Œå¦‚æœæ˜¯å®‰è£…ï¼Œåˆ™æ˜¯ $1 == install ï¼›å¦‚æœæ˜¯å‡çº§ï¼Œåˆ™æ˜¯$1 == upgradeï¼›å¦‚æœæ˜¯å¸è½½åˆ™æ˜¯ $1 == removeã€‚ if æ˜¯ä¸ªåˆ¤æ–­è¯­å¥ï¼Œå½“æ»¡è¶³ifå[ ]ä¸­çš„æŒ‡å®šæ¡ä»¶æ—¶ï¼Œifä¸­çš„å†…å®¹å°±ä¼šæ‰§è¡Œã€‚é‚£ä¹ˆè¿™é‡Œå°±å¯ä»¥é€šè¿‡è®¾å®šinstall/upgrade/removeæ¥æ§åˆ¶åœ¨ä¸åŒæ“ä½œæ—¶æ‰§è¡Œçš„å‘½ä»¤ã€‚ ä½†è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™ä¸ªåŠŸèƒ½åªèƒ½åœ¨Cydiaä¸­ä½¿ç”¨ï¼Œå…¶å®ƒçš„aptè½¯ä»¶ç®¡ç†å·¥å…·ï¼Œå¦‚Icyï¼ŒRockç­‰ï¼Œä¸èƒ½è¯†åˆ«è¿™ä¸ªå‘½ä»¤ï¼Œå› æ­¤æ— æ³•æ‰§è¡Œifä¸­çš„è¯­å¥ï¼Œæ‰€ä»¥åœ¨å†™è„šæœ¬çš„æ—¶å€™åˆ°åº•éœ€ä¸éœ€è¦ç”¨è¿™ç§æ ¼å¼ï¼Œå°±çœ‹è‡ªå·±çš„éœ€è¦äº†ã€‚ æ€»ä½“æ¥è¯´ï¼ŒUnixçš„è„šæœ¬ï¼ˆShell Scriptï¼‰æœ‰å…¶å›ºå®šçš„æ ¼å¼ã€‚ æ–‡ä»¶é¡¶å¤´ä¸º #!/bin/bash è¡¨ç¤ºè°ƒç”¨bashè¿™ä¸ªshell ä¹‹åå°±æ˜¯è¿è¡Œçš„å‘½ä»¤äº†ã€‚ è„šæœ¬ä¸­å¦‚æœéœ€è¦æ³¨é‡Šï¼Œå¯ä»¥ä½¿ç”¨ # ç¬¦å·ã€‚ ä»¥ # å¼€å¤´çš„è¡Œä¼šè¢«å½“ä½œæ³¨é‡Šï¼Œé‡Œé¢çš„å†…å®¹åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­æ²¡æœ‰æ„ä¹‰ã€‚ é€šé…ç¬¦ï¼š * æœ€å¸¸ç”¨çš„ä¸¤ä¸ªå‘½ä»¤è‡ªç„¶æ˜¯è®¾ç½®å±æ€§/æƒé™/ç”¨æˆ·/ç»„ è®¾ç½®å±æ€§/ ä¼šä½¿ç”¨åˆ°çš„ç³»ç»Ÿå‘½ä»¤æ“ä½œæƒé™chmod ã€-Rã€‘ å±æ€§ æ–‡ä»¶å ç”±äºdebçš„è„šæœ¬æ‰§è¡Œéƒ½æ˜¯åœ¨rootç”¨æˆ·ä¸‹ï¼Œå› æ­¤ä¸éœ€è¦æå‡æƒé™ï¼Œå³ä¸éœ€è¦ä½¿ç”¨sudoå‘½ä»¤ã€‚ -Rå‚æ•°ï¼šè¡¨ç¤ºé€’å½’ï¼ŒåŠ ä¸Šæ­¤å‚æ•°ä¼šå°†æŒ‡å®šçš„ç›®å½•åŠå…¶å­ç›®å½•çš„å…¨éƒ¨ç›®å½•å’Œæ–‡ä»¶çš„å±æ€§æ”¹å˜ã€‚ å±æ€§ï¼šæœ‰å¤šç§å†™æ³•ã€‚å…·ä½“å¯ä»¥çœ‹ http://baike.baidu.com/view/1229012.htm?fr=ala0_1 æ¯”è¾ƒå¸¸ç”¨çš„å‡ ç§å±æ€§ï¼š chmod +x XXXXX ä¸ºæ–‡ä»¶å¢åŠ å¯æ‰§è¡Œæƒé™ chmod 0644 XXXXX ä¸å¯æ‰§è¡Œæ–‡ä»¶æœ€å¸¸ä½¿ç”¨çš„æƒé™ chmod 0755 XXXXX å¯æ‰§è¡Œæ–‡ä»¶æœ€å¸¸ä½¿ç”¨çš„æƒé™ å®ä¾‹ï¼š chmod -R 0755 /Applications/Cydia.app è®¾ç½®ç”¨æˆ·/ç»„chown ã€-Rã€‘ ç”¨æˆ·:ç»„ æ–‡ä»¶å åŒæ ·ä¸éœ€è¦sudoæ¥æç¤ºæƒé™ã€‚-Rä¹Ÿæ˜¯è¡¨ç¤ºé€’å½’ã€‚ æ¯”å¦‚è¦å°†æ–‡ä»¶Aè®¾ä¸ºrootç”¨æˆ·ï¼Œwheelç»„ï¼Œå¯ä»¥ä½¿ç”¨å‘½ä»¤ chown -R mobile:mobile /var/mobile/Documents å¤åˆ¶æ–‡ä»¶/æ–‡ä»¶å¤¹cp ã€å‚æ•°ã€‘ åŸå§‹æ–‡ä»¶ ç›®çš„æ–‡ä»¶ å‚æ•°åˆ—è¡¨ï¼š -lï¼ˆå°å†™å­—æ¯Lï¼‰ï¼šåˆ›å»ºç¡¬é“¾æ¥ï¼Œç›¸å½“äºä¸€ä¸ªé•œåƒï¼Œè€Œä¸æ˜¯å®é™…åˆ›å»ºä¸¤ä¸ªæ–‡ä»¶cp -l abc def -fï¼šå¼ºè¡Œå¤åˆ¶ï¼Œå¦‚æœç›®çš„æ–‡ä»¶å·²å­˜åœ¨ï¼Œè¦†ç›–ä¹‹ä¸”ä¸æç¤ºcp -f abc def -pï¼šä¿ç•™æ–‡ä»¶çš„å±æ€§ã€ç”¨æˆ·ã€ç»„ã€æ—¶é—´æˆ³ç­‰ä¿¡æ¯ cp -p abc def -rå’Œ-Rï¼šä½œç”¨éƒ½æ˜¯é€’å½’ï¼Œå°†æ–‡ä»¶å¤¹ä¸‹çš„å…¨éƒ¨å­æ–‡ä»¶å’Œå­æ–‡ä»¶å¤¹ä¸€èµ·å¤åˆ¶ cp -r abc/ def/ -sï¼šåˆ›å»ºç¬¦å·é“¾æ¥è€Œä¸æ˜¯åˆ›å»ºåŒä»½æ–‡ä»¶ cp -s abc/ def/ -nï¼šå¦‚æœç›®çš„æ–‡ä»¶å·²å­˜åœ¨ï¼Œåˆ™ä¸è¦†ç›–ä¸”ä¸æç¤º cp -n abc def -aï¼šç›¸å½“ä¸-dRï¼Œä¿ç•™æ–‡ä»¶è‡ªèº«çš„å±æ€§ç­‰æ•°æ®ï¼Œä¸€å¹¶å¤åˆ¶å­æ–‡ä»¶/æ–‡ä»¶å¤¹ cp -a abc/ def/ ç§»åŠ¨æ–‡ä»¶/æ–‡ä»¶å¤¹ &amp; é‡å‘½åmv ã€å‚æ•°ã€‘ æºæ–‡ä»¶ ç›®çš„æ–‡ä»¶ -fï¼šå¼ºè¡Œç§»åŠ¨ï¼Œå¦‚æœç›®çš„æ–‡ä»¶å·²å­˜åœ¨ï¼Œè¦†ç›–ä¹‹ä¸”ä¸æç¤º å…¶å® mv å‘½ä»¤å°±æ˜¯å¤åˆ¶ä¹‹åå†åˆ é™¤ï¼Œä½† mv å‘½ä»¤ä¼šè‡ªåŠ¨ä¿ç•™æ–‡ä»¶çš„å±æ€§ç­‰æ•°æ®ï¼Œç§»åŠ¨æ–‡ä»¶å¤¹æ—¶ä¼šè‡ªåŠ¨ç§»åŠ¨å­æ–‡ä»¶/å­æ–‡ä»¶å¤¹ï¼Œå› æ­¤éƒ½ä¸éœ€è¦å¦å¤–çš„å‚æ•°ã€‚ é‡å‘½åæ˜¯ç”±mvå‘½ä»¤æ¥å®ç°çš„ï¼Œmv å°±æ˜¯å°† æºæ–‡ä»¶ ç§»åŠ¨åˆ° ç›®æ ‡æ–‡ä»¶çš„ä½ç½®å¹¶ä»¥ç›®æ ‡æ–‡ä»¶çš„æ–‡ä»¶åä¿å­˜ã€‚ æ˜¾ç¤ºè¯­å¥echo &quot;Some Thing&quot;; ç¤ºä¾‹ï¼šæ˜¾ç¤ºè¯­å¥ â€œæµ‹è¯•echoå‘½ä»¤â€ã€‚ echo &quot;æµ‹è¯•echoå‘½ä»¤&quot;; ç®¡ç†è‡ªå¯åŠ¨æœåŠ¡launchctl loadæˆ–unload -w plistæ–‡ä»¶è·¯å¾„ å®ä¾‹ï¼š è®©wefit3è‡ªå¯åŠ¨ launchctl load -w /System/Library/LaunchDaemons/com.weiphone.fitx.plist ç¦ç”¨iPhoneæ—¥å¿—è®°å½•syslogd launchctl unload -w /System/Library/LaunchDaemons/com.apple.syslogd.plist PS: è®°å½•è‡ªå¯åŠ¨è¿›ç¨‹çš„plistæ–‡ä»¶ä¿å­˜åœ¨ä»¥ä¸‹ä¸¤ä¸ªç›®å½•ï¼š /System/Library/LaunchDaemons/ å’Œ /Library/LaunchDaemons/ æ€æ­»è¿›ç¨‹killall è¿›ç¨‹å ç¤ºä¾‹ï¼šå…³é—­Safariè¿›ç¨‹ killall safari åˆ¤æ–­åŸºæœ¬æ ¼å¼æ˜¯ if [ åˆ¤æ–­æ¡ä»¶ä¸€ ]; then æ‰§è¡Œå‘½ä»¤ else æ‰§è¡Œå‘½ä»¤ fi å®ä¾‹ï¼š å¦‚æœæ–‡ä»¶abcå­˜åœ¨ï¼Œåˆ™å¤‡ä»½ä¸ºabc.bakï¼Œå¦åˆ™å°†æ–‡ä»¶defé‡å‘½åä¸ºabc if [ -f abc]; then mv -f abc abc.bak else mv def abc fi å…¶ä¸­[ -f abc ]å¯ä»¥ç”±[ -e abc]å–ä»£ å¦‚æœç›®å½•abcä¸å­˜åœ¨ï¼Œåˆ™æ–°å»ºä¸€ä¸ªç›®å½•abc if [ ! -e abc ]; then mkdir abc fi è·å–å›ºä»¶ç³»ç»Ÿç‰ˆæœ¬å·sw_vers -productVersion è·å–è®¾å¤‡å‹å·uname -i uname -m Cydiaä¸­å®‰è£…å®Œä¹‹åé‡æ–°å¯åŠ¨SpringBoarddeclare -a cydia cydia=($CYDIA) if [[ ${CYDIA+@} ]]; then eval &amp;quot;echo &amp;#39;finish:reboot&amp;#39; &amp;gt;&amp;amp;${cydia[0]}&amp;quot; fi å‡ ä¸ªæ¯”è¾ƒæœ‰ç”¨çš„å®ä¾‹ å¤‡ä»½ preinstï¼ˆå®‰è£…ä¹‹å‰å°±è¦æŠŠåŸå§‹æ–‡ä»¶å¤‡ä»½ï¼Œä¸èƒ½ç­‰åˆ°å®‰è£…å®Œå·²ç»è¦†ç›–ä»¥åæ‰å¤‡ä»½ï¼‰ if [ ! -f åŸå§‹æ–‡ä»¶å¤‡ä»½ ]; then echo &amp;quot;åŸå§‹æ–‡ä»¶çš„å¤‡ä»½å·²å­˜åœ¨ï¼Œè·³è¿‡å¤‡ä»½&amp;quot; else cp -p åŸå§‹æ–‡ä»¶ åŸå§‹æ–‡ä»¶å¤‡ä»½ echo &amp;quot;åŸå§‹æ–‡ä»¶å·²å¤‡ä»½&amp;quot; fi postrmï¼ˆè¿˜åŸå¤‡ä»½ï¼‰ echo &quot;è¿˜åŸå¤‡ä»½&quot;; mv -f åŸå§‹æ–‡ä»¶å¤‡ä»½ åŸå§‹æ–‡ä»¶ å¤‡ä»½æ“ä½œåœ¨åˆ¶ä½œè¡¥ä¸çš„æ—¶å€™ï¼Œå°¤å…¶æ˜¯æ›¿æ¢ç±»å‹çš„è¡¥ä¸æ—¶ç‰¹åˆ«æœ‰ç”¨ åˆ¤åˆ«å…·ä½“å›ºä»¶ç‰ˆæœ¬ åœ¨controlé‡Œå¯ä»¥é€šè¿‡Dependsæ¥è®¾ç½®ä¾èµ–çš„å›ºä»¶ç‰ˆæœ¬ï¼Œä½†æœ‰æ—¶å€™éœ€è¦åœ¨æŸä¸ªç‰¹å®šå›ºä»¶ç‰ˆæœ¬ä¸‹è¿›è¡Œæ“ä½œ æ¯”å¦‚è¯´ä¸€ä¸ªè½¯ä»¶ï¼Œè¦æ±‚å›ºä»¶ç‰ˆæœ¬å¤§äºæˆ–ç­‰äº3.0ï¼Œä½†åœ¨å›ºä»¶ç‰ˆæœ¬ä¸º3.1çš„æ—¶å€™å¿…é¡»åˆ é™¤æŸä¸€ä¸ªæ–‡ä»¶æ‰èƒ½è¿è¡Œï¼Œé‚£ä¹ˆè„šæœ¬å¯ä»¥è¿™æ ·å†™ï¼š firmware=$(sw_vers -productVersion) if [[ $firmware == 3.1 ]]; then åˆ é™¤æ–‡ä»¶ fi åˆ¤åˆ«è®¾å¤‡å‹å· å½“è®¾å¤‡å‹å·ä¸ºiPod Touchæ—¶åˆ é™¤æŸä¸ªæ–‡ä»¶platform=$(uname -i) if [[ $platform == &amp;quot;N45AP&amp;quot; || $platform == &amp;quot;N72AP&amp;quot; || $platform == &amp;quot;N18AP&amp;quot; ]]; then åˆ é™¤æ–‡ä»¶ fi æˆ–platform=$(uname -m) if [ $platform == iPod* ]; then åˆ é™¤æ–‡ä»¶ fi æ›´å¤šå…³äºShell Scriptçš„ä¿¡æ¯è¯·è§ http://www.hack base.com/tech/2009-10-10/56808.html æ‰“åŒ…å¦‚æœåœ¨DEBIANä¸­æœ‰è„šæœ¬å­˜åœ¨ï¼Œåˆ™éœ€è¦å°†æ•´ä¸ªDEBIANæ–‡ä»¶å¤¹åŠå­æ–‡ä»¶å±æ€§è®¾ä¸º0755,å¦‚æœæ²¡æœ‰è„šæœ¬çš„è¯ä¿ç•™0644å±æ€§å³å¯ï¼Œ0755å±æ€§ä¹Ÿæ²¡é—®é¢˜ã€‚ chmod -R 0755 DEBIAN æ‰“åŒ…å‘½ä»¤ dpkg-deb -b PATH FILENAME å…¶ä¸­PATHæ˜¯æ‰“åŒ…debçš„å·¥ä½œç›®å½•ï¼ŒDEBIANæ–‡ä»¶å¤¹éœ€ä½äºPATHæŒ‡å®šçš„ç›®å½•ä¸‹ FILENAMEæ˜¯debçš„æ–‡ä»¶åï¼Œè¿™ä¸ªå¯ä»¥è‡ªå·±å†³å®šã€‚ ä»¥ä¸Šå‘½ä»¤æ‰“åŒ…debé»˜è®¤æ˜¯é‡‡ç”¨gzæ ¼å¼å‹ç¼©ï¼Œå‹ç¼©ç‡æœ‰é™ï¼Œå¦‚æœè¦è·å¾—æ›´æ”¹çš„å‹ç¼©ç‡ï¼ˆæ›´å°çš„æ–‡ä»¶ä½“ç§¯ï¼‰ï¼Œå¯ä»¥ä½¿ç”¨bzip2å’Œlzmaæ ¼å¼ã€‚ å‹ç¼©ä¸ºbzip2æ ¼å¼ dpkg-deb -bZ bzip2 PATH FILENAME å‹ç¼©ä¸ºbzip2æ ¼å¼ dpkg-deb -bZ lzma PATH FILENAME é»˜è®¤çš„gzæ ¼å¼å‹ç¼©ç‡æœ€ä½ï¼Œbzip2æ ¼å¼å±…ä¸­ï¼Œlzmaæ ¼å¼å‹ç¼©ç‡æœ€é«˜ã€‚ï¼ˆå½“ç„¶ä¹Ÿä¼šæœ‰ä¾‹å¤–ï¼‰ PS: å‹ç¼©ç‡è¶Šé«˜ï¼Œå‹ç¼©æ—¶é—´è¶Šé•¿ï¼Œåœ¨iPhoneä¸Šä½¿ç”¨è¾ƒé«˜çš„å‹ç¼©ç‡æœ‰æ›´å¤§æ¦‚ç‡å¯¼è‡´å¤±å»å“åº”ã€‚ iPhone OS 2.xæ— lzmaç»„ä»¶ï¼Œå› æ­¤æ— æ³•å®‰è£…lzmaå‹ç¼©çš„debã€‚iPhone OS 3.xå¯ä»¥è§£å‹lzmaå‹ç¼©ã€‚ å¦‚æœdebåŒ…å«çš„æ–‡ä»¶æ–‡æœ¬é‡æ¯”è¾ƒå¤§ï¼Œé‚£ä¹ˆä¸€èˆ¬å¯ä»¥è·å¾—ä¸é”™çš„å‹ç¼©ç‡ã€‚ä½†å¦‚æœæ˜¯åƒé“ƒå£°ï¼Œjpg/pngå›¾ç‰‡è¿™æ ·æ–‡ä»¶æœ¬èº«å°±æ˜¯å‹ç¼©æ ¼å¼çš„æƒ…å†µï¼Œç»§ç»­å‹ç¼©çš„å¯èƒ½æ€§å°±ä¸é«˜äº†ï¼Œè¿™ç±»æƒ…å†µå¾ˆéš¾è·å¾—æ¯”è¾ƒå¥½çš„å‹ç¼©ç‡ ã€å¯é€‰ã€‘debæ–‡ä»¶è§„èŒƒå‘½ådpkg-name abc_1.0.deb å¦‚æœæƒ³æŒ‡å®šæ–‡ä»¶åæ ¼å¼ï¼Œå¯ä»¥ä½¿ç”¨ dpkg-name --help å›¾å½¢ç•Œé¢çš„debåˆ¶ä½œå·¥å…· Debian Package Maker ç½‘å€ï¼š http://code.google.com/p/debianpackagemaker/ ä¸ªäººæ„Ÿè§‰ä¸å¦‚ç›´æ¥åœ¨å‘½ä»¤è¡Œé‡Œæ¥çš„ç›´è§‚ï¼Œæœ‰å…´è¶£çš„æœ‹å‹å¯ä»¥è‡ªå·±è¯•è¯•ã€‚ ï¼» éœ€è¦ç¿»å¢™ ï¼½ (æ–°) åˆ¶ä½œè‡ªå·±çš„debæ–‡ä»¶å®‰è£…theoså®‰è£…æ–¹æ³• é€‰æ‹©theosçš„å®‰è£…ç›®å½•ï¼Œå®˜æ–¹å»ºè®®æ”¾åœ¨é»˜è®¤çš„ /opt/theos.ç„¶åæ‰§è¡Œ export THEOS=/opt/theos ä¸ºäº†éªŒè¯è®¾ç½®æˆåŠŸæ²¡æœ‰ echo $THEOS å¦‚æœæ‰“å° /opt/theos è¯´æ˜æ‘„åˆ¶å®Œæˆ Using git: git clone --recursive git://github.com/DHowett/theos.git /opt/theos Alternatively, you can use svn, if you prefer: svn co http://svn.howett.net/svn/theos/trunk $THEOS git clone -b stableversion https://github.com/haorenqq/theos/ $THEOSä¸è¦æ‰§è¡Œä¸Šé¢çš„è¯­å¥ï¼Œç”¨ä¸Šé¢çš„æ–¹æ³•æ›¿æ¢ ç‰¹åˆ«æ„Ÿè°¢ç½‘åä¸ºé€é¥ç¬›å­ çš„çƒ­å¿ƒæœ‹å‹ æä¾›çš„åˆ†æ”¯ï¼Œç”±äºåŸtheosæœ€æ–°çš„ç‰ˆæœ¬ä¸å…¼å®¹iosopendevï¼Œæ‰€ä»¥ç”¨15å¹´çš„è€ç‰ˆæœ¬ ä»¥ä¸Šæ“ä½œï¼Œå¦‚æœå‡ºç°ä»»ä½•å…³äºæƒé™çš„é”™è¯¯ã€‚ä½¿ç”¨sudoå°±å¯ä»¥äº†ã€‚ å®‰è£…idldå…¶å®æˆ‘ä¸çŸ¥é“è¿™ä¸ªæ˜¯å¹²ä»€ä¹ˆçš„ï¼Ÿä½†æ˜¯å‘¢ï¼Œè¯´æ˜¯ç­¾åçš„ã€‚ã€‚ã€‚ä½†æ˜¯æˆ‘æ²¡ç”¨åˆ°è¿‡ï¼Œä½†æ˜¯è¿˜æ˜¯è®°å½•ä¸€ä¸‹æ¯•ç«Ÿæœ‰ä¸å°‘å‘ æŒ‰ç…§å®˜æ–¹çš„æ•™ç¨‹æ˜¯å¦‚æ­¤çš„è¯´çš„ã€‚ git clone git://git.saurik.com/ldid.git cd ldid git submodule update --init ./make.sh cp -f ./ldid $THEOS/bin/ldid ä½†æ˜¯é€šå¸¸å‘ç”Ÿé”™è¯¯ï¼Œç¬¬ä¸€ä¸ªé”™è¯¯å°±æ˜¯ å¼•å…¥äº† #include &lt;openssl/err.h&gt; ï¼Œé»˜è®¤æ˜¯ä¸å­˜åœ¨ è¿™ä¸ªæ–‡ä»¶å¤¹çš„é¢ã€‚ç¬¬äºŒä¸ªé”™è¯¯å°±æ˜¯ make.shä¸­çš„ä»£ç é»˜è®¤æ˜¯åªåŒ¹é…Xcode5-1-1çš„åç§°ï¼Œæ‰€ä»¥éœ€è¦ä¿®æ”¹ make æ–‡ä»¶ã€‚ ä¸‹è½½ æ–‡ä»¶ ä¿®å¤ æ¥ä¸‹æ¥ä½¿ç”¨å‘½ä»¤ã€‚ç”Ÿæˆ ldid æ–‡ä»¶./make.sh . åæ­£æˆ‘æ˜¯ç”Ÿæˆå¤±è´¥äº† ä½ å¯ä»¥ç›´æ¥ä¸‹è½½åˆ«äººå·²ç»ç¼–è¯‘å®Œæˆçš„æ–‡ä»¶ ldidæ–‡ä»¶ ä¹‹åå°†æ–‡ä»¶æ‹·è´åˆ° /opt/theos/bin ä¸‹å°±å¯ä»¥äº† å®‰è£…iOSOpenDevgit clone https://github.com/AimobierExample/iOSOpenDevInstallFix cd iOSOpenDevInstallFix sh repair.sh ä¹‹åæ‰“å¼€ iOSOpenDev-1.6-2.pkg æŒ‰ç…§æç¤ºå°±å¯ä»¥å®‰è£…å®Œæˆäº† æ‰“å¼€xcodeå°±å¯ä»¥çœ‹è§è¶Šç‹±çš„é¡¹ç›®äº† é€‰æ‹© Logos TWeak æŒ‰ç…§xmæ–‡ä»¶å†…çš„æç¤ºï¼Œlibsubstrate.dylibæ·»åŠ åˆ°å·¥ç¨‹ä¸­(åœ¨å®‰è£…å¥½çš„/opt/iOSOpenDev/lib ç›®å½•ä¸‹)ï¼Œç„¶åæŠŠxmä¸­çš„å†…å®¹æ¸…ç©ºã€‚mmæ–‡ä»¶çš„å†…å®¹ä¼šæ ¹æ®xmæ–‡ä»¶ä¸­çš„å†…å®¹ç¼–è¯‘åè‡ªåŠ¨ç”Ÿæˆã€‚ %hook SpringBoard - (void)applicationDidFinishLaunching:(id)application{ %orig; UIAlertView * alert = [[UIAlertView alloc]initWithTitle:@&quot;Welcome&quot; message:@&quot;HelloWorld!&quot; delegate:nil cancelButtonTitle:@&quot;Thanks&quot; otherButtonTitles:nil]; [alert show]; } %end ç‚¹å‡»èœå• Product - Build For - Profiling è¿™ä¸ªæ—¶å€™é€šå¸¸ä¼šæŠ¥é”™ï¼Œå› ä¸ºçœŸæœºè°ƒè¯•ä¼šå‡ºç°é—®é¢˜ Failed to create directory /var/root/iOSOpenDevPackages on device ä½ çš„iOSè®¾å¤‡IPåœ°å€ ä½†æ˜¯æ­¤åˆ»å·²ç»åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹å‡ºç°äº† å˜å·²å®Œæˆçš„ debæ–‡ä»¶äº†ï¼Œä½ å¯ä»¥ç›´æ¥æ·»åŠ åˆ°å’±ä»¬çš„æºæœåŠ¡å™¨ä¸­ï¼ŒæŒ‰ç…§ä¹‹å‰çš„æ•™ç¨‹ç”Ÿæˆ packages å®Œæˆå®‰è£…ã€‚ çœŸæœºè°ƒè¯•ç°åœ¨è°ƒè¯•è¶Šç‹±è®¾å¤‡ï¼Œåœ¨å·²ç»è¶Šç‹±çš„æ‰‹æœºä¸Šæ‰“å¼€Cydiaï¼Œæœç´¢ä¸‹åˆ—æ’ä»¶å¦‚æœæœç´¢ä¸åˆ°ï¼Œæ‰“å¼€è½¯ä»¶æº-ç¼–è¾‘ åˆ é™¤BigBoså’ŒModMyiï¼Œå†å›åˆ°é¦–é¡µï¼Œç‚¹å‡»æ›´å¤šè½¯ä»¶æºï¼Œé‡æ–°æ·»åŠ è¿™ä¸¤ä¸ªå³å¯æœç´¢åˆ°ä¸‹åˆ—æ’ä»¶ Core Utilities Core Utilities(/bin) diskdev-cmds file-cmds system-cmds Mobileterminal openSSH sshpass toggle ssh preferencdloader substrate safe mode syslogd to /var/log/syslog å†åœ¨Xcodeä¸­çš„Targetçš„Build Settingsä¸­çš„Code Signingä¸­ï¼Œæ”¹ä¸ºDonâ€™t Code Sign.æœ€åæ‰“å¼€Target-Build Settings æ‰¾åˆ°iOSOpenDevDeviceé€‰é¡¹ï¼Œå¡«å…¥è¶Šç‹±æ‰‹æœºçš„æœ¬åœ°ip ä¹‹åæ‰“å¼€ç»ˆç«¯åˆ›å»ºkey iosod sshkey -h 192.168.23.71ï¼ˆæ¢æˆä½ çš„iOSè®¾å¤‡IPåœ°å€ï¼‰ åˆ›å»ºå®Œæˆ ç‚¹å‡»èœå• Product - Build For - Profiling å°±å¯ä»¥å®‰è£…åˆ°è®¾å¤‡ï¼Œå®‰è£…å®Œæˆä¹‹åï¼Œè®¾å¤‡å›è‡ªå·±é‡å¯ï¼Œä¹‹åå°±ä¼šå¼¹å‡ºäº†ä¸€ä¸ªalertViewã€‚ Theos åˆ›å»º Cydia åº”ç”¨é¦–å…ˆå®‰è£… Theoså®‰è£…æ–¹æ³• é€‰æ‹©theosçš„å®‰è£…ç›®å½•ï¼Œå®˜æ–¹å»ºè®®æ”¾åœ¨é»˜è®¤çš„ /opt/theos.ç„¶åæ‰§è¡Œ export THEOS=/opt/theos ä¸ºäº†éªŒè¯è®¾ç½®æˆåŠŸæ²¡æœ‰ echo $THEOS å¦‚æœæ‰“å° /opt/theos è¯´æ˜æ‘„åˆ¶å®Œæˆ Using git: git clone --recursive git://github.com/DHowett/theos.git /opt/theos ä½¿ç”¨Theosåˆ›å»ºåº”ç”¨å®‰è£…å®Œæˆä¹‹å ä½¿ç”¨ï¼š /opt/theos/bin/nic.pl è°ƒç”¨ä¹‹å msiter:~ jingwenzheng$ /opt/theos/bin/nic.pl NIC 2.0 - New Instance Creator ------------------------------ [1.] iphone/activator_event [2.] iphone/application_modern [3.] iphone/cydget [4.] iphone/flipswitch_switch [5.] iphone/framework [6.] iphone/ios7_notification_center_widget [7.] iphone/library [8.] iphone/notification_center_widget [9.] iphone/preference_bundle_modern [10.] iphone/tool [11.] iphone/tweak [12.] iphone/xpc_service Choose a Template (required): 2 Project Name (required): Demo Package Name [com.yourcompany.demo]: com.demo Author/Maintainer Name [è†æ–‡å¾]: jwz [iphone/application_modern] Class name prefix (two or more characters) [XX]: demo Instantiating iphone/application_modern in demo/... Done. msiter:~ jingwenzheng$ è¿™æ ·å°±åˆ›å»ºå®Œæˆäº† è¿è¡Œåˆ°çœŸæœºé¦–å…ˆè¦ç¡®ä¿éœ‡çº§ä¸Šé¢å®‰è£… openssh ssh root@ipåœ°å€ å¯†ç ã€‚é»˜è®¤ä¸º alpine è¿™æ ·è¿æ¥ä¸Šå°±è¯´æ˜å®‰è£…å®Œæˆï¼Œå¯ä»¥è°ƒç”¨çš„åˆ°ï½ ä¹‹åè®¾ç½®ç¯å¢ƒå˜é‡THEOS_DEVICE_IP ä¸º çœŸæœº IPã€‚ ä¹‹å cd ç›®å½•ã€‚ ä½¿ç”¨å‘½ä»¤å®‰è£…åˆ°çœŸæœºä¸Š make package install ç¬¬ä¸€ä¸ªé—®é¢˜ ldidä½ å¯ä»¥ç›´æ¥ä¸‹è½½åˆ«äººå·²ç»ç¼–è¯‘å®Œæˆçš„æ–‡ä»¶ ldidæ–‡ä»¶ ä¹‹åå°†æ–‡ä»¶æ‹·è´åˆ° /opt/theos/bin ä¸‹å°±å¯ä»¥äº† é»˜è®¤æ˜¯æ²¡æœ‰æƒé™çš„ æ‰€ä»¥å¯èƒ½éœ€è¦ sudo. å¤åˆ¶å®Œæˆä¹‹åèµ‹äºˆæƒé™sudo chmod 777 /opt/theos/bin/ldid ç¬¬äºŒä¸ªé—®é¢˜ dpkgæ²¡æœ‰å®‰è£…æ–‡ä»¶å·¥å…· brew install dpkg dpkg 1.18.14 ç‰ˆæœ¬é—®é¢˜åœ¨ 1.18.14 ç‰ˆæœ¬ï¼Œdpkg lzma ä¸èƒ½ä½¿ç”¨äº†ï¼Œå¿…é¡»ä½¿ç”¨ xz è¿™ä¸ªæ—¶å€™éœ€è¦ä¿®æ”¹ /opt/theos/makefiles/package/deb.mk æ–‡ä»¶ifeq ($(_THEOS_PACKAGE_FORMAT_LOADED),) _THEOS_PACKAGE_FORMAT_LOADED := 1 _THEOS_DEB_PACKAGE_CONTROL_PATH := $(or $(wildcard $(THEOS_PROJECT_DIR)/control),$(wildcard $(THEOS_PROJECT_DIR)/layout/DEBIAN/control)) _THEOS_DEB_CAN_PACKAGE := $(if $(_THEOS_DEB_PACKAGE_CONTROL_PATH),$(_THEOS_TRUE),$(_THEOS_FALSE)) _THEOS_DEB_HAS_DPKG_DEB := $(call __executable,dpkg-deb) ifneq ($(_THEOS_DEB_HAS_DPKG_DEB),$(_THEOS_TRUE)) internal-package-check:: @echo \"$(MAKE) package requires dpkg-deb.\"; exit 1 endif ifeq ($(_THEOS_DEB_CAN_PACKAGE),$(_THEOS_TRUE)) # Control file found (or layout/ found.) THEOS_PACKAGE_NAME := $(shell grep -i \"^Package:\" \"$(_THEOS_DEB_PACKAGE_CONTROL_PATH)\" | cut -d' ' -f2-) THEOS_PACKAGE_ARCH := $(shell grep -i \"^Architecture:\" \"$(_THEOS_DEB_PACKAGE_CONTROL_PATH)\" | cut -d' ' -f2-) THEOS_PACKAGE_BASE_VERSION := $(shell grep -i \"^Version:\" \"$(_THEOS_DEB_PACKAGE_CONTROL_PATH)\" | cut -d' ' -f2-) $(_THEOS_ESCAPED_STAGING_DIR)/DEBIAN: $(ECHO_NOTHING)mkdir -p \"$(THEOS_STAGING_DIR)/DEBIAN\"$(ECHO_END) ifeq ($(_THEOS_HAS_STAGING_LAYOUT),1) # If we have a layout/ directory, copy layout/DEBIAN to the staging directory. $(ECHO_NOTHING)[ -d \"$(THEOS_PROJECT_DIR)/layout/DEBIAN\" ] && rsync -a \"$(THEOS_PROJECT_DIR)/layout/DEBIAN/\" \"$(THEOS_STAGING_DIR)/DEBIAN\" $(_THEOS_RSYNC_EXCLUDE_COMMANDLINE) || true$(ECHO_END) endif # _THEOS_HAS_STAGING_LAYOUT $(_THEOS_ESCAPED_STAGING_DIR)/DEBIAN/control: $(_THEOS_ESCAPED_STAGING_DIR)/DEBIAN $(ECHO_NOTHING)sed -e '/^[Vv]ersion:/d' \"$(_THEOS_DEB_PACKAGE_CONTROL_PATH)\" > \"$@\"$(ECHO_END) $(ECHO_NOTHING)echo \"Version: $(_THEOS_INTERNAL_PACKAGE_VERSION)\" >> \"$@\"$(ECHO_END) $(ECHO_NOTHING)echo \"Installed-Size: $(shell du $(_THEOS_PLATFORM_DU_EXCLUDE) DEBIAN -ks \"$(THEOS_STAGING_DIR)\" | cut -f 1)\" >> \"$@\"$(ECHO_END) before-package:: $(_THEOS_ESCAPED_STAGING_DIR)/DEBIAN/control _THEOS_DEB_PACKAGE_FILENAME = $(THEOS_PACKAGE_DIR)/$(THEOS_PACKAGE_NAME)_$(_THEOS_INTERNAL_PACKAGE_VERSION)_$(THEOS_PACKAGE_ARCH).deb internal-package:: $(ECHO_NOTHING)COPYFILE_DISABLE=1 $(FAKEROOT) -r dpkg-deb -Zgzip -b \"$(THEOS_STAGING_DIR)\" \"$(_THEOS_DEB_PACKAGE_FILENAME)\" $(STDERR_NULL_REDIRECT)$(ECHO_END) # This variable is used in package.mk after-package:: __THEOS_LAST_PACKAGE_FILENAME = $(_THEOS_DEB_PACKAGE_FILENAME) else # _THEOS_DEB_CAN_PACKAGE == 0 internal-package:: @echo \"$(MAKE) package requires you to have a layout/ directory in the project root, containing the basic package structure, or a control file in the project root describing the package.\"; exit 1 endif # _THEOS_DEB_CAN_PACKAGE endif # _THEOS_PACKAGE_FORMAT_LOADED è¿™æ ·æŒ‰ç†å°±å¯ä»¥è¿è¡Œäº†","categories":[{"name":"IOS","slug":"IOS","permalink":"http://www.msiter.com/categories/IOS/"}],"tags":[{"name":"è¶Šç‹±","slug":"è¶Šç‹±","permalink":"http://www.msiter.com/tags/è¶Šç‹±/"},{"name":"cydia","slug":"cydia","permalink":"http://www.msiter.com/tags/cydia/"},{"name":"åˆ¶ä½œæº","slug":"åˆ¶ä½œæº","permalink":"http://www.msiter.com/tags/åˆ¶ä½œæº/"}],"keywords":[{"name":"IOS","slug":"IOS","permalink":"http://www.msiter.com/categories/IOS/"}]},{"title":"WKWebView åˆ¶ä½œè¯¦æƒ…é¡µçš„ä¸€äº›ç»éªŒ","slug":"WKWebView åˆ¶ä½œè¯¦æƒ…é¡µçš„ä¸€äº›ç»éªŒ","date":"2016-09-21T03:25:00.000Z","updated":"2017-11-28T11:07:04.827Z","comments":true,"path":"2016/09/21/WKWebView åˆ¶ä½œè¯¦æƒ…é¡µçš„ä¸€äº›ç»éªŒ/","link":"","permalink":"http://www.msiter.com/2016/09/21/WKWebView åˆ¶ä½œè¯¦æƒ…é¡µçš„ä¸€äº›ç»éªŒ/","excerpt":"Hello Worldå¥½ä¹…å¥½ä¹…æ²¡æœ‰æ›´æ–°è¿‡åšå®¢äº†ï¼Œä»Šå¤©å»é¢è¯•äº†ä¸€å®¶å…¬å¸ã€‚è¢«è¯¢é—®åˆ°å…³äºèµ„è®¯ç±»Appçš„è¯¦æƒ…é¡µé—®é¢˜ï¼Œæƒ³åˆ°äº†å¾ˆå¤šä¹‹å‰åšè¯¦æƒ…é¡µæ—¶å€™é‡è§çš„é—®é¢˜å’Œè§£å†³çš„é—®é¢˜ï¼Œæ‰€ä»¥å¿ƒè¡€æ¥æ½®çš„æƒ³è®°å½•ä¸‹æ¥ã€‚","text":"Hello Worldå¥½ä¹…å¥½ä¹…æ²¡æœ‰æ›´æ–°è¿‡åšå®¢äº†ï¼Œä»Šå¤©å»é¢è¯•äº†ä¸€å®¶å…¬å¸ã€‚è¢«è¯¢é—®åˆ°å…³äºèµ„è®¯ç±»Appçš„è¯¦æƒ…é¡µé—®é¢˜ï¼Œæƒ³åˆ°äº†å¾ˆå¤šä¹‹å‰åšè¯¦æƒ…é¡µæ—¶å€™é‡è§çš„é—®é¢˜å’Œè§£å†³çš„é—®é¢˜ï¼Œæ‰€ä»¥å¿ƒè¡€æ¥æ½®çš„æƒ³è®°å½•ä¸‹æ¥ã€‚ å¦‚ä½•å»å±•ç¤ºä¸€ä¸ªè¯¦æƒ…é¡µå‘¢é‚£ä¹ˆåºŸè¯å°‘è¯´ï¼Œäº®å‰‘å§ï¼ å¦‚ä½•å»æ˜¾ç¤ºä¸€ä¸ªWKWebViewå‘¢å…¶å®æ€ä¹ˆè¯´å‘¢ï¼Œæˆ‘è§‰çš„å…¶å®å§ã€‚æ¯ä¸ªäººéƒ½å¤§åŒå°å¼‚ã€‚æ— éå°±æ˜¯å¦‚ä½•å°†æ•°æ®è½¬æ¢æˆHtmlå¹¶ä¸”å°†å­—ç¬¦ä¸²ä¼ é€’ç»™WebViewã€‚ä¹‹åå±•ç¤ºå‡ºæ¥è€Œå·²ã€‚é‚£ä¹ˆæˆ‘ä»¬å¾ˆå¿«å°±ä¼šé‡åˆ°ç¬¬ä¸€ä¸ªé—®é¢˜ã€‚å¦‚ä½•å°†æ•°æ®è½¬æ¢æˆHtmlæ ¼å¼çš„å­—ç¬¦ä¸²å‘¢ï¼Ÿ æå®šæˆ‘ä»¬çš„æ¨¡æ¿å›æˆ‘ä¸æ¸…æ¥šå…¶ä»–å¼€å‘è€…ä»¬é‡è§çš„æ•°æ®ç»“æ„ï¼Œä½†æ˜¯æˆ‘çš„æ•°æ®ç»“æ„å¦‚ä¸‹/ // // NewContent.swift // Journalism // // Created by Mister on 16/5/30. // Copyright Â© 2016å¹´ aimobier. All rights reserved. // import RealmSwift /// é¢‘é“çš„æ•°æ®æ¨¡å‹ open class Content: Object { /// ç”¨äºè·å–è¯„è®ºçš„ docid dynamic var txt: String? = nil /// æ–°é—»Url dynamic var img: String? = nil /// æ–°é—»æ ‡é¢˜ dynamic var vid: String? = nil } /// é¢‘é“çš„æ•°æ®æ¨¡å‹ open class NewContent: Object { /// æ–°é—»ID dynamic var nid = 1 // æ–°é—»çš„è¯¦æƒ… let content = List&lt;Content>() // Should be declared with `let` // More â€¦â€¦ } è¯¦æƒ…é¡µå¯¹è±¡åŒ…å«ä¸‰ä¸ªå­—æ®µ img,txt,vidã€‚ä¹Ÿå°±æ˜¯å›¾ç‰‡ï¼Œæ–‡å­—ï¼Œè§†é¢‘ä¸‰ç§ç±»å‹ã€‚é‚£è¿™æ ·å°±ç®€å•äº†ã€‚æŠŠä»–ä»¬æ‹¼è£…æˆä¸€ä¸ªHtml è¿˜ä¸ç®€å•~ String += String // ????? è¿™æ ·å­ï¼Ÿ æˆ‘æ˜¯æ‹’ç»çš„â€¦â€¦ ä¹‹åæƒ³èµ·æ¥ä¹‹å‰åšæœåŠ¡çš„æ—¶å€™ jsqï¼Œejsâ€¦ è¿™äº›è§†å›¾æ¨¡æ¿éƒ½æ˜¯å¯ä»¥å®Œæˆç°åœ¨çš„éœ€æ±‚çš„ï¼Œä¸çŸ¥é“IOS æœ‰æ²¡æœ‰å‘¢ï¼Ÿ æ‰€ä»¥è¯´ï¼ åºŸè¯ï¼ å½“ç„¶æœ‰å•Šï¼ MGTemplateEngine è¿™å°±æ˜¯äº†~ ä½†æ˜¯ï¼ï¼ï¼ é—®é¢˜è¿™ä¸ªå¤§ç¥æ²¡æœ‰ä½¿ç”¨é‚£ä¸ªç¬¬ä¸‰æ–¹çš„ç®¡ç†æ’ä»¶æ¥è®©åˆ«äººå¯¼å…¥è‡ªå·±çš„æ¡†æ¶~ éš¾é“æˆ‘åˆè¦å›å½’åˆ° ä¹‹å‰é‚£æ®µ è¢«æ‹–æ‹½å¼•å…¥æ‰€æ”¯é…çš„ææƒ§å—ï¼Ÿ ???? æˆ‘è¿˜æ˜¯æ‹’ç»çš„~~~ é‚£ä¹ˆæ¥ä¸‹æ¥å°±æœ‰ä¸¤ç§æ–¹å¼æ¥å¼•å…¥è¿™ä¸ªæ¡†æ¶äº†~ å½“ç„¶äº† å…¨éƒ½æ˜¯ Cocoapodsçš„â€¦â€¦ ç¬¬ä¸€ç§ä½¿ç”¨ æœ¬åœ°å¼•å…¥çš„æ–¹å¼ï¼š å¦‚æœä½ æƒ³æœ¬åœ°å¼•å…¥çš„è¯ï¼Œé‚£å¾ˆç®€å•çš„ åœ¨ä½ çš„é¡¹ç›®æ ¹ç›®å½•ä¸‹å»ºç«‹ä¸€ä¸ªæ–‡ä»¶å¤¹ å–åå­—å‘¢~ å°±å«åš MGTemplateEngine ï¼Œä¹‹å æŠŠ clone ä¸‹æ¥çš„ MGTemplateEngine é¡¹ç›®æ”¾å…¥ä¸€ä¸ªæ–°å»ºçš„Classes ç›®å½•ä¸‹ã€‚ä¹‹åå†classes åŒçº§ç›®å½•ä¸­æ–°å»ºä¸€ä¸ª æ–‡ä»¶ MGTemplateEngine.podspec é‡Œé¢çš„ä»£ç å‘¢ï¼Œå¤§æ¦‚å†™æˆè¿™æ ·å­ # # Be sure to run `pod lib lint SwaggerClient.podspec' to ensure this is a # valid spec and remove all comments before submitting the spec. # # Any lines starting with a # are optional, but encouraged # # To learn more about a Podspec see http://guides.cocoapods.org/syntax/podspec.html # Pod::Spec.new do |s| s.name = \"MGTemplateEngine\" s.version = \"1.0.0\" s.summary = \"å¥‡ç‚¹èµ„è®¯\" s.description = &lt;&lt;-DESC if youï½ Shabi Boom Sha Ga la ga DESC s.platform = :ios, '7.0' s.requires_arc = true s.framework = 'SystemConfiguration' s.homepage = \"https://github.com/swagger-api/swagger-codegen\" s.license = \"MIT\" s.source = { :git => \"https://github.com/swagger-api/swagger-codegen.git\", :tag => \"#{s.version}\" } s.author = { \"Swagger\" => \"apiteam@swagger.io\" } s.source_files = 'Classes/**/*' s.public_header_files = 'Classes/**/*.h' end æ‰€æœ‰è¯´å¤§æ¦‚çš„ç›®å½•åˆ†å¸ƒå‘¢~ æ˜¯è¿™ä¸ªæ ·å­çš„~ â”€â”€ é¡¹ç›®æ ¹ç›®å½• â”œ MGTemplateEngine â”œâ”€â”€â”€â”€â”€â”€â”œ MGTemplateEngine.podspec â”œâ”€â”€â”€â”€â”€â”€â”œ Classes â”‚ â””â”€â”€â”€â”€ MGTemplateEngine æ‰€æœ‰çš„æ–‡ä»¶ â”” ä½ çš„å…¶ä»–æ–‡ä»¶ ä¹‹åå‘¢ï¼Œåœ¨ä½ é¡¹ç›®ä¸­çš„Podfile å†™ä¸‹è¿™æ ·çš„ä»£ç ~ pod 'MGTemplateEngine', :path => 'MGTemplateEngine/' ## MGTemplateEngineç»„ä»¶ è¿è¡Œå®Œæˆ pod install~ Woooooo~ æå®š~ ç¬¬äºŒç§å‘¢ pod 'JMGTemplateEngine' è¿™ä¸ªä¸œè¥¿æ˜¯æˆ‘è‡ªå·±åšçš„ä¸ºäº†æ–¹ä¾¿â€¦â€¦â€¦â€¦â€¦â€¦ è¿è¡Œå®Œæˆ pod install~ Woooooo~ æå®š~ æ˜¾ç¤ºå‡ºæ¥æˆ‘ä»¬çš„è¯¦æƒ…å§~æ²¡ä»€ä¹ˆå¥½è¯´çš„ç›´æ¥ä¸Šä»£ç å§ import MGTemplateEngine extension MGTemplateEngine{ static var shareTemplateEngine:MGTemplateEngine!{ let templateEngine = MGTemplateEngine() templateEngine.matcher = ICUTemplateMatcher(templateEngine: templateEngine) return templateEngine } } func getHtmlResourcesString() -> String{ let variables = [\"title\":self.title,\"source\":self.pname,\"ptime\":self.ptime,\"theme\":\"normal\",\"body\":body] let result = MGTemplateEngine.shareTemplateEngine.processTemplateInFile(atPath: templatePath, withVariables: variables) return result! } è¿™æ ·å­æˆ‘ä»¬å°±å¾—åˆ°äº†Html çš„String å¯¹è±¡ï¼Œåœ¨è¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬åªè¦ ä½¿ç”¨WkWebViewçš„ loadHTMLString æ–¹æ³•å°±OKäº†å•Šï½ æ˜¯çš„æˆ‘ä»¬å¾ˆå¿«çš„å°±å‘ç°äº†ï½ æˆ‘ä»¬çœŸçš„å¯ä»¥å±•ç¤ºäº†ï½ ä½†æ˜¯ï¼Œè¡Œé«˜æ€ä¹ˆåŠå‘¢ï¼Ÿ é‚£æˆ‘ä»¬å¾ˆå¿«å°±é‡åˆ°äº†æˆ‘ä»¬çš„å‡ ä¸ªå é‡åˆ°çš„åå·è™½ç„¶å±•ç¤ºå®Œæˆäº†ï¼Œä½†æ˜¯æ¥ä¸‹æ¥æˆ‘ä»¬å°±é‡åˆ°äº†å‡ ä¸ªé—®é¢˜ã€‚ æ¥ä¸‹æ¥é’ˆå¯¹è¿™å‡ ä¸ªé—®é¢˜ï¼Œæˆ‘æ¥ç»™ä½ è¯´è¯´ï¼Œæˆ‘æ˜¯æ€ä¹ˆè§£å†³çš„ WebViewå’ŒJSçš„äº¤äº’åœ¨çœ‹æ¥ä¸‹æ¥çš„ä¹‹å‰å’±ä»¬éœ€è¦çŸ¥é“ä¸€ä¸ªçŸ¥è¯†ç‚¹å°±æ˜¯WKWebVIewå’Œjsçš„äº¤äº’ let configuration = WKWebViewConfiguration() configuration.userContentController.add(self, name: \"JSBridge\") self.webView = WKWebView(frame: CGRect(origin: CGPoint.zero, size: CGSize(width: 600, height: 1000)), configuration: configuration) è¿™ä¸ªJSBridgeå°±æ˜¯æˆ‘ä»¬è‡ªå®šä¹‰çš„æ¡¥è¿å¯¹è±¡ï¼Œä½¿ç”¨è¿™ä¸ªæ¡¥è¿å¯¹è±¡å°±å¯ä»¥å®ç°äº¤äº’äº† WKWebView -&gt; javaScriptçš„æ“ä½œ self.webView.evaluateJavaScript(\"js è¯­å¥\") { (data, _) in // data å°±æ˜¯åå›çš„æ•°æ® } javaScript â€“&gt; WKWebViewçš„æ“ä½œ var message = { \"type\": 0 } window.webkit.messageHandlers.JSBridge.postMessage(message); ä¹‹åå†å’±ä»¬çš„é¡¹ç›®ä¸­å®ç°WKScriptMessageHandlerä»£ç†æ–¹æ³• public func userContentController(_ userContentController: WKUserContentController, didReceive message: WKScriptMessage) { guard let bodyData = message.body as? Dictionary&lt;String,AnyObject> else { return } /// bodyDaya å°±æ˜¯å’±ä»¬çš„ä¼ å…¥çš„å¯¹è±¡ è¿™é‡Œæ ¹æ®è‡ªå·±ä¼ å…¥çš„ç±»å‹æœºå‹ options åˆ¤æ–­å³å¯ } å…¶ä¸­JSBridge å¯¹è±¡å°±æ˜¯å’±ä»¬çš„è‡ªå®šä¹‰æ¡¥è¿å¯¹è±¡ è¿™æ ·å°±å¯ä»¥å®ç°äº¤äº’äº† é«˜åº¦çš„è®¡ç®—é—®é¢˜ç›¸ä¿¡å¾ˆæœ‹å‹ä¹Ÿéƒ½æŸ¥é˜…äº†å¾ˆå¤šä¸œè¥¿ï¼ŒçŸ¥é“äº† è°ƒç”¨ JSçš„ é«˜åº¦è®¡ç®—æ–¹æ³• . document.getElementById(&#39;section&#39;).offsetHeight æˆ‘çš„ä¸»è¦å†…å®¹éƒ½æ˜¯æ˜¾ç¤ºåœ¨ä¸€ä¸ª sectionçš„Divé‡Œçš„ï¼Œä½ ä»¬å„ä½ä¹Ÿè¯·è¿›è¡Œè‡ªå·±çš„è®¡ç®—ã€‚ é‚£å¥½å§ï¼Œæˆ‘ä»¬å°±æ¥åšå§~~~ é¦–å…ˆæˆ‘ä»¬å…ˆç›‘å¬ WebView åŠ è½½å®Œæˆé¡µé¢ä¹‹åçš„äº‹ä»¶ï¼Œé‚£ä¹ˆæˆ‘ä»¬å…ˆå®ç°å®ƒçš„Delegateå§ã€‚ /// åŠ è½½å®Œæˆ public func webView(_ webView: WKWebView, didFinish navigation: WKNavigation!) { // æ‰§è¡Œæ–¹æ³• self.webView.evaluateJavaScript(\"document.getElementById('section').offsetHeight\") { (data, _) in if let height = data as? CGFloat{ if self.webView.frame.size.height != height+35 { self.webView.layoutIfNeeded() self.webView.frame.size.height = height+35 self.tableView.tableHeaderView = self.webView } } } } è¿™æ ·æˆ‘ä»¬ä¼šå‘è§‰ï¼Œå¥½äº†å•Š~ é‚£ä¹ˆæ¥ä¸‹æ¥å’±ä»¬å°±é‡åˆ°äº†ï¼Œå’±ä»¬çš„ç¬¬äºŒä¸ªå å›¾ç‰‡LazyLoadçš„é—®é¢˜å¯èƒ½åœ¨è¿™é‡Œå¾ˆå¤šç”¨æˆ·å°±ä¼šå¯Ÿè§‰åˆ°è¿™ä¸ªï¼Œå½“å’±ä»¬çš„æ–°é—»è¯¦æƒ…å¾ˆå¤šå›¾ç‰‡çš„æ—¶å€™ï¼Œå’±ä»¬å°±ä¼šå‡ºç°åŠ è½½æ—¶é—´å·¨é•¿çš„é—®é¢˜ã€‚ä¸»è¦æ˜¯å› ä¸ºHtmlç•Œé¢å‘¢ï¼Œä»–ä¸æ˜¯å’±ä»¬çš„tableView,iosçš„åŠ è½½æœºåˆ¶ï¼Œæ˜¯å¿«è¦æ˜¾ç¤ºäº†å¼€å§‹å‡†å¤‡æ¸²æŸ“Cellï¼Œè€ŒHtmlæ˜¯å…¨éƒ¨æ¸²æŸ“å®Œæˆï¼Œä¹‹åä½ çˆ±æ€ä¹ˆæ»‘æ€ä¹ˆæ»‘ã€‚æ‰€ä»¥å½“å›¾ç‰‡è¿‡å¤§çš„æ—¶å€™ã€‚å°±ä¼šå‡ºç°åŠ è½½æ—¶é—´å¾ˆé•¿çš„é—®é¢˜äº†é‚£ä¹ˆè‡ªç„¶è€Œç„¶çš„æƒ³åˆ°äº†ä½¿ç”¨å’±ä»¬çš„lazyloadã€‚ä¹Ÿå°±æ˜¯ä¿—ç§°çš„ æ‡’åŠ è½½ã€‚ ç°åœ¨ä¸–é¢ä¸Šçš„æ‡’åŠ è½½ï¼Œéƒ½æ˜¯ä¸€ä¸ªæ ·å­çš„ï¼Œç»™ä½ æä¾›ä¸€ä¸ªè‡ªå®šä¹‰çš„é¢å±æ€§ã€‚æ¯”å¦‚lazysrcï¼Œè®¾ç½®æˆå’±ä»¬éœ€è¦åŠ è½½çš„ç½‘ç»œå›¾ç‰‡ï¼Œè€Œsrcè®¾ç½®æˆå’±ä»¬çš„æ²¡æœ‰åŠ è½½å‡ºæ¥çš„å ä½å›¾ç‰‡ã€‚ä¹‹åæ£€æµ‹é¡µé¢çš„æ»‘åŠ¨æƒ…å†µï¼Œå½“æ£€æµ‹åˆ°å¿«æˆ–è€…éœ€è¦æ˜¾ç¤º&lt;img&gt;æ ‡ç­¾çš„æ—¶å€™ï¼Œè¿›è¡Œå§ lazysrcèµ‹å€¼srcçš„è¿™ä¹ˆä¸€ä¸ªæ“ä½œã€‚ &lt;script src=\"jquery-1.11.0.min.js\">&lt;/script> &lt;script src=\"jquery.lazyload.js?v=1.9.1\">&lt;/script> åœ¨ç½‘ä¸Šéšä¾¿æ‰¾äº†ä¸€ä¸ªæµ‹è¯•å‘è§‰æ²¡ç”¨è¿˜æ˜¯æ…¢å•Šï¼Œä¹‹åæŠ“åŒ…ï¼Œå‘ç°å›¾ç‰‡è¿˜æ˜¯ä¸€èµ·åŠ è½½çš„ã€‚å³ä½¿æ²¡æœ‰æ»‘åŠ¨â€¦â€¦ è¿™æ˜¯æ€ä¹ˆå›äº‹å„¿å‘¢ï¼Ÿ å…¶å®ä¸éš¾ç†è§£ï¼Œå’±ä»¬çš„æ‡’åŠ è½½è®¡ç®—çš„æ˜¯é€šè¿‡åç§»ä½ç½®æ¥è®¡ç®—çš„ï¼Œä»€ä¹ˆäº‹åç§»ä½ç½®å‘¢ã€‚ã€‚å…¶å®è¿™ä¸ªåœ°æ–¹ç”¨å›¾çš„æ–¹å¼æ›´å¥½ï¼Œä½†æ˜¯æˆ‘ä¸çŸ¥é“ç”¨ä»€ä¹ˆç”»â€¦â€¦ é‚£ä¹ˆå’±ä»¬ç»™webViewçš„è®¾ç½®çš„å°±æ˜¯å’±ä»¬çš„æ‰€æœ‰çš„htmlçš„é«˜åº¦ï¼Œä»–æ ¹æœ¬å°±ä¸éœ€è¦åç§»å°±å¯ä»¥æ˜¾ç¤ºæ‰€æœ‰çš„å†…å®¹äº†ï¼Œè¿™ä¹Ÿå°±æ˜¯æˆ‘ä»¬çš„lazyload.js æ²¡æœ‰æ•ˆæœçš„åŸå› äº†ã€‚é‚£ä¹ˆæˆ‘ä»¬æ€ä¹ˆè§£å†³è¿™ä¸ªé—®é¢˜å‘¢ï¼Ÿ æˆ‘æ˜¯è¿™æ ·åšçš„ï¼Œå› ä¸ºæˆ‘çš„WebViewæ˜¯tableViewçš„è¡¨è§†å›¾ï¼Œé‚£ä¹ˆæˆ‘å°±å®ç°äº† scrollViewçš„ä»£ç†æ–¹æ³• /** ä¸»è¦æ˜¯ä¸ºäº†é’ˆå¯¹äºå…šå›¾ç‰‡å»¶æ—¶åŠ è½½ä¹‹åçš„webvViewé«˜åº¦é—®é¢˜ - parameter scrollView: æ»‘åŠ¨è§†å›¾ */ public func scrollViewDidScroll(_ scrollView: UIScrollView) { let height = UIScreen.main.bounds.height+scrollView.contentOffset.y self.webView.evaluateJavaScript(\"scrollMethod(\\(height))\", completionHandler: nil) self.adaptionWebViewHeightMethod() } é€šè¿‡è¿™ä¸ªæ–¹æ³•ä¸æ–­æ£€æµ‹é¡µé¢çš„åç§»é‡ function scrollMethod(offesty) { $(\"img\").each(function(index, img) { // &lt;!-- æ›´å¤šçš„æ“ä½œ> }) } åœ¨è¿™ä¸ªæ“ä½œé‡Œè¿›è¡Œå›¾ç‰‡çš„å¾ªç¯è·Ÿæˆ‘ä»¬ä¼ å…¥çš„ä¾¿å®œé‡å¯¹æ¯”ï¼Œå¦‚æœå¿«è¦å±•ç¤ºäº†ï¼Œé‚£ä¹ˆå’±ä»¬å°±æŠŠå’±ä»¬è®¾ç½®çš„ å±æ€§æ›¿æ¢æˆå›¾ç‰‡çš„src ï¼Œè¿™ä¸ªå­å°±å®ç°äº†å›¾ç‰‡çš„æ‡’åŠ è½½äº† å…³äºå›¾ç‰‡ç‚¹å‡»é—®é¢˜è¿™ä¸ªç‚¹å‡»é—®é¢˜ï¼Œç›¸ä¿¡å¤§å®¶çœ‹åˆ°è¿™é‡Œå°±åº”è¯¥å·²ç»çŸ¥é“è¯¥æ€ä¹ˆåšäº†ã€‚å¯¹äº†â€¦â€¦â€¦â€¦ å½“ç„¶æ˜¯ä½¿ç”¨jsæ–¹æ³•æ¡¥è¿äº† $(\"#body_section img\").click(function() { var index = $(\"img\").index(this); window.webkit.messageHandlers.JSBridge.postMessage({ \"type\": 1, \"index\": index }); }) public func userContentController(_ userContentController: WKUserContentController, didReceive message: WKScriptMessage) { guard let bodyData = message.body as? Dictionary&lt;String,AnyObject> else { return } guard let type = bodyData[\"type\"] as? Int else{return} if type == 1 { /// å›¾ç‰‡å±•ç¤º } } ä½†æ˜¯è¿™å°±åˆæœ‰äº†ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯å’±ä»¬çš„webviewå’Œå’±ä»¬çš„å›¾ç‰‡å±•ç¤ºVCçš„å›¾ç‰‡åŠ è½½çš„æ–¹å¼æ˜¯ä¸ä¸€æ ·çš„ã€‚æˆ‘è¿™é‡Œå…ˆè®²è®²æˆ‘çš„ï¼Œä¹‹å‰æ‰¾åˆ°ä½¿ç”¨ webviewçš„ç¼“å­˜ï¼Ÿè¿˜æ˜¯ä»€ä¹ˆçš„ï¼Œè¿˜æ²¡æœ‰ç ”ç©¶â€¦â€¦ å…³äºå›¾ç‰‡é‡å¤åŠ è½½çš„é—®é¢˜ã€‚å…¶å®è¿™é‡Œçš„é—®é¢˜ï¼Œå°±éš¾ç‚¹äº†ï¼Œæˆ‘æ˜¯æƒ³äº†å¾ˆä¹…ï¼Œè¯¥æ€ä¹ˆè§£å†³ï¼Œå› ä¸ºè¿™æ ·è¿˜æ¶‰åŠåˆ°ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯ç»™å›¾ç‰‡æ·»åŠ è¿›åº¦æ¡çš„é—®é¢˜ã€‚ å…ˆè¯´è¯´è§£å†³åŠæ³•å§ï¼Œå¿ƒè·¯å†ç¨‹å°±ä¸è¯´äº†ã€‚é¦–å…ˆå’±ä»¬çš„ä¸æ˜¯å¯ä»¥æ§åˆ¶å›¾ç‰‡çš„ä½•æ—¶åŠ è½½äº†å—ï¼Ÿé‚£ä¹ˆå’±ä»¬å¯ä¸å¯ä»¥æ›´å‰å®³ä¸€ç‚¹å‘¢ï¼Ÿè®©æˆ‘ä»¬çš„å›¾ç‰‡è¯¥è¦åŠ è½½çš„æ—¶å€™æŠŠè¯·æ±‚é“¾æ¥ä¼ ç»™æˆ‘ä»¬ï¼Œæˆ‘ä»¬è¿›è¡Œæˆ‘ä»¬çš„ç¼“å­˜ç­–ç•¥ã€‚SD PIN éšä¾¿äº†å°±ã€‚ ç­”æ¡ˆæ˜¯è‚¯å®šçš„ã€‚ $(\"img\").each(function(index, img) { var datasrc = $(this).attr(\"data-src\") if ($(this).offset().top &lt; offesty + 200 &amp;&amp; ajaxUrl.indexOf(index) == -1) { ajaxUrl.push(index) window.webkit.messageHandlers.JSBridge.postMessage({ \"type\": 3, \"index\": index, \"url\": datasrc }); } }) å…¶ä¸­ ajaxurlå­˜å‚¨äº†å·²ç»æ·»åŠ çš„ index å¦‚æœï¼Œæ²¡æœ‰è¿™ä¸ªä¸œè¥¿çš„è¯ï¼Œæˆ‘ä»¬åªè¦ä¸€æ»‘åŠ¨ï¼Œé‚£å°±è¹­è¹­è¹­çš„ä¼ é€’ç»™æˆ‘ä»¬urlï¼Œæˆ‘ä»¬å°±æœ‰çš„åŠ è½½äº†â€¦â€¦ è¿™å¯ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ã€‚ é‚£ä¹ˆåœ¨æˆ‘ä»¬æ¥æ”¶åˆ°URLçš„åŠ è½½çš„è¯·æ±‚ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¼€å§‹åŠ è½½å§~~ fileprivate func HandlePinDownLoadResult(_ finish:@escaping (String) -> Void,result:PINRemoteImageManagerResult){ /// å«æœ‰é™æ€å›¾ç‰‡ if let img = result.image ,let base64 = UIImageJPEGRepresentation(img, 0.9)?.base64EncodedString(options: NSData.Base64EncodingOptions.init(rawValue: 0)){ DispatchQueue.global(qos: .background).async { let string = \"data:image/jpeg;base64,\\(base64)\".replaceRegex(\"&lt;\", with: \"\").replaceRegex(\">\", with: \"\") DispatchQueue.main.async(execute: { finish(string) }) } } /// å«æœ‰åŠ¨æ€å›¾ç‰‡ if let img = result.animatedImage { DispatchQueue.global(qos: DispatchQoS.QoSClass.background).async { let base64 = img.data.base64EncodedString(options: NSData.Base64EncodingOptions.init(rawValue: 0)) let string = \"data:image/gif;base64,\\(base64)\".replaceRegex(\"&lt;\", with: \"\").replaceRegex(\">\", with: \"\") DispatchQueue.main.async(execute: { finish(string) }) } } } è¿™æ ·æˆ‘ä»¬å°±å®ç°äº†å›¾ç‰‡çš„æœ¬åœ°ç¼“å­˜ç­–ç•¥äº†~ä½†æ˜¯é—®é¢˜åˆæ¥äº†â€¦â€¦ é¦–å…ˆå°±æ˜¯é‡åˆ°å¤§çš„å›¾ç‰‡å°¤å…¶æ˜¯gifé‚£ä¸ªbase64è§£æçœŸæ˜¯æ…¢å•Šâ€¦â€¦ è€Œä¸”æ¯æ¬¡é‡æ–°æ‰“å¼€ webview å°±ç®—æ˜¯å·²ç»ä¸‹è½½å¥½äº†ï¼Œå…‰æ˜¯base64è§£æä¹Ÿè¦å°ä¸€ä¼šå„¿äº†â€¦â€¦ base64çš„é—®é¢˜é‚£è¿˜çœŸæ²¡å¥½çš„åŠæ³•ï¼Œï¼Œç¼“å­˜å§â€¦â€¦â€¦â€¦â€¦â€¦ fileprivate func DownloadImageByUrl(_ progress:@escaping (Int) -> Void,finish:@escaping (String) -> Void){ /// å…ˆè¯»ç¼“å­˜ æ²¡æœ‰å’±ä»¬å†è¿›è¡Œåç»­å·¥ä½œ if let str = PINCache.shared().object(forKey: \"hanle\\(self)\") as? String { return finish(str) } guard let url = URL(string: self) else { return } PINRemoteImageManager.shared().downloadImage(with: url, options: PINRemoteImageManagerDownloadOptions(), { (result) in self.HandlePinDownLoadResult(finish,result:result) } } /** å¤„ç†PINRemoteImageä¸‹è½½å®Œæˆçš„ç»“æœå“¦ - parameter finish: å¤„ç†å®ŒæˆåŒ–åçš„å›è°ƒ - parameter result: Result to PINRemoteImageManagerResult */ fileprivate func HandlePinDownLoadResult(_ finish:@escaping (String) -> Void,result:PINRemoteImageManagerResult){ /// å«æœ‰é™æ€å›¾ç‰‡ if let img = result.image ,let base64 = UIImageJPEGRepresentation(img, 0.9)?.base64EncodedString(options: NSData.Base64EncodingOptions.init(rawValue: 0)){ DispatchQueue.global(qos: .background).async { let string = \"data:image/jpeg;base64,\\(base64)\".replaceRegex(\"&lt;\", with: \"\").replaceRegex(\">\", with: \"\") DispatchQueue.main.async(execute: { finish(string) PINCache.shared().setObject(string as NSCoding, forKey: \"hanle\\(self)\") /// ç¼“å­˜ }) } } /// å«æœ‰åŠ¨æ€å›¾ç‰‡ if let img = result.animatedImage { DispatchQueue.global(qos: DispatchQoS.QoSClass.background).async { let base64 = img.data.base64EncodedString(options: NSData.Base64EncodingOptions.init(rawValue: 0)) let string = \"data:image/gif;base64,\\(base64)\".replaceRegex(\"&lt;\", with: \"\").replaceRegex(\">\", with: \"\") DispatchQueue.main.async(execute: { finish(string) PINCache.shared().setObject(string as NSCoding, forKey: \"hanle\\(self)\") /// ç¼“å­˜ }) } } } å›¾ç‰‡åŠ è½½è¿›åº¦æ¡è¿™ä¸ªéœ€è¦htmlé…åˆï¼Œé¦–å…ˆå’±ä»¬æ¯ä¸ªå›¾ç‰‡ä¹Ÿå°±æ˜¯&lt;img&gt;æ ‡ç­¾ä¸Šéƒ½ç”Ÿæˆä¸€ä¸ªè¿›åº¦æ¡ã€‚æ— è®ºä»€ä¹ˆæ ·å­çš„éƒ½è¡Œã€‚åæ­£ä½ å¾—ä¿è¯æˆ‘æŠŠè¿›åº¦ä¼ é€’å›å»äº†ï¼Œä½ æ‰¾çš„åˆ°ä½ çš„ç©ºé—´ï¼Œé‚£ä¹ˆå”¯ä¸€æ ‡è¯†æ˜¯ã€‚indexè¿˜æ˜¯å…¶ä»–çš„éšä½ äº†ã€‚ fileprivate func DownloadImageByUrl(_ progress:@escaping (Int) -> Void,finish:@escaping (String) -> Void){ if let str = PINCache.shared().object(forKey: \"hanle\\(self)\") as? String { return finish(str) } guard let url = URL(string: self) else { return } PINRemoteImageManager.shared().downloadImage(with: url, options: PINRemoteImageManagerDownloadOptions(), progressDownload: { (min, max) in if url.absoluteString.hasSuffix(\".gif\") { let process = Int(CGFloat(min)/CGFloat(max)*100) progress((process-5 &lt; 0 ? 0 : process-5)) } }) { (result) in self.HandlePinDownLoadResult(finish,result:result) } } è¿™æ ·å’±ä»¬å°±è·å–åˆ°äº†è¿›åº¦äº†ã€‚ /** æ ¹æ®æä¾›çš„ URL å’Œ éœ€è¦åŠ è½½å®Œæˆçš„ Index - parameter url: å›¾ç‰‡URL - parameter index: å›¾ç‰‡æ‰€åœ¨çš„Index */ fileprivate func HandleUrlAndIndex(_ url:String,index:Int){ url.DownloadImageByUrl({ (pro) in DispatchQueue.main.async(execute: { let jsStr = \"$(\\\"div .customProgressBar\\\").eq(\\(index)).css(\\\"width\\\",\\\"\\(pro)%\\\")\" self.webView.evaluateJavaScript(jsStr, completionHandler: nil) }) }, finish: { (base64) in let jsStr = \"$(\\\"img\\\").eq(\\(index)).attr(\\\"src\\\",\\\"\\(base64)\\\")\" self.webView.evaluateJavaScript(jsStr, completionHandler: nil) if url.hasSuffix(\".gif\") { let display = \"$(\\\"div .progress\\\").eq(\\(index)).css(\\\"visibility\\\",\\\"hidden\\\")\" self.webView.evaluateJavaScript(display, completionHandler: nil) } }) } æˆ‘çš„è¿›åº¦æ¡classéƒ½å«åšcustomProgressBarï¼Œä¹‹åæˆ‘æ ¹æ® index è¿›è¡Œçš„å”¯ä¸€æ€§æ ‡è¯†ã€‚ä¹‹åä¼ å…¥è¿‡å»è¿›åº¦æ¡ã€‚è¿›è¡Œè¿›åº¦æ¡çš„æ˜¾ç¤ºã€‚ å¯¹äº†æé†’ä¸€å¥ è¿›åº¦æ¡ç‰¹åˆ«å å†…å­˜ã€‚å’±ä»¬è¿˜æ˜¯åªç»™ gif åšåšå°±ç®—äº†ï¼Œå…¶ä»–çš„æ²¡å¿…è¦å•Šâ€¦â€¦â€¦â€¦ è°¢è°¢","categories":[{"name":"IOS","slug":"IOS","permalink":"http://www.msiter.com/categories/IOS/"}],"tags":[{"name":"swift","slug":"swift","permalink":"http://www.msiter.com/tags/swift/"},{"name":"WKWebView","slug":"WKWebView","permalink":"http://www.msiter.com/tags/WKWebView/"}],"keywords":[{"name":"IOS","slug":"IOS","permalink":"http://www.msiter.com/categories/IOS/"}]},{"title":"RxSwift å­¦ä¹  æœªå®Œå¾…ç»­","slug":"RxSwift å­¦ä¹ ","date":"2016-07-06T21:16:43.000Z","updated":"2017-11-28T11:07:04.827Z","comments":true,"path":"2016/07/06/RxSwift å­¦ä¹ /","link":"","permalink":"http://www.msiter.com/2016/07/06/RxSwift å­¦ä¹ /","excerpt":"ç®€ä»‹ä¸ºä»€ä¹ˆä½¿ç”¨ RxSwiftå…¶å®è¿™ä¸ªé—®é¢˜å°±æ˜¯åœ¨é—®ï¼ŒRxSwiftå®ƒå¯ä»¥åšä»€ä¹ˆå‘¢ï¼Ÿåœ¨ä»–ä»¬ç¼–å†™ç¨‹åºçš„æ—¶å€™ï¼Œæ€»æ˜¯ä¼šç‰µæ¶‰åˆ°éœ€è¦æ£€æµ‹æŸäº›å€¼çš„å˜åŒ–ã€‚æ¯”å¦‚ã€‚textFiled Textå˜åŒ–ï¼Ÿæ•°æ®è¯·æ±‚å®Œæˆå¤±è´¥çš„å˜åŒ–ï¼Ÿé”®ç›˜å¼¹èµ·éšè—çš„å˜åŒ–ï¼Œè€Œæˆ‘ä»¬éœ€è¦åšå¾ˆå¤šä¸ä¸€æ ·çš„æ“ä½œï¼Œå»æ£€æµ‹è¿™äº›ä¸œè¥¿çš„å˜åŒ–æƒ…å†µï¼Œå¯èƒ½ä¼šæ˜¯delegateï¼ŒNotifinotionï¼ŒKVOç­‰ç­‰ã€‚ äºæ˜¯ä¹å°±æœ‰äººæƒ³åˆ°äº†ï¼Œä¸ºä»€ä¹ˆä¸è®¾è®¡ä¸€ç§å¤„ç†æœºåˆ¶æ¥ç»Ÿä¸€å¤„ç†è¿™äº›ä¸œè¥¿å‘¢ï¼Ÿæ‰€ä»¥ reactivex è¿™ç§æœºåˆ¶å‡ºç°äº†ï¼Œè€Œè¿™é‡Œçš„ RxSwift å°±æ˜¯è¿™ä¹ˆä¸€ä¸ªæœºåˆ¶ä¸‹çš„ä¸€ä¸ªæ‰©å±•ã€‚æ‰€ä»¥RxSwift ä¸ºä»€ä¹ˆç”¨å®ƒï¼Ÿä½ å¯ä»¥ç†è§£äº†å—ï¼Ÿ","text":"ç®€ä»‹ä¸ºä»€ä¹ˆä½¿ç”¨ RxSwiftå…¶å®è¿™ä¸ªé—®é¢˜å°±æ˜¯åœ¨é—®ï¼ŒRxSwiftå®ƒå¯ä»¥åšä»€ä¹ˆå‘¢ï¼Ÿåœ¨ä»–ä»¬ç¼–å†™ç¨‹åºçš„æ—¶å€™ï¼Œæ€»æ˜¯ä¼šç‰µæ¶‰åˆ°éœ€è¦æ£€æµ‹æŸäº›å€¼çš„å˜åŒ–ã€‚æ¯”å¦‚ã€‚textFiled Textå˜åŒ–ï¼Ÿæ•°æ®è¯·æ±‚å®Œæˆå¤±è´¥çš„å˜åŒ–ï¼Ÿé”®ç›˜å¼¹èµ·éšè—çš„å˜åŒ–ï¼Œè€Œæˆ‘ä»¬éœ€è¦åšå¾ˆå¤šä¸ä¸€æ ·çš„æ“ä½œï¼Œå»æ£€æµ‹è¿™äº›ä¸œè¥¿çš„å˜åŒ–æƒ…å†µï¼Œå¯èƒ½ä¼šæ˜¯delegateï¼ŒNotifinotionï¼ŒKVOç­‰ç­‰ã€‚ äºæ˜¯ä¹å°±æœ‰äººæƒ³åˆ°äº†ï¼Œä¸ºä»€ä¹ˆä¸è®¾è®¡ä¸€ç§å¤„ç†æœºåˆ¶æ¥ç»Ÿä¸€å¤„ç†è¿™äº›ä¸œè¥¿å‘¢ï¼Ÿæ‰€ä»¥ reactivex è¿™ç§æœºåˆ¶å‡ºç°äº†ï¼Œè€Œè¿™é‡Œçš„ RxSwift å°±æ˜¯è¿™ä¹ˆä¸€ä¸ªæœºåˆ¶ä¸‹çš„ä¸€ä¸ªæ‰©å±•ã€‚æ‰€ä»¥RxSwift ä¸ºä»€ä¹ˆç”¨å®ƒï¼Ÿä½ å¯ä»¥ç†è§£äº†å—ï¼Ÿ RxSwift æ¦‚å¿µæ¯ä¸€ä¸ªObservable çš„å®ä¾‹ç›¸å½“äºä¸€ä¸ªSwiftä¸­çš„Sequenceã€‚ ä½†æ˜¯åŒºåˆ«åœ¨äºï¼ŒSwiftä¸­çš„SequenceTypeæ˜¯åŒæ­¥çš„å¾ªç¯ï¼Œè€Œ Observable æ˜¯å¼‚æ­¥çš„ã€‚ ä¸€ä¸ª Observable (ObservableType) ç›¸å½“äºä¸€ä¸ªåºåˆ—Sequence(SequenceType) . ObservableType.subscribe(_:) æ–¹æ³•å…¶å®å°±ç›¸å½“äº SequenceType.generate() Observable å¯¹è±¡ä¼šåœ¨æœ‰ä»»ä½• Event æ—¶å€™ï¼Œå°†æŠŠ observer (ObserverType) ä½œä¸ºä¸€ä¸ªå‚æ•°é€šè¿‡ ObservableType.subscribe(_:) è‡ªåŠ¨å‘å‡ºã€‚å¹¶ä¸éœ€è¦ observer (ObserverType) è°ƒç”¨ Next()æ–¹æ³• å¦‚æœä¸€ä¸ª Observable å‘é€äº†ä¸€ä¸ª (Event.Next(Element)) ä¸‹ä¸€æ­¥æŒ‡ä»¤çš„æ—¶å€™ï¼Œå®ƒå°†ä¼šç»§ç»­å‘é€åç»­æ›´å¤šçš„ Event ï¼Œç„¶è€Œå¦‚æœå®ƒå‘å‡ºçš„æ˜¯ä¸€ä¸ª (Event.Error(ErrorType)) é”™è¯¯åŠ¨ä½œï¼Œæˆ–è€…æ˜¯ä¸€ä¸ª (Event.Completed) æ­£å¸¸ç»“æŸå®ŒæˆåŠ¨ä½œçš„è¯ã€‚å®ƒå°†é€šçŸ¥ä¸åœ¨å‘å‡ºä»»ä½•åŠ¨ä½œã€‚ åºåˆ—çš„è¯­æ³•å¯ä»¥å¾ˆæ˜æ˜¾çš„è¡¨è¾¾è¿™ä¸€ç‚¹: Next* (Error | Completed)? å›¾è¡¨å¯ä»¥ç›´è§‚çš„è§£é‡Šè¿™ä¸€åˆ‡ --1--2--3--4--5--6--|----> // \"|\" = æ­£å¸¸ç»ˆæ­¢ --a--b--c--d--e--f--X----> // \"X\" = é”™è¯¯ç»ˆæ­¢ --tap--tap----------tap--> // \"|\" = ç»§ç»­è¿›è¡Œ, å¦‚åŒä¸€ä¸ªæŒ‰é’®ç‚¹å‡»äº‹ä»¶çš„ä¸€ä¸ªåºåˆ— è¿™äº›å›¾è¡¨è¢«ç§°ä¸ºmarble diagramsã€‚ä½ å¯ä»¥å­¦ä¹ æ›´å¤šå…³äºä»–ä»¬åœ¨ rxmarbles.comã€‚ Observables å’Œ observers (åˆå subscribers)Observables è§‚æµ‹æ•°æ®å°†ä¸ä¼šæ‰§è¡Œé™¤éæœ‰ç”¨æˆ·ç”¨æˆ·è®¢é˜…äº†å®ƒã€‚åœ¨ä¸‹é¢çš„ç¤ºä¾‹ä¸­ï¼Œè§‚å¯Ÿåˆ°çš„å…³é—­å°†æ°¸è¿œä¸ä¼šè¢«æ‰§è¡Œï¼Œå› ä¸ºæ²¡æœ‰è®¢é˜…observersï¼š example(\"Observable with no subscribers\") { _ = Observable&lt;String>.create { observerOfString -> Disposable in print(\"This will never be printed\") observerOfString.on(.Next(\"ğŸ˜¬\")) observerOfString.on(.Completed) return NopDisposable.instance } } åœ¨ä¸‹é¢çš„ç¤ºä¾‹ä¸­, åœ¨ç»“æŸä¹‹å‰ä¼šè°ƒç”¨ subscribe(_:): example(\"Observable with subscriber\") { _ = Observable&lt;String>.create { observerOfString in print(\"Observable created\") observerOfString.on(.Next(\"ğŸ˜‰\")) observerOfString.on(.Completed) return NopDisposable.instance } .subscribe { event in print(event) } } ä¸ç”¨æ‹…å¿ƒè¿™äº›åˆ›å»º Observable çš„ç»†èŠ‚ï¼Œé©¬ä¸Šå°±è¦å­¦ä¹ äº† åœ¨ä»¥ä¸Šçš„æ —å­ä¸­ï¼Œæˆ‘ä»¬è¿”å›çš„éƒ½æ˜¯ä¸€ä¸ª NopDisposable.instance ï¼Œè€Œåœ¨å®é™…çš„æƒ…å†µä¸­æ˜¯éœ€è¦ è¿”å›ä¸€ä¸ª DisposeBag çš„å®ä¾‹çš„ï¼Œæ¥å¦¥å–„çš„å¤„ç†è¿™äº›ä»£ç ã€‚ è‡³äºä¸ºä»€ä¹ˆï¼Ÿå—¯ã€‚ â€¦â€¦ practice makes permanent ğŸ™‚ ç†Ÿèƒ½ç”Ÿå·§ï¼Ÿ ä½ å¯ä»¥æŸ¥çœ‹æ›´å¤šä»‹ç» Disposing ï¼Œ Getting Started guide. åˆ›å»ºå’Œè®¢é˜…ä¸€ä¸ª Observablesæœ‰ä»¥ä¸‹è¿™å‡ ç§æ–¹æ³•æ¥åˆ›å»ºå’Œè®¢é˜…ä¸€ä¸ª Observables neveråˆ›å»ºä¸€ä¸ª Observables ï¼Œä¸å‘å‡ºä»»ä½•é¡¹ç›®ï¼Œä¸ç»ˆæ­¢ å°±æ˜¯ä»»æ€§ï¼ï¼ï¼ï¼ example(\"never\") { let disposeBag = DisposeBag() let neverSequence = Observable&lt;String>.never() let neverSequenceSubscription = neverSequence .subscribe { _ in print(\"This will never be printed\") } neverSequenceSubscription.addDisposableTo(disposeBag) } emptyåˆ›å»ºä¸€ä¸ªåªå‘é€å®ŒæˆåŠ¨ä½œçš„ Observables å¯¹è±¡ã€‚ è€å­ä¸é—®è¿‡ç¨‹ï¼Œåªçœ‹ç»“æœï¼ï¼ï¼ example(\"empty\") { let disposeBag = DisposeBag() Observable&lt;Int>.empty() .subscribe { event in print(event) } .addDisposableTo(disposeBag) } è¿™ä¸ªå®ä¾‹è¿˜ä»‹ç»äº†åˆ›å»ºå’Œè®¢é˜…ä¸€ä¸ª Observables å¯¹è±¡ï¼Œå…¶å®å°±æ˜¯æ‰§è¡Œäº† subscribe è¿™ä¸ªæ–¹æ³•ã€‚ juståˆ›å»ºä¸€ä¸ªå‘é€åˆ¶å®šåŠ¨ä½œçš„çš„ Observables å¯¹è±¡ã€‚ example(\"just\") { let disposeBag = DisposeBag() Observable.just(\"ğŸ”´\") .subscribe { event in print(event) } .addDisposableTo(disposeBag) } è¿™ä¸ªå®ä¾‹è¿˜ä»‹ç»äº†åˆ›å»ºå’Œè®¢é˜…ä¸€ä¸ª Observables å¯¹è±¡ï¼Œå…¶å®å°±æ˜¯æ‰§è¡Œäº† subscribe è¿™ä¸ªæ–¹æ³•ã€‚ ofåˆ›å»ºä¸€ä¸ªå…·æœ‰å›ºå®šæ•°é‡çš„ Observables å¯¹è±¡ example(\"of\") { let disposeBag = DisposeBag() Observable.of(\"ğŸ¶\", \"ğŸ±\", \"ğŸ­\", \"ğŸ¹\") .subscribeNext { element in print(element) } .addDisposableTo(disposeBag) } è¿™ä¸ªä¾‹å­è¿˜ä»‹ç»äº† subscribeNext(:) è¿™ç§ç®€å•çš„æ–¹æ³•ä¸åƒ subscribe(:),å®ƒæ˜¯å®šè¯­äº†æ‰€æœ‰çš„åŠ¨ä½œ åŒ…æ‹¬ ï¼ˆNext, Error, and Completedï¼‰subscribeNext å°†ä¼šå¿½ç•¥æ‰€æœ‰çš„ (Error and Completed )åŠ¨ä½œï¼Œåªä¼šç”Ÿäº§å‡ºä¸€ä¸ª Next åŠ¨ä½œã€æˆ‘ä»¬è¿™é‡ŒåŒæ ·ä¹Ÿæœ‰ å®Œæˆ å’Œ å¤±è´¥ å¯¹åº”çš„ç®€å•æ–¹æ³•ã€‚ subscribeError(:) and subscribeCompleted(:)ï¼Œå½“ä½ åªæƒ³æ£€æµ‹æ˜¯å¯¹åº”çš„åŠ¨ä½œçš„æ—¶å€™å¦‚æœä½ æƒ³è®¢é˜…æ‰€æœ‰çš„åŠ¨ä½œçš„ä½ å¯ä»¥ä½¿ç”¨ subscribe(onNext:onError:onCompleted:onDisposed:)` å°±åƒä¸‹é¢çš„ä¾‹å­ ğŸ‘‡çœ‹äº†ä»¥ä¸‹è‡ªå·±å†™çš„ã€‚ä¸çŸ¥é“æ€ä¹ˆè¯´ï¼ è‰ ï¼subscribe å°±æ˜¯æ‹¦æˆªæ‰€æœ‰çš„æ“ä½œï¼ æ¯”å¦‚ next error å’Œ compltedã€‚è€Œè¿™äº›æ£€æµ‹éƒ½æœ‰å•ç‹¬çš„ç®€ä¾¿æ–¹æ³• subscribeNext subscribeError subscribeCompleted Example someObservable.subscribe( onNext: { print(&quot;Element:&quot;, $0) }, onError: { print(&quot;Error:&quot;, $0) }, onCompleted: { print(&quot;Completed&quot;) }, onDisposed: { print(&quot;Disposed&quot;) } ) toObservableå°†ä¸€ä¸ª sequence(SequenceType),è½¬æ¢æˆä¸ºä¸€ä¸ª Observable ,å¯ä»¥æ˜¯ä»»ä½•å®ç°äº†(SequenceType)åè®®çš„å¯¹è±¡ï¼Œæ¯”å¦‚Array, Dictionary, or Set example(\"toObservable\") { let disposeBag = DisposeBag() [\"ğŸ¶\", \"ğŸ±\", \"ğŸ­\", \"ğŸ¹\"].toObservable() .subscribeNext { print($0) } .addDisposableTo(disposeBag) } è¯¥ä¾‹å­ä½¿ç”¨äº† $0 è¿™ä¸€ç§å‚æ•°ï¼Œè€Œä¸æ˜¯æ˜¾å¼å‘½åçš„å‚æ•° createåˆ›å»ºä¸€ä¸ª Observable åºåˆ— example(\"create\") { let disposeBag = DisposeBag() let myJust = { (element: String) -> Observable&lt;String> in return Observable.create { observer in observer.on(.Next(element)) observer.on(.Completed) return NopDisposable.instance } } myJust(\"ğŸ”´\") .subscribe { print($0) } .addDisposableTo(disposeBag) } rangeåˆ›å»ºä¸€ä¸ª å¯ä»¥å‘å°„ä¸€ç³»åˆ—çš„è¿ç»­æ•´æ•°ï¼Œç„¶åç»ˆæ­¢ çš„ Observableå¯¹è±¡ example(\"range\") { let disposeBag = DisposeBag() Observable.range(start: 1, count: 10) .subscribe { print($0) } .addDisposableTo(disposeBag) } repeatElementåˆ›å»ºä¸€ä¸ªæ— é™åœ°å‘å°„ç»™å®šçš„å…ƒç´  Observableã€‚ è±Œè±†å›ï¼Ÿï¼Ÿ example(\"repeatElement\") { let disposeBag = DisposeBag() Observable.repeatElement(\"ğŸ”´\") .take(3) .subscribeNext { print($0) } .addDisposableTo(disposeBag) } è¯¥æ —å­ä¸­ä½¿ç”¨ take æ–¹æ³•æ¥é™åˆ¶å‘å°„ç»™å®šå…ƒç´ çš„æ¬¡æ•° generateåˆ›å»ºä¸€ä¸ªåªæœ‰å½“æä¾›çš„æ‰€æœ‰çš„åˆ¤æ–­æ¡ä»¶éƒ½ä¸º true çš„æ—¶å€™ï¼Œæ‰ä¼šç»™å‡ºåŠ¨ä½œçš„ Observable ! è€å­ åˆšæ­£ä¸é˜¿ example(\"generate\") { let disposeBag = DisposeBag() Observable.generate( initialState: 0, condition: { $0 &lt; 3 }, iterate: { $0 + 1 } ) .subscribeNext { print($0) } .addDisposableTo(disposeBag) } deferredåˆ›å»ºä¸€ä¸ªå…¨æ–°çš„ Observable ï¼Œä½ TMæ‰æ˜¯æ¬è¿å·¥ï¼Œè€å­æ˜¯å¤§è‡ªç„¶çš„åˆ›é€ è€…ï¼ example(\"deferred\") { let disposeBag = DisposeBag() var count = 1 let deferredSequence = Observable&lt;String>.deferred { print(\"Creating \\(count)\") count += 1 return Observable.create { observer in print(\"Emitting...\") observer.onNext(\"ğŸ¶\") observer.onNext(\"ğŸ±\") observer.onNext(\"ğŸµ\") return NopDisposable.instance } } deferredSequence .subscribeNext { print($0) } .addDisposableTo(disposeBag) deferredSequence .subscribeNext { print($0) } .addDisposableTo(disposeBag) } erroråˆ›å»ºä¸€ä¸ªä¸åšä»»ä½•æ“ä½œï¼Œç›´æ¥ä¸¢ä¸€ä¸ªé”™è¯¯ç»™ä½ çš„ Observable. å¯¹æ–¹ä¸æƒ³å’Œä½  BBï¼Œå¹¶ä¸¢ç»™ä½ ä¸€ä¸ªé”™è¯¯ ğŸ˜ example(\"error\") { let disposeBag = DisposeBag() Observable&lt;Int>.error(Error.Test) .subscribe { print($0) } .addDisposableTo(disposeBag) } doOnä¸ºæ¯ä¸€ä¸ªå‘å‡ºçš„äº‹ä»¶å’Œè¿”å›çš„æ‰§è¡Œåˆ¶å®šæ“ä½œã€‚ æ”¶è´¹ç«™ï¼Ÿ example(\"doOn\") { let disposeBag = DisposeBag() Observable.of(\"ğŸ\", \"ğŸ\", \"ğŸŠ\", \"ğŸ‹\") .doOn { print(\"Intercepted:\", $0) } .subscribeNext { print($0) } .addDisposableTo(disposeBag) } è¿™é‡Œä¹Ÿæœ‰ã€‚ doOnNext(:), doOnError(:), and doOnCompleted(:) ç®€ä¾¿æ–¹æ³•ã€‚ ä¹Ÿæœ‰ doOn(onNext(:)onError(:)onCompleted(:)) è¿™æ ·çš„æ–¹æ³• Working with Subjectsä½¿ç”¨ Subjects è¿›è¡Œå·¥ä½œï¼Œä¸€ä¸ª Subject å¯ä»¥ç†è§£ä¸ºä¸€ä¸ªä¸­é—´äººï¼Œä»–æ—¢å¯ä»¥è§‚å¯Ÿè€…è§‚å¯Ÿï¼Œå‘è§‚å¯Ÿè€…æä¾›åŠ¨ä½œã€‚ä¹Ÿå¯ä»¥å½“ä½œè§‚å¯Ÿè€…å»è§‚å¯Ÿï¼Œæ¥æ¥å—å¯¹è±¡ã€‚ å¤§æ¦‚çš„æ„æ€ã€‚å¯æ”»å¯å—ï¼Ÿï¼Ÿï¼Ÿ PublishSubjectå‘æ‰€æœ‰è®¢é˜…è€…å‘å¸ƒåŠ¨ä½œã€‚åœ¨ä»–ä»¬è®¢é˜…ä¹‹åã€‚è¿™ä¸ªæ—¶é—´æ˜¯æœ‰å…³ç³»çš„å“¦ã€‚ä»ä¸‹å›¾ä¹Ÿå¯ä»¥çœ‹åˆ°ï¼Œç¬¬äºŒä¸ªè®¢é˜…çš„ç”¨æˆ·ï¼Œå·²ç»é”™è¿‡äº†æ¥å—çº¢ç»¿çš„æ—¶é—´ã€‚æ‰€ä»¥ä»–åªæ¥å—åˆ°äº†ï¼Œè“è‰²å’Œé”™è¯¯åŠ¨ä½œ let disposeBag = DisposeBag() let subject = PublishSubject&lt;String>() subject.subscribe{print(\"ç¬¬ä¸€æ¬¡è®¢é˜…\",$0)}.addDisposableTo(disposeBag) subject.onNext(\"ğŸ¶\") subject.onNext(\"ğŸ±\") subject.subscribe{print(\"ç¬¬äºŒæ¬¡è®¢é˜…\",$0)}.addDisposableTo(disposeBag) subject.onNext(\"ğŸ…°ï¸\") subject.onNext(\"ğŸ…±ï¸\") åœ¨è¿™ä»½ä»£ç ä¸­ç¬¬ä¸€ä¸ªè®¢é˜…å¯ä»¥å±•ç¤º4ä¸ªï¼Ÿè€Œç¬¬äºŒæ¬¡ï¼Œå°±åªèƒ½æ¥æ”¶åˆ° å°çŒ«å’Œå°ç‹—ã€‚ åœ¨è¿™ä»½ä¾‹å­ä¸­ï¼Œä½¿ç”¨çš„æ˜¯ onNext(:) ç®€ä¾¿çš„æ–¹æ³•ï¼Œå½“ç„¶ä¹Ÿæœ‰ é”™è¯¯ å’Œ å®Œæˆçš„ç®€ä¾¿æ–¹æ³• onError(:) , onCompleted() . ä½ ä¹Ÿå¯ä»¥ç›´æ¥é£Ÿç”¨ on(.Error(:)) on(.Completed(:)) on(.Next(:)) è¿™å’Œä¹‹å‰çš„å¦‚å‡ºä¸€è¾™ (:) ReplaySubjectå’±ä»¬ä¹‹å‰åˆ›å»ºçš„ PublishSubject ï¼Œå¦‚æœåœ¨è®¢é˜…ä¹‹å‰çš„æ—¶é—´æ˜¯ä¸ä¼šæ¥æ”¶åˆ°çš„ï¼Œè€Œè¿™ä¸ªå‘¢ å¯ä»¥æŒ‡å®šï¼Œç¼“å­˜çš„ä¸ªæ•°ï¼Œæ¯”å¦‚ 2 ï¼Œé‚£ä¹ˆå’±ä»¬å°±å¯ä»¥æ¥å—è®¢é˜…æ—¶é—´ä¹‹å‰ä¸¤æ¬¡çš„ åŠ¨ä½œäº‹ä»¶ã€‚ let disposeBag = DisposeBag() let subject = ReplaySubject&lt;String>.create(bufferSize: 1) subject.subscribe{print(\"ç¬¬ä¸€æ¬¡è®¢é˜…\",$0)}.addDisposableTo(disposeBag) subject.onNext(\"ğŸ¶\") subject.onNext(\"ğŸ±\") subject.subscribe{print(\"ç¬¬äºŒæ¬¡è®¢é˜…\",$0)}.addDisposableTo(disposeBag) subject.onNext(\"ğŸ…°ï¸\") subject.onNext(\"ğŸ…±ï¸\") åœ¨è¿™ä»½ä»£ç ä¸­ï¼Œç¬¬äºŒæ¬¡çš„é¢è®¢é˜…çš„æ—¶å€™ å°±ä¼š æ˜¯ å°çŒ« A å’Œ Bäº†ï½ BehaviorSubjectå‘æ‰€æœ‰çš„è®¢é˜…è€…å¹¿æ’­æ–°çš„äº‹ä»¶ï¼Œå¹¶ä¸”ä¼ é€’ å½“å‰ çš„æœ€æ–°å€¼ï¼Œåˆå§‹å€¼ã€‚ æ€ä¹ˆæ„Ÿè§‰å°±æ˜¯ ReplaySubject ä¹‹å buffSize æ˜¯ 1 çš„å˜å½¢å‘¢ã€‚ã€‚ã€‚ã€‚é™¤äº†å¤šäº†ä¸€ä¸ªåˆå§‹å€¼ã€‚ã€‚ã€‚ let disposeBag = DisposeBag() let subject = BehaviorSubject(value: \"ğŸ”´\") subject.subscribe{print(\"ç¬¬ä¸€æ¬¡è®¢é˜…\",$0) }.addDisposableTo(disposeBag) subject.onNext(\"ğŸ¶\") subject.onNext(\"ğŸ±\") subject.subscribe{ print(\"ç¬¬äºŒæ¬¡è®¢é˜…\",$0)}.addDisposableTo(disposeBag) subject.onNext(\"ğŸ…°ï¸\") subject.onNext(\"ğŸ…±ï¸\") åœ¨ç¬¬äºŒæ¬¡è®¢é˜…å‡ºç°çš„æ—¶å€™ä¼šå¤šå‡ºç°ä¸€æ¬¡ã€‚æœ€æ–°å€¼ã€‚è€Œç¬¬ä¸€æ¬¡è®¢é˜…åˆ™ä¼šå‡ºç°ä¸€ä¸ª åˆå§‹å€¼ã€‚ çœ‹äº†è¿™ä¸‰ä¸ªä¾‹å­æœ‰æ²¡æœ‰å¥½åƒé—æ¼äº†ä»€ä¹ˆ ï¼Œä¸€ä¸ª Completed äº‹ä»¶ã€‚ PublishSubject, ReplaySubject, å’Œ BehaviorSubject ä¸ä¼šåœ¨è‡ªåŠ¨å‘å‡º å®Œæˆäº‹ä»¶çš„ã€‚ VariableBehaviorSubject å˜ç§ã€‚ã€‚ã€‚ å°±æ˜¯è¯´å‘¢ï¼ŒBehaviorSubject ä¸æ˜¯ä¸ä¼šè‡ªåŠ¨å‘é€ Completed äº‹ä»¶å—ï¼Ÿ Variable ä¼šã€‚æ²¡äº†ã€‚ let variable = Variable(\"ğŸ”´\") subject.subscribe{print(\"ç¬¬ä¸€æ¬¡è®¢é˜…\",$0) }.addDisposableTo(disposeBag) variable.value = \"ğŸ¶\" variable.value = \"ğŸ±\" subject.subscribe{ print(\"ç¬¬ä¸€æ¬¡è®¢é˜…\",$0)}.addDisposableTo(disposeBag) variable.value = \"ğŸ…°ï¸\" variable.value = \"ğŸ…±ï¸\" Variable å¯¹è±¡ è°ƒç”¨ asObservable() æ–¹æ³•å¯ä»¥è·å–ä»–å˜ç§å‰çš„ BehaviorSubject å¯¹è±¡ã€‚ Variable å¯¹è±¡ ä¸èƒ½å®ç° onNext æ–¹æ³•ï¼Œä½†æ˜¯ä½ å¯ä»¥è°ƒç”¨ä»–çš„ value å‚æ•°ï¼Œæ¥ get å’Œset å®ƒçš„å€¼ã€‚","categories":[{"name":"IOS","slug":"IOS","permalink":"http://www.msiter.com/categories/IOS/"}],"tags":[{"name":"ios","slug":"ios","permalink":"http://www.msiter.com/tags/ios/"},{"name":"swift","slug":"swift","permalink":"http://www.msiter.com/tags/swift/"},{"name":"RX","slug":"RX","permalink":"http://www.msiter.com/tags/RX/"}],"keywords":[{"name":"IOS","slug":"IOS","permalink":"http://www.msiter.com/categories/IOS/"}]},{"title":"reactivex å­¦ä¹ ","slug":"reactivex å­¦ä¹ ","date":"2016-06-21T23:22:00.000Z","updated":"2017-11-28T11:07:04.831Z","comments":true,"path":"2016/06/21/reactivex å­¦ä¹ /","link":"","permalink":"http://www.msiter.com/2016/06/21/reactivex å­¦ä¹ /","excerpt":"æ•£è®°å¥½ä¹…æ²¡æœ‰å­¦ä¹ åˆ°æ–°çš„ä¸œè¥¿äº†ï¼Œä¹‹å‰ä¸€ç›´æƒ³å­¦ä¹  ReactiveCocoa,ä½†æ˜¯çœ‹äº†ä¸€ç‚¹ä¹‹åï¼Œè§‰çš„å¾ˆæ˜¯ç¹çï¼Œè€Œä¸”æ„Ÿè§‰å¾ˆå¤šapiæ–¹æ³•ï¼Œå†åŠ ä¸Šé¡¹ç›®å¾ˆç´§è¿«æ²¡æœ‰æ—¶é—´å»å­¦ä¹ æ–°çš„ä¸œè¥¿äº†ã€‚æˆ‘å°±æš‚æ—¶æç½®äº†ï¼Œç°åœ¨é¡¹ç›®åšçš„ä¹Ÿå·®ä¸å¤šäº†ï¼Œè§‰å¾—è¿™ä¸ªå­¦ä¹ è¿›åº¦æ˜¯æ—¶å€™æä¸Šè¿›ç¨‹ã€‚ å†å¼€å§‹å­¦ä¹ çš„æ—¶å€™ï¼Œå‘ç°äº†RxSwift.åœ¨ä¹‹åå‘ç°äº† reactivex ã€‚è¿›å…¥äº†å®˜ç½‘å‘ç°è‡ªå·±å¯èƒ½ï¼Œæ‰¾åˆ°äº†ä¸€ä¸ª ç±»ä¼¼äº Realmå’Œswagger çš„åºç„¶å¤§ç‰©ï¼Œ ç»å¯¹è¦å¥½å¥½å­¦ä¹ ï¼Œåœ¨åŠ ä¸Šè‡ªå·±å­¦ä¹ çš„æœ¬èº«å°±æ˜¯swiftã€‚è‡ªç„¶é€‰æ‹©äº† RXswiftã€‚ å¥½äº†ï¼ŒåºŸè¯ä¸å¤šè¯´äº†ï¼Œå¼€å§‹å­¦ä¹ å§ï¼Œè¯·è€å¿ƒçœ‹ä¸‹å»ã€‚å› ä¸ºæˆ‘ä¹Ÿæ˜¯ç¿»è¯‘ï¼Œæ‰€ä»¥å¦‚æœæœ‰ä»»ä½•è§‰å¾—ä¸åº”è¯¥çš„åœ°æ–¹ï¼Œå¯ä»¥æé†’æˆ‘ã€‚","text":"æ•£è®°å¥½ä¹…æ²¡æœ‰å­¦ä¹ åˆ°æ–°çš„ä¸œè¥¿äº†ï¼Œä¹‹å‰ä¸€ç›´æƒ³å­¦ä¹  ReactiveCocoa,ä½†æ˜¯çœ‹äº†ä¸€ç‚¹ä¹‹åï¼Œè§‰çš„å¾ˆæ˜¯ç¹çï¼Œè€Œä¸”æ„Ÿè§‰å¾ˆå¤šapiæ–¹æ³•ï¼Œå†åŠ ä¸Šé¡¹ç›®å¾ˆç´§è¿«æ²¡æœ‰æ—¶é—´å»å­¦ä¹ æ–°çš„ä¸œè¥¿äº†ã€‚æˆ‘å°±æš‚æ—¶æç½®äº†ï¼Œç°åœ¨é¡¹ç›®åšçš„ä¹Ÿå·®ä¸å¤šäº†ï¼Œè§‰å¾—è¿™ä¸ªå­¦ä¹ è¿›åº¦æ˜¯æ—¶å€™æä¸Šè¿›ç¨‹ã€‚ å†å¼€å§‹å­¦ä¹ çš„æ—¶å€™ï¼Œå‘ç°äº†RxSwift.åœ¨ä¹‹åå‘ç°äº† reactivex ã€‚è¿›å…¥äº†å®˜ç½‘å‘ç°è‡ªå·±å¯èƒ½ï¼Œæ‰¾åˆ°äº†ä¸€ä¸ª ç±»ä¼¼äº Realmå’Œswagger çš„åºç„¶å¤§ç‰©ï¼Œ ç»å¯¹è¦å¥½å¥½å­¦ä¹ ï¼Œåœ¨åŠ ä¸Šè‡ªå·±å­¦ä¹ çš„æœ¬èº«å°±æ˜¯swiftã€‚è‡ªç„¶é€‰æ‹©äº† RXswiftã€‚ å¥½äº†ï¼ŒåºŸè¯ä¸å¤šè¯´äº†ï¼Œå¼€å§‹å­¦ä¹ å§ï¼Œè¯·è€å¿ƒçœ‹ä¸‹å»ã€‚å› ä¸ºæˆ‘ä¹Ÿæ˜¯ç¿»è¯‘ï¼Œæ‰€ä»¥å¦‚æœæœ‰ä»»ä½•è§‰å¾—ä¸åº”è¯¥çš„åœ°æ–¹ï¼Œå¯ä»¥æé†’æˆ‘ã€‚ ReactiveXåœ¨è¿›å…¥ReactiveXçš„å®˜æ–¹ç½‘ç«™åï¼Œå°±çœ‹åˆ°äº†å®ƒå¯¹è‡ªå·±çš„è¯„ä»· ReactiveX is a combination of the best ideas fromthe Observer pattern, the Iterator pattern, and functional programming reactivexç»„åˆæ˜¯è§‚å¯Ÿè€…æ¨¡å¼ï¼Œè¿­ä»£å™¨æ¨¡å¼å’Œå‡½æ•°å¼ç¼–ç¨‹æœ€å¥½çš„æƒ³æ³•ã€‚ ok ~ å¥½å§ï¼Œç®—ä½ åŠã€‚ä»€ä¹ˆæ„æ€ï¼ Observable è§‚å¯Ÿè€…æ¨¡å¼ç®€ä»‹åœ¨reactivex è§‚å¯Ÿè€… è®¢é˜… å¯è§‚å¯Ÿå¯¹è±¡ã€‚ç„¶åï¼Œè§‚å¯Ÿè€… ä¼šå¯¹ å¯è§‚å¯Ÿå¯¹è±¡ ä»¥ä»»æ„é¡ºåºå‘å‡ºçš„ä»»ä½•é¡¹ç›®ä¸¢å›ä½œå‡ºååº”ã€‚è¿™ç§æ¨¡å¼æœ‰åˆ©äºå¹¶å‘æ“ä½œï¼Œä»–ä¸éœ€è¦åˆ›å»ºä¸€ä¸ªé˜»å¡å¯¹è±¡æ¥ç­‰å¾… å¯è§‚å¯Ÿè€… å‘å‡ºä»»ä½•æŒ‡ä»¤,è€Œæ˜¯åˆ›å»ºä¸€ä¸ªå“¨å…µçš„å½¢å¼çš„è§‚å¯Ÿå‘˜ï¼Œéšæ—¶å‡†å¤‡ä½œå‡ºé€‚å½“çš„ååº”é’ˆå¯¹äº å¯è§‚å¯Ÿå¯¹è±¡ å‘å‡ºçš„é¡¹ç›®ã€‚ See Also Single â€” ä¸€ä¸ªé’ˆå¯¹äºå¯è§‚å¯Ÿå¯¹è±¡åªå‘å‡ºä¸€æ¬¡é¡¹ç›®çš„ä¸“é—¨ç‰ˆæœ¬ Rx Workshop: Introduction Introduction to Rx: IObservable Mastering observables (æ¥è‡ª Couchbase æœåŠ¡å™¨çš„æ–‡æ¡£) 2 minute introduction to Rx ä½œè€…: Andre Staltz(â€œThink of an Observable as an asynchronous immutable array.â€) (æŠŠä¸€ä¸ªå¯è§‚å¯Ÿå¯¹è±¡è®¤ä½œä¸ºä¸€ä¸ªå¼‚æ­¥ä¸å¯æ”¹å˜çš„æ•°ç»„) Introducing the Observable by Jafar Husain (JavaScript Video Tutorial) Observable object (RxJS) by Dennis Stoyanov Turning a callback into an Rx Observable by @afterecho Backgroundåœ¨è®¸å¤šç¼–ç¨‹é¡¹ç›®ä¸­ï¼Œäººä»¬å¾€å¾€æ›´å€¾å‘äºåœ¨ä¸€ä¸ªæ—¶é—´æ‰§è¡Œä¸€ä¸ªæŒ‡ä»¤æ‰§è¡Œæˆ–è€…å®Œæˆä¸€ä¸ªå¢é‡æ“ä½œã€‚ä½†æ˜¯åœ¨reactivexä¸­ï¼Œè®¸å¤šæŒ‡ä»¤å¯ä»¥å¹¶è¡Œæ‰§è¡Œã€‚å…¶ç»“æœä¼šåœ¨åæ¥ä»¥ä»»æ„é¡ºåºè¢«è§‚å¯Ÿè€…æŠ“è·ã€‚è€Œä¸æ˜¯å®šä¹‰ä¸€ä¸ªæ–¹æ³•å®Œæˆæ•°æ®çš„è½¬æ¢ç­‰æ“ä½œæ–¹æ³•ï¼Œç„¶åä»¥ä¸€ä¸ª è¢«è§‚å¯Ÿè€…çš„èº«ä»½å»è®¢é˜…äº†ä¸€ä¸ªè§‚å¯Ÿè€…ã€‚ è¿™ç§æ–¹æ³•çš„ä¸€ä¸ªä¼˜ç‚¹æ˜¯ï¼Œå½“ä½ æœ‰ä¸€å †ä¸ä¾èµ–äºå½¼æ­¤çš„ä»»åŠ¡æ—¶ï¼Œä½ å¯ä»¥åŒæ—¶å¯åŠ¨å®ƒä»¬ï¼Œè€Œä¸æ˜¯ç­‰å¾…æ¯ä¸€ä¸ªå®Œæˆä¹‹å‰å¼€å§‹ä¸‹ä¸€ä¸ª-è¿™æ ·ï¼Œä½ çš„æ€»æ‰§è¡Œæ—¶é—´å°±æ˜¯ä½ ä¸€å †ä»»åŠ¡æ‰§è¡Œæ—¶é—´æœ€é•¿çš„é‚£ä¸€ä¸ªï¼Œå°±åƒæ˜¯æœ¨æ¿ç»„æˆæ°´æ¡¶ï¼Œè£…çš„æ°´å¤šå°‘åœ¨äºæœ€çŸ­çš„é‚£å—æœ¨æ¿ä¸€æ ·çš„é“é‡Œã€‚ æœ‰è®¸å¤šæœ¯è¯­ç”¨æ¥æè¿°è¿™ç§å¼‚æ­¥ç¼–ç¨‹å’Œè®¾è®¡æ¨¡å‹ã€‚æœ¬æ–‡æ¡£å°†ä½¿ç”¨ä»¥ä¸‹æœ¯è¯­ï¼šä¸€ä¸ªè§‚å¯Ÿè€…è®¢é˜…è§‚å¯Ÿã€‚ä¸€ä¸ªå¯è§‚å¯Ÿçš„å‘å°„é¡¹ç›®æˆ–é€šè¿‡è°ƒç”¨è§‚å¯Ÿå‘˜çš„æ–¹æ³•å‘é€é€šçŸ¥ç»™å®ƒçš„è§‚å¯Ÿå‘˜ã€‚ åœ¨å…¶ä»–æƒ…å†µä¸‹ï¼Œæœ‰æ—¶ä¹Ÿç§°è§‚å¯Ÿå‘˜ä¸ºâ€œç”¨æˆ·â€â€œè§‚çœ‹çš„äººâ€æˆ–â€œå †â€ã€‚è¿™ç§æ¨¡å¼ä¸€èˆ¬æ˜¯é€šå¸¸è¢«ç§°ä¸ºâ€œååº”æ¨¡å¼â€ å»ºç«‹è§‚å¯Ÿå‘˜åœ¨ä¸€ä¸ªæ™®é€šçš„æ–¹æ³•è°ƒç”¨æ˜¯å¼‚æ­¥çš„ï¼Œæ²¡æœ‰æ’åºï¼Œå¹¶è¡Œè°ƒç”¨å…¸å‹çš„reactivex -æµç¨‹æ˜¯è¿™æ ·çš„ï¼š è°ƒç”¨æ–¹æ³•ã€‚ å°†è¯¥æ–¹æ³•çš„è¿”å›å€¼å­˜å‚¨åœ¨ä¸€ä¸ªå˜é‡ä¸­ ä½¿ç”¨è¿™ä¸ªå˜é‡å’Œå®ƒçš„æ–°å€¼æ¥åšä¸€äº›æœ‰ç”¨çš„äº‹æƒ…ã€‚ æˆ–è€…ï¼Œåƒè¿™æ ·çš„ï¼š // æ‰“ç”µè¯ï¼ŒæŠŠå®ƒçš„è¿”å›å€¼ èµ‹å€¼ç»™` returnval ` returnval =æ–¹æ³•ï¼ˆå‚æ•°ï¼‰ï¼› // returnval å»åšç‚¹æœ‰ç”¨çš„äº‹å„¿ åœ¨å¼‚æ­¥æ¨¡å‹ä¸­ï¼Œæµç¨‹ä¼šåƒè¿™æ ·ï¼š å®šä¹‰ä¸€ä¸ªæ–¹æ³•ï¼Œåšä¸€äº›æœ‰ç”¨çš„ä»å¼‚æ­¥è°ƒç”¨è¿”å›å€¼ï¼›è¯¥æ–¹æ³•æ˜¯è§‚å¯Ÿè€…çš„ä¸€éƒ¨åˆ†ã€‚ä¹Ÿå°±æ˜¯ A è°ƒç”¨æ–¹æ³•åšå‡ºä¸€äº›è°ƒæ•´å åæ‚” A å®šä¹‰å¼‚æ­¥è°ƒç”¨æ–¹æ³•æœ¬èº«ä½œä¸ºä¸€ä¸ªå¯è§‚å¯Ÿçš„å¯¹è±¡ é™„åŠ çš„è§‚æµ‹å™¨ï¼Œé€šè¿‡è®¢é˜…å®ƒè§‚å¯Ÿï¼ˆè¿™ä¹Ÿå¯¼è‡´å¯è§‚å¯Ÿåˆ°çš„å¼€å§‹è¡ŒåŠ¨ï¼‰ ç»§ç»­ä½ çš„ä¸šåŠ¡ï¼›æ¯å½“è°ƒç”¨è¿”å›æ—¶ï¼Œè§‚å¯Ÿè€…çš„æ–¹æ³•å°†å¼€å§‹æ“ä½œå®ƒçš„è¿”å›å€¼æˆ–å€¼-æ‰€è§‚å¯Ÿåˆ°çš„é¡¹ç›®ã€‚ çœ‹èµ·æ¥åƒè¿™æ ·ï¼š // å®šä¹‰ï¼Œä½†ä¸è°ƒç”¨ï¼Œç”¨æˆ· onNext å¤„ç† // åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œè§‚å¯Ÿè€…æ˜¯éå¸¸ç®€å•çš„ï¼Œåªæœ‰ä¸€ä¸ª`onNext`å¤„ç† def myOnNext = { it -&gt; do something useful with it }; // å®šä¹‰ï¼Œä½†ä¸è°ƒç”¨ï¼Œå¯è§‚å¯Ÿåˆ°çš„ def myObservable = someObservable(itsParameters); // è®¢é˜…ç”¨æˆ·å¯è§ï¼Œå¹¶è°ƒç”¨è§‚å¯Ÿ myObservable.subscribe(myOnNext); // ç»§ç»­æˆ‘çš„ä¸šåŠ¡ onNext, onCompleted, and onErroræ‚¨çš„è§‚å¯Ÿè€…å®ç°ä»¥ä¸‹æ–¹æ³•çš„ä¸€äº›è®¢é˜…æ–¹æ³•å­é›†å¯ä»¥å°†ä¸€ä¸ªè§‚å¯Ÿè€…è¿æ¥åˆ°ä¸€ä¸ªå¯è§‚å¯Ÿåˆ°çš„ï¼š onNextæ— è®ºä»»ä½•æ—¶å€™ï¼Œä¸€ä¸ªå¯è§‚å¯Ÿå¯¹è±¡è°ƒç”¨è¿™ä¸ªæ–¹æ³•å‘å‡ºä¸€ä¸ªé¡¹ç›®ï¼Œè¿™ä¸ªæ–¹æ³•ä¼šæŠŠ è¢«è§‚å¯Ÿè€…å‘å‡ºçš„è¿™ä¸ªé¡¹ç›®ä½œä¸ºä¸€ä¸ªå‚æ•°ç»§ç»­ä¼ é€’ä¸‹å» onErrorä¸€ä¸ªè¢«è§‚å¯Ÿè€…é‡åˆ°éé¢„æœŸçš„æ•°æ®å’Œä¸€äº›é”™è¯¯ï¼Œå°±ä¼šè°ƒç”¨è¿™ä¸ªæ–¹æ³•ï¼Œæ¥ä¸‹æ¥å®ƒä¸ä¼šè°ƒç”¨ onCompleted æˆ–è€… onNext æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•å°†é”™è¯¯çš„æŒ‡ç¤ºä½œä¸ºå‚æ•° onCompletedæ²¡æœ‰å‘ç”Ÿé”™è¯¯çš„æƒ…å†µä¸‹ï¼Œå®Œæˆæ“ä½œåï¼Œè°ƒç”¨çš„æ–¹æ³•ã€‚ é€šè¿‡å¯¹è§‚å¯Ÿåˆ°çš„æ¡æ¬¾ï¼Œå®ƒå¯ä»¥è°ƒç”¨OnNexté›¶æ¬¡æˆ–æ›´å¤šæ¬¡ï¼Œç„¶åå¯ä»¥æ ¹æ®è°ƒç”¨ç»“æœè°ƒç”¨ æœ€åä¸€æ¬¡ onCompletedæˆ–OnErrorã€‚æŒ‰ç…§æƒ¯ä¾‹ï¼Œåœ¨è¿™ä¸ªæ–‡ä»¶ä¸­ï¼Œè°ƒç”¨OnNexté€šå¸¸è¢«ç§°ä¸ºâ€œæ’æ”¾â€çš„é¡¹ç›®ï¼Œè€Œå«onCompletedæˆ–onErrorè¢«ç§°ä¸ºâ€œé€šçŸ¥â€ã€‚ å‚è§ï¼š Introduction to Rx: IObserver æ³¨é”€ Unsubscribingåœ¨ä¸€äº›reactivexå®ç°ï¼Œæœ‰ä¸€ä¸ªä¸“é—¨çš„è§‚å¯Ÿè€…æ¥å£ï¼Œç­¾çº¦è€…ï¼Œå®ç°ä¸€ä¸ªUnsubscribingçš„æ–¹æ³•ã€‚ä½ å¯ä»¥è°ƒç”¨è¿™ä¸ªæ–¹æ³•æ¥è¡¨æ˜ï¼Œç”¨æˆ·ä¸å†å¯¹ç›®å‰ä»»ä½•è®¢é˜…æ„Ÿå…´è¶£ã€‚è¿™äº›è§‚æµ‹å¯ä»¥ï¼ˆå¦‚æœä»–ä»¬æ²¡æœ‰å…¶ä»–æ„Ÿå…´è¶£çš„è§‚å¯Ÿå‘˜ï¼‰é€‰æ‹©åœæ­¢äº§ç”Ÿæ–°çš„ç‰©å“å‘å‡ºã€‚ è¿™ä¸€ç»“æœå°†çº§è”é€€è®¢é€šè¿‡è¿è¥å•†ï¼Œé€‚ç”¨äºè§‚å¯Ÿï¼Œè§‚å¯Ÿè€…è®¢é˜…çš„é“¾ï¼Œè¿™å°†å¯¼è‡´åœ¨äº§ä¸šé“¾çš„å„ä¸ªç¯èŠ‚åœæ­¢å‘å°„é¡¹ç›®ã€‚è¿™ä¸ä¿è¯ç«‹å³å‘ç”Ÿï¼Œä½†æ˜¯ï¼Œå®ƒæ˜¯å¯èƒ½çš„ä¸€ä¸ªè§‚å¯Ÿåˆ°çš„äº§ç”Ÿå’Œå°è¯•å‘å°„ä¸€æ®µæ—¶é—´ï¼Œå³ä½¿æ²¡æœ‰è§‚å¯Ÿè€…ä»ç„¶è§‚å¯Ÿè¿™äº›æ’æ”¾é‡ã€‚ å…³äºå‘½åçº¦å®šçš„ä¸€äº›æ³¨é‡Šreactivexæ¯ä¸ªè¯­è¨€çš„å…·ä½“å®ç°æœ‰è‡ªå·±çš„å‘½åä¹ æƒ¯ã€‚æœ‰æ²¡æœ‰è§„èŒƒçš„å‘½åæ ‡å‡†ï¼Œè™½ç„¶æœ‰è®¸å¤šå…±æ€§ä¹‹é—´çš„å®ç° æ­¤å¤–ï¼Œè¿™äº›åç§°ä¸­çš„ä¸€äº›åœ¨å…¶ä»–ä¸Šä¸‹æ–‡ä¸­æœ‰ä¸åŒçš„å«ä¹‰ï¼Œæˆ–åœ¨ä¸€ä¸ªç‰¹å®šçš„å®ç°è¯­è¨€çš„æˆè¯­ä¸­æ˜¾å¾—æœ‰äº›å°´å°¬ã€‚ ä¾‹å¦‚æœ‰äº‹ä»¶çš„å‘½åæ¨¡å¼ï¼ˆä¾‹å¦‚OnNextï¼ŒOnCompletedï¼ŒOnErrorï¼‰ã€‚åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œè¿™æ ·çš„åç§°å°†è¡¨ç¤ºæ–¹æ³•ï¼Œé€šè¿‡è¯¥äº‹ä»¶å¤„ç†ç¨‹åºçš„æ³¨å†Œã€‚ç„¶è€Œï¼Œä»–ä»¬çš„åå­—reactivexï¼Œäº‹ä»¶å¤„ç†å™¨ã€‚ â€œçƒ­â€å’Œâ€œå†·â€çš„ è¢«è§‚æµ‹è€…ä»€ä¹ˆæ—¶å€™è¢«è§‚å¯Ÿè€…ä¼šå‘å‡ºä¿¡æ¯ï¼Ÿè¿™å–å†³äºè¢«è§‚å¯Ÿè€…ã€‚â€œçƒ­â€çš„è§‚å¯Ÿå¯èƒ½å½“ä»–åˆšè¢«åˆ›å»ºæ²¡å¤šä¹…å°±å‘å‡ºä¿¡æ¯ï¼Œæ‰€ä»¥åæ¥è®¢é˜…çš„è§‚å¯Ÿè€…è§‚å¯Ÿåˆ°çš„ä¿¡æ¯å°±æ˜¯ä¸­é—´çš„æŸäº›åœ°æ–¹ã€‚â€œå†·â€çš„è§‚å¯Ÿï¼Œç›´åˆ°ä¸€ä¸ªè®¢é˜…è€…è§‚å¯Ÿä»–çš„å˜åŒ–ï¼Œä»–æ‰å¼€å§‹å‘ç”Ÿä¿¡æ¯ã€‚æ‰€ä»¥è§‚å¯Ÿè€…å°±çœ‹åˆ°ä»–çš„æ•´ä¸ªä¿¡æ¯è¿‡ç¨‹ åœ¨reactivexä¸€äº›å®æ–½æ–¹æ¡ˆä¸­ï¼Œä¹Ÿæœ‰ä¸€äº›ç§°ä¸ºâ€œè¿æ¥â€çš„è§‚å¯Ÿã€‚é™¤éä¸€ä¸ªè§‚å¯Ÿè€…è®¢é˜…äº†è¿™ä¸ªè¿æ¥å¯¹è±¡å¹¶ä¸”è°ƒç”¨å®ƒçš„ Connect æ–¹æ³•ï¼Œå¦åˆ™è¢«è§‚å¯Ÿè€…ä¸ä¼šå‘å‡ºä¿¡æ¯ é€šè¿‡å¯è§‚å¯Ÿç®—å­çš„åˆæˆè§‚å¯Ÿè€…å’Œè¢«è§‚å¯Ÿè€…ä»…ä»…åªæ˜¯ ReactiveXçš„å¼€å§‹ã€‚ç”±ä»–ä»¬è‡ªå·±ï¼Œä»–ä»¬åªä¸è¿‡æ˜¯ä¸€ä¸ªè½»å¾®çš„æ‰©å±•çš„æ ‡å‡†è§‚å¯Ÿè€…æ¨¡å¼ï¼Œæ›´é€‚åˆå¤„ç†ä¸€ç³»åˆ—çš„äº‹ä»¶ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªå•ä¸€çš„å›è°ƒã€‚ çœŸæ­£çš„åŠ›é‡æ¥è‡ªäºreactive extensionsï¼ˆå³reactivexï¼‰-è¿è¥å•†å¯ä»¥å˜æ¢ï¼Œç»“åˆï¼Œæ“çºµï¼Œå¹¶ä¸å‘å°„çš„è§‚æµ‹å€¼åºåˆ—çš„å·¥ä½œé¡¹ç›®ã€‚ è¿™äº›æ¥æ”¶è¿è¥å•†å…è®¸ä½ ä¸€èµ·æ„æˆå¼‚æ­¥åºåˆ—åœ¨å£°æ˜çš„æ–¹å¼ä¸æ‰€æœ‰çš„å›è°ƒå‡½æ•°çš„æ•ˆç‡æ•ˆç›Šä½†æ²¡æœ‰åµŒå¥—çš„å›è°ƒå¤„ç†ç¨‹åºé€šå¸¸ä¸å¼‚æ­¥ç³»ç»Ÿç›¸å…³çš„é—®é¢˜ã€‚ This documentation groups information about the various operators and examples of their usage into the following pages: Creating ObservablesCreate, Defer, Empty/Never/Throw, From, Interval, Just, Range, Repeat, Start, and TimerTransforming Observable ItemsBuffer, FlatMap, GroupBy, Map, Scan, and WindowFiltering ObservablesDebounce, Distinct, ElementAt, Filter, First, IgnoreElements, Last, Sample, Skip, SkipLast, Take, and TakeLastCombining ObservablesAnd/Then/When, CombineLatest, Join, Merge, StartWith, Switch, and ZipError Handling OperatorsCatch and RetryUtility OperatorsDelay, Do, Materialize/Dematerialize, ObserveOn, Serialize, Subscribe, SubscribeOn, TimeInterval, Timeout, Timestamp, and UsingConditional and Boolean OperatorsAll, Amb, Contains, DefaultIfEmpty, SequenceEqual, SkipUntil, SkipWhile, TakeUntil, and TakeWhileMathematical and Aggregate OperatorsAverage, Concat, Count, Max, Min, Reduce, and SumConverting ObservablesToConnectable Observable OperatorsConnect, Publish, RefCount, and ReplayBackpressure Operatorsæ‰§è¡Œç‰¹å®šçš„æµé‡æ§åˆ¶ç­–ç•¥çš„å„ç§è¿è¥å•† è¿é”è¿è¥å•†å¤§å¤šæ•°æ“ä½œç¬¦åœ¨å¯è§‚å¯Ÿåˆ°çš„å’Œè¿”å›ä¸€ä¸ªå¯è§‚å¯Ÿåˆ°çš„ã€‚è¿™å…è®¸ä½ åº”ç”¨è¿™äº›æ“ä½œç¬¦ä¸€ä¸ªæ¥ä¸€ä¸ªï¼Œåœ¨ä¸€ä¸ªé“¾ä¸­ã€‚é“¾ä¸­çš„æ¯ä¸ªæ“ä½œç¬¦éƒ½ä¿®æ”¹äº†å¯è§‚å¯Ÿåˆ°çš„ç»“æœï¼Œä»ä»¥å‰çš„æ“ä½œçš„æ“ä½œã€‚è¿˜æœ‰å…¶ä»–æ¨¡å¼ï¼Œå¦‚ç”Ÿæˆå™¨æ¨¡å¼ï¼Œå…¶ä¸­ä¸€ä¸ªç‰¹å®šç±»çš„å„ç§æ–¹æ³•é€šè¿‡ä¿®æ”¹è¯¥å¯¹è±¡çš„æ“ä½œæ¥ä¿®æ”¹è¯¥ç±»çš„ä¸€ä¸ªç±»ä¸Šçš„ä¸€ä¸ªé¡¹ç›®ã€‚è¿™äº›æ¨¡å¼ä¹Ÿå…è®¸ä½ ä»¥ç±»ä¼¼çš„æ–¹å¼é“¾çš„æ–¹æ³•ã€‚ä½†åœ¨ç”Ÿæˆå™¨æ¨¡å¼ä¸­ï¼Œåœ¨é“¾ä¸­å‡ºç°çš„æ–¹æ³•çš„é¡ºåºé€šå¸¸ä¸é‡è¦ï¼Œä¸å¯è§‚å¯Ÿåˆ°çš„è¿è¥å•†çš„è®¢å•äº‹å®œã€‚è§‚å¯Ÿåˆ°çš„æ“ä½œç¬¦çš„é“¾ä¸ç‹¬ç«‹äºåŸå§‹è§‚å¯Ÿåˆ°çš„èµ·æºé“¾ï¼Œä½†ä»–ä»¬åè¿‡æ¥æ“ä½œï¼Œæ¯ä¸€ä¸ªæ“ä½œä¸Šçš„è§‚å¯Ÿæ‰€äº§ç”Ÿçš„è¿è¥å•†ç«‹å³åœ¨å¤–é“¾ã€‚","categories":[{"name":"å¼€å‘å¸®åŠ©","slug":"å¼€å‘å¸®åŠ©","permalink":"http://www.msiter.com/categories/å¼€å‘å¸®åŠ©/"}],"tags":[{"name":"reactiv","slug":"reactiv","permalink":"http://www.msiter.com/tags/reactiv/"},{"name":"rxswift","slug":"rxswift","permalink":"http://www.msiter.com/tags/rxswift/"}],"keywords":[{"name":"å¼€å‘å¸®åŠ©","slug":"å¼€å‘å¸®åŠ©","permalink":"http://www.msiter.com/categories/å¼€å‘å¸®åŠ©/"}]},{"title":"Realm-cocoa å­¦ä¹ ","slug":"realm-cocoa å­¦ä¹ ","date":"2016-03-03T20:53:35.000Z","updated":"2017-11-28T11:07:04.831Z","comments":true,"path":"2016/03/03/realm-cocoa å­¦ä¹ /","link":"","permalink":"http://www.msiter.com/2016/03/03/realm-cocoa å­¦ä¹ /","excerpt":"PS:ä»¥ä¸‹å†…å®¹å‡ä¸ºé¡¹ç›®ä¸ºSwiftçš„åŸºç¡€ï¼Œå¦‚æœéœ€è¦Objectï¼cè¯·æŸ¥é˜…Realmçš„Objectï¼cæ–‡æ¡£ã€‚ å‰äº›æ—¥å­åœ¨çœ‹ç¬¬ä¸€å±Šã€Šä¸­å›½Swiftå¼€å‘è€…å¤§ä¼šã€‹çš„æ—¶å€™ï¼Œå¬åˆ°äº†realmè¿™ä¸ªæ•°æ®åº“ï¼Œè¯´åˆ°äº†è¿è¡Œé€Ÿåº¦æ–¹é¢ï¼Œç›¸è¾ƒäºCoreDataå¯ä»¥æœ‰å¾ˆå¤§çš„æå‡ã€‚å†åŠ ä¸Šä¹‹å‰åœ¨åšé¡¹ç›®çš„æ—¶å€™ï¼Œè§‰çš„coredataçš„å¾ˆå¤šé…ç½®è®©æˆ‘è§‰çš„ä¸çˆ½ï¼Œå¾ˆæ˜¯ç¹çã€‚æ‰€ä»¥å°±æƒ³çœ‹ä¸€çœ‹realmåˆ°åº•å¦‚ä½•ï¼Œå­¦ä¹ äº†ä¸€å¤©è§‰çš„å¾ˆå¥½ï¼Œå›ºå†³å®šè®°å½•ä¸€ä¸‹ã€‚å› ä¸ºä¹Ÿä¸çŸ¥é“æ€ä¹ˆè®²è§£ï¼Œæ‰€ä»¥æˆ‘ä¼šå°è¯•ç¿»è¯‘realmå®˜ç½‘çš„æ–‡æ¡£ï¼Œå†åŠ ä¸Šæˆ‘çš„ç†è§£è¿›è¡Œè§£é‡Šã€‚ Realm is a mobile databasehundreds of millions of people rely on","text":"PS:ä»¥ä¸‹å†…å®¹å‡ä¸ºé¡¹ç›®ä¸ºSwiftçš„åŸºç¡€ï¼Œå¦‚æœéœ€è¦Objectï¼cè¯·æŸ¥é˜…Realmçš„Objectï¼cæ–‡æ¡£ã€‚ å‰äº›æ—¥å­åœ¨çœ‹ç¬¬ä¸€å±Šã€Šä¸­å›½Swiftå¼€å‘è€…å¤§ä¼šã€‹çš„æ—¶å€™ï¼Œå¬åˆ°äº†realmè¿™ä¸ªæ•°æ®åº“ï¼Œè¯´åˆ°äº†è¿è¡Œé€Ÿåº¦æ–¹é¢ï¼Œç›¸è¾ƒäºCoreDataå¯ä»¥æœ‰å¾ˆå¤§çš„æå‡ã€‚å†åŠ ä¸Šä¹‹å‰åœ¨åšé¡¹ç›®çš„æ—¶å€™ï¼Œè§‰çš„coredataçš„å¾ˆå¤šé…ç½®è®©æˆ‘è§‰çš„ä¸çˆ½ï¼Œå¾ˆæ˜¯ç¹çã€‚æ‰€ä»¥å°±æƒ³çœ‹ä¸€çœ‹realmåˆ°åº•å¦‚ä½•ï¼Œå­¦ä¹ äº†ä¸€å¤©è§‰çš„å¾ˆå¥½ï¼Œå›ºå†³å®šè®°å½•ä¸€ä¸‹ã€‚å› ä¸ºä¹Ÿä¸çŸ¥é“æ€ä¹ˆè®²è§£ï¼Œæ‰€ä»¥æˆ‘ä¼šå°è¯•ç¿»è¯‘realmå®˜ç½‘çš„æ–‡æ¡£ï¼Œå†åŠ ä¸Šæˆ‘çš„ç†è§£è¿›è¡Œè§£é‡Šã€‚ Realm is a mobile databasehundreds of millions of people rely on æ•£è®°è¿™æ˜¯Realmå®˜ç½‘çš„å¯¹äºè‡ªå·±çš„è§£é‡Šã€‚ realmå¯ä»¥å¿«é€Ÿæœ‰æ•ˆçš„ç¼–å†™åº”ç”¨ç¨‹åºçš„æœ¬åœ°æŒä¹…åŒ–ï¼Œå®ƒçš„ä»£ç å¤§æ¦‚å°±æ˜¯ä¸‹é¢è¿™ä¸ªæ ·å­ï¼š // å…ˆåˆ›å»ºä¸€ä¸ªä½ æƒ³è¦æŒä¹…åŒ–çš„å¯¹è±¡çš„æ¨¡å‹ï¼ŒObject æ˜¯ Reaml è‡ªå·±å®šä¹‰çš„å¯¹è±¡ class Dog: Object { dynamic var name = \"\" dynamic var age = 0 } class Person: Object { dynamic var name = \"\" dynamic var picture: NSData? = nil // è¿™æ˜¯ä¸€ä¸ªå¯é€‰ç±»å‹ let dogs = List&lt;Dog>() } // è¿™æ˜¯å®ä¾‹åŒ–ä¸€ä¸ªRealmå¯¹è±¡çš„æ—¶å€™ï¼Œå°±åƒå’±ä»¬å¹³æ—¶åˆ›å»ºClasså¯¹è±¡ä¸€æ ·çš„ let myDog = Dog() myDog.name = \"Rex\" myDog.age = 1 print(\"name of dog: \\(myDog.name)\") // å¾—åˆ°ä¸€ä¸ªRealmå¯¹è±¡ let realm = try! Realm() // æŸ¥è¯¢è¿™ä¸ªç‹—å°äºä¸¤å²çš„ï¼Œå…¶å®å’±ä»¬çœ‹ç€ä»£ç å°±å¯ä»¥ç†è§£äº†ï¼Œå®ƒä½¿ç”¨äº†é“¾å¼ä»£ç ç»“æ„ï¼Œå¾ˆå®¹æ˜“çœ‹æ‡‚ let puppies = realm.objects(Dog).filter(\"age &lt; 2\") puppies.count // => 0 æ¯”å¦‚ç°åœ¨çš„åˆ°çš„æ•°ç›®æ˜¯0ï¼Œå› ä¸ºç°åœ¨å’±ä»¬è¿˜æ²¡æœ‰æ·»åŠ ä»»ä½•æ•°æ® // æŠŠå’±ä»¬çš„ä¸Šé¢åˆ›å»ºçš„ç‹—çš„å¯¹è±¡ï¼Œæ·»åŠ åˆ°æ•°æ®åº“ä¸­ try! realm.write { realm.add(myDog) } // å†æ¬¡æŸ¥çœ‹æ•°é‡çš„æ—¶å€™ï¼Œä¸éœ€è¦å†è¿›è¡Œä¸€æ¬¡æŸ¥è¯¢ï¼ŒRealmä¼šè‡ªåŠ¨çš„ä¸ºä½ å®Œæˆæ›´æ–° puppies.count // => 1 // ä½ ä¹Ÿå¯ä»¥æ›´æ–°ä½ çš„æ•°æ®å†…å®¹åœ¨ä»»ä½•çº¿ç¨‹ dispatch_async(dispatch_queue_create(\"background\", nil)) { let realm = try! Realm() let theDog = realm.objects(Dog).filter(\"age == 1\").first try! realm.write { theDog!.age = 3 } } æ•™ç¨‹é¡¹ç›®ä¸­å¦‚ä½•æ·»åŠ  Realm æ¡†æ¶ä¸»è¦æœ‰ä¸‹é¢çš„ä¸‰ç§é›†æˆæ–¹å¼ ä½¿ç”¨Dynamic Frameworkï¼š ä¸‹è½½Realmå®‰è£…åŒ…æœ€æ–°ç‰ˆæœ¬ æ ¹æ®ä½ çš„éœ€è¦ï¼Œå°†ä½ ä¸‹è½½æ–‡ä»¶è§£å‹åï¼Œ ä»/ios/swift-2.1.1ï¼ˆIOSè®¾å¤‡ï¼‰ æˆ–è€… tvos/ï¼ˆAppleç”µè§†è®¾å¤‡ï¼‰ å†æˆ–è€… osx/swift-2.1.1/ï¼ˆmacç”µè„‘è®¾å¤‡ï¼‰ è¿™ä¸‰ä¸ªç›®å½•ä¸­ï¼Œé€‰æ‹©è‡ªå·±éœ€è¦çš„æ–‡ä»¶ï¼Œå°†å…¶æ‹–å…¥é¡¹ç›®ä¸­ï¼Œå¹¶ä¸”è¦é€‰ä¸­â€œå¦‚æœéœ€è¦è¯·å‹¾é€‰â€é€‰é¡¹ åœ¨ä½ çš„é¡¹ç›®ä¸­ Build Settings ï¼Œä¸ºFramework Search Paths è®¾ç½®ealmSwift.framework è·¯å¾„ å¦‚æœä½¿ç”¨Realm åœ¨ IOSï¼ŒwatchOSæˆ–è€…TvOSï¼Œåœ¨Build Phase åˆ›å»ºä¸€ä¸ªæ–°çš„ â€œRun Script Phaseâ€ï¼Œä¸‹é¢å†™ä¸Šbash &quot;${BUILT_PRODUCTS_DIR}/${FRAMEWORKS_FOLDER_PATH}/Realm.framework/strip-frameworks.sh&quot;è¿™ä¸€æ­¥æ˜¯éœ€è¦è§£å†³åº”ç”¨ç¨‹åºå•†åº—æäº¤bugæ—¶å­˜æ¡£é€šç”¨äºŒè¿›åˆ¶æ–‡ä»¶ã€‚ä½¿ç”¨CocoaPods å®‰è£…CocoaPods0.39.0 ç‰ˆæœ¬æˆ–è€…æ›´æ–°çš„ç‰ˆæœ¬. åœ¨ä½ çš„Podfileæ–‡ä»¶ä¸­æ·»åŠ use_frameworks! å’Œ pod &#39;RealmSwift&#39; åœ¨ç»ˆç«¯ä¸­è¿è¡Œ pod install æ‰“å¼€ ï¼Š.xcworkspace é¡¹ç›®ä½¿ç”¨Carthage å®‰è£… Carthage 0.9.2 æˆ–è€…æ›´æ–°çš„ç‰ˆæœ¬ åœ¨ä½ çš„Cartfileæ–‡ä»¶ä¸­æ·»åŠ &quot;realm/realm-cocoa&quot; è¿è¡Œ carthage update. ä» Carthage/Build/ æ‹–æ‹½RealmSwift.framework å’Œ Realm.framework åˆ° General ä¸‹é¢çš„â€œEmbedded Binariesâ€ iOS/watchOS/tvOS: åœ¨ä½ çš„é¡¹ç›®targetsçš„ â€œBuild Phasesâ€è®¾ç½®é¡¹ä¸­ï¼Œç‚¹å‡»â€œï¼‹â€å¥½æŒ‰é’®ï¼Œæ·»åŠ ä¸€ä¸ªæ–°çš„â€œNew Run Script Phaseâ€ï¼Œå†…å®¹å¦‚ä¸‹/usr/local/bin/carthage copy-frameworkså’Œè·¯å¾„æ·»åŠ åˆ°æ¡†æ¶ä¸‹æ‚¨æƒ³è¦ä½¿ç”¨â€œè¾“å…¥æ–‡ä»¶â€,å¦‚$(SRCROOT)/Carthage/Build/iOS/Realm.framework,$(SRCROOT)/Carthage/Build/iOS/RealmSwift.frameworkè¿™ä¸ªè„šæœ¬æ˜¯åœ¨åº”ç”¨ç¨‹åºå•†åº—æäº¤é”™è¯¯å¼•å‘äº†æ™®éçš„äºŒè¿›åˆ¶æ–‡ä»¶ã€‚ç¡®ä¿è¿™ä¸€é˜¶æ®µå,â€œåµŒå…¥æ¡†æ¶â€é˜¶æ®µã€‚ åˆ›å»ºæ•°æ®æ¨¡å‹ æ–¹ä¾¿å¿«æ·çš„åˆ›å»ºRealmæ¨¡å‹é¦–å…ˆéœ€è¦å®‰è£…Alcatraz,åœ¨ç»ˆç«¯é‡Œé¢æ‰§è¡Œä»¥ä¸‹å‘½ä»¤.å¦‚æœæ‰§è¡Œå¤±è´¥ï¼Œè¯·ç¿»å¢™ååœ¨å°è¯• curl -fsSL https://raw.githubusercontent.com/supermarin/Alcatraz/deploy/Scripts/install.sh | sh å®‰è£…å®Œæˆä¹‹åï¼Œé‡å¯xcodeå°±å¯ä»¥åœ¨èœå•windowé€‰é¡¹ä¸‹é¢çœ‹åˆ°ä¸€ä¸ªPackage Manager é€‰é¡¹ï¼Œç‚¹å‡» å®‰è£…package ï¼Œæœç´¢ Xcode Plugin ï¼Œä¹‹åï¼Œå†é‡å¯ã€‚åˆ›å»ºåˆ›å»ºæ–‡ä»¶ï¼Œå°±å¯ä»¥æ–‡ä»¶ç±»å‹ä¸­æœ‰ä¸€ä¸ªRealmé€‰é¡¹ï¼Œç‚¹å‡»åˆ›å»ºã€‚ä¹‹åç”Ÿæˆæ–‡ä»¶ï¼ ä½ ä¼šå‘ç°ï¼ï¼SHITï¼ï¼ï¼ï¼ï¼æˆ‘ä¸å¦‚è‡ªå·±å†™äº†ï¼ï¼ï¼ï¼ï¼ï¼ï¼ åˆ›å»ºRealm æ•°æ®æ¨¡å‹å…¶å®åˆ›å»ºRealmæ•°æ®æ¨¡å‹çš„æ–¹æ³•è¶…çº§ç®€å•ï¼Œå°±å’Œå’±ä»¬å¹³æ—¶åˆ›å»ºClassæ˜¯ä¸€æ ·ä¸€æ ·çš„ã€‚ import RealmSwift // ç‹—çš„æ•°æ®æ¨¡å‹ class Dog: Object { dynamic var name = \"\" dynamic var owner: Person? // ç‹—çš„ä¸»äººæ˜¯å¯ä»¥ä¸ºç©ºçš„ } ä½†æ˜¯ï¼Œåœ¨ä»¬å¿…é¡»çŸ¥é“ä»–éƒ½å…è®¸å’±ä»¬åˆ›å»ºä»€ä¹ˆç±»å‹çš„æ•°æ®ã€‚ è¿™æ ·å­å’±ä»¬åˆ›å»ºæ•°æ®æ¨¡å‹çš„æ—¶å€™å°±æ²¡æœ‰é—®é¢˜äº†å§ã€‚å½“ç„¶Realmæ˜¯æ”¯æŒç»‘å®šå…³ç³»çš„ã€‚ä¸€å¯¹ä¸€ï¼Œä¸€å¯¹å¤šä¹‹ç±»çš„ï¼Œéƒ½å¯ä»¥çš„ã€‚ æ•°æ®çš„æ“ä½œ å‘Realmæ’å…¥æ•°æ®ç»ˆäºè¿æ¥äº†ï¼Œå’±ä»¬çš„å¢åˆ æ”¹æŸ¥äº†ã€‚ å½“ä½ å®šä¹‰ä¸€ä¸ªæ¨¡å‹ä½ å¯ä»¥å®ä¾‹åŒ–å¯¹è±¡å­ç±»å’Œæ–°å®ä¾‹æ·»åŠ åˆ°åŸŸã€‚è€ƒè™‘ä¸€ä¸‹è¿™ä¸ªç®€å•çš„æ¨¡å‹: class Dog: Object { dynamic var name = \"\" dynamic var age = 0 } æˆ‘ä»¬å¯ä»¥ä»¥ä¸‹å‡ ä¸ªæ–¹å¼åˆ›å»ºå¯¹è±¡: // (1) å…ˆåˆ›å»ºç‹—çš„å¯¹è±¡ï¼Œç„¶ååœ¨ç»™äºˆå…¶èµ‹å€¼ var myDog = Dog() myDog.name = \"Rex\" myDog.age = 10 // (2) ä½¿ç”¨å­—å…¸åˆ›å»º let myOtherDog = Dog(value: [\"name\" : \"Pluto\", \"age\": 3]) // (3) ä½¿ç”¨ä¸€ä¸ªArrayåˆ›å»ºyã€‚ let myThirdDog = Dog(value: [\"Fido\", 5]) 1.æœ€æ˜¾è€Œæ˜“è§çš„å°±æ˜¯ ç›´æ¥åˆ›å»ºå¯¹è±¡ï¼Œå¹¶ä¸”èµ‹å€¼2.ä¹Ÿå¯ä»¥ä½¿ç”¨å­—å…¸å®ä¾‹åŒ–å¯¹è±¡ï¼Œä½†æ˜¯ï¼è¦ä½¿ç”¨æ•°æ®æ¨¡å‹ä¸­å¯¹åº”çš„ï¼çš„é”®å’Œå€¼ã€‚3.æœ€å,å¯ä»¥ä½¿ç”¨æ•°ç»„å®ä¾‹åŒ–å¯¹è±¡ã€‚ä½†æ˜¯è¦æ³¨æ„ï¼æ•°ç»„ä¸­çš„å€¼ï¼Œå¿…é¡»å’Œæ•°æ®æ¨¡å‹ä¸­çš„å±æ€§çš„é¡ºåºä¿æŒä¸€è‡´ åˆ›å»ºå®Œæˆå¯¹è±¡ä¹‹åå°±æ˜¯æŠŠå®ƒæ”¾å…¥æ•°æ®åº“é‡Œé¢äº†ï¼Œä½ å¯ä»¥åƒä¸‹é¢çš„æ–¹æ³•ä¸€æ ·æ”¾è¿›æ•°æ®åº“ // åˆ›å»ºä¸€ä¸ªç”¨æˆ·å¯¹è±¡ï¼Œå¹¶ä¸”èµ‹å€¼ let author = Person() author.name = \"David Foster Wallace\" // å¾—åˆ°é»˜è®¤çš„Realmå¯¹è±¡ let realm = try! Realm() // ä½ åªéœ€è¦è¿™ä¹ˆåšä¸€æ¬¡ // æ·»åŠ è¿™ä¸ªå¯¹è±¡åˆ°Realm try! realm.write { realm.add(author) } è¿™æ ·å°±åœ¨æ•°æ®åº“ä¸­ï¼Œæ·»åŠ äº†ä¸€ä¸ªå¯¹è±¡äº†ã€‚ Realmä¿®æ”¹æ•°æ®Realm æä¾›å¾ˆå¤šæ–¹å¼å»ä¿®æ”¹æ•°æ®ï¼Œè¯·é€‰æ‹©é€‚åˆè‡ªå·±çš„æ–¹å¼è¿›è¡Œä¿®æ”¹ Typed Updatesä½ å¯ä»¥ä¿®æ”¹ä»»ä½•å¯¹è±¡çš„å±æ€§ï¼Œåœ¨writeè¿›ç¨‹ä¸­ // Update an object with a transaction try! realm.write { author.name = \"Thomas Pynchon\" } æ ¹æ®æ•°æ®çš„ä¸»é”®è¿›è¡Œä¿®æ”¹é‡å†™æ•°æ®æ¨¡å‹çš„Object.primaryKey()æ–¹æ³•å¯ä»¥è®¾ç½®æ¨¡å‹çš„ä¸»é”®ï¼Œå£°æ˜ä¸€ä¸ªä¸»é”®ï¼Œå…è®¸å¯¹è±¡å¯ä»¥é€šè¿‡ä¸»é”®è¿›è¡Œæœ‰æ•ˆçš„æŸ¥è¯¢å’Œä¿®æ”¹ï¼Œå¹¶å¼ºåˆ¶æ¯ä¸ªå€¼çš„å”¯ä¸€æ€§ã€‚ä¸€æ—¦ä¸€ä¸ªå¯¹è±¡æ·»åŠ åˆ°Realmï¼Œä¸»é”®å°±ä¸èƒ½æ›´æ”¹ class Book: Object { dynamic var id = 0 dynamic var price = 0 dynamic var title = \"\" override static func primaryKey() -> String? { return \"id\" } } å› ä¸ºè¿™ä¸ªæ•°æ®æ¨¡å‹å«æœ‰ä¸»é”®ï¼Œæ‰€ä»¥å†å‘Realmæ·»åŠ ä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œå¦‚æœå·²ç»å­˜åœ¨åŒæ ·ä¸»é”®çš„å¯¹è±¡æ—¶ï¼ŒRealmä¼šè‡ªåŠ¨æ›´æ–°å‰ä¸€ä¸ªæ•°æ®çš„å…¶å®ƒä¸ä¸€æ ·çš„å±æ€§ã€‚è€Œå¦‚æœä¸å­˜åœ¨è¿™ä¸ªä¸»é”®çš„å¯¹è±¡ï¼ŒRealmä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„å¯¹è±¡ // å‡è®¾Realmä¸­å­˜åœ¨ä¸€ä¸ªä¸»é”®ä¸º1çš„å¯¹è±¡çš„æ—¶å€™ let cheeseBook = Book() cheeseBook.title = \"Cheese recipes\" cheeseBook.price = 9000 cheeseBook.id = 1 // id==1ï¼Œä¿®æ”¹è¿™ä¸ªä¹¦çš„å±æ€§ try! realm.write { realm.add(cheeseBook, update: true) } ä½ ä¹Ÿå¯ä»¥é€šè¿‡ä¸€ä¸ªå­—å…¸çš„æ–¹å¼ï¼ŒæŒ‡å®šä¸»é”®å’Œä½ è¦ä¿®æ”¹çš„å±æ€§ï¼Œæ¥è¿›è¡Œä¿®æ”¹ç”¨æˆ· // å‡è®¾æ•°æ®åº“ä¸­å·²ç»å­˜åœ¨ä¸€ä¸ªä¸»é”®ä¸º1çš„Bookæ—¶ try! realm.write { realm.create(Book.self, value: [\"id\": 1, \"price\": 9000.0], update: true) // the book's `title` property will remain unchanged. } ä¿®æ”¹å¤§æ‰¹é‡æ•°æ®å¯ä»¥è·å–ä¸€ç¾¤æ•°æ®åï¼ŒæŒ‡å®šè¿™äº›æ•°æ®å…¶ä¸­çš„æŸäº›æ•°æ®ï¼Œæˆ–è€…å…¨éƒ¨æ•°æ®ã€‚ çš„æŸä¸€æ­‡å±æ€§å€¼ã€‚ let persons = realm.objects(Person) try! realm.write { // è®¾ç½®ç¬¬ä¸€ä¸ªäººçš„ isFirstå¯¹è±¡ä¸ºTrue persons.first?.setValue(true, forKeyPath: \"isFirst\") // æŠŠæ¯ä¸ªäººçš„æ‰€å±…ä½çš„è¡Œæ˜Ÿï¼Œè®¾ç½®ä¸ºåœ°çƒ persons.setValue(\"Earth\", forKeyPath: \"planet\") } Realmåˆ é™¤æ•°æ®å½“ç”¨æˆ·æƒ³åˆ é™¤æŸä¸€ä¸ªå¯¹è±¡çš„æ—¶å€™ï¼ŒæŸ¥è¯¢å‡ºæ¥ï¼Œä¹‹åï½ // let cheeseBook = ... Book stored in Realm //åˆ é™¤ä¸€ä¸ªå¯¹è±¡ï¼Œåœ¨Wirteäº¤æ˜“ä¸­ã€‚ try! realm.write { realm.delete(cheeseBook) } ä½ ä¹Ÿå¯ä»¥åˆ é™¤Realmä¸­çš„å…¨éƒ¨æ•°æ®ï¼Œè¿™å¾ˆå¿«é€Ÿ // åˆ é™¤Realmä¸­æ‰€æœ‰çš„å¯¹è±¡ try! realm.write { realm.deleteAll() } RealmæŸ¥è¯¢æ•°æ®Realmç§°ä¸ºè¿™ä¹ˆå—æ¬¢è¿çš„æ•°æ®åº“çš„åŸå› æ¥äº†ï¼å’±ä»¬çœ‹å¥¹ä»¬å®˜æ–¹çš„è§£é‡Šã€‚ Queries return a Results instance, which contains a collection of Objects. Results have an interface very similar to Array and objects contained in a Results can be accessed using indexed subscripting. Unlike Arrays, Results only hold Objects of a single subclass type. æŸ¥è¯¢è¿”å›ä¸€ä¸ªç»“æœå®ä¾‹ï¼Œå®ƒåŒ…å«ä¸€ä¸ªå¯¹è±¡é›†åˆã€‚ç»“æœç±»ä¼¼äºArrayä¸€æ ·çš„ä¸œè¥¿ï¼Œå¯ä»¥ä½¿ç”¨ä¸‹æ ‡æ¥è¿›è¡Œæ¯ä¸€ä¸ªæ•°æ®çš„è®¿é—®ã€‚å’ŒArraysä¸ä¸€æ ·çš„åœ°æ–¹åœ¨äº,æŸ¥è¯¢ç»“æœåªæŒæœ‰ä¸€ç§ç±»å‹çš„å¯¹è±¡ã€‚ All queries (including queries and property access) are lazy in Realm. Data is only read when the properties are accessed. åœ¨Realmä¸­ï¼Œæ‰€æœ‰çš„æŸ¥è¯¢ï¼ˆè¿™é‡Œé¢åŒ…æ‹¬äº†æŸ¥è¯¢å’Œå±æ€§çš„è®¿é—®ï¼‰éƒ½æ˜¯æ‡’åŠ è½½çš„ã€‚æ•°æ®ä»…ä»…åœ¨æ•°æ®è®¿é—®çš„æ—¶å€™å†è¿›è¡Œå”¯ä¸€çš„ä¸€æ¬¡è¯»å– é‚£ä¹ˆå°±è®©æˆ‘ä»¬æ¥è¯•è¯•å§ã€‚ let dogs = realm.objects(Dog) // è¿™æ ·å­å°±æŸ¥è¯¢äº†Realmæ•°æ®åº“ä¸­æ‰€æœ‰çš„ç‹— æ¡ä»¶ç­›é€‰å¦‚æœä½ ç†Ÿæ‚‰nspredicateï¼Œé‚£ä¹ˆä½ å·²ç»åˆ°äº†æŒ‡å¯¼å¦‚ä½•æŸ¥è¯¢çš„å¢ƒç•Œã€‚å¯¹è±¡ã€Realmsï¼Œåˆ—è¡¨ï¼Œå’Œç»“æœéƒ½æä¾›äº†æ–¹æ³•ï¼ŒæŸ¥è¯¢ä¸€ä¸ªç»“æœArrays å¯ä»¥ä¼ é€’ä¸€ä¸ªnspredicateå®ä¾‹ï¼Œè°“è¯å­—ç¬¦ä¸²ï¼Œæˆ–è°“æ ¼å¼å­—ç¬¦ä¸²ã€‚ä¾‹å¦‚ï¼Œæ£€ç´¢æ‰€æœ‰ç‹—çš„é¢œè‰²æ£•è¤è‰²å’Œåå­—é¦–â€œBâ€ä»é»˜è®¤çš„å¢ƒç•Œï¼š // æŸ¥è¯¢ä½¿ç”¨è°“è¯å­—ç¬¦ä¸² var tanDogs = realm.objects(Dog).filter(\"color = 'tan' AND name BEGINSWITH 'B'\") // æŸ¥è¯¢ä½¿ç”¨ NSPredicate å®ä¾‹ let predicate = NSPredicate(format: \"color = %@ AND name BEGINSWITH %@\", \"tan\", \"B\") tanDogs = realm.objects(Dog).filter(predicate) çœ‹åˆ°è‹¹æœçš„è°“è¯ç¼–ç¨‹æŒ‡å—å»ºç«‹è°“è¯çš„æ›´å¤šä¿¡æ¯å’Œä½¿ç”¨æˆ‘ä»¬çš„nspredicateåˆ—è¡¨ã€‚é¢†åŸŸæ”¯æŒè®¸å¤šå…±åŒçš„è°“è¯ï¼š æ¯”è¾ƒæ“ä½œæ•°å¯ä»¥æ˜¯å±æ€§åç§°æˆ–å¸¸é‡ã€‚è‡³å°‘ä¸€ä¸ªæ“ä½œæ•°å¿…é¡»æ˜¯ä¸€ä¸ªå±æ€§åã€‚ æ¯”è¾ƒè¿ç®—ç¬¦= =ï¼Œ&lt;ï¼Œ&gt; =ï¼Œ&gt;ï¼Œï¼=ï¼Œæ”¯æŒInt, Int8, Int16, Int32, Int64, Float, Double å’Œ NSDate å±æ€§ç±»å‹ã€‚å¦‚: age == 45 èº«ä»½æ¯”è¾ƒ == ï¼Œ!= ï¼ŒResults&lt;Employee&gt;().filter(&quot;company == %@&quot;, company) æ¯”è¾ƒè¿ç®—ç¬¦ = å’Œ != éœ€è¦Boolå±æ€§çš„æ”¯æŒã€‚ å­—ç¬¦ä¸²å’ŒNSDataæ€§è´¨ï¼Œæˆ‘ä»¬æˆ‘ä»¬æ”¯æŒ ==, !=,BEGINSWITH,CONTAINS, andENDSWITH ï¼Œå¦‚åç§°ä¸­ CONTAINS â€˜Jaâ€™ ä¸åŒºåˆ†å¤§å°å†™çš„æ¯”è¾ƒå­—ç¬¦ä¸²ï¼Œå¦‚:CONTAINS[c] â€˜Jaâ€™ã€‚è¯·æ³¨æ„åªæœ‰å­—ç¬¦A-Zå’Œa-zä¼šè¢«å¿½ç•¥ã€‚ Realmæ”¯æŒä»¥ä¸‹å¤åˆæ“ä½œï¼š: AND, OR, and NOT. ä¾‹å¦‚ï¼šname BEGINSWITH â€˜Jâ€™ AND age &gt;= 32 åŒ…å«æ“ä½œç¬¦å· INï¼Œ å¦‚ åå­— name IN {â€˜Lisaâ€™, â€˜Spikeâ€™, â€˜Hachiâ€™} æˆ‘ä»¬å¯ä»¥æ¯”è¾ƒå±æ€§æ˜¯å¦ä¸ºç©ºï¼Œå¦‚ï¼šResults&lt;Company&gt;().filter(&quot;ceo == nil&quot;).æ³¨æ„ï¼Œå¢ƒç•ŒæŠŠNilä½œä¸ºä¸€ä¸ªç‰¹æ®Šçš„å€¼è€Œä¸æ˜¯ä¸€ä¸ªå±æ€§çš„ç¼ºå¤±ï¼Œæ‰€ä»¥ä¸åƒSQLé›¶ç­‰äºæœ¬èº«ã€‚ ä»»ä½•çš„æ¯”è¾ƒï¼Œå¦‚æœ‰ student.ageï¼œ21 èšåˆè¡¨è¾¾å¼@count, @min, @max, @sum å’Œ @avgRealméƒ½æ”¯æŒã€‚ä¾‹å¦‚ï¼šrealm.objects(Company).filter(&quot;employees.@count &gt; 5&quot;)ã€‚æ‰¾åˆ°æ‰€æœ‰å‘˜å·¥åœ¨äº”ä¸ªä»¥ä¸Šçš„å…¬å¸ å­æŸ¥è¯¢çš„é™åˆ¶å’Œæ”¯æŒï¼š @countåœ¨å­æŸ¥è¯¢è¡¨è¾¾å¼æ˜¯å”¯ä¸€çš„ã€‚ SUBQUERY(â€¦).@countå¿…é¡»å’Œä¸€ä¸ªå¸¸é‡è¿›è¡Œæ¯”è¾ƒ ç›¸å…³å­æŸ¥è¯¢ç°åœ¨è¿˜ä¸æ”¯æŒ æ’åºç»“æœå…è®¸æ‚¨åœ¨ä¸€ä¸ªæˆ–å¤šä¸ªå±æ€§çš„åŸºç¡€ä¸ŠæŒ‡å®šä¸€ä¸ªæ’åºæ ‡å‡†å’Œé¡ºåºã€‚ä¾‹å¦‚ï¼Œä¸‹é¢çš„ä¾‹å­ä¸­ç‹—æŒ‰ç…§åå­—æ¥è¿›è¡Œæ’åºè¿”å›ï¼š let sortedDogs = realm.objects(Dog).filter(\"color = 'tan' AND name BEGINSWITH 'B'\").sorted(\"name\") é“¾å¼æŸ¥è¯¢Realm å’Œå…¶å®ƒçš„æŸ¥åŒºåˆ«åœ¨äºï¼Œä»–æ¯ä¸€ä¸ªæŸ¥è¯¢ç»“æœéƒ½æ‹¥æœ‰ç»§ç»­æŸ¥è¯¢çš„èƒ½åŠ›ï¼Œè¿™æ ·ç”¨æˆ·å°±å¯ä»¥å¯¹è‡ªå·±æŸ¥è¯¢çš„ç»“æœè¿›è¡Œè¿›ä¸€æ­¥çš„è¯¢é—®ã€‚ä¾‹å¦‚ï¼šæˆ‘ä»¬å…ˆæŸ¥æ‰¾äº†ä¸€ç¾¤æ£•è‰²çš„ç‹—ï¼Œä¹‹ååˆæƒ³æŸ¥è¯¢å¤„å…¶ä¸­åå­—ä»¥â€œBâ€å¼€å¤´çš„ç‹—ã€‚ let tanDogs = realm.objects(Dog).filter(\"color = 'tan'\") let tanDogsWithBNames = tanDogs.filter(\"name BEGINSWITH 'B'\") Realmç‰ˆæœ¬è¿ç§»å…¶å®ä¸€èˆ¬çš„ç‰ˆæœ¬è¿ç§»æœ‰ä¸¤ç§æƒ…å†µï¼Œç¬¬ä¸€ç§ã€‚åˆ é™¤äº†æŸäº›å­—æ®µ class Person: Object { dynamic var firstName = \"\" dynamic var lastName = \"\" dynamic var age = 0 } To: class Person: Object { dynamic var fullName = \"\" dynamic var age = 0 } æ¥ä¸‹æ¥ï¼Œä½ å°†è¿›è¡Œ // åœ¨ä½ çš„(application:didFinishLaunchingWithOptions:) let config = Realm.Configuration( // è®¾ç½®ä¸€ä¸ªæ–°çš„ç‰ˆæœ¬ï¼Œå¦‚æœä½ ä»æ¥æ²¡æœ‰è®¾ç½®è¿‡ç‰ˆæœ¬ï¼Œé‚£ä¹ˆé»˜è®¤ç‰ˆæœ¬å°±æ˜¯0 schemaVersion: 1, /// è®¾ç½®ä¸€ä¸ªæ‰¾åˆ°ä¸ä¸€æ ·ç‰ˆæœ¬çš„å›è°ƒæ–¹æ³• migrationBlock: { migration, oldSchemaVersion in // å› ä¸ºæˆ‘ä»¬æ²¡æœ‰è®¾ç½®è¿‡ç‰ˆæœ¬ï¼Œæ‰€ä»¥ oldSchemaVersion &lt; 1 if (oldSchemaVersion &lt; 1) { // ä»€ä¹ˆéƒ½ä¸ç”¨åš // Realm å°†è‡ªåŠ¨æ£€æµ‹æ–°çš„å±æ€§å’Œåˆ é™¤çš„å±æ€§ // å¹¶ä¼šè‡ªåŠ¨æ›´æ–°ç£ç›˜æ¨¡å¼ } }) // å‘Šè¯‰Realm ä½¿ç”¨è¿™ä¸ªæ–°çš„é…ç½®ä½œä¸ºé»˜è®¤é…ç½® Realm.Configuration.defaultConfiguration = config // æ¥ä¸‹æ¥å°±è®©æˆ‘ä»¬è·å¾—é»˜è®¤çš„å¯¹è±¡å§ let realm = try! Realm() è€Œå¦‚æœä½ æ·»åŠ äº†ä¸€äº›å­—æ®µï¼Œæ¯”å¦‚å’±ä»¬ä¸æƒ³è¦FirstNameå’ŒLastNameäº†ï¼Œæˆ‘ä»¬å¸Œæœ›ä»–å˜æˆä¸€ä¸ªå­—æ®µï¼fullNameï¼ // åœ¨ä½ çš„(application:didFinishLaunchingWithOptions:) Realm.Configuration.defaultConfiguration = Realm.Configuration( schemaVersion: 1, migrationBlock: { migration, oldSchemaVersion in if (oldSchemaVersion &lt; 1) { // æšä¸¾æ‰€æœ‰çš„å±æ€§ migration.enumerate(Person.className()) { oldObject, newObject in // ä»æ—§çš„å¯¹è±¡ä¸­è·å–ä¹‹å‰å­˜å‚¨çš„ä¸œè¥¿ let firstName = oldObject![\"firstName\"] as! String let lastName = oldObject![\"lastName\"] as! String // è®¾ç½®åˆ°æ–°çš„å¯¹è±¡ä¸­çš„å±æ€§ä¸Šå» newObject![\"fullName\"] = \"\\(firstName) \\(lastName)\" } } }) è¿˜æœ‰ä¸€ç§æƒ…å†µï¼šä»ç‰ˆæœ¬0 ç›´æ¥ å‡åˆ° ç‰ˆæœ¬2 Realm.Configuration.defaultConfiguration = Realm.Configuration( schemaVersion: 2, migrationBlock: { migration, oldSchemaVersion in // The enumerateObjects:block: method iterates // over every 'Person' object stored in the Realm file migration.enumerate(Person.className()) { oldObject, newObject in // Add the `fullName` property only to Realms with a schema version of 0 if oldSchemaVersion &lt; 1 { let firstName = oldObject![\"firstName\"] as! String let lastName = oldObject![\"lastName\"] as! String newObject![\"fullName\"] = \"\\(firstName) \\(lastName)\" } // Add the `email` property to Realms with a schema version of 0 or 1 if oldSchemaVersion &lt; 2 { newObject![\"email\"] = \"\" } } }) // Realm will automatically perform the migration and opening the Realm will succeed let realm = try! Realm() Realmæ•°æ®å˜åŒ–é€šçŸ¥ç»“æœæˆ–åˆ—è¡¨æ˜¯é€šè¿‡è°ƒç”¨addnotificationblockæ–¹æ³•åœ¨å…¶æ•°å€¼å‘ç”Ÿå˜åŒ–çš„æ—¶å€™ç»™äºˆé€šçŸ¥è¿™æ˜¯å¯èƒ½çš„ã€‚æ¯ä¸€æ¬¡å†™äº‹åŠ¡æäº¤æ—¶ï¼Œåœ¨å…¶ä»–çº¿ç¨‹ä¸Šçš„å…¶ä»–çº¿ç¨‹å‘é€é€šçŸ¥åˆ°å…¶ä»–å®ä¾‹ï¼š // æ³¨å†Œé€šçŸ¥ let token = realm.addNotificationBlock { notification, realm in viewController.updateUI() } // ç¨å token.stop() å½“ç„¶ä½ ä¹Ÿå¯ä»¥æ³¨å†ŒæŸä¸€èŒƒå›´çš„æ•°å€¼å‘ç”Ÿå˜åŒ–çš„æ—¶å€™ï¼Œè¿›è¡Œç»™äºˆé€šçŸ¥ // å¤§äº5å²çš„äººå¹´çºªå‘ç”Ÿå˜åŒ–çš„æ—¶å€™è¿›è¡Œç»Ÿæ²» let token = realm.objects(Person).filter(\"age > 5\").addNotificationBlock { results, error in // results å°±å·²ç»æ˜¯ `realm.objects(Person).filter(\"age > 5\")`çš„ç»“æœé›†äº† viewController.updateUI() } // ç¨å token.stop() å…¶å®ƒæ›´è¯¦ç»†çš„æ–‡æ¡£è¯·è®¿é—® Realmï¼Swiftæ–‡æ¡£","categories":[{"name":"IOS","slug":"IOS","permalink":"http://www.msiter.com/categories/IOS/"}],"tags":[{"name":"DB","slug":"DB","permalink":"http://www.msiter.com/tags/DB/"},{"name":"realm","slug":"realm","permalink":"http://www.msiter.com/tags/realm/"}],"keywords":[{"name":"IOS","slug":"IOS","permalink":"http://www.msiter.com/categories/IOS/"}]},{"title":"IOS Tips å°é›†åˆ","slug":"IOS Tips å°é›†åˆ","date":"2015-08-10T20:53:35.000Z","updated":"2017-11-28T11:07:04.827Z","comments":true,"path":"2015/08/10/IOS Tips å°é›†åˆ/","link":"","permalink":"http://www.msiter.com/2015/08/10/IOS Tips å°é›†åˆ/","excerpt":"IOSæŠ€å·§ï¼Œåœ¨å·¥ä½œå­¦ä¹ ä¸­é‡åˆ°çš„ä¸€äº›æœ‰ç‚¹æ„æ€çš„å°æŠ€å·§ï¼Œè®°å½•åœ¨åœ¨è¿™é‡Œ","text":"IOSæŠ€å·§ï¼Œåœ¨å·¥ä½œå­¦ä¹ ä¸­é‡åˆ°çš„ä¸€äº›æœ‰ç‚¹æ„æ€çš„å°æŠ€å·§ï¼Œè®°å½•åœ¨åœ¨è¿™é‡Œ ä»£ç è®°å½•è·å–çŠ¶æ€æ  ///è·å–çŠ¶æ€æ  private func JZStatusBar() -> UIView?{ var object = UIApplication.sharedApplication(),statusBar:UIView? if object.respondsToSelector(NSSelectorFromString(\"statusBar\")) { statusBar = object.valueForKey(\"statusBar\") as? UIView } return statusBar } åŠ¨æ€æ˜¾ç¤ºè§†å›¾///æŒ‰é’®æ‰©å±•ç±» @IBDesignable class borderImageView:UIButton{ /// è®¾ç½®è¾¹æ¡†å®½åº¦ @IBInspectable var borderWidth:CGFloat = 0 { didSet{ self.layer.borderWidth = borderWidth } } /// è®¾ç½®è¾¹æ¡†é¢œè‰² @IBInspectable var borderColor:UIColor = UIColor.blackColor() { didSet{ self.layer.borderColor = borderColor.CGColor } } /// è®¾ç½®åœ†å½¢å¼§åº¦ @IBInspectable var cornerRadius:CGFloat = 0{ didSet{ self.layer.cornerRadius = cornerRadius } } } æ£€æµ‹é”®ç›˜å¼¹èµ·éšè—func resignNotification(){ NSNotificationCenter.defaultCenter().addObserver(self, selector: \"keyboardShow:\", name: UIKeyboardWillShowNotification, object: nil) NSNotificationCenter.defaultCenter().addObserver(self, selector: \"keyboardHide:\", name: UIKeyboardWillHideNotification, object: nil) } //é€šçŸ¥ä¸­å¿ƒé€šçŸ¥é”®ç›˜è¦å‡ºç°äº†ï¼ ğŸ˜³ å…¨å‘˜æˆ’å¤‡ï¼ func keyboardShow(note:NSNotification){ if let info = note.userInfo { let keyboardFrame:CGRect = (info[UIKeyboardFrameEndUserInfoKey] as! NSValue).CGRectValue() let deltay:CGFloat = keyboardFrame.size.height as CGFloat self.InputBackViewBottomSpaceConstraint.constant = deltay self.view.layoutIfNeeded() } } //é€šçŸ¥ä¸­å¿ƒé€šçŸ¥é”®ç›˜è¦æ¶ˆå¤±äº† ğŸ˜„ è§£æ•£~ åº†åŠŸå®´~~ func keyboardHide(note:NSNotification){ self.InputBackViewBottomSpaceConstraint.constant = 0 self.view.layoutIfNeeded() } å•ä¾‹æ¨¡å¼ /// è·å–å•ä¾‹æ¨¡å¼ä¸‹çš„UIStoryBoardå¯¹è±¡ class var shareWelComeStoryBoard:UIStoryboard!{ get{ struct backTaskLeton{ static var predicate:dispatch_once_t = 0 static var bgTask:UIStoryboard? = nil } dispatch_once(&amp;backTaskLeton.predicate, { () -> Void in backTaskLeton.bgTask = UIStoryboard(name: \"WelCome\", bundle: NSBundle.mainBundle()) }) return backTaskLeton.bgTask } } è·å–å½“å‰æ˜¾ç¤ºçš„UIViewControllerextension UIViewController{ class func getCurrentViewController() -> UIViewController?{ if let rootViewController = UIApplication.sharedApplication().keyWindow?.rootViewController{ var topViewController = rootViewController while let present = topViewController.presentedViewController{ topViewController = present } return topViewController } return nil } } /// è°ƒç”¨æ–¹æ³•å¦‚ä¸‹ if let currentViewController = UIViewController.getCurrentViewController(){ //// ç•¥ } åˆ¤æ–­æ˜¯å¦åœ¨å‰å° /// å¤„äºå‰å° if application.applicationState == UIApplicationState.Active{ /// å¤„äºåå° }else if application.applicationState == UIApplicationState.Inactive{ } ä¸€ä¸‹å­dismiss ä¸¤ä¸ªViewControllerself.presentingViewController!.presentingViewController?.dismissViewControllerAnimated(true, completion: { () -> Void in }) ç¬¬ä¸‰æ–¹å¯¼å…¥åº“ä¸‹æ‹‰åˆ·æ–°BreakOutToRefresh ä¸€ä¸ªä¸‹æ‹‰åˆ·æ–°æ‰“ç –å—çš„swiftåº“SDRefreshView ç®€å•æ˜“ç”¨çš„ä¸Šæ‹‰å’Œä¸‹æ‹‰åˆ·æ–°ZLSwiftRefresh - ä¸‹æ‹‰åˆ·æ–°/ä¸Šæ‹‰åŠ è½½æ›´å¤šï¼Œæ”¯æŒè‡ªå®šä¹‰åŠ¨ç”»ï¼Œé›†æˆç®€å•GearRefreshControl - ä¸€ä¸ªéå¸¸ç²¾ç»†çš„ä¸‹æ‹‰åˆ·æ–° åšçš„å¾ˆç»†å¿ƒrefresher - ç®€æ´æ¸…çˆ½çš„ä¸‹æ‹‰åˆ·æ–°PullToBounce - å¼¹æ€§åŠ¨ç”» éå¸¸ç‚«é…·çš„ä¸‹æ‹‰åˆ·æ–°RCTRefreshControl qqçš„æ©¡çš®ç³–ä¸‹æ‹‰åˆ·æ–°PullToRefresh åˆ·æ–°åŠ¨ç”»å¯å®šåˆ¶çš„ä¸‹æ‹‰æ•°æ®è¯·æ±‚æ›´æ–°ç»„ä»¶MLSwiftBasic é›†åˆè‡ªå®šä¹‰å¯¼èˆªæ ã€ä¸‹æ‹‰åˆ·æ–°/ä¸Šæ‹‰åŠ è½½æ›´å¤šã€è§†è§‰æ•ˆæœã€å¥½ç”¨åˆ†ç±»ç­‰ç­‰ä¸€ç³»åˆ—ï¼Œå´è€¦åˆæ€§å¾ˆä½çš„Swiftåº“! å›¾ç‰‡é€‰æ‹©ã€æµè§ˆ (è¿™éƒ¨åˆ†swiftåº“çœŸå°‘å‘€ æ¬¢è¿çŸ¥é“çš„è¡¥å……)PhotoBrowser-swift å›¾ç‰‡æµè§ˆPhotoPicker swiftå›¾ç‰‡é€‰æ‹©BSImagePicker è¿™ä¸ªå›¾ç‰‡é€‰æ‹© ä¸é”™ï¼Œocå’Œswiftéƒ½æœ‰ çœŸè´´å¿ƒå‘€KYElegantPhotoGallery - ä¸€ä¸ªä¼˜é›…çš„å›¾ç‰‡æµè§ˆåº“(å¯æƒœOCå†™çš„å‘€ã€‚ã€‚ã€‚ã€‚)CocoaPicker - ä»¿ QQ å›¾ç‰‡é€‰æ‹©å™¨ï¼ˆéswiftï¼‰ã€‚ ç½‘ç»œéƒ¨åˆ†Alamofire è‘—åçš„ AFNetworking ç»œåŸºç¡€åº“ Swift è¯­è¨€ç‰ˆAlamofireImage åŸºäº Alamofire çš„ç½‘ç»œå›¾ç‰‡ç»„ä»¶åº“Reachability.swift Reachability Swift ç‰ˆæœ¬Ji Swift ç‰ˆ HTML/XML è§£æå™¨CoreStore æä¾›é«˜å¯è¯»æ€§ï¼Œä¸€è‡´æ€§åŠå®‰å…¨æ€§çš„ Core Data ç®¡ç†ç±»åº“SwiftyJSON GitHub ä¸Šæœ€ä¸ºå¼€å‘è€…è®¤å¯çš„ JSON è§£æç±» å›¾ç‰‡Kingfisher onevcat å¤§ç¥å¼€å‘çš„å¤„ç†ç½‘ç»œå›¾ç‰‡åŠç¼“å­˜çš„åº“ImageScout æœ€å°ç½‘ç»œä»£ä»·è·å¾—å›¾ç‰‡å¤§å°åŠç±»å‹Nuke å®Œæ•´ã€å¼ºå¤§ã€å®ç”¨çš„å›¾ç‰‡ç®¡ç†ç±»åº“HanekeSwift è½»é‡å¸¦ç¼“å­˜é«˜æ€§èƒ½å›¾ç‰‡åŠ è½½ç»„ä»¶UIImageColors è·å–å›¾ç‰‡å¼ çš„ä¸»è‰²è°ƒå’Œå…¶ç›¸å¯¹åº”çš„å¯¹æ¯”è‰²ï¼ŒèƒŒæ™¯è‰²ä¹‹ç±»çš„æ¡†æ¶ï¼Œå¯ä»¥å»çœ‹ä¸€ä¸‹ï¼Œæ„Ÿè§‰ç”¨åˆ°çš„åœ°æ–¹è¿˜æ˜¯ä¼šå¾ˆå¤šçš„ ç•Œé¢æ•ˆæœ,åŠ¨ç”»ç­‰awesome-ios-animation æ”¶é›†äº†iOSå¹³å°ä¸‹æ¯”è¾ƒä¸»æµç‚«é…·çš„å‡ æ¬¾åŠ¨ç”»æ¡†æ¶ï¼ˆè¿™ä¸Šé¢æœ‰å¾ˆå¤šï¼Œå­™ç„¶ä¸æ˜¯å…¨éƒ¨ç”¨swiftå†™çš„ã€‚ä½†æ˜¯è¿˜æ˜¯å¯ä»¥é‰´èµä¸‹ï¼‰LiquidFloatingActionButton å¯å®šåˆ¶æ°´æ»´å‹æµ®åŠ¨åŠ¨æ€æŒ‰é’®ç»„ä»¶åŠæ¼”ç¤ºPNChart-Swift å¸¦åŠ¨ç”»æ•ˆæœçš„å›¾è¡¨æ§ä»¶åº“HamburgerButton - Menu/Close æ— è®ºè®¾è®¡è¿˜æ˜¯ä»£ç ï¼Œéƒ½è¿›è¡Œäº†ç²¾é›•ç»†ç¢HamburgerButton - Check Hamburger é£æ ¼æŒ‰é’®åŠ¨ç”»å›¾æ ‡ï¼ˆå•é€‰ï¼‰ç»„ä»¶entotsu/TKSubmitTransition ç™»å½•åŠ è½½ã€è¿”å›æŒ‰é’®è½¬åœºåŠ¨ç”»ç»„ä»¶SweetAlert-iOS å¸¦åŠ¨ç”»æ•ˆæœå¼¹çª—å°è£…ç±»Dodo ä¸€æ¬¾è½»é‡åœ°å¯å®šåˆ¶ä¿¡æ¯æ å°ç»„ä»¶AnimatedTabBar çµåŠ¨çš„åŠ¨ç”»tabbarKYCircularProgress ç®€å•ã€å®ç”¨è·¯å¾„å¯å®šè¿›ç¨‹æ¡ParkedTextField å¸¦å›ºå®šæ–‡æœ¬çš„è¾“å…¥ç»„ä»¶optonaut/ActiveLabel.swift æ‰©å±•å®ç° UILabel è§¦æ§äº‹ä»¶é’ˆå¯¹ â€œ#, @, é“¾æ¥â€ å“åº”GMStepper å¸¦åŠ¨ç”»æ•ˆæœã€æ”¯æŒæ‰‹åŠ¿æ»‘åŠ¨æ“ä½œçš„æ­¥è¿›æ ‡ç­¾KSTokenView å¸¦æœç´¢ã€å¿«æ·è¾“å…¥ã€åˆ†æ®µæ˜¾ç¤ºå…³é”®è¯è¾“å…¥ç»„ä»¶QRCodeReader QR äºŒç»´ç é˜…è¯»ç»„ä»¶åŠç¤ºä¾‹EasyTipView å¼¹å‡ºæç¤ºæ¡†ç±»åŠæ¼”ç¤ºç¤ºä¾‹Popover æ³¡æ³¡é£æ ¼å¼¹å‡ºè§†å›¾å°è£…ç±»åº“TimingFunctionEditor - TimingFunctionEditorç”¨swiftç¼–å†™ï¼Œ è´å¡å°”æ›²çº¿ç¼–è¾‘å™¨ï¼Œç¼–è¾‘åå¯ä»¥é¢„è§ˆæˆ–æ‹·è´ä»£ç ç‰‡æ®µç›´æ¥ä½¿ç”¨ã€‚P.S. è¯¥é¡¹ç›®é‡‡ç”¨æ›´ç®€å•çš„ä¾èµ–ç®¡ç†å™¨Carthage ï¼Œè€Œéå¸¸ç”¨çš„ CocoaPodsã€‚Carthageä»‹ç»ä¸­æ–‡ã€‚AAFaceDetection - AAFaceDetectionâ€“swiftï¼Œç®€å•ã€å®ç”¨çš„é¢éƒ¨è¯†åˆ«å°è£…åº“ã€‚è™½ç„¶è¯¥æŠ€æœ¯ä» iOS 5 å‘å±•ï¼Œä¸è¿‡çœŸæ­£æœ‰è¶£çš„åº”ç”¨è¿˜ä¸å¤šã€‚ã€‚Concorde - swift, Concorde, ä¸€ä¸ªå¯ç”¨äºä¸‹è½½å’Œè§£ç æ¸è¿›å¼ JPEG çš„åº“, å¯ç”¨æ¥æ”¹å–„åº”ç”¨çš„ç”¨æˆ·ä½“éªŒã€‚ZoomTransition - swift, é€šè¿‡æ‰‹åŠ¿æ“æ§å›¾ç‰‡çš„æ”¾å¤§ã€ç¼©å°ã€æ—‹è½¬ç­‰è‡ªç”±å˜åŒ–æ•ˆæœçš„ç»„ä»¶åŠç¤ºä¾‹ã€‚AFImageHelper - swift,ä¸€å¥—é’ˆå¯¹ UIImage å’Œ UIImageView çš„å®ç”¨æ‰©å±•åº“ï¼ŒåŠŸèƒ½åŒ…å«å¡«è‰²å’Œæ¸å˜ã€è£å‰ªã€ç¼©æ”¾ä»¥åŠå…·æœ‰ç¼“å­˜æœºåˆ¶çš„åœ¨çº¿å›¾ç‰‡è·å–PinterestSwift - swift,Pinterest é£æ ¼å›¾ç‰‡ç¼©æ”¾ã€åˆ‡æ¢ç¤ºä¾‹ã€‚NVActivityIndicatorView ç­‰å¾…æŒ‡ç¤ºå™¨ çœŸå¿ƒå¤šã€‚UIViewXXYBoom æ¨¡æ‹ŸMIUIå¸è½½è½¯ç”²çš„æ—¶å€™åŠ¨ç”»TisprCardStack ä¸€æ¬¾UICollectionåˆ‡æ¢åŠ¨ç”»LTMorphingLabel è¶…çº§ç‚«é…·çš„Labelåˆ‡æ¢æ–‡å­—çš„åŠ¨ç”»æ¡†æ¶XLPagerTabStrip å¤šé¡µUIViewControllæ¡†æ¶ çº¦æŸAutolayoutSnapKit æˆ‘å°±ç”¨è¿™ä¸€ä¸ª æ•°æ®åº“æ–¹é¢ realm-cocoa ç»æµ‹è¯•ï¼Œè¡¨ç¤ºæ¯”è‹¹æœè‡ªå¸¦çš„CoreData é€Ÿåº¦æ›´åŠ çš„å¿«ï¼Œæ–‡æ¡£è¯¦ç»†ã€‚ç‰ˆæœ¬è¿ç§»æ–¹ä¾¿ã€‚ CoreStore ä¸€æ¬¾CoreDataçš„ç¬¬ä¸‰æ–¹å¸®åŠ©åº“ï¼Œä½¿ç”¨CoreDataæ›´æ–¹é¢ï¼ŒåŒ…æ‹¬ç‰ˆæœ¬è¿ç§»ã€‚ ç›¸æœºKYShutterButton æ¨¡æ‹Ÿç³»ç»Ÿç›¸æœºæŒ‰é’®â€¦â€¦â€¦â€¦TOCropViewController æ¨¡æ‹Ÿç³»ç»Ÿç›¸å†Œå‰ªåˆ‡å›¾ç‰‡æ—¶çš„ç•Œé¢MHVideoPhotoGallery ä¸€æ¬¾å¯ä»¥è®©ä½ å­¦ä¹ åˆ°å¾ˆå¤šçŸ¥è¯†çš„demo å…¶ä»–æ–¹é¢ExSwift ä¸€æ¬¾Extensioné›†åˆçš„æ¡†æ¶ï¼Œçœç€é€ è½®å­äº†JSQMessagesViewController èŠå¤©é¡µé¢çš„æ­å»ºï¼Œä¸ç”¨æ„äº†ï½ ä½†æ˜¯éœ€è¦è‡ªå·±å»å®ç°ä¸€äº›ï¼Œä¾‹å¦‚æ’­æ”¾è§†é¢‘ä¹‹ç±»çš„ä¸œè¥¿ï¼Œå®ƒæœ¬èº«åªå®ç°äº†æ–‡å­—å’Œå›¾ç‰‡STClock å®Œå…¨æ¨¡ä»¿é”¤å­æ—¶é’Ÿï¼Œå¯ä»¥å½“ä½œä¸€ä¸ªå­¦ä¹ çš„æ¡ˆä¾‹","categories":[{"name":"IOS","slug":"IOS","permalink":"http://www.msiter.com/categories/IOS/"}],"tags":[{"name":"ios","slug":"ios","permalink":"http://www.msiter.com/tags/ios/"},{"name":"swift","slug":"swift","permalink":"http://www.msiter.com/tags/swift/"},{"name":"æŠ€å·§","slug":"æŠ€å·§","permalink":"http://www.msiter.com/tags/æŠ€å·§/"}],"keywords":[{"name":"IOS","slug":"IOS","permalink":"http://www.msiter.com/categories/IOS/"}]},{"title":"Swagger åˆçº§å­¦ä¹ ","slug":"swagger å­¦ä¹ ","date":"2015-07-13T18:41:43.000Z","updated":"2017-11-28T11:07:04.831Z","comments":true,"path":"2015/07/13/swagger å­¦ä¹ /","link":"","permalink":"http://www.msiter.com/2015/07/13/swagger å­¦ä¹ /","excerpt":"æœ€å¼€å§‹åªæ˜¯æƒ³æ‰¾ä¸€ä¸ªåˆ¶ä½œapiçš„å·¥å…·è€Œå·²ï¼Œç„¶åå†æŸä¸€ä¸ªå¸–å­ä¸­å‘ç°äº†è¿™ä¸ªå®¶ä¼™ã€‚ä»–ä¸åªæ˜¯å¯ä»¥è®©ä½ å¯ä»¥å±•ç¤ºæœåŠ¡å™¨çš„APIæ¥å£ã€‚ä½ ç”šè‡³å¯ä»¥è®©å®¢æˆ·ç«¯å—ç›Šï¼Œç”Ÿæˆå®¢æˆ·ç«¯ä»£ç ï¼Œè®©å®¢æˆ·ç«¯å¼€å‘è€…ç›´æ¥è°ƒç”¨ç”Ÿæˆä»£ç ï¼Œä½¿ç”¨ç”Ÿæˆçš„ä»£ç ï¼Œè®¿é—®ä½ çš„æ¥å£å¹¶ä¸”å®Œæˆæ•°æ®çš„è·å–ã€‚So Coll Swagge is a simple yet powerful representation of your RESTful API","text":"æœ€å¼€å§‹åªæ˜¯æƒ³æ‰¾ä¸€ä¸ªåˆ¶ä½œapiçš„å·¥å…·è€Œå·²ï¼Œç„¶åå†æŸä¸€ä¸ªå¸–å­ä¸­å‘ç°äº†è¿™ä¸ªå®¶ä¼™ã€‚ä»–ä¸åªæ˜¯å¯ä»¥è®©ä½ å¯ä»¥å±•ç¤ºæœåŠ¡å™¨çš„APIæ¥å£ã€‚ä½ ç”šè‡³å¯ä»¥è®©å®¢æˆ·ç«¯å—ç›Šï¼Œç”Ÿæˆå®¢æˆ·ç«¯ä»£ç ï¼Œè®©å®¢æˆ·ç«¯å¼€å‘è€…ç›´æ¥è°ƒç”¨ç”Ÿæˆä»£ç ï¼Œä½¿ç”¨ç”Ÿæˆçš„ä»£ç ï¼Œè®¿é—®ä½ çš„æ¥å£å¹¶ä¸”å®Œæˆæ•°æ®çš„è·å–ã€‚So Coll Swagge is a simple yet powerful representation of your RESTful API swaggerçš„æ„æ€æ˜¯ ç‹‚å¦„è‡ªå¤§ã€‚ä½†æ˜¯ç­‰æˆ‘ä»‹ç»å®Œæ¯•ä¹‹åä½ ä¼šçš„è§‰çš„ä»–çš„ç‹‚å¦„ç»å¯¹æ˜¯æœ‰é“ç†çš„ï¼Œæ²¡æœ‰æµ®å¤¸ã€‚å…·ä½“æ¥è¯´ä»–æ˜¯ä»€ä¹ˆå‘¢ï¼Œæ­£å¦‚ä»–è‡ªå·±çš„ä»‹ç»ï¼Œæ˜¯ä¸€ä¸ªç®€å•è€Œåˆå¼ºå¤§çš„apiå‘å¸ƒå·¥å…·ï¼Œå¼ºå¤§æ˜¯æ¯‹åº¸ç½®ç–‘çš„ï¼Œæˆ‘ç°åœ¨çŸ¥é“ä¹Ÿåªæ˜¯ä»–çš„å‡ ä¸ªç»„ä»¶ä¸­çš„å‡ ä¸ªè€Œå·²ï¼Œè¿˜æœ‰æ›´å¤šçš„ä½œç”¨çš„ï¼Œå½“ç„¶å°±æ˜¯è¿™å‡ ä¸ªä½œç”¨æˆ‘å°±å·²ç»è·ç›ŠåŒªæµ…äº†ã€‚åºŸè¯ä¸å¤šè¯´ã€‚ æœ¬æ–‡å°†ä»è¿™å‡ ä¸ªæ­¥éª¤å±•å¼€è®²è¿°ï¼š ä½œä¸ºæœåŠ¡å™¨ï¼Œæˆ‘ä»¬åº”è¯¥å¦‚ä½•å‘åç«¯å±•ç¤ºAPIä»‹ç»é¡µé¢å‘¢ åœ¨å“ªé‡Œç¼–å†™å‘¢ï¼Ÿ æ€ä¹ˆç¼–å†™ï¼Ÿ å¦‚ä½•å±•ç¤ºï¼Ÿ ä»…é™NodJs ä½œä¸ºå®¢æˆ·ç«¯ï¼Œæˆ‘ä»¬å¦‚ä½•è·å–æ•°æ®æ ¹æ®Swaggerçš„æ–¹å¼ å¦‚ä½•è·å–? æ€ä¹ˆä½¿ç”¨? ä»…é™swift åœ¨å“ªé‡Œç¼–å†™å‘¢ï¼Ÿä¸¤ç§æ˜¯ï¼Œä¸€ç§æ˜¯ç½‘ç»œç¼–è¾‘å™¨ï¼Œç¬¬äºŒç§æœ¬åœ°ç¼–è¾‘å™¨ã€‚å¦‚æœä½ å“ªé‡Œçš„ç½‘ç»œæ²¡æœ‰å¾ˆå·®çš„è¯ï¼Œæ¯”è¾ƒæ¨èä½¿ç”¨ç¬¬ä¸€ç§æ–¹å¼ã€‚æ¯•ç«Ÿç®€å•æ‰æ˜¯ç‹é“ ç‚¹å‡»è¿™é‡Œè¿›å…¥ é¦–å…ˆéœ€è¦ä½ æ‹¥æœ‰ nodejs ç¯å¢ƒï¼Œç„¶åæ‰§è¡Œä»¥ä¸‹è¯­å¥ git clone https://github.com/swagger-api/swagger-editor.git cd swagger-editor npm start å…¶å®è¿™ä¸¤ç§æ–¹å¼å®Œæˆä¹‹åéƒ½ä¼šçœ‹åˆ°ç¼–è¾‘é¡µé¢ã€‚å½“ç„¶ç¬¬ä¸€ç§ä¼šç®€å•çš„å¾ˆå¤šã€‚æ‰“å¼€é¡µé¢ä¹‹åä½ è¦çœ‹çœ‹ä¸Šé¢çš„å¯¼èˆªæ å“¦ fileè‡ªç„¶å°±æ˜¯æ–‡ä»¶çš„ä¸€äº›æ“ä½œäº†ï¼Œæ¯”å¦‚æ–°å»ºå•Šï¼Œæ‰“å¼€è‡ªå·±çš„ï¼Œæˆ–è€…æ‰“å¼€é­”æ¿å•Šï¼Œä¹‹ç±»çš„ã€‚ã€ Preferences åŸºæœ¬çš„ä¸€äº›é…ç½®ï¼Œè­¬å¦‚è¯´ï¼š å­—ä½“å¤§å°å•Šä¹‹ç±»çš„é¥¿ï¼Œå½“ç„¶ä¹Ÿä¼šæœ‰å…¶ä»–çš„è®¾ç½®ï¼Œä½†æ˜¯å¦‚æœä½ ä¸æ˜¯å¼ºè¿«ç—‡æˆ–è€…æœ‰è‡ªå·±çš„ç‹¬ç‰¹çš„å‡†åˆ™çš„äººï¼Œé‚£ä¹ˆè¿™ä¸ªä¸œè¥¿ä½ å¯ä»¥æ— è§† Generate Server çœ‹ä»–çš„æ„æ€ä¹Ÿå¾ˆæ˜ç™½äº†ï¼Œç”ŸæˆæœåŠ¡å™¨ä»£ç è‡³äºä½ ç”Ÿæˆä»€ä¹ˆè¯­è¨€çš„æœåŠ¡å™¨å°±çœ‹ä½ è‡ªå·±äº†ã€‚ Generate Client ç”Ÿæˆå®¢æˆ·ç«¯ä»£ç ã€‚å¾ˆæ˜æ˜¾å•¦~ å“‡å“ˆå“ˆå“ˆ help - can l help you? ç•Œé¢æ€ä¹ˆç¼–å†™å‘¢è¿™ä¸ªå°±è¦è¯´èµ·æ¥è¯å°±å¤šäº†ï¼Œä½†æ˜¯æˆ‘å°±æŒ‘ä¸€äº›é‡è¦çš„å§ã€‚æ¯•ç«Ÿæˆ‘æ‡’â€¦è¿™é‡Œçš„ç¼–è¾‘éœ€è¦ä¸€ç§æ¨¡æ¿è¯­è¨€çš„åŸºç¡€ã€‚````yamlä½¿ç”¨è¯·æ‰“å¼€ ã€http://editor.swagger.io/#/ã€‘ æˆ–è€… ################################################################################ swagger################################################################################ #è¿™ä¸ªæ˜¯å¿…é¡»çš„swagger: â€˜2.0â€™ ################################################################################ info################################################################################ #æ–‡æ¡£ä¿¡æ¯info: title: é‡è§ Api description: é‡è§ web Service Api æ¥å£ã€‚è¯¥æ¥å£æ–‡æ¡£ç”¨äºå¼€å‘è€…æ›´å¥½çš„æ ¹æ®æ•°æ®ï¼Œç”¨äºé‡è§ç”¨æˆ·çš„è®°å½•å’Œé‡è§ç”¨æˆ·åŠ¨æ€çš„æ•´åˆã€‚ version: â€œ1.0.0â€ termsOfService: Copyright [2015] [ä¸€åŒ¡å¤©ä¸‹] license:#å¯æœ‰å¯æ—  name: Apache 2.0 url: http://www.apache.org/licenses/LICENSE-2.0.html contact: name: è†æ–‡å¾ url: msiter.com email: msiter@qq.com APIåœ°å€host: api.msiter.com è¯·æ±‚æ–¹å¼schemes: httpè¿™ä¸ªå­—æ®µä¼šæ·»åŠ åˆ°æ‰€æœ‰çš„APIå‰é¢ï¼Œå½“åšç‰ˆæœ¬æ§åˆ¶å­—æ®µè¿˜æ˜¯ä¸é”™çš„#basePath: /v1 #MIMEç±»å‹çš„apiå¯ä»¥äº§ç”Ÿçš„åˆ—è¡¨ã€‚è¿™æ˜¯å¯ä»¥è¦†ç›–å…¨çƒæ‰€æœ‰API,ä½†åœ¨ç‰¹å®šçš„APIè°ƒç”¨ã€‚å€¼å¿…é¡»æ˜¯æ‰€è¿° http://http://swagger.io/specification/#mimeTypesconsumes: application/json #MIMEç±»å‹çš„apiå¯ä»¥äº§ç”Ÿçš„åˆ—è¡¨ã€‚è¿™æ˜¯å¯ä»¥è¦†ç›–å…¨çƒæ‰€æœ‰API,ä½†åœ¨ç‰¹å®šçš„APIè°ƒç”¨ã€‚å€¼å¿…é¡»æ˜¯æ‰€è¿° http://http://swagger.io/specification/#mimeTypesproduces: application/json################################################################################Tags#################################################################################æ ‡ç­¾ï¼Œå¦‚æœä½ ä¸å†™çš„è¯ï¼Œä»–ä¼šè‡ªåŠ¨å¸®ä½ ç”Ÿæˆçš„ã€‚å¦‚æœä½ è‡ªå·±å†™çš„è¯â€¦è¯·æ³¨æ„åˆ°å’±ä»¬çš„æ°‘æ—ã€‚å¤§ä¸­å›½è¯­è¨€æ¯•ç«Ÿæœ‰äº›ä¸è¢«ä¸–ç•Œæ¥å—ï¼Œæ‰€ä»¥éš¾å…ä¸å¥½çœ‹ã€‚è¿˜æ˜¯å¸Œæœ›ä½¿ç”¨è‹±æ–‡å§ã€‚tags: name: ç”¨æˆ·description: | æœ‰å…³äºç”¨æˆ·çš„æ¥å£API: å…³äºæ³¨å†Œ å…³äºè·å– name: åŠ¨æ€description: | æœ‰å…³äºåŠ¨æ€çš„æ¥å£API: å…³äºåˆ›å»º å…³äºè·å– name: è¾…åŠ©æ ‡ç­¾description: | å•çº¯çš„ä¸ºäº†å¥½çœ‹################################################################################ paths#################################################################################æ¥ä¸‹é‡Œå°±æ˜¯APIä¸»é¢˜äº†paths:/users/registered:post: summary: æ³¨å†Œç”¨æˆ· description: æ ¹æ®ç”¨æˆ·ä¼ å…¥çš„æ–°æµªå¾®åšå‚æ•°,è¿”å›æ•°æ®åº“é‡Œçš„ç”¨æˆ·ä¿¡æ¯. parameters: name: sourcerequired: truein: querytype: stringformat: stringdescription: æ–°æµªå¾®åš App Id name: access_tokenrequired: truein: querytype: stringformat: stringdescription: æ–°æµªå¾®åš è®¤è¯å£ä»¤ name: uidrequired: truein: querytype: stringformat: stringdescription: æ–°æµªå¾®åš ç”¨æˆ·ID.tags: ç”¨æˆ·responses:200:description: è¯·æ±‚å®Œæˆï¼Œè·å–ç”¨æˆ·æˆåŠŸschema: $ref: â€˜#/definitions/Userâ€™400:description: è¯·æ±‚å¤±è´¥schema: $ref: â€˜#/definitions/Errorâ€™ /users/obtainbyid:get: summary: æ ¹æ®ç”¨æˆ·idè·å–ç”¨æˆ·ä¿¡æ¯ description: æ ¹æ®ç”¨æˆ·ä¼ å…¥çš„ç”¨æˆ·idè·å–ç”¨æˆ·çš„ä¿¡æ¯. parameters: name: masteridrequired: truein: querytype: stringformat: stringdescription: ä¸»äººid name: otheridrequired: falsein: querytype: stringformat: stringdescription: è¦æŸ¥è¯¢çš„ç”¨æˆ·id,å¦‚æœä¸ä¼ é€’åˆ™æŸ¥è¯¢ä¸»äººidtags: ç”¨æˆ·responses:200:description: è¯·æ±‚å®Œæˆï¼Œè·å–ç”¨æˆ·æˆåŠŸschema: $ref: â€˜#/definitions/Userâ€™400:description: è¯·æ±‚å¤±è´¥schema: $ref: â€˜#/definitions/Errorâ€™/users/obtainallmeetuser:get:summary: get User By Iddescription: æ ¹æ®ç”¨æˆ·idè·å–ç”¨æˆ·æ‰€æœ‰çš„é‡è§çš„äººä¿¡æ¯.è¿™ä¸ªæ¥å£å…¶å®å°±æ˜¯è·å–ç”¨æˆ·çš„å¥½å‹ã€‚parameters: name: useridrequired: truein: querytype: stringformat: stringdescription: ç”¨æˆ·idtags: ç”¨æˆ·responses:200:description: è¯·æ±‚å®Œæˆï¼Œè·å–ç”¨æˆ·æˆåŠŸschema: type: array items: $ref: â€˜#/definitions/Userâ€™400:description: è¯·æ±‚å¤±è´¥schema: $ref: â€˜#/definitions/Errorâ€™################################################################################Definitions#################################################################################APIæ‰€éœ€è¦çš„æ¨¡å—ã€‚definitions:User:description: ç”¨æˆ·å¯¹è±¡type: objectproperties:_id:type: stringdescription: ç”¨æˆ·id.sinaId:type: stringdescription: æ–°æµªå¾®åšå”¯ä¸€æ ‡ç¤º.name:type: stringdescription: ç”¨æˆ·åç§°.gender:type: stringdescription: ç”¨æˆ·æ€§åˆ« mï¼šç”·ã€fï¼šå¥³ã€nï¼šæœªçŸ¥.commGround:type: stringdescription: ç”¨æˆ·å¸¸å‡ºæ²¡åœ°.signature:type: stringdescription: ç”¨æˆ·çš„ä¸ªæ€§ç­¾å.headPhotoKey:type: stringdescription: ä¸ƒç‰›çš„æ–‡ä»¶è®¿é—®æ ‡ç¤º.createDateTime:type: stringformat: date-timedescription: ç”¨æˆ·æ³¨å†Œæ—¶é—´.userLabels:type: arrayitems:$ref: â€˜#/definitions/UserLabelâ€™userBacks:type: arrayitems:$ref: â€˜#/definitions/UserBackâ€™UserBack:description: ç”¨æˆ·èƒŒæ™¯å¯¹è±¡type: objectproperties:index:type: numberdescription: ç”¨æˆ·èƒŒæ™¯çš„æ’åºè¡¨ç¤º.identifier:type: stringdescription: ç”¨æˆ·èƒŒæ™¯çš„å”¯ä¸€æ ‡ç¤º.imageKey:type: stringdescription: ä¸ƒç‰›çš„æ–‡ä»¶è®¿é—®æ ‡ç¤º.UserLabel:description: ç”¨æˆ·ä¸ªæ€§ç­¾åå¯¹è±¡type: objectproperties:content:type: stringdescription: ç”¨æˆ·èƒŒæ™¯çš„æ’åºè¡¨ç¤º.identifier:type: stringdescription: ç”¨æˆ·èƒŒæ™¯çš„å”¯ä¸€æ ‡ç¤º.createDateTime:type: stringformat: date-timedescription: ä¸ƒç‰›çš„æ–‡ä»¶è®¿é—®æ ‡ç¤º.Error:description: é”™è¯¯ä¿¡æ¯properties:error:type: stringdescription: é”™è¯¯ä¿¡æ¯. è¿™ä¸ªæˆ‘çœŸçš„ä¸çŸ¥é“æ€ä¹ˆè¯´äº†ï¼Œä»£ç å¤åˆ¶ä¸€ä¸‹ï¼Œå¤åˆ¶åˆ°ç¼–è¾‘å™¨å†…ã€‚çœ‹çœ‹æ•ˆæœå¯¹ç…§ç€æ¥ï¼Œæˆ‘ç›¸ä¿¡å¾ˆå¿«å°±ä¼šå­¦ä¼šçš„ã€‚å½“ç„¶äººå®¶ä¹Ÿæ˜¯æä¾›äº†ä¸€äº›ç¤ºä¾‹ä»£ç äº†çš„ï¼Œä½ ä¹Ÿå¯ä»¥ä¸çœ‹æˆ‘çš„è¿™ä¸ªçš„ã€‚ ### æ€ä¹ˆå±•ç¤º é‚£å°±`so Easy`å•¦ï¼Œå»å¯¼èˆªä¸‹è½½ä½ ç´¢å¯¹åº”çš„æœåŠ¡å™¨è¯­è¨€å°±OKï¼Œæ‰¾ä¸åˆ°ï¼Ÿ é‚£ä¹ˆæˆ‘æ¨èä½ ä½¿ç”¨`NODEJS`ã€‚ æ¯”å¦‚æˆ‘å°±æ˜¯ä¸‹è½½çš„nodejsä»£ç ï¼Œè§£å‹å cd nodejs-servernpm installnode index.js ç„¶å[ç‚¹å‡»](http://localhost:8080/docs)ä¸å‡ºç°ä»€ä¹ˆé‡å¤§æ„å¤–ï¼Œä½ ç°åœ¨å·²ç»å¤„äºapié¡µé¢äº†ã€‚ ### å¦‚ä½•è·å–? ç‚¹å‡»å¯¼èˆªå†…ï¼Œå¹¶ä¸‹è½½ä½ æ‰€å¯¹åº”çš„è¯­è¨€ ### æ€ä¹ˆä½¿ç”¨? - `swift` æˆ‘åªçŸ¥é“swiftçš„oc çš„ç±»ä¼¼ï¼Œå…¶ä»–çš„è¯­è¨€å°å¼Ÿä¸æ›¾æ¶‰çŒã€‚æŠ±æ­‰ã€‚ ä¸‹è½½å®Œæˆåï¼Œè§£å‹åè¿›å…¥åï¼š 1. å¦‚æœä½ ä½¿ç”¨çš„`cocopod`,åªéœ€è¦æŠŠ æ–‡ä»¶å¤¹å†…çš„`SwaggerClient`æ–‡ä»¶å¤¹ä¸€è‚¡è„‘çš„æ‹½è¿›ä½ çš„é¡¹ç›®å°±OKï¼Œå½“ç„¶ä½ éœ€è¦æŸ¥çœ‹ä¸€ä¸‹ `Carfile`æ–‡ä»¶çœ‹çœ‹éœ€è¦å¼•å…¥é‚£äº›ç¬¬ä¸‰æ–¹ï¼Œpod installå°±å¯ä»¥äº†ã€‚ 2. `Carthage`æ˜¯ä¸€ä¸ªç¬¬ä¸‰æ–¹åŠ è½½ç»„ä»¶ã€‚æˆ‘ä¹‹å‰å› ä¸ºä¸çŸ¥é“ï¼Œç›´æ¥ä½¿ç”¨`cocopod`ä¹Ÿå¯ä»¥,æ‰€ä»¥å°è¯•äº†ä¸€ç•ªï¼Œæ•…è®°ä¸‹ï¼š - å®‰è£… `Carthage` - ä½¿ç”¨ `brew install Carthage` 2. å®‰è£…å®Œæˆåï¼Œè¿›å…¥æ–‡ä»¶ç›®å½•ï¼Œ`Carthage update` 3. æ‰“å¼€é¡¹ç›®ï¼Œåœ¨é¡¹ç›®çš„æŸä¸ªTarget -> Build Phases -> Link Library with Librariesï¼Œå°†Carthage/Buildç›®å½•ä¸­å¸Œæœ›å¯¼å…¥çš„Frameworkåº“æ‹–æ‹½è¿›å»ã€‚ 4. æ·»åŠ è„šæœ¬ï¼Œæ·»åŠ Input Files - æ·»åŠ è„šæœ¬ ```/usr/local/bin/carthage copy-frameworks - æ·»åŠ Input Files ```$(SRCROOT)/Carthage/Build/iOS/ä½ æ‰€éœ€è¦çš„.framework```","categories":[{"name":"å¼€å‘å¸®åŠ©","slug":"å¼€å‘å¸®åŠ©","permalink":"http://www.msiter.com/categories/å¼€å‘å¸®åŠ©/"}],"tags":[{"name":"swagger","slug":"swagger","permalink":"http://www.msiter.com/tags/swagger/"},{"name":"api","slug":"api","permalink":"http://www.msiter.com/tags/api/"}],"keywords":[{"name":"å¼€å‘å¸®åŠ©","slug":"å¼€å‘å¸®åŠ©","permalink":"http://www.msiter.com/categories/å¼€å‘å¸®åŠ©/"}]},{"title":"Mongoose å­¦ä¹ ","slug":"Mongoose å­¦ä¹ ","date":"2015-07-11T20:53:35.000Z","updated":"2017-11-28T11:07:04.827Z","comments":true,"path":"2015/07/11/Mongoose å­¦ä¹ /","link":"","permalink":"http://www.msiter.com/2015/07/11/Mongoose å­¦ä¹ /","excerpt":"Mongoose is a MongoDB object modeling tool designed to work in an asynchronous environment. å…³äºmongodbçš„ä¼˜åŠ¿ä¹‹ç±»çš„è¯ï¼Œæˆ‘ä¹Ÿå°±ä¸è¯´ä»€ä¹ˆï¼Œå› ä¸ºä½ æ—¢ç„¶ä½¿ç”¨è¿™ä¸ªæ•°æ®åº“çš„è¯ï¼Œæˆ‘ç›¸ä¿¡ä½ å·²ç»å¯¹ä»–çš„åŸºæœ¬ä¿¡æ¯å¾ˆäº†è§£äº†ã€‚å¦å¤–æœ¬ç¯‡æ–‡ç« æ²¡æœ‰åŸºæœ¬çš„æ“ä½œã€‚ä¸»è¦æ˜¯é’ˆå¯¹ï¼Œå­è¡¨å’Œå…³è”è¡¨çš„æ“ä½œã€‚å› ä¸ºæˆ‘è§‰çš„åŸºæœ¬çš„æ“ä½œï¼Œä¸æ˜¯å¾ˆéº»çƒ¦ï¼Œè€Œéåœ°éƒ½æ˜¯æ–‡æ¡£ï¼Œæˆ‘æ„Ÿè§‰æ²¡ä»€ä¹ˆå¿…è¦å†å¨å” ä¸€éäº†","text":"Mongoose is a MongoDB object modeling tool designed to work in an asynchronous environment. å…³äºmongodbçš„ä¼˜åŠ¿ä¹‹ç±»çš„è¯ï¼Œæˆ‘ä¹Ÿå°±ä¸è¯´ä»€ä¹ˆï¼Œå› ä¸ºä½ æ—¢ç„¶ä½¿ç”¨è¿™ä¸ªæ•°æ®åº“çš„è¯ï¼Œæˆ‘ç›¸ä¿¡ä½ å·²ç»å¯¹ä»–çš„åŸºæœ¬ä¿¡æ¯å¾ˆäº†è§£äº†ã€‚å¦å¤–æœ¬ç¯‡æ–‡ç« æ²¡æœ‰åŸºæœ¬çš„æ“ä½œã€‚ä¸»è¦æ˜¯é’ˆå¯¹ï¼Œå­è¡¨å’Œå…³è”è¡¨çš„æ“ä½œã€‚å› ä¸ºæˆ‘è§‰çš„åŸºæœ¬çš„æ“ä½œï¼Œä¸æ˜¯å¾ˆéº»çƒ¦ï¼Œè€Œéåœ°éƒ½æ˜¯æ–‡æ¡£ï¼Œæˆ‘æ„Ÿè§‰æ²¡ä»€ä¹ˆå¿…è¦å†å¨å” ä¸€éäº† MongoDB ç®€ä»‹MongoDB æ˜¯ä¸€ä¸ªåŸºäºåˆ†å¸ƒå¼æ–‡ä»¶å­˜å‚¨çš„æ•°æ®åº“ã€‚ç”± C++ è¯­è¨€ç¼–å†™ã€‚æ—¨åœ¨ä¸º WEB åº”ç”¨æä¾›å¯æ‰©å±•çš„é«˜æ€§èƒ½æ•°æ®å­˜å‚¨è§£å†³æ–¹æ¡ˆã€‚MongoDB æ˜¯ä¸€ä¸ªä»‹äºå…³ç³»æ•°æ®åº“å’Œéå…³ç³»æ•°æ®åº“ä¹‹é—´çš„äº§å“ï¼Œæ˜¯éå…³ç³»æ•°æ®åº“å½“ä¸­åŠŸèƒ½æœ€ä¸°å¯Œï¼Œæœ€åƒå…³ç³»æ•°æ®åº“çš„ã€‚ æ•°æ®åº“æ“ä½œè¿æ¥æ•°æ®åº“ï¼Œåˆ›å»ºä¸€ä¸ªè¡¨ã€‚///è·å–Mongooseç»„ä»¶ var mongoose = require('mongoose'); ///é“¾æ¥è‡³æ•°æ®åº“ï¼ŒMeetåˆ™ä¸ºæ•°æ®åº“åç§° mongoose.connect('mongodb://localhost/Meet'); æ—¢ç„¶å·²ç»è¿æ¥ä¸Šçš„è¯ï¼Œé‚£ä¹ˆæ¥ä¸‹æ¥å°±è¯¥æ˜¯å¦‚ä½•åˆ›å»ºè¡¨äº†ã€‚ var mongoose = require('mongoose'); var UserSchema = new mongoose.Schema({ sinaId: String, name: String, gender: String,//æ€§åˆ«ï¼Œmï¼šç”·ã€fï¼šå¥³ã€nï¼šæœªçŸ¥ commGround: String, signature: String, headPhotoKey: String, userBacks: [{ identifier: String, index: Number, imageKey: String }], userLabels: [{ content: String, identifier: String, createDateTime: {type: Date, default: Date.now} }], createDateTime: {type: Date, default: Date.now} }, {collection: \"User\"});///Userå°±æ˜¯è¡¨åäº† /** ä¸­é—´å†™å…¶ä»–çš„ä¸€äº›æ–¹æ³• */ var User = mongoose.model('User', UserSchema); è‡³æ­¤ ä¸€ä¸ªè¡¨å·²ç»åˆ›å»ºå®Œæˆäº†ï¼Œå¯èƒ½ä½ ä¼šè¯§å¼‚ä¸ºä»€ä¹ˆä½ å¯åŠ¨äº†æœåŠ¡å™¨å¹¶ä¸”ä¹Ÿè¿æ¥åˆ°äº†æ•°æ®åº“å´æ²¡æœ‰åˆ›å»ºè¡¨ï¼Œä¸è¦ç€æ€¥ï¼Œä½ æ²¡æœ‰æ•°æ®çš„æ—¶å€™ï¼Œæ•°æ®åº“æ˜¯ä¸ä¼šæ˜¾ç¤ºçš„ã€‚ å­è¡¨å¦‚ä½•æ“ä½œå¤§å®¶çœ‹æˆ‘æ¥ä¸‹æ¥çš„ä¸€å¼ è¡¨ var UserSchema = new mongoose.Schema({ sinaId: String,//æ–°æµªå¾®åšID name: String,//ç”¨æˆ·åç§° gender: String,//æ€§åˆ«ï¼Œmï¼šç”·ã€fï¼šå¥³ã€nï¼šæœªçŸ¥ commGround: String,//å”±å‡ºæ²¡åœ° signature: String,//ä¸ªæ€§ç­¾å headPhotoKey: String,//å¤´åƒåœ°å€ userLabels: [{//ç”¨æˆ·ä¸ªäººæ ‡ç­¾é›†åˆ content: String,//å†…å®¹ identifier: String,//å”¯ä¸€æ ‡ç¤º createDateTime: {type: Date, default: Date.now}//åˆ›å»ºæ—¶é—´ }], createDateTime: {type: Date, default: Date.now},//ç”¨æˆ·æ³¨å†Œæ—¶é—´ isDelete: {type: Boolean, default: false}//æ˜¯å¦åˆ é™¤ }, {collection: \"MeetUser\"}); è¿™æ˜¯ä¸€ä¸ªåŸºæœ¬çš„ç”¨æˆ·æ•°æ®ç±»å‹ã€‚æ¥ä¸‹æ¥è®©æˆ‘ä»¬æ¥çœ‹çœ‹å¦‚ä½•æ“ä½œè¿™ä¸ªç±»å‹é‚£ä¸ªå§ã€‚ å­è¡¨æ–°å¢æ•°æ® //åˆ›å»ºç”¨æˆ·æ ‡ç­¾æ–¹æ³• UserSchema.statics.createUserLabel = function (userid, identifier, content, createtime, callBack) { //é¦–å…ˆæŸ¥çœ‹æ•°æ®åº“ä¸­è¯¥ç”¨æˆ·æ˜¯å¦å­˜åœ¨è¿™ä¸ªä¸ªäººæ ‡ç­¾ï¼Œæ–¹æ³•ä¼šåœ¨ä¸‹é¢åˆ—å‡º this.findUserLabel(userid, identifier, function (err, result) { if (result) { if (callBack)return callBack(err, result); return; } //å¦‚æœå¹¶æ²¡æœ‰è¯¥å¯¹è±¡ï¼Œé‚£ä¹ˆä¹…åˆ›å»ºä¸€ä¸ªæ–°å¾·å¯¹è±¡ var b = { identifier: identifier, content: content, createDateTime: createtime } //è¿™é‡Œå°±æ˜¯é‡ç‚¹ï¼Œä½¿ç”¨findOneAndUpdateæ‰¾åˆ°é«˜ç”¨æˆ·ï¼Œä¹‹åä½¿ç”¨ $push æ–°å¢ä¸€ä¸ªç”¨æˆ·ä¸ªäººæ ‡ç­¾ï¼Œå¹¶ä¸”æ‰§è¡Œ User.findOneAndUpdate({\"_id\": mongoose.Types.ObjectId(userid)}, {'$push': {\"userLabels\": b}}).exec(function (err, result) { ///æ¥å£éœ€è¦æ‰€ä»¥è¦åœ¨å¢åŠ å®Œæˆä¹‹åï¼Œè·å–è¿™ä¸ªç”¨æˆ·å¹¶ä¸”è¿”å› User.findOne({\"_id\": mongoose.Types.ObjectId(userid)}, function (err, result) { callBack(err, result); }); }); }); }; å­è¡¨æŸ¥æ‰¾æ•°æ®///è¯¥æ–¹æ³•å°±æ˜¯ä¸Šé¢æ–¹æ³•ä¸­è°ƒç”¨çš„æŸ¥æ‰¾æ–¹æ³• UserSchema.statics.findUserLabel = function (userid, identifier, callBack) { this.findOne({ \"_id\": mongoose.Types.ObjectId(userid), \"userLabels.identifier\": identifier }, function (err, result) { if (callBack)return callBack(err, result); }) }; å­è¡¨åˆ é™¤æ•°æ®ç”±äºä¸šåŠ¡ä¸Šçš„éœ€è¦ï¼Œæ‰€ä»¥æ¥ä¸‹æ¥æ–¹æ³•æ˜¯æ¸…ç©ºè¯¥ç”¨æˆ·æ‰€æœ‰çš„ä¸ªäººæ ‡ç­¾ UserSchema.statics.cleanUserLabels = function (userid, callBack) { ///å…ˆæ‰¾åˆ°è¯¥ç”¨æˆ· this.findOne({\"_id\": mongoose.Types.ObjectId(userid)}, function (err, result) { ///å¾ªç¯éå†ç”¨æˆ·çš„ä¸ªäººæ ‡ç­¾ï¼Œasync ä¼šåœ¨å¦ä¸€ç¯‡åšå®¢ä¸­è¯¦ç»†è®²è§£ async.map(result.userLabels, function (item, callback) { // ä¹‹åä½¿ç”¨ $pull åˆ é™¤ç”¨æˆ·çš„ä¸ªäººæ ‡ç­¾ User.update({\"_id\": mongoose.Types.ObjectId(userid)}, {'$pull': {\"userLabels\": {\"identifier\": item.identifier}}}, function (err, numberUpdated) { callback(null, true) }); }, function (err, results) { if (callBack)return callBack(results.length); }); }); }; å­è¡¨ä¿®æ”¹æ•°æ®UserSchema.statics.modifysUserLabel = function (userid, identifier,content, callBack) { this.update({ \"_id\": mongoose.Types.ObjectId(userid), \"userLabels.identifier\": identifier }, {'$set': {\"userLabels.$.content\": content}}, function (err, numberUpdated) { User.findById(userid, function (err, data) { if(callBack)callBack(err, data); }); }); }; ä»¥ä¸Šå°±æ˜¯å­ç±»çš„å¢åˆ æ”¹æŸ¥ã€‚å¸Œæœ›å¯¹ä½ æœ‰äº›è®¸å¸®åŠ©ã€‚åŸºæœ¬çš„å¢åˆ æ”¹æŸ¥ï¼Œæˆ‘è¿™é‡Œå°±ä¸å¤šå¤šè§£é‡Šäº†ã€‚ ##å…³è”è¡¨å¦‚ä½•æ“ä½œ åœ¨mongodbä¸­å¹¶æ²¡æœ‰å…³è”è¡¨è¿™ä¹ˆä¸€è¯´ï¼Œè¿™ä¹Ÿæ˜¯å› ä¸ºmongodbæœ¬èº«å°±æ˜¯éå…³ç³»å‹æ•°æ®åº“ï¼Œä½†æ˜¯mongooseä¸­çš„populateæ–¹æ³•åœ¨ä¸€å®šç¨‹åº¦ä¸Šè§£å†³äº†å…³è”é—®é¢˜ é¦–å…ˆæ¥æŸ¥çœ‹ä¸€äº›æ•°æ®åº“çš„è®¾è®¡å§ã€‚ å…³è”è¡¨è®¾è®¡//ç”¨æˆ·è¡¨ var UserSchema = new mongoose.Schema({ name: String }, {collection: \"MeetUser\"}); //åŠ å…¥æ•°æ®åº“ var User = mongoose.model('User', UserSchema); //åˆ†ç»„è¡¨ var GroupSchema = new mongoose.Schema({ name:String, //æ­¤æ—¶çš„refå­—æ®µè¦å’ŒåŠ å…¥æ•°æ®åº“ä¸­çš„modelæ–¹æ³•å†…çš„å­—æ®µå»åˆï¼Œå¹¶ä¸”è®°ä½ä¸€å®šè¦å†™å­—ç¬¦ä¸² users:[{type:mongoose.Schema.ObjectId,ref:'User'}] },{collection:\"MeetGroup\"}); var Group = mongoose.model('Group',GroupSchema); å…³è”è¡¨æŸ¥è¯¢æ–¹æ³• GroupSchema.statics.loadGroup = function(callBack){ Group.find().populate('users').exec(callBack); }; ä»¥ä¸Šæ˜¯æ¯”è¾ƒåŸºç¡€çš„æŸ¥è¯¢ï¼Œä½†æ˜¯æˆ‘ä»¬å¼€å‘çš„æ—¶å€™é‡åˆ°çš„å¾€å¾€æ²¡æœ‰é‚£ä¹ˆç®€å•ï¼Œå¦‚æœæˆ‘æƒ³å¯¹å­—è¡¨è¿›è¡Œæ’åºæˆ–è€…ç­›é€‰å†æˆ–è€…æˆ‘åªæƒ³è¦å­è¡¨é‡Œçš„å…¶ä¸­ä¸€äº›å­—æ®µè¯¥æ€ä¹ˆåŠå‘¢ å…³è”è¡¨å‡†ç¡®æŸ¥è¯¢GroupSchema.statics.loadGroup = function(callBack){ var populateQuery = {path:'users',select:'name',match:{ 'name':'Msiter' },options:{ limit:20 },sort:{'_id':1}}; Group.findOne({name:\"Test\"}).select('name users').populate(populateQuery).exec(callBack); }; å…¶ä¸­ Pathå­—æ®µæ˜¯æŒ‡è¦æŸ¥è¯¢çš„ å“ªä¸€ä¸ª å…³è”è¡¨ï¼Œselect åˆ™æ˜¯éœ€è¦å­—è¡¨çš„é‚£äº›å­—æ®µ ï¼Œå¦‚æœéœ€è¦å¤šä¸ª ä¸­é—´ä¸€ä¸ª ç©ºæ ¼åˆ†éš”å³å¯ï¼Œ_idå­—æ®µæ˜¯é»˜è®¤è¢«éœ€è¦çš„ã€‚matchå°±æ˜¯å¯¹å…³è”è¡¨çš„è¿™äº›ç­›é€‰çš„ï¼Œoptionså°±å¯ä»¥ä½¿ç”¨åˆ†é¡µå‚æ•° Skipå’Œlimitäº† å½“ç„¶ä¹Ÿæœ‰ä¸€äº›å¸¸è§çš„æŸ¥è¯¢å‚æ•°è­¬å¦‚Sortç­‰ï¼› å…³è”è¡¨çš„å¢åŠ å‘¢ï¼Ÿ///è¿™é‡Œçš„Useridæ—¶mongoose.Schema.ObjectIdï¼Œå³ä½ è¦å…³è”çš„å¯¹è±¡çš„Id GroupSchema.statics.createGroup = function(groupname,userId,callBack){ var group = new Group({name:groupname}); group.users.push(userId); group.save(callBack); }; å…³è”è¡¨çš„åˆ é™¤///è¿™é‡Œçš„Useridæ—¶mongoose.Schema.ObjectIdï¼Œå³ä½ è¦å…³è”çš„å¯¹è±¡çš„Id GroupSchema.statics.createGroup = function(groupname,userId,callBack){ var group = new Group({name:groupname}); group.users.pull(userId); group.save(callBack); };","categories":[{"name":"æœåŠ¡å™¨","slug":"æœåŠ¡å™¨","permalink":"http://www.msiter.com/categories/æœåŠ¡å™¨/"}],"tags":[{"name":"mongodb","slug":"mongodb","permalink":"http://www.msiter.com/tags/mongodb/"},{"name":"mongoose","slug":"mongoose","permalink":"http://www.msiter.com/tags/mongoose/"},{"name":"nodejs","slug":"nodejs","permalink":"http://www.msiter.com/tags/nodejs/"}],"keywords":[{"name":"æœåŠ¡å™¨","slug":"æœåŠ¡å™¨","permalink":"http://www.msiter.com/categories/æœåŠ¡å™¨/"}]},{"title":"Nodejs Async å­¦ä¹ ","slug":"Nodejs Async å­¦ä¹ ","date":"2015-07-06T18:41:43.000Z","updated":"2017-11-28T11:07:04.827Z","comments":true,"path":"2015/07/06/Nodejs Async å­¦ä¹ /","link":"","permalink":"http://www.msiter.com/2015/07/06/Nodejs Async å­¦ä¹ /","excerpt":"æœ¬æ–‡æ•´ç†äºbsspiritçš„åšæ–‡å’Œä»£ç ç¤ºä¾‹ Asyncæ˜¯ä¸€ä¸ªæµç¨‹æ§åˆ¶å·¥å…·åŒ…ï¼Œæä¾›äº†ç›´æ¥è€Œå¼ºå¤§çš„å¼‚æ­¥åŠŸèƒ½ã€‚åŸºäºJavascriptä¸ºNode.jsè®¾è®¡ï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥ç›´æ¥åœ¨æµè§ˆå™¨ä¸­ä½¿ç”¨ã€‚Asyncæä¾›äº†å¤§çº¦20ä¸ªå‡½æ•°ï¼ŒåŒ…æ‹¬å¸¸ç”¨çš„map,reduce, filter, forEach ç­‰ï¼Œå¼‚æ­¥æµç¨‹æ§åˆ¶æ¨¡å¼åŒ…æ‹¬ï¼Œä¸²è¡Œ(series)ï¼Œå¹¶è¡Œ(parallel)ï¼Œç€‘å¸ƒ(waterfall)ç­‰ã€‚","text":"æœ¬æ–‡æ•´ç†äºbsspiritçš„åšæ–‡å’Œä»£ç ç¤ºä¾‹ Asyncæ˜¯ä¸€ä¸ªæµç¨‹æ§åˆ¶å·¥å…·åŒ…ï¼Œæä¾›äº†ç›´æ¥è€Œå¼ºå¤§çš„å¼‚æ­¥åŠŸèƒ½ã€‚åŸºäºJavascriptä¸ºNode.jsè®¾è®¡ï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥ç›´æ¥åœ¨æµè§ˆå™¨ä¸­ä½¿ç”¨ã€‚Asyncæä¾›äº†å¤§çº¦20ä¸ªå‡½æ•°ï¼ŒåŒ…æ‹¬å¸¸ç”¨çš„map,reduce, filter, forEach ç­‰ï¼Œå¼‚æ­¥æµç¨‹æ§åˆ¶æ¨¡å¼åŒ…æ‹¬ï¼Œä¸²è¡Œ(series)ï¼Œå¹¶è¡Œ(parallel)ï¼Œç€‘å¸ƒ(waterfall)ç­‰ã€‚ é¡¹ç›®ç®€ä»‹Async For Async v1.5.x documentation, go HERE Async is a utility module which provides straight-forward, powerful functionsfor working with asynchronous JavaScript. Although originally designed foruse with Node.js and installable via npm install --save async,it can also be used directly in the browser. Async is also installable via: bower: bower install async component: component install caolan/async jam: jam install async Async provides around 70 functions that include the usual â€˜functionalâ€™suspects (map, reduce, filter, eachâ€¦) as well as some common patternsfor asynchronous control flow (parallel, series, waterfallâ€¦). All thesefunctions assume you follow the Node.js convention of providing a singlecallback as the last argument of your asynchronous function â€“ a callback which expects an Error as its first argument â€“ and calling the callback once. åŠŸèƒ½ç®€ä»‹ é›†åˆ:Collections each: å¦‚æœæƒ³å¯¹åŒä¸€ä¸ªé›†åˆä¸­çš„æ‰€æœ‰å…ƒç´ éƒ½æ‰§è¡ŒåŒä¸€ä¸ªå¼‚æ­¥æ“ä½œã€‚ map: å¯¹é›†åˆä¸­çš„æ¯ä¸€ä¸ªå…ƒç´ ï¼Œæ‰§è¡ŒæŸä¸ªå¼‚æ­¥æ“ä½œï¼Œå¾—åˆ°ç»“æœã€‚æ‰€æœ‰çš„ç»“æœå°†æ±‡æ€»åˆ°æœ€ç»ˆçš„callbacké‡Œã€‚ä¸eachçš„åŒºåˆ«æ˜¯ï¼Œeachåªå…³å¿ƒæ“ä½œä¸ç®¡æœ€åçš„å€¼ï¼Œè€Œmapå…³å¿ƒçš„æœ€åäº§ç”Ÿçš„å€¼ã€‚ filter: ä½¿ç”¨å¼‚æ­¥æ“ä½œå¯¹é›†åˆä¸­çš„å…ƒç´ è¿›è¡Œç­›é€‰, éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œiteratorçš„callbackåªæœ‰ä¸€ä¸ªå‚æ•°ï¼Œåªèƒ½æ¥æ”¶trueæˆ–falseã€‚ reject: rejectè·Ÿfilteræ­£å¥½ç›¸åï¼Œå½“æµ‹è¯•ä¸ºtrueæ—¶åˆ™æŠ›å¼ƒ reduce: å¯ä»¥è®©æˆ‘ä»¬ç»™å®šä¸€ä¸ªåˆå§‹å€¼ï¼Œç”¨å®ƒä¸é›†åˆä¸­çš„æ¯ä¸€ä¸ªå…ƒç´ åšè¿ç®—ï¼Œæœ€åå¾—åˆ°ä¸€ä¸ªå€¼ã€‚reduceä»å·¦å‘å³æ¥éå†å…ƒç´ ï¼Œå¦‚æœæƒ³ä»å³å‘å·¦ï¼Œå¯ä½¿ç”¨reduceRightã€‚ detect: ç”¨äºå–å¾—é›†åˆä¸­æ»¡è¶³æ¡ä»¶çš„ç¬¬ä¸€ä¸ªå…ƒç´ ã€‚ sortBy: å¯¹é›†åˆå†…çš„å…ƒç´ è¿›è¡Œæ’åºï¼Œä¾æ®æ¯ä¸ªå…ƒç´ è¿›è¡ŒæŸå¼‚æ­¥æ“ä½œåäº§ç”Ÿçš„å€¼ï¼Œä»å°åˆ°å¤§æ’åºã€‚ some: å½“é›†åˆä¸­æ˜¯å¦æœ‰è‡³å°‘ä¸€ä¸ªå…ƒç´ æ»¡è¶³æ¡ä»¶æ—¶ï¼Œæœ€ç»ˆcallbackå¾—åˆ°çš„å€¼ä¸ºtrueï¼Œå¦åˆ™ä¸ºfalse. every: å¦‚æœé›†åˆé‡Œæ¯ä¸€ä¸ªå…ƒç´ éƒ½æ»¡è¶³æ¡ä»¶ï¼Œåˆ™ä¼ ç»™æœ€ç»ˆå›è°ƒçš„resultä¸ºtrueï¼Œå¦åˆ™ä¸ºfalse concat: å°†å¤šä¸ªå¼‚æ­¥æ“ä½œçš„ç»“æœåˆå¹¶ä¸ºä¸€ä¸ªæ•°ç»„ã€‚ æµç¨‹æ§åˆ¶: Control Flow concat: ä¸²è¡Œæ‰§è¡Œï¼Œä¸€ä¸ªå‡½æ•°æ•°ç»„ä¸­çš„æ¯ä¸ªå‡½æ•°ï¼Œæ¯ä¸€ä¸ªå‡½æ•°æ‰§è¡Œå®Œæˆä¹‹åæ‰èƒ½æ‰§è¡Œä¸‹ä¸€ä¸ªå‡½æ•°ã€‚ parallel: å¹¶è¡Œæ‰§è¡Œå¤šä¸ªå‡½æ•°ï¼Œæ¯ä¸ªå‡½æ•°éƒ½æ˜¯ç«‹å³æ‰§è¡Œï¼Œä¸éœ€è¦ç­‰å¾…å…¶å®ƒå‡½æ•°å…ˆæ‰§è¡Œã€‚ä¼ ç»™æœ€ç»ˆcallbackçš„æ•°ç»„ä¸­çš„æ•°æ®æŒ‰ç…§tasksä¸­å£°æ˜çš„é¡ºåºï¼Œè€Œä¸æ˜¯æ‰§è¡Œå®Œæˆçš„é¡ºåºã€‚ whilst: ç›¸å½“äºwhileï¼Œä½†å…¶ä¸­çš„å¼‚æ­¥è°ƒç”¨å°†åœ¨å®Œæˆåæ‰ä¼šè¿›è¡Œä¸‹ä¸€æ¬¡å¾ªç¯ã€‚ doWhilst: ç›¸å½“äºdoâ€¦while, doWhilstäº¤æ¢äº†fn,testçš„å‚æ•°ä½ç½®ï¼Œå…ˆæ‰§è¡Œä¸€æ¬¡å¾ªç¯ï¼Œå†åšteståˆ¤æ–­ã€‚ until: untilä¸whilstæ­£å¥½ç›¸åï¼Œå½“testä¸ºfalseæ—¶å¾ªç¯ï¼Œä¸trueæ—¶è·³å‡ºã€‚å…¶å®ƒç‰¹æ€§ä¸€è‡´ã€‚ doUntil: doUntilä¸doWhilstæ­£å¥½ç›¸åï¼Œå½“testä¸ºfalseæ—¶å¾ªç¯ï¼Œä¸trueæ—¶è·³å‡ºã€‚å…¶å®ƒç‰¹æ€§ä¸€è‡´ã€‚ forever: æ— è®ºæ¡ä»¶å¾ªç¯æ‰§è¡Œï¼Œå¦‚æœä¸å‡ºé”™ï¼Œcallbackæ°¸è¿œä¸è¢«æ‰§è¡Œã€‚ waterfall: æŒ‰é¡ºåºä¾æ¬¡æ‰§è¡Œä¸€ç»„å‡½æ•°ã€‚æ¯ä¸ªå‡½æ•°äº§ç”Ÿçš„å€¼ï¼Œéƒ½å°†ä¼ ç»™ä¸‹ä¸€ä¸ªã€‚ compose: åˆ›å»ºä¸€ä¸ªåŒ…æ‹¬ä¸€ç»„å¼‚æ­¥å‡½æ•°çš„å‡½æ•°é›†åˆï¼Œæ¯ä¸ªå‡½æ•°ä¼šæ¶ˆè´¹ä¸Šä¸€æ¬¡å‡½æ•°çš„è¿”å›å€¼ã€‚æŠŠf(),g(),h()å¼‚æ­¥å‡½æ•°ï¼Œç»„åˆæˆf(g(h()))çš„å½¢å¼ï¼Œé€šè¿‡callbackå¾—åˆ°è¿”å›å€¼ã€‚ applyEach: å®ç°ç»™ä¸€æ•°ç»„ä¸­æ¯ä¸ªå‡½æ•°ä¼ ç›¸åŒå‚æ•°ï¼Œé€šè¿‡callbackè¿”å›ã€‚å¦‚æœåªä¼ ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œå°†è¿”å›ä¸€ä¸ªå‡½æ•°å¯¹è±¡ï¼Œæˆ‘å¯ä»¥ä¼ å‚è°ƒç”¨ã€‚ queue: æ˜¯ä¸€ä¸ªä¸²è¡Œçš„æ¶ˆæ¯é˜Ÿåˆ—ï¼Œé€šè¿‡é™åˆ¶äº†workeræ•°é‡ï¼Œä¸å†ä¸€æ¬¡æ€§å…¨éƒ¨æ‰§è¡Œã€‚å½“workeræ•°é‡ä¸å¤Ÿç”¨æ—¶ï¼Œæ–°åŠ å…¥çš„ä»»åŠ¡å°†ä¼šæ’é˜Ÿç­‰å€™ï¼Œç›´åˆ°æœ‰æ–°çš„workerå¯ç”¨ã€‚ cargo: ä¸€ä¸ªä¸²è¡Œçš„æ¶ˆæ¯é˜Ÿåˆ—ï¼Œç±»ä¼¼äºqueueï¼Œé€šè¿‡é™åˆ¶äº†workeræ•°é‡ï¼Œä¸å†ä¸€æ¬¡æ€§å…¨éƒ¨æ‰§è¡Œã€‚ä¸åŒä¹‹å¤„åœ¨äºï¼Œcargoæ¯æ¬¡ä¼šåŠ è½½æ»¡é¢çš„ä»»åŠ¡åšä¸ºä»»åŠ¡å•å…ƒï¼Œåªæœ‰ä»»åŠ¡å•å…ƒä¸­å…¨éƒ¨æ‰§è¡Œå®Œæˆåï¼Œæ‰ä¼šåŠ è½½æ–°çš„ä»»åŠ¡å•å…ƒã€‚ auto: ç”¨æ¥å¤„ç†æœ‰ä¾èµ–å…³ç³»çš„å¤šä¸ªä»»åŠ¡çš„æ‰§è¡Œã€‚ iterator: å°†ä¸€ç»„å‡½æ•°åŒ…è£…æˆä¸ºä¸€ä¸ªiteratorï¼Œåˆæ¬¡è°ƒç”¨æ­¤iteratoræ—¶ï¼Œä¼šæ‰§è¡Œå®šä¹‰ä¸­çš„ç¬¬ä¸€ä¸ªå‡½æ•°å¹¶è¿”å›ç¬¬äºŒä¸ªå‡½æ•°ä»¥ä¾›è°ƒç”¨ã€‚ apply: å¯ä»¥è®©æˆ‘ä»¬ç»™ä¸€ä¸ªå‡½æ•°é¢„ç»‘å®šå¤šä¸ªå‚æ•°å¹¶ç”Ÿæˆä¸€ä¸ªå¯ç›´æ¥è°ƒç”¨çš„æ–°å‡½æ•°ï¼Œç®€åŒ–ä»£ç ã€‚ nextTick: ä¸nodejsçš„nextTickä¸€æ ·ï¼Œå†æœ€åè°ƒç”¨å‡½æ•°ã€‚ times: å¼‚æ­¥è¿è¡Œ,timeså¯ä»¥æŒ‡å®šè°ƒç”¨å‡ æ¬¡ï¼Œå¹¶æŠŠç»“æœåˆå¹¶åˆ°æ•°ç»„ä¸­è¿”å› timesSeries: ä¸timeç±»ä¼¼ï¼Œå”¯ä¸€ä¸åŒçš„æ˜¯åŒæ­¥æ‰§è¡Œ å·¥å…·ç±»: Utils memoize: è®©æŸä¸€ä¸ªå‡½æ•°åœ¨å†…å­˜ä¸­ç¼“å­˜å®ƒçš„è®¡ç®—ç»“æœã€‚å¯¹äºç›¸åŒçš„å‚æ•°ï¼Œåªè®¡ç®—ä¸€æ¬¡ï¼Œä¸‹æ¬¡å°±ç›´æ¥æ‹¿åˆ°ä¹‹å‰ç®—å¥½çš„ç»“æœã€‚ unmemoize: è®©å·²ç»è¢«ç¼“å­˜çš„å‡½æ•°ï¼Œè¿”å›ä¸ç¼“å­˜çš„å‡½æ•°å¼•ç”¨ã€‚ log: æ‰§è¡ŒæŸå¼‚æ­¥å‡½æ•°ï¼Œå¹¶è®°å½•å®ƒçš„è¿”å›å€¼ï¼Œæ—¥å¿—è¾“å‡ºã€‚ dir: ä¸logç±»ä¼¼ï¼Œä¸åŒä¹‹å¤„åœ¨äºï¼Œä¼šè°ƒç”¨æµè§ˆå™¨çš„console.dir()å‡½æ•°ï¼Œæ˜¾ç¤ºä¸ºDOMè§†å›¾ã€‚ noConflict: å¦‚æœä¹‹å‰å·²ç»åœ¨å…¨å±€åŸŸä¸­å®šä¹‰äº†asyncå˜é‡ï¼Œå½“å¯¼å…¥æœ¬async.jsæ—¶ï¼Œä¼šå…ˆæŠŠä¹‹å‰çš„asyncå˜é‡ä¿å­˜èµ·æ¥ï¼Œç„¶åè¦†ç›–å®ƒã€‚ä»…ä»…ç”¨äºæµè§ˆå™¨ç«¯ï¼Œåœ¨nodejsä¸­æ²¡ç”¨ï¼Œè¿™é‡Œæ— æ³•æ¼”ç¤ºã€‚ ä»£ç æ¼”ç¤º applyä»£ç æ¼”ç¤ºvar async = require('async'); var t = require('./t'); var log = t.log; /** * applyæ˜¯ä¸€ä¸ªéå¸¸å¥½ç”¨çš„å‡½æ•°ï¼Œå¯ä»¥è®©æˆ‘ä»¬ç»™ä¸€ä¸ªå‡½æ•°é¢„ç»‘å®šå¤šä¸ªå‚æ•°å¹¶ç”Ÿæˆä¸€ä¸ªå¯ç›´æ¥è°ƒç”¨çš„æ–°å‡½æ•°ï¼Œç®€åŒ–ä»£ç ã€‚ * * function(callback) { t.inc(3, callback); } * ç­‰ä»·äºï¼š * async.apply(t.inc, 3); */ // apply(function, arguments..) /** * é€šè¿‡åå­—ç»‘å®šå‡½æ•°t.inc, t.fireï¼Œä½œä¸ºæ–°å‡½æ•°ç»™parallelè°ƒç”¨ */ //1.1 async.parallel([ async.apply(t.inc, 3), async.apply(t.fire, 100) ], function (err, results) { log('1.1 err: ', err); log('1.1 results: ', results); }); //58.605> 1.1 err: null //58.613> 1.1 results: [ 4, 100 ] /** * æ„é€ ä¸€ä¸ªåŠ æ³•å‡½æ•°ï¼Œé€šè¿‡applyç®€åŒ–ä»£ç  */ //1.2 function inc(a,b,callback,timeout){ var timeout = timeout || 200; t.wait(200); setTimeout(function() { callback(null, a+b); }, timeout); } var fn = async.apply(inc, 1, 2); fn(function(err, n){ log('1.2 inc: ' + n); }); //58.616> 1.2 inc: 3 applyEachä»£ç æ¼”ç¤ºvar async = require('async'); var t = require('./t'); var log = t.log; /** * applyEachï¼Œå¯ä»¥å®ç°ç»™ä¸€æ•°ç»„ä¸­æ¯ä¸ªå‡½æ•°ä¼ ç›¸åŒå‚æ•°ï¼Œé€šè¿‡callbackè¿”å›ã€‚ * å¦‚æœåªä¼ ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œå°†è¿”å›ä¸€ä¸ªå‡½æ•°å¯¹è±¡ï¼Œæˆ‘å¯ä»¥ä¼ å‚è°ƒç”¨ã€‚ */ // applyEach(fns, args..., callback) /** * å¼‚æ­¥æ‰§è¡Œï¼Œç»™æ•°ç»„ä¸­çš„å‡½æ•°ï¼Œä»–ä»¬æœ‰ç›¸åŒçš„å‚æ•°ã€‚ */ //1.1 async.applyEach([ function (name,cb) { setTimeout(function () { log(\"1.1 handler: \" + name + \" A\"); cb(null, name); }, 500); }, function (name,cb) { setTimeout(function () { log(\"1.1 handler: \" + name + \" B\"); cb(null, name); }, 150); } ], 'Hello', function (err) { log('1.1 err: ', err); }); //06.739> 1.1 handler: Hello B //07.079> 1.1 handler: Hello A //07.080> 1.1 err: null /** * å¼‚æ­¥æ‰§è¡Œï¼Œå½“åªè®¾ç½®ç¬¬ä¸€å‚æ•°åï¼Œå¾—åˆ°å‡½æ•°å¯¹è±¡ï¼Œå†ä¼ å‚è°ƒç”¨è¿™ä¸ªå‡½æ•°ã€‚ */ //1.2 var fn = async.applyEach([ function (name,cb) { setTimeout(function () { log(\"1.2 handler: \" + name + \" A\"); }, 500); }, function (name,cb) { setTimeout(function () { log(\"1.2 handler: \" + name + \" B\"); }, 150); } ]); fn(\"simgle\",function(err){ log('err: ',err); }); //29.351> 1.2 handler: simgle B //29.688> 1.2 handler: simgle A /** * applyEachSeriesä¸applyEachå”¯ä¸€ä¸åŒçš„æ˜¯ï¼Œæ•°ç»„çš„å‡½æ•°åŒæ­¥æ‰§è¡Œã€‚ */ //applyEachSeries(arr, args..., callback) //1.3 async.applyEachSeries([ function (name,cb) { setTimeout(function () { log(\"1.3 handler: \" + name + \" A\"); cb(null, name); }, 500); }, function (name,cb) { setTimeout(function () { log(\"1.3 handler: \" + name + \" B\"); cb(null, name); }, 150); } ], \"aaa\", function (err) { log('1.3 err: ', err); }); //10.669> 1.3 handler: aaa A //10.831> 1.3 handler: aaa B //10.834> 1.3 err: null autoä»£ç æ¼”ç¤ºvar async = require('async'); var t = require('./t'); var log = t.log; /** * autoç”¨æ¥å¤„ç†æœ‰ä¾èµ–å…³ç³»çš„å¤šä¸ªä»»åŠ¡çš„æ‰§è¡Œã€‚ * * æ¯”å¦‚æŸäº›ä»»åŠ¡ä¹‹é—´å½¼æ­¤ç‹¬ç«‹ï¼Œå¯ä»¥å¹¶è¡Œæ‰§è¡Œï¼›ä½†æŸäº›ä»»åŠ¡ä¾èµ–äºå…¶å®ƒæŸäº›ä»»åŠ¡ï¼Œåªèƒ½ç­‰é‚£äº›ä»»åŠ¡å®Œæˆåæ‰èƒ½æ‰§è¡Œã€‚ * è™½ç„¶æˆ‘ä»¬å¯ä»¥ä½¿ç”¨parallelå’Œseriesç»“åˆèµ·æ¥å®ç°è¯¥åŠŸèƒ½ï¼Œä½†å¦‚æœä»»åŠ¡ä¹‹é—´å…³ç³»å¤æ‚ï¼Œåˆ™ä»£ç ä¼šç›¸å½“å¤æ‚ï¼Œä»¥åå¦‚æœæƒ³æ·»åŠ ä¸€ä¸ªæ–°ä»»åŠ¡ï¼Œä¹Ÿä¼šå¾ˆéº»çƒ¦ã€‚ * è¿™æ—¶ä½¿ç”¨autoï¼Œåˆ™ä¼šäº‹åŠåŠŸå€ã€‚ * * å¦‚æœæœ‰ä»»åŠ¡ä¸­é€”å‡ºé”™ï¼Œåˆ™ä¼šæŠŠè¯¥é”™è¯¯ä¼ ç»™æœ€ç»ˆcallbackï¼Œæ‰€æœ‰ä»»åŠ¡ï¼ˆåŒ…æ‹¬å·²ç»æ‰§è¡Œå®Œçš„ï¼‰äº§ç”Ÿçš„æ•°æ®å°†è¢«å¿½ç•¥ã€‚ * å¦‚æœä¸å…³å¿ƒé”™è¯¯å’Œæœ€ç»ˆæ•°æ®ï¼Œå¯ä»¥ä¸ç”¨å†™æœ€åé‚£ä¸ªcallbackã€‚ */ // async.auto(tasks, [callback]) /** * æˆ‘è¦å†™ä¸€ä¸ªç¨‹åºï¼Œå®ƒè¦å®Œæˆä»¥ä¸‹å‡ ä»¶äº‹ï¼š * 1. ä»æŸå¤„å–å¾—æ•°æ® * 2. åœ¨ç¡¬ç›˜ä¸Šå»ºç«‹ä¸€ä¸ªæ–°çš„ç›®å½• * 3. å°†æ•°æ®å†™å…¥åˆ°ç›®å½•ä¸‹æŸæ–‡ä»¶ * 4. å‘é€é‚®ä»¶ï¼Œå°†æ–‡ä»¶ä»¥é™„ä»¶å½¢å¼å‘é€ç»™å…¶å®ƒäººã€‚ * * åˆ†æè¯¥ä»»åŠ¡ï¼Œå¯ä»¥çŸ¥é“1ä¸2å¯ä»¥å¹¶è¡Œæ‰§è¡Œï¼Œ3éœ€è¦ç­‰1å’Œ2å®Œæˆï¼Œ4è¦ç­‰3å®Œæˆã€‚ * å¯ä»¥æŒ‰ä»¥ä¸‹æ–¹å¼æ¥ä½¿ç”¨autoå‡½æ•°ã€‚ */ // 1.1 async.auto({ getData: function (callback) { setTimeout(function(){ console.log('1.1: got data'); callback(null, 'mydata'); }, 300); }, makeFolder: function (callback) { setTimeout(function(){ console.log('1.1: made folder'); callback(null, 'myfolder'); }, 200); }, writeFile: ['getData', 'makeFolder', function(callback) { setTimeout(function(){ console.log('1.1: wrote file'); callback(null, 'myfile'); }, 300); }], emailFiles: ['writeFile', function(callback, results) { log('1.1: emailed file: ', results.writeFile); callback(null, results.writeFile); }] }, function(err, results) { log('1.1: err: ', err); log('1.1: results: ', results); }); //1.1: made folder //1.1: got data //1.1: wrote file //20.120> 1.1: emailed file: myfile //20.125> 1.1: err: null //20.127> 1.1: results: { makeFolder: 'myfolder', // getData: 'mydata', // writeFile: 'myfile', // emailFiles: 'myfile' } /** * å¦‚æœä¸­é€”å‡ºé”™ï¼Œåˆ™ä¼šæŠŠé”™è¯¯äº¤ç»™æœ€ç»ˆcallbackï¼Œæ‰§è¡Œå®Œä»»åŠ¡çš„ä¼ ç»™æœ€ç»ˆcallbackã€‚æœªæ‰§è¡Œå®Œæˆçš„å‡½æ•°å€¼è¢«å¿½ç•¥ */ // 1.2 async.auto({ getData: function (callback) { setTimeout(function(){ console.log('1.2: got data'); callback(null, 'mydata'); }, 300); }, makeFolder: function (callback) { setTimeout(function(){ console.log('1.2: made folder'); callback(null, 'myfolder'); }, 200); }, writeFile: ['getData', 'makeFolder', function(callback, results) { setTimeout(function(){ console.log('1.2: wrote file'); callback('myerr'); }, 300); }], emailFiles: ['writeFile', function(callback, results) { console.log('1.2: emailed file: ' + results.writeFile); callback('err sending email', results.writeFile); }] }, function(err, results) { log('1.2 err: ', err); log('1.2 results: ', results); }); //1.2: made folder //1.2: got data //1.2: wrote file //51.399> 1.2 err: myerr //51.401> 1.2 results: { makeFolder: 'myfolder', // getData: 'mydata', // writeFile: undefined } cargoä»£ç æ¼”ç¤ºvar async = require('async'); var t = require('./t'); var log = t.log; /** * cargoä¹Ÿæ˜¯ä¸€ä¸ªä¸²è¡Œçš„æ¶ˆæ¯é˜Ÿåˆ—ï¼Œç±»ä¼¼äºqueueï¼Œé€šè¿‡é™åˆ¶äº†workeræ•°é‡ï¼Œä¸å†ä¸€æ¬¡æ€§å…¨éƒ¨æ‰§è¡Œã€‚ * å½“workeræ•°é‡ä¸å¤Ÿç”¨æ—¶ï¼Œæ–°åŠ å…¥çš„ä»»åŠ¡å°†ä¼šæ’é˜Ÿç­‰å€™ï¼Œç›´åˆ°æœ‰æ–°çš„workerå¯ç”¨ã€‚ * * cargoçš„ä¸åŒä¹‹å¤„åœ¨äºï¼Œcargoæ¯æ¬¡ä¼šåŠ è½½æ»¡é¢çš„ä»»åŠ¡åšä¸ºä»»åŠ¡å•å…ƒï¼Œåªæœ‰ä»»åŠ¡å•å…ƒä¸­å…¨éƒ¨æ‰§è¡Œå®Œæˆåï¼Œæ‰ä¼šåŠ è½½æ–°çš„ä»»åŠ¡å•å…ƒã€‚ */ // cargo(worker, [payload]) /** * åˆ›å»ºcargoå®ä¾‹ */ var cargo = async.cargo(function (tasks, callback) { for(var i=0; i&lt;tasks.length; i++){ log('start ' + tasks[i].name); } callback(); }, 2); /** * ç›‘å¬ï¼šå¦‚æœæŸæ¬¡pushæ“ä½œåï¼Œä»»åŠ¡æ•°å°†è¾¾åˆ°æˆ–è¶…è¿‡workeræ•°é‡æ—¶ï¼Œå°†è°ƒç”¨è¯¥å‡½æ•° */ cargo.saturated = function() { log('all workers to be used'); } /** * ç›‘å¬ï¼šå½“æœ€åä¸€ä¸ªä»»åŠ¡äº¤ç»™workeræ—¶ï¼Œå°†è°ƒç”¨è¯¥å‡½æ•° */ cargo.empty = function() { log('no more tasks wating'); } /** * ç›‘å¬ï¼šå½“æ‰€æœ‰ä»»åŠ¡éƒ½æ‰§è¡Œå®Œä»¥åï¼Œå°†è°ƒç”¨è¯¥å‡½æ•° */ cargo.drain = function() { log('all tasks have been processed'); } /** * å¢åŠ æ–°ä»»åŠ¡ */ cargo.push({name: 'A'}, function (err) { t.wait(300); log('finished processing A'); }); cargo.push({name: 'B'}, function (err) { t.wait(600); log('finished processing B'); }); cargo.push({name: 'C'}, function (err) { t.wait(500); log('finished processing C'); }); cargo.push({name: 'D'}, function (err) { t.wait(100); log('finished processing D'); }); cargo.push({name: 'E'}, function (err) { t.wait(200); log('finished processing E'); }); //40.016> all workers to be used //40.020> no more tasks wating //40.020> start A //40.020> start B //40.322> finished processing A //40.923> finished processing B //40.923> no more tasks wating //40.924> start C //40.924> start D //41.425> finished processing C //41.526> finished processing D //41.526> no more tasks wating //41.527> start E //41.728> finished processing E //41.728> all tasks have been processed //41.729> all tasks have been processed //41.729> all tasks have been processed //41.729> all tasks have been processed //41.730> all tasks have been processed composeä»£ç æ¼”ç¤ºvar async = require('async'); var t = require('./t'); var log = t.log; /** * åˆ›å»ºä¸€ä¸ªåŒ…æ‹¬ä¸€ç»„å¼‚æ­¥å‡½æ•°çš„å‡½æ•°é›†åˆï¼Œæ¯ä¸ªå‡½æ•°ä¼šæ¶ˆè´¹ä¸Šä¸€æ¬¡å‡½æ•°çš„è¿”å›å€¼ã€‚ * æŠŠf(),g(),h()å¼‚æ­¥å‡½æ•°ï¼Œç»„åˆæˆf(g(h()))çš„å½¢å¼ï¼Œé€šè¿‡callbackå¾—åˆ°è¿”å›å€¼ã€‚ */ // compose(fn1, fn2...) /** * é€šè¿‡composeç»„åˆï¼Œf(g(h()))çš„å½¢å¼ï¼Œä»å†…å±‚åˆ°å¤–å±‚çš„æ‰§è¡Œçš„é¡ºåºã€‚ */ //1.1 function f(n,callback){ log('1.1.f enter: ',n); setTimeout(function () { callback(null, n + 1); }, 10); } function g(n, callback) { log('1.1.g enter: ',n); setTimeout(function () { callback(null, n * 2); }, 10); } function h(n, callback) { log('1.1.h enter: ',n); setTimeout(function () { callback(null, n - 10); }, 10); } var fgh = async.compose(f,g,h); fgh(4,function(err,result){ log('1.1 err: ', err); log('1.1 result: ', result); }); //05.307> 1.1.h enter: 4 //05.329> 1.1.g enter: -6 //05.341> 1.1.f enter: -12 //05.361> 1.1 err: null //05.362> 1.1 result: -11 concatä»£ç æ¼”ç¤ºvar async = require('async'); var t = require('./t'); var log = t.log; /** * å°†å¤šä¸ªå¼‚æ­¥æ“ä½œçš„ç»“æœåˆå¹¶ä¸ºä¸€ä¸ªæ•°ç»„ã€‚ */ // concat(arr, iterator(item,callback(err,result)), callback(err,result)) var data = { aaa: [11,22,33], bbb: [44,55], ccc: 66 }; var keys = [ {name: 'aaa', delay: 300}, {name: 'bbb', delay: 100}, {name: 'ccc', delay: 200} ]; /** * ä»¥å¹¶è¡Œæ–¹å¼å¯¹é›†åˆä¸­å„å…ƒç´ è¿›è¡Œå¼‚æ­¥æ“ä½œï¼Œç„¶åæŠŠå¾—åˆ°çš„ç»“æœåˆå¹¶ä¸ºä¸€ä¸ªæ•°ç»„ï¼Œä¼ ç»™æœ€åçš„callbackã€‚ */ // 1.1 async.concat(keys, function(key,callback) { setTimeout(function() { callback(null, data[key.name]); }, key.delay); }, function(err, values) { log('1.1 err: ', err); log('1.1 values: ', values); }); // 13.539> 1.1 err: // 13.539> 1.1 values: [ 44, 55, 66, 11, 22, 33 ] /** * å¦‚æœä¸­é€”å‡ºé”™ï¼Œåˆ™æŠŠé”™è¯¯ä»¥åŠå·²ç»å®Œæˆçš„æ“ä½œçš„ç»“æœäº¤ç»™æœ€åcallbackã€‚æœªæ‰§è¡Œå®Œçš„åˆ™å¿½ç•¥ã€‚ */ // 1.2 async.concat(keys, function(key,callback) { setTimeout(function() { if(key.name==='ccc') callback('myerr'); else callback(null, data[key.name]); }, key.delay); }, function(err, values) { log('1.2 err: ', err); log('1.2 values: ', values); }); // 13.439> 1.2 err: myerr // 13.439> 1.2 values: [ 44, 55 ] /** * æŒ‰æ•°ç»„ä¸­çš„å…ƒç´ é¡ºåºæ¥æ‰§è¡Œå¼‚æ­¥æ“ä½œï¼Œä¸€ä¸ªå®Œæˆåæ‰å¯¹ä¸‹ä¸€ä¸ªè¿›è¡Œæ“ä½œã€‚æ‰€æœ‰ç»“æœä¼šæ±‡é›†æˆä¸€ä¸ªæ•°ç»„äº¤ç»™æœ€åçš„callbackã€‚ */ // concatSeries(arr, iterator, callback) // 1.3 async.concatSeries(keys, function(key,callback) { setTimeout(function() { callback(null, data[key.name]); }, key.delay); }, function(err, values) { log('1.3 err: ', err); log('1.3 values: ', values); }); // 13.859> 1.3 err: // 13.859> 1.3 values: [ 11, 22, 33, 44, 55, 66 ] detectä»£ç æ¼”ç¤ºvar async = require('async'); var t = require('./t'); var log = t.log; /** * ç”¨äºå–å¾—é›†åˆä¸­æ»¡è¶³æ¡ä»¶çš„ç¬¬ä¸€ä¸ªå…ƒç´ ã€‚ * å®ƒåˆ†ä¸ºå¹¶è¡Œä¸é¡ºåºæ‰§è¡Œä¸¤ç§æ–¹å¼ï¼Œåˆ†åˆ«å¯¹åº”å‡½æ•°detectå’ŒdetectSeriesã€‚ */ // detect(array, iterator(item,callback(test)), callback(result) var arr = [ {value:1,delay:500}, {value:2,delay:200}, {value:3,delay:300} ]; /** * å¹¶è¡Œæ‰§è¡Œï¼Œé€šè¿‡t.incåšä¸€ä¸ªç´¯åŠ å™¨ï¼Œå¾—åˆ°ç¬¬ä¸€ä¸ªæ»¡è¶³æ¡ä»¶çš„ç»“æœå¯¹è±¡ */ async.detect(arr, function(item,callback){ log('1.1 enter: ', item.value); t.inc(item.value, function(err,n) { log('1.1 handle: ', item.value); callback(n%2===0); }, item.delay); }, function(result) { log('1.1 result: ', result); }); // 09.928> 1.1 enter: 1 // 09.928> 1.1 enter: 2 // 09.928> 1.1 enter: 3 // 10.138> 1.1 handle: 2 // 10.228> 1.1 handle: 3 // 10.228> 1.1 result: { value: 3, delay: 300 } // 10.438> 1.1 handle: 1 // 10.438> 1.1 handle: 1 /** * ä¸²è¡Œæ‰§è¡Œï¼Œé€šè¿‡t.incåšä¸€ä¸ªç´¯åŠ å™¨ï¼Œå¾—åˆ°ç¬¬ä¸€ä¸ªæ»¡è¶³æ¡ä»¶çš„ç»“æœå¯¹è±¡ */ async.detectSeries(arr, function(item,callback) { log('1.2 enter: ', item.value); t.inc(item.value, function(err,n) { log('1.1 handle: ', item.value); callback(n%2===0); }, item.delay); }, function(result) { log('1.2 result: ', result); }); // 09.928> 1.2 enter: 1 // 10.438> 1.2 result: { value: 1, delay: 500 } eachä»£ç æ¼”ç¤ºvar async = require('async'); var t = require('./t'); var log = t.log; /** * å¦‚æœæƒ³å¯¹åŒä¸€ä¸ªé›†åˆä¸­çš„æ‰€æœ‰å…ƒç´ éƒ½æ‰§è¡ŒåŒä¸€ä¸ªå¼‚æ­¥æ“ä½œï¼Œå¯ä»¥åˆ©ç”¨eachå‡½æ•°ã€‚ * * asyncæä¾›äº†ä¸‰ç§æ–¹å¼ï¼š * 1. é›†åˆä¸­æ‰€æœ‰å…ƒç´ å¹¶è¡Œæ‰§è¡Œ * 2. ä¸€ä¸ªä¸€ä¸ªé¡ºåºæ‰§è¡Œ * 3. åˆ†æ‰¹æ‰§è¡Œï¼ŒåŒä¸€æ‰¹å†…å¹¶è¡Œï¼Œæ‰¹ä¸æ‰¹ä¹‹é—´æŒ‰é¡ºåº * * å¦‚æœä¸­é€”å‡ºé”™ï¼Œåˆ™é”™è¯¯å°†ä¸Šä¼ ç»™æœ€ç»ˆçš„callbackå¤„ç†ã€‚å…¶å®ƒå·²ç»å¯åŠ¨çš„ä»»åŠ¡ç»§ç»­æ‰§è¡Œï¼Œæœªå¯åŠ¨çš„å¿½ç•¥ã€‚ */ // each(arr, iterator(item, callback), callback(err)) var arr = [{name:'Jack', delay: 200}, {name:'Mike', delay: 100}, {name:'Freewind', delay: 300}]; /** * æ‰€æœ‰æ“ä½œå¹¶å‘æ‰§è¡Œï¼Œä¸”å…¨éƒ¨æœªå‡ºé”™ï¼Œæœ€ç»ˆå¾—åˆ°çš„errä¸ºundefinedã€‚æ³¨æ„æœ€ç»ˆcallbackåªæœ‰ä¸€ä¸ªå‚æ•°errã€‚ */ // 1.1 async.each(arr, function(item, callback) { log('1.1 enter: ' + item.name); setTimeout(function(){ log('1.1 handle: ' + item.name); callback(null, item.name); }, item.delay); }, function(err) { log('1.1 err: ' + err); }); // è¾“å‡ºå¦‚ä¸‹ï¼š // 42.244> 1.1 enter: Jack // 42.245> 1.1 enter: Mike // 42.245> 1.1 enter: Freewind // 42.350> 1.1 handle: Mike // 42.445> 1.1 handle: Jack // 42.554> 1.1 handle: Freewind // 42.554> 1.1 err: undefined /** * å¦‚æœä¸­é€”å‡ºé”™ï¼Œåˆ™å‡ºé”™åé©¬ä¸Šè°ƒç”¨æœ€ç»ˆçš„callbackã€‚å…¶å®ƒæœªæ‰§è¡Œå®Œçš„ä»»åŠ¡ç»§ç»­æ‰§è¡Œã€‚ */ async.each(arr,function(item, callback) { log('1.2 enter: ' +item.name); setTimeout(function() { log('1.2 handle: ' + item.name); if(item.name==='Jack') { callback('myerr'); } }, item.delay); }, function(err) { log('1.2 err: ' + err); }); // è¾“å‡ºå¦‚ä¸‹ï¼š // 42.246> 1.2 enter: Jack // 42.246> 1.2 enter: Mike // 42.246> 1.2 enter: Freewind // 42.350> 1.2 handle: Mike // 42.445> 1.2 handle: Jack // 42.446> 1.2 err: myerr // 42.555> 1.2 handle: Freewind /** * ä¸eachç›¸ä¼¼ï¼Œä½†ä¸æ˜¯å¹¶è¡Œæ‰§è¡Œã€‚è€Œæ˜¯ä¸€ä¸ªä¸ªæŒ‰é¡ºåºæ‰§è¡Œã€‚ */ async.eachSeries(arr, function(item, callback) { log('1.3 enter: ' + item.name); setTimeout(function(){ log('1.3 handle: ' + item.name); callback(null, item.name); }, item.delay); }, function(err) { log('1.3 err: ' + err); }); // 42.247> 1.3 enter: Jack // 42.459> 1.3 handle: Jack // 42.459> 1.3 enter: Mike // 42.569> 1.3 handle: Mike // 42.569> 1.3 enter: Freewind // 42.883> 1.3 handle: Freewind // 42.883> 1.3 err: undefined /** * å¦‚æœä¸­é€”å‡ºé”™ï¼Œåˆ™é©¬ä¸ŠæŠŠé”™è¯¯ä¼ ç»™æœ€ç»ˆçš„callbackï¼Œè¿˜æœªæ‰§è¡Œçš„ä¸å†æ‰§è¡Œã€‚ */ async.eachSeries(arr,function(item, callback) { log('1.4 enter: ' +item.name); setTimeout(function() { log('1.4 handle: ' + item.name); if(item.name==='Jack') { callback('myerr'); } }, item.delay); }, function(err) { log('1.4 err: ' + err); }); // 42.247> 1.4 enter: Jack // 42.460> 1.4 handle: Jack // 42.460> 1.4 err: myerr /** * åˆ†æ‰¹æ‰§è¡Œï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯æ¯ä¸€æ‰¹çš„ä¸ªæ•°ã€‚æ¯ä¸€æ‰¹å†…å¹¶è¡Œæ‰§è¡Œï¼Œä½†æ‰¹ä¸æ‰¹ä¹‹é—´æŒ‰é¡ºåºæ‰§è¡Œã€‚ */ async.eachLimit(arr, 2, function(item, callback) { log('1.5 enter: ' + item.name); setTimeout(function(){ log('1.5 handle: ' + item.name); callback(null, item.name); }, item.delay); }, function(err) { log('1.5 err: ' + err); }); // 42.247> 1.5 enter: Jack // 42.248> 1.5 enter: Mike // 42.351> 1.5 handle: Mike // 42.352> 1.5 enter: Freewind // 42.461> 1.5 handle: Jack // 42.664> 1.5 handle: Freewind // 42.664> 1.5 err: undefined /** * å¦‚æœä¸­é€”å‡ºé”™ï¼Œé”™è¯¯å°†é©¬ä¸Šä¼ ç»™æœ€ç»ˆçš„callbackã€‚åŒä¸€æ‰¹ä¸­çš„æœªæ‰§è¡Œå®Œçš„ä»»åŠ¡è¿˜å°†ç»§ç»­æ‰§è¡Œï¼Œä½†ä¸‹ä¸€æ‰¹åŠä»¥åçš„ä¸å†æ‰§è¡Œã€‚ */ async.eachLimit(arr,2,function(item, callback) { log('1.6 enter: ' +item.name); setTimeout(function() { log('1.6 handle: ' + item.name); if(item.name==='Jack') { callback('myerr'); } }, item.delay); }, function(err) { log('1.6 err: ' + err); }); // 42.248> 1.6 enter: Jack // 42.248> 1.6 enter: Mike // 42.352> 1.6 handle: Mike // 42.462> 1.6 handle: Jack // 42.462> 1.6 err: myerr everyä»£ç æ¼”ç¤ºvar async = require('async'); var t = require('./t'); var log = t.log; /** * å¦‚æœé›†åˆé‡Œæ¯ä¸€ä¸ªå…ƒç´ éƒ½æ»¡è¶³æ¡ä»¶ï¼Œåˆ™ä¼ ç»™æœ€ç»ˆå›è°ƒçš„resultä¸ºtrueï¼Œå¦åˆ™ä¸ºfalse */ // every(arr, iterator(item,callback), callback(result)) //alias: all var arr = [1,2,3,6]; /** * ä¸²è¡Œæ‰§è¡Œï¼Œé›†åˆä¸­æ‰€æœ‰çš„å…ƒç´ éƒ½&lt;=10ï¼Œæ‰€ä»¥ä¸ºtrue */ async.every(arr, function(item,callback){ log('1.1 enter: ',item); setTimeout(function(){ log('1.1 handle: ',item); callback(item&lt;=10); },100); }, function(result) { log('1.1 result: ', result); }); // 32.113> 1.1 enter: 1 // 32.123> 1.1 enter: 2 // 32.123> 1.1 enter: 3 // 32.123> 1.1 enter: 6 // 32.233> 1.1 handle: 1 // 32.233> 1.1 handle: 2 // 32.233> 1.1 handle: 3 // 32.233> 1.1 handle: 6 // 32.233> 1.1 result: true /** * ä¸²è¡Œæ‰§è¡Œï¼Œé›†åˆä¸­è‡³å°‘æœ‰ä¸€ä¸ªå…ƒç´ ä¸å¤§äº2ï¼Œæ‰€ä»¥ä¸ºfalse */ async.every(arr, function(item,callback){ log('1.2 enter: ',item); setTimeout(function(){ log('1.2 handle: ',item); callback(item>2); },100); }, function(result) { log('1.2 result: ', result); }); // 32.123> 1.2 enter: 1 // 32.123> 1.2 enter: 2 // 32.123> 1.2 enter: 3 // 32.123> 1.2 enter: 6 // 32.233> 1.2 handle: 1 // 32.233> 1.2 result: false // 32.233> 1.2 handle: 2 // 32.233> 1.2 handle: 3 // 32.233> 1.2 handle: 6 filter å’Œ rejectä»£ç æ¼”ç¤º var async = require('async'); var t = require('./t'); var log = t.log; /** * ä½¿ç”¨å¼‚æ­¥æ“ä½œå¯¹é›†åˆä¸­çš„å…ƒç´ è¿›è¡Œç­›é€‰ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œiteratorçš„callbackåªæœ‰ä¸€ä¸ªå‚æ•°ï¼Œåªèƒ½æ¥æ”¶trueæˆ–falseã€‚ * * å¯¹äºå‡ºé”™ï¼Œè¯¥å‡½æ•°æ²¡æœ‰åšå‡ºä»»ä½•å¤„ç†ï¼Œç›´æ¥ç”±nodejsæŠ›å‡ºã€‚æ‰€ä»¥éœ€è¦æ³¨æ„å¯¹Errorçš„å¤„ç†ã€‚ * * asyncæä¾›äº†ä¸¤ç§æ–¹å¼ï¼š * 1. å¹¶è¡Œæ‰§è¡Œï¼šfilter * 2. é¡ºåºæ‰§è¡Œï¼šfilterSereis */ // filter(arr, iterator(item, callback(test)), callback(results)) var arr = [1,2,3,4,5]; /** * å¹¶è¡Œæ‰§è¡Œï¼Œå¯¹arrè¿›è¡Œç­›é€‰ã€‚ */ async.filter(arr, function(item, callback) { log('1.1 enter: ' + item); setTimeout(function() { log('1.1 test: ' + item); callback(item>=3); }, 200); }, function(results) { log('1.1 results: ', results); }); //16.739> 1.1 enter: 1 //16.749> 1.1 enter: 2 //16.749> 1.1 enter: 3 //16.749> 1.1 enter: 4 //16.749> 1.1 enter: 5 //16.749> 1.3 enter: 1 //16.949> 1.1 test: 1 //16.949> 1.1 test: 2 //16.949> 1.1 test: 3 //16.949> 1.1 test: 4 //16.949> 1.1 test: 5 //16.949> 1.1 results: [ 3, 4, 5 ] /** * å¦‚æœå‡ºé”™ï¼Œå°†ä¼šç”±nodejsæŠ›å‡ºï¼Œå¯¼è‡´å‡ºé”™ã€‚ä¸ºä¿è¯å…¶å®ƒä»£ç æ­£å¸¸è¿è¡Œï¼Œæ³¨é‡Šæ‰è¯¥æµ‹è¯•ã€‚ * * try..catchï¼šæŠ“ä¸åˆ°è¿™ä¸ªé”™è¯¯ */ /* async.filter(arr, function(item, callback) { log('1.2 enter: ' + item); setTimeout(function() { log('1.2 handle: ' + item); if(item===2) { throw new Error('myerr'); } callback(item>=3); }, 100); }, function(results) { log('1.2 results: ', results); }); */ /** * ä¸²è¡Œæ‰§è¡Œï¼Œå¯¹arrè¿›è¡Œç­›é€‰ã€‚ */ // 1.3 async.filterSeries(arr, function(item, callback) { log('1.3 enter: ' + item); setTimeout(function() { log('1.3 handle: ' + item); callback(item>=3); }, 200); }, function(results) { log('1.3 results: ', results); }); // 16.749> 1.3 enter: 1 // 16.949> 1.3 handle: 1 // 16.949> 1.3 enter: 2 // 17.149> 1.3 handle: 2 // 17.149> 1.3 enter: 3 // 17.369> 1.3 handle: 3 // 17.369> 1.3 enter: 4 // 17.589> 1.3 handle: 4 // 17.589> 1.3 enter: 5 // 17.789> 1.3 handle: 5 // 17.789> 1.3 results: [ 3, 4, 5 ] /* * rejectè·Ÿfilteræ­£å¥½ç›¸åï¼Œå½“æµ‹è¯•ä¸ºtrueæ—¶ï¼ŒæŠ›å¼ƒä¹‹ */ // reject(arr, iterator(item, callback(test)), callback(results) async.reject(arr, function(item, callback) { log('1.4 enter: ' + item); setTimeout(function() { log('1.4 test: ' + item); callback(item>=3); }, 200); }, function(results) { log('1.4 results: ', results); }); // 31.359> 1.4 enter: 1 // 31.359> 1.4 enter: 2 // 31.359> 1.4 enter: 3 // 31.359> 1.4 enter: 4 // 31.359> 1.4 enter: 5 // 31.559> 1.4 test: 1 // 31.559> 1.4 test: 2 // 31.559> 1.4 test: 3 // 31.559> 1.4 test: 4 // 31.559> 1.4 test: 5 // 31.569> 1.4 results: [ 1, 2 ] /** * ä¸²è¡Œæ‰§è¡Œï¼Œå¯¹arrè¿›è¡Œç­›é€‰ã€‚ */ // 1.3 async.rejectSeries(arr, function(item, callback) { log('1.5 enter: ' + item); setTimeout(function() { log('1.5 handle: ' + item); callback(item>=3); }, 200); }, function(results) { log('1.5 results: ', results); }); //43.592> 1.5 enter: 1 //43.799> 1.5 handle: 1 //43.800> 1.5 enter: 2 //44.004> 1.5 handle: 2 //44.007> 1.5 enter: 3 //44.210> 1.5 handle: 3 //44.211> 1.5 enter: 4 //44.412> 1.5 handle: 4 //44.413> 1.5 enter: 5 //44.614> 1.5 handle: 5 //44.616> 1.5 results: [ 1, 2 ] iteratorä»£ç æ¼”ç¤ºvar async = require('async'); var t = require('./t'); var log = t.log; /** * å°†ä¸€ç»„å‡½æ•°åŒ…è£…æˆä¸ºä¸€ä¸ªiteratorï¼Œåˆæ¬¡è°ƒç”¨æ­¤iteratoræ—¶ï¼Œä¼šæ‰§è¡Œå®šä¹‰ä¸­çš„ç¬¬ä¸€ä¸ªå‡½æ•°å¹¶è¿”å›ç¬¬äºŒä¸ªå‡½æ•°ä»¥ä¾›è°ƒç”¨ã€‚ * ä¹Ÿå¯é€šè¿‡æ‰‹åŠ¨è°ƒç”¨ next() å¾—åˆ°ä»¥ä¸‹ä¸€ä¸ªå‡½æ•°ä¸ºèµ·ç‚¹çš„æ–°çš„iteratorã€‚ * è¯¥å‡½æ•°é€šå¸¸ç”±asyncåœ¨å†…éƒ¨ä½¿ç”¨ï¼Œä½†å¦‚æœéœ€è¦æ—¶ï¼Œä¹Ÿå¯åœ¨æˆ‘ä»¬çš„ä»£ç ä¸­ä½¿ç”¨å®ƒã€‚ */ // async.iterator(tasks) var iter = async.iterator([ function () {log('I am 111')}, function () {log('I am 222')}, function () {log('I am 333')} ]); /** * ç›´æ¥è°ƒç”¨()ï¼Œä¼šæ‰§è¡Œå½“å‰å‡½æ•°ï¼Œå¹¶è¿”å›ä¸€ä¸ªç”±ä¸‹ä¸ªå‡½æ•°ä¸ºèµ·ç‚¹çš„æ–°çš„iterator */ //1.1 log('1.1 iter()'); var it1 = iter(); it1(); it1(); //28.368> 1.1 iter() //28.371> I am 111 //28.372> I am 222 //28.372> I am 222 /** * é€šè¿‡iter()æ¥è°ƒç”¨ä¸‹ä¸€ä¸ªå‡½æ•° */ log('1.2 iter()'); var it2 = iter(); var it3 = it2(); var it4 = it3(); //it4(); // è¿™å¥ä»£ç æ‰§è¡Œä¼šæŠ¥é”™ log(it4); // => 'null' //32.449> 1.2 iter() //32.452> I am 111 //32.452> I am 222 //32.453> I am 333 //32.454> null /** * è°ƒç”¨next()ï¼Œä¸ä¼šæ‰§è¡Œå½“å‰å‡½æ•°ï¼Œç›´æ¥è¿”å›ç”±ä¸‹ä¸ªå‡½æ•°ä¸ºèµ·ç‚¹çš„æ–°iterator * å¯¹äºåŒä¸€ä¸ªiteratorï¼Œå¤šæ¬¡è°ƒç”¨next()ï¼Œä¸ä¼šå½±å“è‡ªå·± */ //1.3 log('1.3 iter()'); var it5 = iter.next(); it5(); var it6 = iter.next().next(); it6(); iter(); //39.895> 1.3 iter() //39.898> I am 222 //39.899> I am 333 //39.899> I am 111 mapä»£ç æ¼”ç¤ºvar async = require('async'); var t = require('./t'); var log = t.log; /** * å¯¹é›†åˆä¸­çš„æ¯ä¸€ä¸ªå…ƒç´ ï¼Œæ‰§è¡ŒæŸä¸ªå¼‚æ­¥æ“ä½œï¼Œå¾—åˆ°ç»“æœã€‚æ‰€æœ‰çš„ç»“æœå°†æ±‡æ€»åˆ°æœ€ç»ˆçš„callbacké‡Œã€‚ä¸eachçš„åŒºåˆ«æ˜¯ï¼Œeachåªå…³å¿ƒæ“ä½œä¸ç®¡æœ€åçš„å€¼ï¼Œè€Œmapå…³å¿ƒçš„æœ€åäº§ç”Ÿçš„å€¼ã€‚ * * æä¾›äº†ä¸¤ç§æ–¹å¼ï¼š * 1. å¹¶è¡Œæ‰§è¡Œã€‚åŒæ—¶å¯¹é›†åˆä¸­æ‰€æœ‰å…ƒç´ è¿›è¡Œæ“ä½œï¼Œç»“æœæ±‡æ€»åˆ°æœ€ç»ˆcallbacké‡Œã€‚å¦‚æœå‡ºé”™ï¼Œåˆ™ç«‹åˆ»è¿”å›é”™è¯¯ä»¥åŠå·²ç»æ‰§è¡Œå®Œçš„ä»»åŠ¡çš„ç»“æœï¼Œæœªæ‰§è¡Œå®Œçš„å ä¸ªç©ºä½ * 2. é¡ºåºæ‰§è¡Œã€‚å¯¹é›†åˆä¸­çš„å…ƒç´ ä¸€ä¸ªä¸€ä¸ªæ‰§è¡Œæ“ä½œï¼Œç»“æœæ±‡æ€»åˆ°æœ€ç»ˆcallbacké‡Œã€‚å¦‚æœå‡ºé”™ï¼Œåˆ™ç«‹åˆ»è¿”å›é”™è¯¯ä»¥åŠå·²ç»æ‰§è¡Œå®Œçš„ç»“æœï¼Œæœªæ‰§è¡Œçš„è¢«å¿½ç•¥ã€‚ */ // map(arr, iterator(item, callback), callback(err, results)) var arr = [{name:'Jack', delay:200}, {name:'Mike', delay: 100}, {name:'Freewind', delay:300}, {name:'Test', delay: 50}]; /** * æ‰€æœ‰æ“ä½œå‡æ­£ç¡®æ‰§è¡Œï¼Œæœªå‡ºé”™ã€‚æ‰€æœ‰ç»“æœæŒ‰å…ƒç´ é¡ºåºæ±‡æ€»ç»™æœ€ç»ˆçš„callbackã€‚ */ // 1.1 async.map(arr, function(item, callback) { log('1.1 enter: ' + item.name); setTimeout(function() { log('1.1 handle: ' + item.name); callback(null, item.name + '!!!'); }, item.delay); }, function(err,results) { log('1.1 err: ', err); log('1.1 results: ', results); }); // 54.569> 1.1 enter: Jack // 54.569> 1.1 enter: Mike // 54.569> 1.1 enter: Freewind // 54.569> 1.1 enter: Test // 54.629> 1.1 handle: Test // 54.679> 1.1 handle: Mike // 54.789> 1.1 handle: Jack // 54.879> 1.1 handle: Freewind // 54.879> 1.1 err: // 54.879> 1.1 results: [ 'Jack!!!', 'Mike!!!', 'Freewind!!!', 'Test!!!' ] /** * å¦‚æœä¸­é€”å‡ºé”™ï¼Œç«‹åˆ»å°†é”™è¯¯ã€ä»¥åŠå·²ç»æ‰§è¡Œå®Œæˆçš„ç»“æœæ±‡æ€»ç»™æœ€ç»ˆcallbackã€‚æœªæ‰§è¡Œå®Œçš„å°†ä¼šåœ¨ç»“æœæ•°ç»„ä¸­ç”¨å ä¸ªç©ºä½ã€‚ */ async.map(arr, function(item, callback) { log('1.2 enter: ' + item.name); setTimeout(function() { log('1.2 handle: ' + item.name); if(item.name==='Jack') callback('myerr'); else callback(null, item.name+'!!!'); }, item.delay); }, function(err, results) { log('1.2 err: ', err); log('1.2 results: ', results); }); // 54.569> 1.2 enter: Jack // 54.569> 1.2 enter: Mike // 54.569> 1.2 enter: Freewind // 54.569> 1.2 enter: Test // 54.629> 1.2 handle: Test // 54.679> 1.2 handle: Mike // 54.789> 1.2 handle: Jack // 54.789> 1.2 err: myerr // 54.789> 1.2 results: [ undefined, 'Mike!!!', , 'Test!!!' ] // 54.879> 1.2 handle: Freewind /** * é¡ºåºæ‰§è¡Œï¼Œä¸€ä¸ªå®Œäº†æ‰æ‰§è¡Œä¸‹ä¸€ä¸ªã€‚ */ async.mapSeries(arr, function(item, callback) { log('1.3 enter: ' + item.name); setTimeout(function() { log('1.3 handle: ' + item.name); callback(null, item.name+'!!!'); }, item.delay); }, function(err,results) { log('1.3 err: ', err); log('1.3 results: ', results); }); // 54.569> 1.3 enter: Jack // 54.789> 1.3 handle: Jack // 54.789> 1.3 enter: Mike // 54.899> 1.3 handle: Mike // 54.899> 1.3 enter: Freewind // 55.209> 1.3 handle: Freewind // 55.209> 1.3 enter: Test // 55.269> 1.3 handle: Test // 55.269> 1.3 err: // 55.269> 1.3 results: [ 'Jack!!!', 'Mike!!!', 'Freewind!!!', 'Test!!!' ] /** * é¡ºåºæ‰§è¡Œè¿‡ç¨‹ä¸­å‡ºé”™ï¼ŒåªæŠŠé”™è¯¯ä»¥åŠæ‰§è¡Œå®Œçš„ä¼ ç»™æœ€ç»ˆcallbackï¼Œæœªæ‰§è¡Œçš„å¿½ç•¥ã€‚ */ async.mapSeries(arr, function(item, callback) { log('1.4 enter: ' + item.name); setTimeout(function() { log('1.4 handle: ' + item.name); if(item.name==='Mike') callback('myerr'); else callback(null, item.name+'!!!'); }, item.delay); }, function(err, results) { log('1.4 err: ', err); log('1.4 results: ', results); }); // 47.616> 1.4 enter: Jack // 47.821> 1.4 handle: Jack // 47.821> 1.4 enter: Mike // 47.931> 1.4 handle: Mike // 47.931> 1.4 err: myerr // 47.932> 1.4 results: [ 'Jack!!!', undefined ] /** * å¹¶è¡Œæ‰§è¡Œï¼ŒåŒæ—¶æœ€å¤š2ä¸ªå‡½æ•°å¹¶è¡Œï¼Œä¼ ç»™æœ€ç»ˆcallbackã€‚ */ //1.5 async.mapLimit(arr,2, function(item, callback) { log('1.5 enter: ' + item.name); setTimeout(function() { log('1.5 handle: ' + item.name); if(item.name==='Jack') callback('myerr'); else callback(null, item.name+'!!!'); }, item.delay); }, function(err, results) { log('1.5 err: ', err); log('1.5 results: ', results); }); //57.797> 1.5 enter: Jack //57.800> 1.5 enter: Mike //57.900> 1.5 handle: Mike //57.900> 1.5 enter: Freewind //58.008> 1.5 handle: Jack //58.009> 1.5 err: myerr //58.009> 1.5 results: [ undefined, 'Mike!!!' ] //58.208> 1.5 handle: Freewind //58.208> 1.5 enter: Test //58.273> 1.5 handle: Test nextTickä»£ç æ¼”ç¤ºvar async = require('async'); var t = require('./t'); var log = t.log; /** * nextTickçš„ä½œç”¨ä¸nodejsçš„nextTickä¸€æ ·ï¼Œå†æœ€åè°ƒç”¨å‡½æ•°ã€‚ * ä½†åœ¨æµè§ˆå™¨ç«¯ï¼Œåªèƒ½ä½¿ç”¨setTimeout(callback,0)ï¼Œä½†è¿™ä¸ªæ–¹æ³•æœ‰æ—¶å€™ä¼šè®©å…¶å®ƒé«˜ä¼˜å…ˆçº§çš„ä»»åŠ¡æ’åˆ°å‰é¢å»ã€‚ * æ‰€ä»¥æä¾›äº†è¿™ä¸ªnextTickï¼Œè®©åŒæ ·çš„ä»£ç åœ¨æœåŠ¡å™¨ç«¯å’Œæµè§ˆå™¨ç«¯è¡¨ç°ä¸€è‡´ã€‚ */ // nextTick(callback) var calls = []; async.nextTick(function() { calls.push('two'); }); async.nextTick(function() { log('1.1',calls); }); calls.push('one'); log('1.2',calls); async.nextTick(function() { log('1.3',calls); }); //09.838> 1.2[ 'one' ] //09.842> 1.1[ 'one', 'two' ] //09.843> 1.3[ 'one', 'two' ] parallelä»£ç æ¼”ç¤ºvar async = require('async'); var t = require('./t'); var log = t.log; /** * å¹¶è¡Œæ‰§è¡Œå¤šä¸ªå‡½æ•°ï¼Œæ¯ä¸ªå‡½æ•°éƒ½æ˜¯ç«‹å³æ‰§è¡Œï¼Œä¸éœ€è¦ç­‰å¾…å…¶å®ƒå‡½æ•°å…ˆæ‰§è¡Œã€‚ä¼ ç»™æœ€ç»ˆcallbackçš„æ•°ç»„ä¸­çš„æ•°æ®æŒ‰ç…§tasksä¸­å£°æ˜çš„é¡ºåºï¼Œè€Œä¸æ˜¯æ‰§è¡Œå®Œæˆçš„é¡ºåºã€‚ * * å¦‚æœæŸä¸ªå‡½æ•°å‡ºé”™ï¼Œåˆ™ç«‹åˆ»å°†errå’Œå·²ç»æ‰§è¡Œå®Œçš„å‡½æ•°çš„ç»“æœå€¼ä¼ ç»™parallelæœ€ç»ˆçš„callbackã€‚å…¶å®ƒæœªæ‰§è¡Œå®Œçš„å‡½æ•°çš„å€¼ä¸ä¼šä¼ åˆ°æœ€ç»ˆæ•°æ®ï¼Œä½†è¦å ä¸ªä½ç½®ã€‚ * åŒæ—¶æ”¯æŒjsonå½¢å¼çš„tasksï¼Œå…¶æœ€ç»ˆcallbackçš„ç»“æœä¹Ÿä¸ºjsonå½¢å¼ã€‚ */ // parallel(tasks, [callback]) /** * å¹¶è¡Œæ‰§è¡Œå¤šä¸ªå‡½æ•°ï¼Œæ¯ä¸ªå‡½æ•°çš„å€¼å°†æŒ‰å‡½æ•°å£°æ˜çš„å…ˆåé¡ºåºæ±‡æˆä¸€ä¸ªæ•°ç»„ï¼Œä¼ ç»™æœ€ç»ˆcallbackã€‚ */ // 1.1 async.parallel([ function(cb) { t.fire('a400', cb, 400) }, function(cb) { t.fire('a200', cb, 200) }, function(cb) { t.fire('a300', cb, 300) } ], function (err, results) { log('1.1 err: ', err); log('1.1 results: ', results); }); //36.929> 1.1 err: null //36.930> 1.1 results: [ 'a400', 'a200', 'a300' ] /** * å¦‚æœä¸­é€”æœ‰ä¸ªå‡½æ•°å‡ºé”™ï¼Œåˆ™å°†è¯¥errå’Œå·²ç»å®Œæˆçš„å‡½æ•°å€¼æ±‡æˆä¸€ä¸ªæ•°ç»„ï¼Œä¼ ç»™æœ€ç»ˆçš„callbackã€‚è¿˜æ²¡æœ‰æ‰§è¡Œå®Œçš„å‡½æ•°çš„å€¼å°†è¢«å¿½ç•¥ï¼Œä½†è¦åœ¨æœ€ç»ˆæ•°ç»„ä¸­å ä¸ªä½ç½® */ // 1.2 async.parallel([ function(cb) { log('1.2.1: ', 'start'); t.fire('a400', cb, 400) }, // è¯¥å‡½æ•°çš„å€¼ä¸ä¼šä¼ ç»™æœ€ç»ˆcallbackï¼Œä½†è¦å ä¸ªä½ç½® function(cb) { log('1.2.2: ', 'start'); t.err('e200', cb, 200) }, function(cb) { log('1.2.3: ', 'start'); t.fire('a100', cb, 100) } ], function(err, results) { log('1.2 err: ', err); log('1.2 results: ', results); }); //36.537> 1.2.1: start //36.540> 1.2.2: start //36.541> 1.2.3: start //36.741> 1.2 err: e200 //36.744> 1.2 results: [ , undefined, 'a100' ] /** * ä»¥jsonå½¢å¼ä¼ å…¥tasksï¼Œæœ€ç»ˆresultsä¹Ÿä¸ºjson */ // 1.3 async.parallel({ a: function(cb) { t.fire('a400', cb, 400) }, b: function(cb) { t.fire('c300', cb, 300) } }, function(err, results) { log('1.3 err: ', err); log('1.3 results: ', results); }); //36.943> 1.3 err: null //36.944> 1.3 results: { b: 'c300', a: 'a400' } /** * å¦‚æœä¸­é€”å‡ºé”™ï¼Œä¼šå°†errä¸å·²ç»å®Œæˆçš„å‡½æ•°å€¼ï¼ˆæ±‡æˆä¸€ä¸ªjsonï¼‰ä¼ ç»™æœ€ç»ˆcallbackã€‚æœªæ‰§è¡Œå®Œæˆçš„å‡½æ•°å€¼è¢«å¿½ç•¥ï¼Œä¸ä¼šå‡ºç°åœ¨æœ€ç»ˆjsonä¸­ã€‚ */ // 1.4 async.parallel({ a: function(cb) { t.fire('a400', cb, 400) }, // è¯¥å‡½æ•°çš„å€¼ä¸ä¼šä¼ ç»™æœ€ç»ˆçš„callback b: function(cb) { t.err('e300', cb, 300) }, c: function(cb) { t.fire('c200', cb, 200) } }, function(err, results) { log('1.4 err: ', err); log('1.4 results: ', results); }); //36.853> 1.4 err: e300 //36.854> 1.4 results: { c: 'c200', b: undefined } /** * å¹¶è¡Œæ‰§è¡Œï¼ŒåŒæ—¶æœ€å¤š2ä¸ªå‡½æ•°å¹¶è¡Œï¼Œä¼ ç»™æœ€ç»ˆcallbackã€‚ */ //1.5 async.parallelLimit({ a:function(cb) { log('a start'); t.fire('a400', cb, 200) }, b:function(cb) { log('b start'); t.fire('b200', cb, 200) }, c:function(cb) { log('c start'); t.fire('c100', cb, 100) }, d:function(cb) { log('d start'); t.fire('d600', cb, 600) }, e:function(cb) { log('e start'); t.fire('e300', cb, 300) } },2, function(err, results) { log('1.5 err: ', err); log('1.5 results: ', results); }); //26.993> a start //26.996> b start //27.200> c start //27.202> d start //27.313> e start //27.809> 1.5 err: //27.810> 1.5 results: { a: 'a400', b: 'b200', c: 'c100', e: 'e300', d: 'd600' } queueä»£ç æ¼”ç¤ºvar async = require('async'); var t = require('./t'); var log = t.log; /** * queueæ˜¯ä¸€ä¸ªä¸²è¡Œçš„æ¶ˆæ¯é˜Ÿåˆ—ï¼Œé€šè¿‡é™åˆ¶äº†workeræ•°é‡ï¼Œä¸å†ä¸€æ¬¡æ€§å…¨éƒ¨æ‰§è¡Œã€‚ * å½“workeræ•°é‡ä¸å¤Ÿç”¨æ—¶ï¼Œæ–°åŠ å…¥çš„ä»»åŠ¡å°†ä¼šæ’é˜Ÿç­‰å€™ï¼Œç›´åˆ°æœ‰æ–°çš„workerå¯ç”¨ã€‚ * * è¯¥å‡½æ•°æœ‰å¤šä¸ªç‚¹å¯ä¾›å›è°ƒï¼Œå¦‚workerç”¨å®Œæ—¶ã€æ— ç­‰å€™ä»»åŠ¡æ—¶ã€å…¨éƒ¨æ‰§è¡Œå®Œæ—¶ç­‰ã€‚ */ // queue(worker, concurrency) /** * å®šä¹‰ä¸€ä¸ªqueueï¼Œè®¾workeræ•°é‡ä¸º2 */ var q = async.queue(function(task, callback) { log('worker is processing task: ', task.name); task.run(callback); }, 2); /** * ç›‘å¬ï¼šå¦‚æœæŸæ¬¡pushæ“ä½œåï¼Œä»»åŠ¡æ•°å°†è¾¾åˆ°æˆ–è¶…è¿‡workeræ•°é‡æ—¶ï¼Œå°†è°ƒç”¨è¯¥å‡½æ•° */ q.saturated = function() { log('all workers to be used'); } /** * ç›‘å¬ï¼šå½“æœ€åä¸€ä¸ªä»»åŠ¡äº¤ç»™workeræ—¶ï¼Œå°†è°ƒç”¨è¯¥å‡½æ•° */ q.empty = function() { log('no more tasks wating'); } /** * ç›‘å¬ï¼šå½“æ‰€æœ‰ä»»åŠ¡éƒ½æ‰§è¡Œå®Œä»¥åï¼Œå°†è°ƒç”¨è¯¥å‡½æ•° */ q.drain = function() { log('all tasks have been processed'); } /** * ç‹¬ç«‹åŠ å…¥2ä¸ªä»»åŠ¡ */ q.push({name:'t1', run: function(cb){ log('t1 is running, waiting tasks: ', q.length()); t.fire('t1', cb, 400); // 400msåæ‰§è¡Œ }}, function(err) { log('t1 executed'); }); log('pushed t1, waiting tasks: ', q.length()); q.push({name:'t2',run: function(cb){ log('t2 is running, waiting tasks: ', q.length()); t.fire('t2', cb, 200); // 200msåæ‰§è¡Œ }}, function(err) { log('t2 executed'); }); log('pushed t2, waiting tasks: ', q.length()); //54.448> pushed t1, waiting tasks: 1 //54.451> all workers to be used //54.452> pushed t2, waiting tasks: 2 //54.452> worker is processing task: t1 //54.453> t1 is running, waiting tasks: 1 //54.455> no more tasks wating //54.455> worker is processing task: t2 //54.455> t2 is running, waiting tasks: 0 //54.656> t2 executed //54.867> t1 executed //54.868> all tasks have been processed // åŒæ—¶åŠ å…¥å¤šä¸ªä»»åŠ¡ q.push([ { name:'t3', run: function(cb){ log('t3 is running, waiting tasks: ', q.length()); t.fire('t3', cb, 300); // 300msåæ‰§è¡Œ } },{ name:'t4', run: function(cb){ log('t4 is running, waiting tasks: ', q.length()); t.fire('t4', cb, 500); // 500msåæ‰§è¡Œ } },{ name:'t5', run: function(cb){ log('t5 is running, waiting tasks: ', q.length()); t.fire('t5', cb, 100); // 100msåæ‰§è¡Œ } },{ name:'t6', run: function(cb){ log('t6 is running, waiting tasks: ', q.length()); t.fire('t6', cb, 400); // 400msåæ‰§è¡Œ } } ], function(err) { log('err: ',err); }); log('pushed t3,t4,t5,t6 into queue, waiting tasks: ', q.length()); //53.755> all workers to be used //53.758> pushed t3,t4,t5,t6 into queue, waiting tasks: 4 //53.759> worker is processing task: t3 //53.760> t3 is running, waiting tasks: 3 //53.762> worker is processing task: t4 //53.762> t4 is running, waiting tasks: 2 //54.073> err: null //54.074> worker is processing task: t5 //54.076> t5 is running, waiting tasks: 1 //54.183> err: null //54.184> no more tasks wating //54.185> worker is processing task: t6 //54.186> t6 is running, waiting tasks: 0 //54.265> err: null //54.588> err: null //54.589> all tasks have been processed Reduceä»£ç æ¼”ç¤ºvar async = require('async'); var t = require('./t'); var log = t.log; /** * Reduceå¯ä»¥è®©æˆ‘ä»¬ç»™å®šä¸€ä¸ªåˆå§‹å€¼ï¼Œç”¨å®ƒä¸é›†åˆä¸­çš„æ¯ä¸€ä¸ªå…ƒç´ åšè¿ç®—ï¼Œæœ€åå¾—åˆ°ä¸€ä¸ªå€¼ã€‚reduceä»å·¦å‘å³æ¥éå†å…ƒç´ ï¼Œå¦‚æœæƒ³ä»å³å‘å·¦ï¼Œå¯ä½¿ç”¨reduceRightã€‚ */ //reduce(arr, memo, iterator(memo,item,callback), callback(err,result)) //alias: inject, foldl var arr = [1,3,5]; /** * é¡ºåºæ‰§è¡Œ */ async.reduce(arr, 100, function(memo, item, callback) { log('1.1 enter: ' + memo +', ' + item); setTimeout(function() { callback(null, memo+item); }, 100); },function(err, result) { log('1.1 err: ', err); log('1.1 result: ', result); }); // 28.789> 1.1 enter: 100, 1 // 28.889> 1.1 enter: 101, 3 // 28.999> 1.1 enter: 104, 5 // 29.109> 1.1 err: // 29.109> 1.1 result: 109 /** * é¡ºåºæ‰§è¡Œè¿‡ç¨‹ä¸­å‡ºé”™ï¼ŒåªæŠŠé”™è¯¯ä¼ ç»™æœ€ç»ˆcallbackï¼Œç»“æœæ˜¯null */ async.reduce(arr, 100, function(memo, item, callback) { log('1.2 enter: ' + memo +', ' + item); setTimeout(function() { if(item===3) callback('myerr'); else callback(null, memo+item); }, 100); },function(err, result) { log('1.2 err: ', err); log('1.2 result: ', result); }); // 05.541> 1.2 enter: 100, 1 // 05.649> 1.2 enter: 101, 3 // 05.760> 1.2 err: myerr // 05.760> 1.2 result: /** * é¡ºåºæ‰§è¡Œä»å³å‘å·¦ * * alias: foldr */ async.reduceRight(arr, 100, function(memo, item, callback) { log('1.3 enter: ' + memo +', ' + item); setTimeout(function() { callback(null, memo+item); }, 100); },function(err, result) { log('1.3 err: ', err); log('1.3 result: ', result); }); // 28.789> 1.3 enter: 100, 5 // 28.889> 1.3 enter: 105, 3 // 28.999> 1.3 enter: 108, 1 // 29.109> 1.3 err: // 29.109> 1.3 result: 109 /** * é€šè¿‡t.incåšä¸€ä¸ªç´¯åŠ å™¨ï¼Œå‚ä¸reduceçš„è®¡ç®— */ async.reduce(arr, 100, function(memo,item,callback) { log('1.4 enter: '+memo+','+item); t.inc(item, function(err,n) { log('1.4 handle: ',n); callback(null, memo+n); }); }, function(err,result) { log('1.4 err: ', err); log('1.4 result: ', result); }); // 28.789> 1.4 enter: 100,1 // 28.999> 1.4 handle: 2 // 28.999> 1.4 enter: 102,3 // 29.209> 1.4 handle: 4 // 29.209> 1.4 enter: 106,5 // 29.409> 1.4 handle: 6 // 29.409> 1.4 err: // 29.409> 1.4 result: 112 // --> spent 0.62s /** * é€šè¿‡t.incåšä¸€ä¸ªç´¯åŠ å™¨ï¼Œå¹¶å®ç°å¯¹mapçš„ç»“æœé›†åšreduce */ async.map(arr, function(item, callback) { log('1.5 enter: ', item); t.inc(item, function(err,n){ log('1.5 handle: ', n); callback(null,n); }); },function(err, results) { log('1.5 err: ', err); log('1.5 results: ', results); var sum = results.reduce(function(memo, item) { return memo + item; }, 100); log('1.5 sum: ', sum); }); // 28.789> 1.5 enter: 1 // 28.789> 1.5 enter: 3 // 28.789> 1.5 enter: 5 // 28.999> 1.5 handle: 2 // 28.999> 1.5 handle: 4 // 28.999> 1.5 handle: 6 // 28.999> 1.5 err: // 28.999> 1.5 results: [ 2, 4, 6 ] // 28.999> 1.5 sum: 112 // --> spent 0.21 seriesä»£ç æ¼”ç¤ºvar async = require('async'); var t = require('./t'); var log = t.log; /** * ä¸²è¡Œæ‰§è¡Œï¼Œä¸€ä¸ªå‡½æ•°æ•°ç»„ä¸­çš„æ¯ä¸ªå‡½æ•°ï¼Œæ¯ä¸€ä¸ªå‡½æ•°æ‰§è¡Œå®Œæˆä¹‹åæ‰èƒ½æ‰§è¡Œä¸‹ä¸€ä¸ªå‡½æ•°ã€‚ * * å¦‚æœä»»ä½•ä¸€ä¸ªå‡½æ•°å‘å®ƒçš„å›è°ƒå‡½æ•°ä¸­ä¼ äº†ä¸€ä¸ªerrorï¼Œåˆ™åé¢çš„å‡½æ•°éƒ½ä¸ä¼šè¢«æ‰§è¡Œï¼Œå¹¶ä¸”ä¼šç«‹åˆ»å°†è¯¥errorä»¥åŠå·²ç»æ‰§è¡Œäº†çš„å‡½æ•°çš„ç»“æœï¼Œä¼ ç»™seriesä¸­æœ€åé‚£ä¸ªcallbackã€‚ * å½“æ‰€æœ‰çš„å‡½æ•°æ‰§è¡Œå®Œåï¼ˆæ²¡æœ‰å‡ºé”™ï¼‰ï¼Œåˆ™ä¼šæŠŠæ¯ä¸ªå‡½æ•°ä¼ ç»™å…¶å›è°ƒå‡½æ•°çš„ç»“æœåˆå¹¶ä¸ºä¸€ä¸ªæ•°ç»„ï¼Œä¼ ç»™seriesæœ€åçš„é‚£ä¸ªcallbackã€‚ * è¿˜å¯ä»¥jsonçš„å½¢å¼æ¥æä¾›tasksã€‚æ¯ä¸€ä¸ªå±æ€§éƒ½ä¼šè¢«å½“ä½œå‡½æ•°æ¥æ‰§è¡Œï¼Œå¹¶ä¸”ç»“æœä¹Ÿä¼šä»¥jsonå½¢å¼ä¼ ç»™seriesæœ€åçš„é‚£ä¸ªcallbackã€‚è¿™ç§æ–¹å¼å¯è¯»æ€§æ›´é«˜ä¸€äº›ã€‚ */ // series(tasks, [callback]) /** * å…¨éƒ¨å‡½æ•°éƒ½æ­£å¸¸æ‰§è¡Œã€‚æ¯ä¸ªå‡½æ•°äº§ç”Ÿçš„å€¼å°†æŒ‰é¡ºåºåˆå¹¶ä¸ºä¸€ä¸ªæ•°ç»„ï¼Œä¼ ç»™æœ€ç»ˆçš„callbackã€‚ */ // 1.1 async.series([ function(cb) { t.inc(3, cb); }, function(cb) { t.inc(8, cb); }, function(cb) { t.inc(2, cb); } ], function(err, results) { log('1.1 err: ', err); log('1.1 results: ', results); }); //05.155> 1.1 err: null //05.156> 1.1 results: [ 4, 9, 3 ] /** * ä¸­é—´æœ‰å‡½æ•°å‡ºé”™ã€‚å‡ºé”™ä¹‹åçš„å‡½æ•°ä¸ä¼šæ‰§è¡Œï¼Œé”™è¯¯åŠä¹‹å‰æ­£å¸¸æ‰§è¡Œçš„å‡½æ•°ç»“æœå°†ä¼ ç»™æœ€ç»ˆçš„callbackã€‚ */ // 1.2 async.series([ function(cb) { t.inc(3, cb); }, function(cb) { t.err('test_err', cb); }, function(cb) { t.inc(8, cb); } ], function (err, results) { log('1.2 err: ', err); log('1.2 results: ', results); }); //04.964> 1.2 err: test_err //04.973> 1.2 results: [ 4, undefined ] /** * å¦‚æœæŸä¸ªå‡½æ•°ä¼ çš„æ•°æ®æ˜¯undefined, null, {}, []ç­‰ï¼Œå®ƒä»¬ä¼šåŸæ ·ä¼ ç»™æœ€ç»ˆcallbackã€‚ */ // 1.3 async.series([ function(cb) { t.fire(3, cb);}, function(cb) { t.fire(undefined, cb); }, function(cb) { t.fire(null, cb); }, function(cb) { t.fire({}, cb); }, function(cb) { t.fire([], cb); }, function(cb) { t.fire('abc', cb) } ], function(err, results) { log('1.3 err: ', err); log('1.3 results: ', results); }); //05.794> 1.3 err: null //05.795> 1.3 results: [ 3, undefined, null, {}, [], 'abc' ] /** * ä»¥jsonå½¢å¼ä¼ å…¥tasksã€‚å…¶ç»“æœä¹Ÿå°†ä»¥jsonå½¢å¼ä¼ ç»™æœ€ç»ˆcallbackã€‚ */ async.series({ a: function(cb) { t.inc(3, cb); }, b: function(cb) { t.fire(undefined, cb); }, c: function (cb) { t.err('myerr', cb); }, d: function (cb) { t.inc(8, cb); } }, function (err, results) { log('1.4 err: ', err); log('1.4 results: ', results); }); //05.178> 1.4 err: myerr //05.179> 1.4 results: { a: 4, b: undefined, c: undefined } someä»£ç æ¼”ç¤ºvar async = require('async'); var t = require('./t'); var log = t.log; /** * å½“é›†åˆä¸­æ˜¯å¦æœ‰è‡³å°‘ä¸€ä¸ªå…ƒç´ æ»¡è¶³æ¡ä»¶æ—¶ï¼Œæœ€ç»ˆcallbackå¾—åˆ°çš„å€¼ä¸ºtrueï¼Œå¦åˆ™ä¸ºfalse. */ // some(arr, iterator(item,callback(test)), callback(result)) //alias: any var arr = [1,2,3,6]; /** * ä¸²è¡Œæ‰§è¡Œï¼Œé›†åˆä¸­è‡³å°‘æœ‰ä¸€ä¸ªå…ƒç´ &lt;=3ï¼Œæ‰€ä»¥ç»“æœä¸ºtrue */ // 1.1 async.some(arr, function(item,callback){ log('1.1 enter: ',item); setTimeout(function(){ log('1.1 handle: ',item); callback(item&lt;=3); },100); }, function(result) { log('1.1 result: ', result); }); // 36.165> 1.1 enter: 1 // 36.165> 1.1 enter: 2 // 36.165> 1.1 enter: 3 // 36.165> 1.1 enter: 6 // 36.275> 1.1 handle: 1 // 36.275> 1.1 result: true // 36.275> 1.1 handle: 2 // 36.275> 1.1 handle: 3 // 36.275> 1.1 handle: 6 /** * ä¸²è¡Œæ‰§è¡Œï¼Œé›†åˆä¸­æ²¡æœ‰ä¸€ä¸ªå…ƒç´ >10ï¼Œæ‰€ä»¥ç»“æœä¸ºfalse */ async.some(arr, function(item,callback){ log('1.2 enter: ',item); setTimeout(function(){ log('1.2 handle: ',item); callback(item>10); },100); }, function(result) { log('1.2 result: ', result); }); // 36.165> 1.2 enter: 1 // 36.165> 1.2 enter: 2 // 36.165> 1.2 enter: 3 // 36.165> 1.2 enter: 6 // 36.275> 1.2 handle: 1 // 36.275> 1.2 handle: 2 // 36.275> 1.2 handle: 3 // 36.275> 1.2 handle: 6 // 36.275> 1.2 result: false sortByä»£ç æ¼”ç¤ºvar async = require('async'); var t = require('./t'); var log = t.log; /** * å¯¹é›†åˆå†…çš„å…ƒç´ è¿›è¡Œæ’åºï¼Œä¾æ®æ¯ä¸ªå…ƒç´ è¿›è¡ŒæŸå¼‚æ­¥æ“ä½œåäº§ç”Ÿçš„å€¼ï¼Œä»å°åˆ°å¤§æ’åºã€‚ */ // sortBy(array, iterator(item,callback(err,result)), callback(err,results)) var arr = [3,6,1]; /** * é€šè¿‡å¼‚æ­¥è¿­ä»£å™¨ï¼Œå¯¹é›†åˆè¿›è¡Œæ’åº */ async.sortBy(arr, function(item, callback) { setTimeout(function() { callback(null,item); }, 200); }, function(err,results) { log('1.1 err: ', err); log('1.1 results: ', results); }); // 26.562> 1.1 err: null // 26.562> 1.1 results: [ 1, 3, 6 ] /** * è¿­ä»£å‡ºé”™ï¼Œcallbackè¿”å›errï¼Œæ²¡æœ‰results */ async.sortBy(arr, function(item, callback) { setTimeout(function() { if(item===6) callback('myerr'); else callback(null,item); }, 200); }, function(err,results) { log('1.2 err: ', err); log('1.2 results: ', results); }); // 26.572> 1.2 err: myerr // 26.572> 1.2 results: t.jsä»£ç æ¼”ç¤º// å…¶å®è¿™ä¸ªæ–‡ä»¶åçš„'t'æˆ‘ä¸æ˜¯å¾ˆæ˜ç™½åŸä½œè€…freewindçš„æ„æ€ï¼Œæˆ‘è§‰å¾—å«åš'lib.js'æˆ–è€… // 'helper.js'æ¯”è¾ƒåˆé€‚ï¼Œå› ä¸ºè¿™é‡Œé¢éƒ½æ˜¯äº›è¾…åŠ©å‡½æ•°ã€‚ var moment = require('moment'); exports.inc = function(n, callback, timeout) { //å°†å‚æ•°nè‡ªå¢1ä¹‹åçš„ç»“æœè¿”å›ç»™async timeout = timeout || 200; setTimeout(function() { callback(null, n+1); }, timeout); }; exports.fire = function(obj, callback, timeout) { //ç›´æ¥å°†objçš„å†…å®¹è¿”å›ç»™async timeout = timeout || 200; setTimeout(function() { callback(null, obj); }, timeout); }; exports.err = function(errMsg, callback, timeout) { //æ¨¡æ‹Ÿä¸€ä¸ªé”™è¯¯çš„äº§ç”Ÿï¼Œè®©asyncå„ä¸ªå‡½æ•°æœ«å°¾çš„callbackæ¥æ”¶åˆ°ã€‚ timeout = timeout || 200; setTimeout(function() { callback(errMsg); }, timeout); }; // utils exports.log = function(msg, obj) { //å¯¹console.logè¿›è¡Œäº†å°è£…ã€‚ä¸»è¦æ˜¯å¢åŠ äº†ç§’é’Ÿçš„è¾“å‡ºï¼Œé€šè¿‡ç§’æ•°çš„å·®å€¼æ–¹ä¾¿å¤§å®¶å¯¹asyncçš„ç†è§£ã€‚ process.stdout.write(moment().format('ss.SSS')+'> '); if(obj!==undefined) { process.stdout.write(msg); console.log(obj); } else { console.log(msg); } }; exports.wait = function(mils) { //åˆ»æ„ç­‰å¾…milsçš„æ—¶é—´ï¼Œmilsçš„å•ä½æ˜¯æ¯«ç§’ã€‚ var now = new Date; while(new Date - now &lt;= mils); } times timesSeriesä»£ç æ¼”ç¤ºvar async = require('async'); var t = require('./t'); var log = t.log; /** * å¼‚æ­¥è¿è¡Œ,timeså¯ä»¥æŒ‡å®šè°ƒç”¨å‡ æ¬¡ï¼Œå¹¶æŠŠç»“æœåˆå¹¶åˆ°æ•°ç»„ä¸­è¿”å› */ // times(n, callback) function delay(n){return (n+12) % 7 *100;} var createUser = function(id, callback) { callback(null, { id: 'user' + id, delay:delay(id) }) } /** * å¼‚æ­¥æ‰§è¡Œï¼Œè°ƒç”¨3æ¬¡createUserå‡½æ•°ï¼Œç»“æœè¢«åˆå¹¶åˆ°æ•°ç»„è¿”å› */ //1.1 async.times(3, function(n, callback){ log(\"1.1 enter: \"+ n); setTimeout(function(){ log('1.1 handler: ',n); createUser(n, function(err, user) { callback(err, user) }) },delay(n)); }, function(err, users) { log('1.1 err: ',err); log('1.1 result: ',users); }); //07.397> 1.1 enter: 0 //07.400> 1.1 enter: 1 //07.401> 1.1 enter: 2 //07.412> 1.1 handler: 2 //07.912> 1.1 handler: 0 //08.009> 1.1 handler: 1 //08.010> 1.1 err: null //08.011> 1.1 result: [ { id: 'user0', delay: 500 }, // { id: 'user1', delay: 600 }, // { id: 'user2', delay: 0 } ] /** * timesSeriesä¸timeå”¯ä¸€ä¸åŒçš„æ˜¯ï¼ŒåŒæ­¥æ‰§è¡Œ */ //timesSeries(n, callback) /** * åŒæ­¥æ‰§è¡Œï¼Œè°ƒç”¨3æ¬¡createUserå‡½æ•°ï¼Œç»“æœè¢«åˆå¹¶åˆ°æ•°ç»„è¿”å› */ //1.2 async.timesSeries(3, function(n, callback){ log(\"1.2 enter: \"+ n); setTimeout(function(){ log('1.2 handler: ',n); createUser(n, function(err, user) { callback(err, user) }) },delay(n)); }, function(err, users) { log('1.2 err: ',err); log('1.2 result: ',users); }); //16.642> 1.2 enter: 0 //17.159> 1.2 handler: 0 //17.162> 1.2 enter: 1 //17.763> 1.2 handler: 1 //17.767> 1.2 enter: 2 //17.778> 1.2 handler: 2 //17.779> 1.2 err: null //17.780> 1.2 result: [ { id: 'user0', delay: 500 }, // { id: 'user1', delay: 600 }, // { id: 'user2', delay: 0 } ] unmemoize noConflict memoize log dir ä»£ç æ¼”ç¤ºvar async = require('async'); var t = require('./t'); var log = t.log; /** * è®©æŸä¸€ä¸ªå‡½æ•°åœ¨å†…å­˜ä¸­ç¼“å­˜å®ƒçš„è®¡ç®—ç»“æœã€‚å¯¹äºç›¸åŒçš„å‚æ•°ï¼Œåªè®¡ç®—ä¸€æ¬¡ï¼Œä¸‹æ¬¡å°±ç›´æ¥æ‹¿åˆ°ä¹‹å‰ç®—å¥½çš„ç»“æœã€‚ * hasherå¯ä»¥è®©æˆ‘ä»¬è‡ªå®šä¹‰å¦‚ä½•æ ¹æ®å‚æ•°æ¥åˆ¤æ–­å®ƒæ˜¯å¦å·²ç»åœ¨ç¼“å­˜ä¸­äº†ã€‚ */ // memoize(fn, [hasher]) //1.1 var slow_fn = function(x, y, callback) { log('1.1 start working for: ' + x+','+y); t.wait(500); log('1.1 finished: ' + x+','+y); callback(null, x+','+y); }; var fn = async.memoize(slow_fn,function(x,y) { return x+y; }); fn('a','b', function(err, result) { log(\"1.1 first time: \"+result); }); fn('cc','d', function(err, result) { log(\"1.1 first time: \"+result); }); fn('a','b', function(err, result) { log(\"1.1 second time: \"+result); }); //15.416> 1.1 start working for: a,b //15.920> 1.1 finished: a,b //15.920> 1.1 first time: a,b //15.921> 1.1 start working for: cc,d //16.423> 1.1 finished: cc,d //16.423> 1.1 first time: cc,d //16.424> 1.1 second time: a,b /** * è®©å·²ç»è¢«ç¼“å­˜çš„å‡½æ•°ï¼Œè¿”å›ä¸ç¼“å­˜çš„å‡½æ•°å¼•ç”¨ã€‚ */ // unmemoize(fn) //1.2 var slow_fn2 = function(x, y, callback) { log('1.2 start working for: ' + x+','+y); t.wait(500); log('1.2 finished: ' + x+','+y); callback(null, x+','+y); }; var fn2 = async.memoize(slow_fn2,function(x,y) { return x+y; }); fn2('a','b', function(err,result) { log(\"1.2 first time: \"+result); }); var unFn2 =async.unmemoize(fn2); log('1.2 unmemoized'); unFn2('a','b', function(err,result) { log(\"1.2 second time: \"+result); }); //16.424> 1.2 start working for: a,b //16.926> 1.2 finished: a,b //16.926> 1.2 first time: a,b //16.927> 1.2 unmemoized //16.927> 1.2 start working for: a,b //17.428> 1.2 finished: a,b //17.428> 1.2 second time: a,b /** * æ‰§è¡ŒæŸå¼‚æ­¥å‡½æ•°ï¼Œå¹¶è®°å½•å®ƒçš„è¿”å›å€¼ã€‚è¯•éªŒå‡½æ•°æ—¶å¾ˆæ–¹ä¾¿ï¼Œä¸ç”¨å†™é‚£äº›å›ºå®šæ¨¡å¼çš„ä»£ç ã€‚ * å¦‚æœè¯¥å‡½æ•°å‘å›è°ƒä¸­ä¼ å…¥äº†å¤šä¸ªå‚æ•°ï¼Œåˆ™æ¯è¡Œè®°å½•ä¸€ä¸ªã€‚ */ // log(function, arguments) //1.3 var x = function() { this.name = 'bsspirit'; } var hello = function(name, callback) { setTimeout(function() { callback(null, 'first ' + name, 'second '+ name, x, {a:'123'} ); }, 200); }; log(\"1.3 handler\"); async.log(hello, 'time'); //37.620> 1.3 handler //first time //second time //[Function] //{ a: '123' } /** * dirä¸logéƒ½æ˜¯æ‰“å°å‡ºè¾“ï¼Œåœ¨nodejsç¯å¢ƒä¸­æ²¡æœ‰åˆ†åˆ«ã€‚ * dirçš„ä¸åŒä¹‹å¤„åœ¨äºï¼Œä¼šè°ƒç”¨æµè§ˆå™¨çš„console.dir()å‡½æ•°ï¼Œæ˜¾ç¤ºä¸ºDOMè§†å›¾ã€‚ * * http://stackoverflow.com/questions/10636866/whats-the-difference-between-async-log-and-async-dir */ //1.4 log(\"1.4 handler\"); async.dir(hello, 'world'); //37.620> 1.4 handler //first time //second time //[Function] //{ a: '123' } /** * noConflict()ä»…ä»…ç”¨äºæµè§ˆå™¨ç«¯ï¼Œåœ¨nodejsä¸­æ²¡ç”¨ï¼Œè¿™é‡Œæ— æ³•æ¼”ç¤ºã€‚ * * å®ƒçš„ä½œç”¨æ˜¯ï¼šå¦‚æœä¹‹å‰å·²ç»åœ¨å…¨å±€åŸŸä¸­å®šä¹‰äº†asyncå˜é‡ï¼Œå½“å¯¼å…¥æœ¬async.jsæ—¶ï¼Œä¼šå…ˆæŠŠä¹‹å‰çš„asyncå˜é‡ä¿å­˜èµ·æ¥ï¼Œç„¶åè¦†ç›–å®ƒã€‚ * ç”¨å®Œä¹‹åï¼Œè°ƒç”¨noConflict()æ–¹æ³•ï¼Œå°±ä¼šå½’è¿˜è¯¥å€¼ã€‚åŒæ—¶è¿”å›asyncæœ¬èº«ä¾›æ¢åä½¿ç”¨ã€‚ */ // noConflict() /* // global on the server, window in the browser var root = this, previous_async = root.async; if (typeof module !== 'undefined' &amp;&amp; module.exports) { module.exports = async; } else { root.async = async; } async.noConflict = function () { root.async = previous_async; return async; }; */ waterfallä»£ç æ¼”ç¤ºvar async = require('async'); var t = require('./t'); var log = t.log; /** * æŒ‰é¡ºåºä¾æ¬¡æ‰§è¡Œä¸€ç»„å‡½æ•°ã€‚æ¯ä¸ªå‡½æ•°äº§ç”Ÿçš„å€¼ï¼Œéƒ½å°†ä¼ ç»™ä¸‹ä¸€ä¸ªã€‚ * å¦‚æœä¸­é€”å‡ºé”™ï¼Œåé¢çš„å‡½æ•°å°†ä¸ä¼šè¢«æ‰§è¡Œã€‚é”™è¯¯ä¿¡æ¯å°†ä¼ ç»™waterfallæœ€ç»ˆçš„callbackã€‚ä¹‹å‰äº§ç”Ÿçš„ç»“æœè¢«ä¸¢å¼ƒã€‚ * * è¿™ä¸ªå‡½æ•°åä¸ºwaterfall(ç€‘å¸ƒ)ï¼Œå¯ä»¥æƒ³åƒç€‘å¸ƒä»ä¸Šåˆ°ä¸‹ï¼Œä¸­é€”å†²è¿‡ä¸€å±‚å±‚çªèµ·çš„çŸ³å¤´ã€‚ * * æ³¨æ„ï¼Œè¯¥å‡½æ•°ä¸æ”¯æŒjsonæ ¼å¼çš„tasks */ // async.waterfall(tasks, [callback]); /** * æ‰€æœ‰å‡½æ•°æ­£å¸¸æ‰§è¡Œï¼Œæ¯ä¸ªå‡½æ•°çš„ç»“æœéƒ½å°†å˜ä¸ºä¸‹ä¸€ä¸ªå‡½æ•°çš„å‚æ•°ã€‚ * * æ³¨æ„ï¼Œæ‰€æœ‰çš„callbackéƒ½å¿…é¡»å½¢å¦‚callback(err, result)ï¼Œä½†errå‚æ•°åœ¨å‰é¢å„å‡½æ•°ä¸­æ— éœ€å£°æ˜ï¼Œå®ƒè¢«è‡ªåŠ¨å¤„ç†ã€‚ */ // 1.1 async.waterfall([ function(cb) { log('1.1.1: ', 'start'); cb(null, 3); }, function(n, cb) { log('1.1.2: ',n); t.inc(n, cb); }, function(n, cb) { log('1.1.3: ',n); t.fire(n*n, cb); } ], function (err, result) { log('1.1 err: ', err); log('1.1 result: ', result); }); //31.749> 1.1.1: start //31.752> 1.1.2: 3 //31.953> 1.1.3: 4 //32.156> 1.1 err: null //32.159> 1.1 result: 16 /** * ä¸­é€”æœ‰å‡½æ•°å‡ºé”™ï¼Œå…¶errç›´æ¥ä¼ ç»™æœ€ç»ˆcallbackï¼Œç»“æœè¢«ä¸¢å¼ƒï¼Œåé¢çš„å‡½æ•°ä¸å†æ‰§è¡Œã€‚ */ // 1.2 async.waterfall([ function(cb) { log('1.2.1: ', 'start'); cb(null, 3); }, function(n, cb) { log('1.2.2: ', n); t.inc(n, cb); }, function(n, cb) { log('1.2.3: ', n); t.err('myerr', cb); }, function(n, cb) { log('1.2.4: ', n); t.fire(n, cb); } ], function (err, result) { log('1.2 err: ', err); log('1.2 result: ', result); }); //44.935> 1.2.1: start //44.939> 1.2.2: 3 //45.140> 1.2.3: 4 //45.344> 1.2 err: myerr //45.348> 1.2 result: /** * æ³¨æ„ï¼š ä»¥jsonå½¢å¼ä¼ å…¥tasksï¼Œå°†ä¸ä¼šè¢«æ‰§è¡Œ!! */ async.waterfall({ a: function(cb) { log('1.3.1: ', 'start'); cb(null, 3); }, b: function(n, cb) { log('1.3.2: ', n); t.inc(n, cb); }, c: function(n, cb) { log('1.3.3: ', n); t.fire(n*n, cb); } }, function (err, result) { log('1.3 err: ', err); log('1.3 result: ', result); }); //49.222> 1.3 err: [Error: First argument to waterfall must be an array of functions] //49.228> 1.3 result: whilst until doUntil foreverå’Œ doWhilstä»£ç æ¼”ç¤ºvar async = require('async'); var t = require('./t'); var log = t.log; /** * ç›¸å½“äºwhileï¼Œä½†å…¶ä¸­çš„å¼‚æ­¥è°ƒç”¨å°†åœ¨å®Œæˆåæ‰ä¼šè¿›è¡Œä¸‹ä¸€æ¬¡å¾ªç¯ã€‚ * * å®ƒç›¸å½“äºï¼š * try { * whilst(test) { * fn(); * } * callback(); * } catch (err) { * callback(err); * } * * è¯¥å‡½æ•°çš„åŠŸèƒ½æ¯”è¾ƒç®€å•ï¼Œæ¡ä»¶å˜é‡é€šå¸¸å®šä¹‰åœ¨å¤–é¢ï¼Œå¯ä¾›æ¯ä¸ªå‡½æ•°è®¿é—®ã€‚åœ¨å¾ªç¯ä¸­ï¼Œå¼‚æ­¥è°ƒç”¨æ—¶äº§ç”Ÿçš„å€¼å®é™…ä¸Šè¢«ä¸¢å¼ƒäº†ï¼Œå› ä¸ºæœ€åé‚£ä¸ªcallbackåªèƒ½ä¼ å…¥é”™è¯¯ä¿¡æ¯ã€‚ * * å¦å¤–ï¼Œç¬¬äºŒä¸ªå‡½æ•°fnéœ€è¦èƒ½æ¥å—ä¸€ä¸ªå‡½æ•°cbï¼Œè¿™ä¸ªcbæœ€ç»ˆå¿…é¡»è¢«æ‰§è¡Œï¼Œç”¨äºè¡¨ç¤ºå‡ºé”™æˆ–æ­£å¸¸ç»“æŸã€‚ */ // whilst(test, fn, callback) /** * æ­£å¸¸æƒ…å†µï¼Œæ²¡æœ‰å‡ºé”™ã€‚ç¬¬äºŒä¸ªå‡½æ•°è™½ç„¶æ˜¯å¼‚æ­¥è°ƒç”¨ï¼Œä½†è¢«åŒæ­¥æ‰§è¡Œã€‚æ‰€ä»¥ç¬¬ä¸‰ä¸ªå‡½æ•°è¢«è°ƒç”¨æ—¶ï¼Œå·²ç»è¿‡äº†3ç§’ã€‚ */ // 1.1 var count1 = 0; async.whilst( function() { return count1 &lt; 3 }, function(cb) { log('1.1 count: ', count1); count1++; setTimeout(cb, 1000); }, function(err) { // 3s have passed log('1.1 err: ', err); } ); //10.318> 1.1 count: 0 //11.330> 1.1 count: 1 //12.342> 1.1 count: 2 //13.356> 1.1 err: /** * ä¸­é€”å‡ºé”™ã€‚å‡ºé”™åç«‹åˆ»è°ƒç”¨ç¬¬ä¸‰ä¸ªå‡½æ•°ã€‚ */ // 1.2 var count2 = 0; async.whilst( function() { return count2 &lt; 3 }, function(cb) { log('1.2 count: ', count2); if(count2===1) { t.err('myerr', cb, 200); } else { count2++; setTimeout(cb, 1000); } }, function(err) { // 2s have passed log('1.2 err: ', err); } ); //12.805> 1.2 count: 0 //13.824> 1.2 count: 1 //14.026> 1.2 err: myerr /** * ç¬¬äºŒä¸ªå‡½æ•°å³ä½¿äº§ç”Ÿå€¼ï¼Œä¹Ÿä¼šè¢«å¿½ç•¥ã€‚ç¬¬ä¸‰ä¸ªå‡½æ•°åªèƒ½å¾—åˆ°errã€‚ */ // 1.3 var count3 = 0; async.whilst( function() {return count3 &lt; 3 }, function(cb) { log('1.3 count: ', count3); t.inc(count3++, cb); }, function(err,result){ // resultæ²¡æœ‰ç”¨ log('1.3 err: ', err); log('1.3 result: ', result); } ); //45.311> 1.3 count: 0 //45.514> 1.3 count: 1 //45.718> 1.3 count: 2 //45.920> 1.3 err: //45.923> 1.3 result: /** * doWhilstäº¤æ¢äº†fn,testçš„å‚æ•°ä½ç½®ï¼Œå…ˆæ‰§è¡Œä¸€æ¬¡å¾ªç¯ï¼Œå†åšteståˆ¤æ–­ã€‚ å’Œjavascriptä¸­do..whileè¯­æ³•ä¸€è‡´ã€‚ */ // doWhilst(fn, test, callback) //1.4 var count4 = 0; async.doWhilst( function(cb) { log('1.4 count: ', count4); t.inc(count4++, cb); }, function() { log(\"1.4 test\"); return count4 &lt; 3 }, function(err,result){ // resultæ²¡æœ‰ç”¨ log('1.4 err: ', err); log('1.4 result: ', result); } ); //33.643> 1.4 count: 0 //33.848> 1.4 test //33.850> 1.4 count: 1 //34.054> 1.4 test //34.057> 1.4 count: 2 //34.269> 1.4 test //34.270> 1.4 err: //34.270> 1.4 result: /** * untilä¸whilstæ­£å¥½ç›¸åï¼Œå½“testä¸ºfalseæ—¶å¾ªç¯ï¼Œä¸trueæ—¶è·³å‡ºã€‚å…¶å®ƒç‰¹æ€§ä¸€è‡´ã€‚ */ // 1.5 var count5 = 0; async.until( function() { return count5>3 }, function(cb) { log('1.5 count: ', count5); count5++; setTimeout(cb, 200); }, function(err) { // 4s have passed log('1.5 err: ',err); } ); //42.498> 1.5 count: 0 //42.701> 1.5 count: 1 //42.905> 1.5 count: 2 //43.107> 1.5 count: 3 //43.313> 1.5 err: /** * doUntilä¸doWhilstæ­£å¥½ç›¸åï¼Œå½“testä¸ºfalseæ—¶å¾ªç¯ï¼Œä¸trueæ—¶è·³å‡ºã€‚å…¶å®ƒç‰¹æ€§ä¸€è‡´ã€‚ */ // doUntil(fn, test, callback) // 1.6 var count6 = 0; async.doUntil( function(cb) { log('1.6 count: ', count6); count6++; setTimeout(cb, 200); }, function() { log('1.6 test');return count6>3 }, function(err) { // 4s have passed log('1.6 err: ',err); } ); //41.831> 1.6 count: 0 //42.035> 1.6 test //42.037> 1.6 count: 1 //42.241> 1.6 test //42.244> 1.6 count: 2 //42.456> 1.6 test //42.457> 1.6 count: 3 //42.660> 1.6 test //42.661> 1.6 err: /** * foreverï¼Œæ— è®ºæ¡ä»¶å¾ªç¯æ‰§è¡Œï¼Œå¦‚æœä¸å‡ºé”™ï¼Œcallbackæ°¸è¿œä¸è¢«æ‰§è¡Œ */ //forever(fn, callback) //1.7 var count7 = 0; async.forever( function(cb) { log('1.7 count: ', count7); count7++; setTimeout(cb, 200); }, function(err) { log('1.7 err: ',err); } ); //52.770> 1.7 count: 0 //52.973> 1.7 count: 1 //53.175> 1.7 count: 2 //53.377> 1.7 count: 3 //53.583> 1.7 count: 4 //53.785> 1.7 count: 5 //53.987> 1.7 count: 6 //54.189> 1.7 count: 7 //54.391> 1.7 count: 8 //54.593> 1.7 count: 9 //54.795> 1.7 count: 10 //54.997> 1.7 count: 11 //55.199> 1.7 count: 12","categories":[{"name":"æœåŠ¡å™¨","slug":"æœåŠ¡å™¨","permalink":"http://www.msiter.com/categories/æœåŠ¡å™¨/"}],"tags":[{"name":"nodejs","slug":"nodejs","permalink":"http://www.msiter.com/tags/nodejs/"},{"name":"async","slug":"async","permalink":"http://www.msiter.com/tags/async/"}],"keywords":[{"name":"æœåŠ¡å™¨","slug":"æœåŠ¡å™¨","permalink":"http://www.msiter.com/categories/æœåŠ¡å™¨/"}]}]}