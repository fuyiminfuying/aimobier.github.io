<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
    
    <entry>
      <title><![CDATA[å¤©é€šè‹‘åœ°é“ å®‰æ£€æ–¹å¼æ”¹å˜]]></title>
      <url>http://www.msiter.com/2017/11/23/%E7%94%9F%E6%B4%BB%E9%9A%8F%E5%A4%84%E5%8F%AF%E8%A7%81%E4%B8%80%E6%96%9120171123/</url>
      <content type="html"><![CDATA[<p>ä»Šå¤©æ—©ä¸Šæ¥åˆ°å¤©é€šè‹‘åœ°é“ç«™å‘ç°å®‰æ£€æ–¹å¼æ”¹å˜äº†ï¼Œä»¥å‰æ˜¯ä¸€ä¸ªå£å®‰æ£€ï¼Œåœ¨å¤§é—¨å£å­˜åœ¨ä¸€ä¸ªå¯ä»¥ä¾›æ²¡å¸¦åŒ…ä¹˜å®¢è¿›å…¥çš„é€šé“ï¼Œç”±äºè¿™ä¸ªå£ç¦»å®‰æ£€äººå‘˜è¾ƒè¿œç”šè‡³å­˜åœ¨ä¸€ä¸ªå¼¯é“ï¼Œæ‰€ä»¥æ ¹æœ¬æ²¡äººä¼šç®¡å¸¦åŒ…ä¹˜å®¢è¿›å…¥è¯¥é€šé“ã€‚åæ¥é€šé“å¹²è„†å°æ‰äº†ï¼Œè¿™æ ·ä¸€æ¥ï¼Œå¸¦åŒ…ä¸å¸¦åŒ…éƒ½éœ€è¦åœ¨ä¸€ä¸ªåœ°æ–¹æ’é˜Ÿç­‰å¾…å®‰æ£€äº†ã€‚ç°åœ¨åœ¨åŸæœ¬é€šé“çš„åœ°æ–¹æ”¾ç½®äº†ä¸¤ä¸ªå®‰æ£€é—¨æŠŠæœ‰åŒ…æ— åŒ…åŒºåˆ†å¼€æ¥ã€‚æˆ‘åªæ˜¯è§‰å¾—è¿™æ ·å­æŒºå¥½çš„ï¼Œæœ¬ç€ç”Ÿæ´»å¤„å¤„çš†å­¦é—®çš„å¿ƒç†è‡ªå·±è§‰å¾—å¤§æ¦‚æœ‰å‡ ç§å¿ƒç†å¯¼è‡´äº†ä»¥ä¸Šæè¿°<br><a id="more"></a></p>
<p>æœ€å¼€å§‹äººä»¬åœ¨æ²¡æœ‰äººæ³¨æ„çš„æ—¶å€™ä¼šèµ°é€šé“ï¼Œå¦å¤–å°±æ˜¯å½“ä¸€ä¸ªå¸¦åŒ…çš„äººèµ°ä¹‹åã€‚æ‰€æœ‰çš„äººéƒ½ä¼šå‡ºç°è¿™ç§æƒ…å†µï¼Œè¿™ç§æƒ…å†µå°±ç±»ä¼¼ä¸€ä¸ªå¾ˆå¹²å‡€çš„åœ°æ–¹ï¼Œè¢«ä¸€ä¸ªäººä¸¢äº†åƒåœ¾ï¼Œé‚£é‡Œå°±ä¼šä¸æ–­è¢«äººä¸¢åƒåœ¾ï¼Œç›´åˆ°å˜æˆåƒåœ¾æ¡¶ã€‚è¿™ç§å¿ƒç†å¾ˆå¤šï¼Œä»ä¼—ï¼Œç¾Šç¾¤ï¼Œæˆ‘è§‰å¾—æœ€å¥½çš„æ˜¯ ç ´çª—å®šå¾‹ã€‚</p>
<blockquote>
<p>ç ´çª—æ•ˆåº”ï¼Œæ˜¯å…³äºç¯å¢ƒå¯¹äººä»¬å¿ƒç†é€ æˆæš—ç¤ºæ€§æˆ–è¯±å¯¼æ€§å½±å“çš„ä¸€ç§è®¤è¯†ã€‚æŒ‡å¦‚æœæœ‰äººæ‰“åäº†ä¸€å¹¢å»ºç­‘ç‰©çš„çª—æˆ·ç»ç’ƒï¼Œè€Œè¿™æ‰‡çª—æˆ·åˆå¾—ä¸åˆ°åŠæ—¶çš„ç»´ä¿®ï¼Œåˆ«äººå°±å¯èƒ½å—åˆ°æŸäº›æš—ç¤ºæ€§çš„çºµå®¹å»æ‰“çƒ‚æ›´å¤šçš„çª—æˆ·ã€‚ä¸€ä¸ªæˆ¿å­å¦‚æœçª—æˆ·ç ´äº†ï¼Œæ²¡æœ‰äººå»ä¿®è¡¥ï¼Œéš”ä¸ä¹…ï¼Œå…¶å®ƒçš„çª—æˆ·ä¹Ÿä¼šè«åå…¶å¦™åœ°è¢«äººæ‰“ç ´ï¼›ä¸€é¢å¢™ï¼Œå¦‚æœå‡ºç°ä¸€äº›æ¶‚é¸¦æ²¡æœ‰è¢«æ¸…æ´—æ‰ï¼Œå¾ˆå¿«çš„ï¼Œå¢™ä¸Šå°±å¸ƒæ»¡äº†ä¹±ä¸ƒå…«ç³Ÿã€ä¸å ªå…¥ç›®çš„ä¸œè¥¿ï¼›ä¸€ä¸ªå¾ˆå¹²å‡€çš„åœ°æ–¹ï¼Œäººä»¬ä¸å¥½æ„æ€ä¸¢åƒåœ¾ï¼Œä½†æ˜¯ä¸€æ—¦åœ°ä¸Šæœ‰åƒåœ¾å‡ºç°ä¹‹åï¼Œäººå°±ä¼šæ¯«ä¸çŠ¹è±«åœ°æŠ›ï¼Œä¸æ¯«ä¸è§‰ç¾æ„§ã€‚ä¸€å¹¢æœ‰å°‘è®¸ç ´çª—çš„å»ºç­‘ä¸ºä¾‹ï¼Œå¦‚æœé‚£äº›çª—ä¸è¢«ä¿®ç†å¥½ï¼Œå¯èƒ½å°†ä¼šæœ‰ <a href="https://link.zhihu.com/?target=http%3A//kb.kkyuyin.com/item/a6ee85e3ee4639a2dc5ba8f11b79918a.html" target="_blank" rel="noopener">ç ´åè€…</a> ç ´åæ›´å¤šçš„çª—æˆ·ã€‚æœ€ç»ˆä»–ä»¬ç”šè‡³ä¼šé—¯å…¥å»ºç­‘å†…ï¼Œå¦‚æœå‘ç°æ— äººå±…ä½ï¼Œä¹Ÿè®¸å°±åœ¨é‚£é‡Œå®šå±…æˆ–è€…çºµç«ã€‚ä¸€é¢å¢™ï¼Œå¦‚æœå‡ºç°ä¸€äº›æ¶‚é¸¦æ²¡æœ‰è¢«æ¸…æ´—æ‰ï¼Œå¾ˆå¿«çš„ï¼Œå¢™ä¸Šå°±å¸ƒæ»¡äº†ä¹±ä¸ƒå…«ç³Ÿã€ä¸å ªå…¥ç›®çš„ä¸œè¥¿ï¼›ä¸€æ¡äººè¡Œé“æœ‰äº›è®¸çº¸å±‘ï¼Œä¸ä¹…åå°±ä¼šæœ‰æ›´å¤šåƒåœ¾ï¼Œæœ€ç»ˆäººä»¬ä¼šè§†è‹¥ç†æ‰€å½“ç„¶åœ°å°†åƒåœ¾é¡ºæ‰‹ä¸¢å¼ƒåœ¨åœ°ä¸Šã€‚è¿™ä¸ªç°è±¡ï¼Œå°±æ˜¯çŠ¯ç½ªå¿ƒç†å­¦ä¸­çš„ç ´çª—æ•ˆåº”ã€‚  </p>
</blockquote>
<p>è€Œç°åœ¨çš„å¤„ç†æ–¹å¼åˆ™æ˜¯åˆ©ç”¨çš„æ˜¯ï¼Œè‡ªæˆ‘ç„¦ç‚¹æ•ˆåº”ï¼Œåœ¨ä¼—ç›®ç½ç½ä¹‹ä¸‹ï¼Œå°¤å…¶æ˜¯åœ¨å®‰æ£€äººå‘˜å’Œä¹˜å®¢ä¸å¤ªå‡ºç°é‚£ç§æ— è§†è§„åˆ™çš„äººï¼Œé™¤éâ€¦</p>
<blockquote>
<p>è‡ªæˆ‘ç„¦ç‚¹æ•ˆåº”,spotlight effect ï¼Œä¹Ÿå«åšç¤¾ä¼šç„¦ç‚¹æ•ˆåº”ï¼Œæ˜¯äººä»¬ <a href="https://link.zhihu.com/?target=http%3A//www.bing.com/knows/%25E9%25AB%2598%25E4%25BC%25B0" target="_blank" rel="noopener">é«˜ä¼°</a> å‘¨å›´äººå¯¹è‡ªå·±å¤–è¡¨å’Œè¡Œä¸ºå…³æ³¨åº¦çš„ä¸€ç§è¡¨ç°ã€‚ç„¦ç‚¹æ•ˆåº”æ„å‘³ç€äººç±»å¾€å¾€ä¼šæŠŠè‡ªå·±çœ‹ä½œä¸€åˆ‡çš„ä¸­å¿ƒï¼Œå¹¶ä¸”ç›´è§‰åœ°é«˜ä¼°åˆ«äººå¯¹æˆ‘ä»¬çš„æ³¨æ„ç¨‹åº¦ã€‚ç„¦ç‚¹æ•ˆåº”å…¶å®æ˜¯ <a href="https://link.zhihu.com/?target=http%3A//www.bing.com/knows/%25E6%25AF%258F%25E4%25B8%25AA%25E4%25BA%25BA%25E9%2583%25BD%25E4%25BC%259A" target="_blank" rel="noopener">æ¯ä¸ªäººéƒ½ä¼š</a> æœ‰çš„ä½“éªŒï¼Œè¿™ç§å¿ƒç†çŠ¶æ€è®©æˆ‘ä»¬è¿‡åº¦å…³æ³¨è‡ªæˆ‘ï¼Œè¿‡åˆ†åœ¨æ„èšä¼šæˆ–è€…å·¥ä½œé›†ä¼šæ—¶å‘¨å›´äººä»¬å¯¹æˆ‘ä»¬çš„å…³æ³¨ç¨‹åº¦ã€‚<br>å›½å¤–æœ‰å®éªŒå’Œç»“è®ºçš„,å¤§ä½“å°±æ˜¯é™¤éä½ ä¸ç©¿è¡£æœ,æˆ–è€…åœ¨è®²å’Œåšé‚£äº›å¼•äººæ³¨æ„çš„äº‹(é€šå¸¸è·Ÿæ€§,æ­»äº¡æœ‰å…³)å³ä½¿ä½ ç©¿çš„åƒåªçŒ´å­æˆ–è€…æ¼‚äº®çš„åƒåªå­”é›€,ä¹Ÿä¹ˆæœ‰å‡ ä¸ªäººä¼šç•™æ„ä½ ï¼Œå¤§å®¶éƒ½æ˜¯çœ‹çš„è‡ªå·±,åŒæ—¶å¸Œæœ›åˆ«äººçœ‹è‡ªå·±.  </p>
</blockquote>
<p>ç”Ÿæ´»å¤„å¤„çš†å­¦é—®ï¼Œä¸å¾—ä¸è¯´å…¶å®å‰å®³çš„äººæ— å¤„ä¸åœ¨ã€‚ å¾ˆå¤šäººæœ‰ä»‡è§†ç¤¾ä¼šï¼Œè‡ªå·±å¦‚ä½•åŠªåŠ›éƒ½èƒ½åšåˆ°ä¸€äº›äº‹æƒ…ï¼Œè€Œè§‰å¾—ç¤¾ä¼šä¸å…¬ï¼Œè§‰å¾—è‡ªå·±å°±æ˜¯åŸºäºä¸åˆ°ï¼Œä»¥ä¸‹æ˜¯æˆ‘è¾å­¦å·¥ä½œè¿™ä¹ˆå¤šå¹´ä½“ä¼šå¾—åˆ°ä¸€äº›ç‚¹å¯ä»¥ä¸€èµ·åˆ†äº«ä¸‹</p>
<ol>
<li>åœ¨äº’è”ç½‘çœ‹åˆ°çš„å†…å®¹æ¥æºäºä½ æƒ³çœ‹åˆ°çš„å†…å®¹ã€‚</li>
<li>ä¸Šå­¦æœ‰æ²¡æœ‰ç”¨æˆ‘ä¸çŸ¥é“ï¼Œæˆ‘åªçŸ¥é“å­¦å†æ¯”æˆ‘é«˜çš„äººä»–çœ‹é—®é¢˜æ¯”æˆ‘å¿«å‡†ç‹ ï¼Œæˆ‘æŒ‡çš„æ˜¯â€œå­¦æˆâ€</li>
<li>æ¥¼ä¸‹ä¸€ä¸ªç”·äººç—…å¾—è¦æ­»ï¼Œé‚£é—´å£çš„ä¸€å®¶å”±ç€ç•™å£°æœºï¼Œå¯¹é¢æ˜¯å¼„å­©å­ã€‚å¢™ä¸Šæœ‰ä¸¤ä¸ªäººç‹‚ç¬‘ï¼Œè¿˜æœ‰æ‰“ç‰Œå£°ã€‚æ²³ä¸­çš„èˆ¹ä¸Šæœ‰å¥³äººå“­ç€å¥¹æ­»å»çš„æ¯äº²ã€‚äººç±»çš„æ‚²æ¬¢å¹¶ä¸ç›¸é€šï¼Œæˆ‘åªæ˜¯è§‰å¾—ä»–ä»¬åµé—¹ã€‚ é²è¿… - ã€Šè€Œå·²é›†ã€‹</li>
<li>å½“ä½ è€äº†ï¼Œå›é¡¾ä¸€ç”Ÿï¼Œå°±ä¼šå‘è§‰ï¼šä»€ä¹ˆæ—¶å€™å‡ºå›½è¯»ä¹¦ï¼Œä»€ä¹ˆæ—¶å€™å†³å®šåšç¬¬ä¸€ä»½èŒä¸šã€ä½•æ—¶é€‰å®šäº†å¯¹è±¡è€Œæ‹çˆ±ã€ä»€ä¹ˆæ—¶å€™ç»“å©šï¼Œå…¶å®éƒ½æ˜¯å‘½è¿çš„å·¨å˜ã€‚åªæ˜¯å½“æ—¶ç«™åœ¨ä¸‰å²”è·¯å£ï¼Œçœ¼è§é£äº‘åƒæ¨¯ï¼Œä½ ä½œå‡ºé€‰æ‹©çš„é‚£ä¸€æ—¥ï¼Œåœ¨æ—¥è®°ä¸Šï¼Œç›¸å½“æ²‰é—·å’Œå¹³å‡¡ï¼Œå½“æ—¶è¿˜ä»¥ä¸ºæ˜¯ç”Ÿå‘½ä¸­æ™®é€šçš„ä¸€å¤©ã€‚ é™¶æ°-ã€Šæ€é¹Œé¹‘çš„å°‘å¥³ã€‹</li>
</ol>
<p>ä¸€ä¸‹å†ä¹Ÿæƒ³ä¸èµ·æ¥è¿™ä¹ˆå¤šäº† ä»¥åæ…¢æ…¢è¡¥å……å§ã€‚</p>
<p>çƒ­çˆ±ç”Ÿæ´»ï¼Œæœ‰æ—¶å€™ç­‰å¾…å›æŠ¥çš„æ—¶å€™ä¸è¦è‡ªæš´è‡ªå¼ƒï¼Œåœ¨è¿™æ®µæ—¶é—´ä¸å¦‚å¤šå­¦ä¹ ï¼ğŸ‰ğŸ‰ğŸ‰ğŸ‰</p>
]]></content>
      
        <categories>
            
            <category> ç”Ÿæ´» </category>
            
        </categories>
        
        
        <tags>
            
            <tag> æ— è¶£ï¼Œå¿ƒç†å­¦ </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[ä½¿ç”¨ NodeJS APNS ç»™ä½ çš„åº”ç”¨å‘æ¶ˆæ¯]]></title>
      <url>http://www.msiter.com/2017/11/22/%E4%BD%BF%E7%94%A8%20NodeJS%20APNS%20%E7%BB%99%E4%BD%A0%E7%9A%84%E5%BA%94%E7%94%A8%E5%8F%91%E6%B6%88%E6%81%AF/</url>
      <content type="html"><![CDATA[<p>ç”¨åˆ°äº†å°ç±³çš„ MiPushSDK ä»Šå¤©å‡ºç°äº†é—®é¢˜ï¼Œæ€»ä¹‹æ— è®ºå¦‚ä½•å°±åƒé”™è¯¯ã€‚åœ¨è·Ÿä»–ä»¬çš„å¼€å‘äººå‘˜è¿›è¡Œäº¤æµçš„åŒæ—¶ï¼Œæˆ‘æƒ³çœ‹çœ‹æ˜¯è°çš„é—®é¢˜ï¼Œæ‰€ä»¥æœ‰äº†ä»¥ä¸‹çš„ç»å†ã€‚</p>
<p><img class = "g-pl-90"  src="http://image.msiter.com/stock-photo-236362221.jpg" alt="æ¥¼ä¸‹ä¸€ä¸ªç”·äººç—…çš„è¦æ­»ï¼Œéš”å£çš„ä¸€å®¶å”±ç€ç•™éŸ³æœºã€‚å¯¹é¢æ˜¯å“„å­©å­ï¼Œæ¥¼ä¸Šæœ‰ä¸¤ä¸ªäººç‹‚ç¬‘ï¼Œè¿˜æœ‰æ‰“ç‰Œå£°ã€‚æ²³è¾¹çš„èˆ¹ä¸Šæœ‰å¥³äººå“­ç€å¥¹æ­»å»çš„æ¯äº²ã€‚äººç±»çš„æ‚²å–œå¹¶ä¸ç›¸é€šï¼Œæˆ‘åªè§‰å¾—ä»–ä»¬åµé—¹ã€‚â€”â€”é²è¿…"></p>
<a id="more"></a>
<h2 id="åˆ›å»ºæ¨é€è¯ä¹¦"><a href="#åˆ›å»ºæ¨é€è¯ä¹¦" class="headerlink" title="åˆ›å»ºæ¨é€è¯ä¹¦"></a>åˆ›å»ºæ¨é€è¯ä¹¦</h2><p>åˆ›å»ºæ¨é€è¯ä¹¦ è¿™ä¸ªæ­¥éª¤çœç•¥</p>
<h2 id="å¯¼å‡º-è¯ä¹¦-p12-å’Œ-key-p12"><a href="#å¯¼å‡º-è¯ä¹¦-p12-å’Œ-key-p12" class="headerlink" title="å¯¼å‡º è¯ä¹¦.p12 å’Œ key.p12"></a>å¯¼å‡º è¯ä¹¦.p12 å’Œ key.p12</h2><p>æ¨é€è¯ä¹¦å®‰è£…åœ¨æœ¬åœ°ä¹‹å</p>
<ol>
<li>æ‰“å¼€ åº”ç”¨ é’¥åŒ™ä¸²è®¿é—® æ‰¾åˆ°è‡ªå·±çš„è¯ä¹¦</li>
<li>åœ¨éœ€è¦å¯¼å‡ºçš„è¯ä¹¦ä¸Šå³é”®ç‚¹å‡» å¯¼å‡º è¿™ä¸ªä¸œè¥¿å°±æ˜¯è¯ä¹¦.p12 æœ‰æ²¡æœ‰å¯†ç éƒ½å¯ä»¥ å¯†ç ä¼šç”¨æ¥ä¸€ä¼š openssl çš„æ—¶å€™è¾“å…¥</li>
<li>ç‚¹å‡»è¿™ä¸ªè¯ä¹¦ å±•å¼€ä¹‹åä¼šçœ‹åˆ°ä¸€ä¸ª Key å³é”®å¯¼å‡º è¿™ä¸ªå¯¼å‡ºçš„ p12 å°±æ˜¯ key.p12 å¯†ç è®¾ç½®åŒä¸Š</li>
</ol>
<h2 id="å°†å¯¼å‡ºçš„-p12-ç”Ÿæˆä¸º-pem"><a href="#å°†å¯¼å‡ºçš„-p12-ç”Ÿæˆä¸º-pem" class="headerlink" title="å°†å¯¼å‡ºçš„ p12 ç”Ÿæˆä¸º pem"></a>å°†å¯¼å‡ºçš„ p12 ç”Ÿæˆä¸º pem</h2><pre class="line-numbers language-shell"><code class="language-shell">openssl pkcs12 -clcerts -nokeys -out cert.pem -in cert.p12 # å¯¼å‡º cert.pem
openssl pkcs12 -in key.p12 -out key.pem -nodes # å¯¼å‡º key.pem
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>åœ¨è½¬æ¢è¿‡ç¨‹ä¸­ p12 è®¾ç½®äº†å¯†ç å°±è¾“å…¥å¯†ç  æ²¡æœ‰è¾“å…¥ç›´æ¥å›è½¦å°±å¯ä»¥<br>åœ¨è®¾ç½® key.pem çš„è¿‡ç¨‹ä¸­ ä¼šå‘ä½ è¯¢é—®æ˜¯å¦è®¾ç½®å¯†ç ï¼Œè®¾ç½®å¯†ç éœ€è¦è¾“å…¥ä¸¤æ¬¡ åˆ†åˆ«æ˜¯å¯†ç å’Œç¡®è®¤å¯†ç </p>
<h2 id="å¼€å§‹åˆ›å»º-Nodejs-APNS-æœåŠ¡"><a href="#å¼€å§‹åˆ›å»º-Nodejs-APNS-æœåŠ¡" class="headerlink" title="å¼€å§‹åˆ›å»º Nodejs APNS æœåŠ¡"></a>å¼€å§‹åˆ›å»º Nodejs APNS æœåŠ¡</h2><h3 id="åˆ›å»º-NodeJsé¡¹ç›®"><a href="#åˆ›å»º-NodeJsé¡¹ç›®" class="headerlink" title="åˆ›å»º NodeJsé¡¹ç›®"></a>åˆ›å»º NodeJsé¡¹ç›®</h3><p>åˆ›å»ºä¸€ä¸ª NodeJS é¡¹ç›®</p>
<pre class="line-numbers language-shell"><code class="language-shell">mkdir APNS
cd APNS
npm init
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>æŒ‰ç…§æ­¥éª¤å¡«å†™ä¿¡æ¯ï¼Œä¹‹ååœ¨ç”Ÿæˆçš„package.json æ–‡ä»¶ä¸­ å¼•å…¥ å¯¹äº apn  çš„æ”¯æŒ</p>
<pre class="line-numbers language-json"><code class="language-json"><span class="token property">"dependencies"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token property">"apn"</span><span class="token operator">:</span> <span class="token string">""</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>æ€»ä½“ä¸Šçœ‹èµ·æ¥æ˜¯è¿™ä¸ªæ ·å­çš„</p>
<pre class="line-numbers language-json"><code class="language-json"><span class="token punctuation">{</span>
  <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"apn"</span><span class="token punctuation">,</span>
  <span class="token property">"version"</span><span class="token operator">:</span> <span class="token string">"1.0.0"</span><span class="token punctuation">,</span>
  <span class="token property">"description"</span><span class="token operator">:</span> <span class="token string">""</span><span class="token punctuation">,</span>
  <span class="token property">"main"</span><span class="token operator">:</span> <span class="token string">"index.js"</span><span class="token punctuation">,</span>
  <span class="token property">"scripts"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"test"</span><span class="token operator">:</span> <span class="token string">"echo \"Error: no test specified\" &amp;&amp; exit 1"</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">"author"</span><span class="token operator">:</span> <span class="token string">""</span><span class="token punctuation">,</span>
  <span class="token property">"license"</span><span class="token operator">:</span> <span class="token string">"ISC"</span><span class="token punctuation">,</span>
  <span class="token property">"dependencies"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"apn"</span><span class="token operator">:</span> <span class="token string">""</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="å®Œæˆ"><a href="#å®Œæˆ" class="headerlink" title="å®Œæˆ"></a>å®Œæˆ</h3><p>åˆ›å»ºä¸€ä¸ª index.js æ–‡ä»¶</p>
<pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">var</span> apn <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"apn"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> tokens <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"&lt;&lt;you want push device token>>"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> service <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">apn<span class="token punctuation">.</span>Provider</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token string">"cert"</span><span class="token punctuation">:</span> <span class="token string">"push/cert.pem"</span><span class="token punctuation">,</span> <span class="token comment" spellcheck="true">// æ ¹ç›®å½•ä¸‹åˆ›å»º push æ–‡ä»¶å¤¹ å°†æ–‡ä»¶æ”¾ç½®åœ¨å†…ï¼Œå½“ç„¶ä½ å¯ä»¥æ”¾åœ¨è‡ªå·±å–œæ¬¢çš„ä½ç½®</span>
  <span class="token string">"key"</span><span class="token punctuation">:</span> <span class="token string">"push/key.pem"</span><span class="token punctuation">,</span>
  <span class="token string">"production"</span><span class="token punctuation">:</span><span class="token boolean">false</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> note <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">apn<span class="token punctuation">.</span>Notification</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token string">"alert"</span><span class="token punctuation">:</span><span class="token string">"Hello World!"</span><span class="token punctuation">,</span>
  <span class="token string">"sound"</span><span class="token punctuation">:</span><span class="token string">"default"</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">// The topic is usually the bundle identifier of your application.</span>
note<span class="token punctuation">.</span>topic <span class="token operator">=</span> <span class="token string">"&lt;&lt;you bundle identifier>>"</span><span class="token punctuation">;</span>
note<span class="token punctuation">.</span>badge <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`Sending: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>note<span class="token punctuation">.</span><span class="token function">compile</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> to </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>tokens<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
service<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>note<span class="token punctuation">,</span> tokens<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span> result <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"sent:"</span><span class="token punctuation">,</span> result<span class="token punctuation">.</span>sent<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"failed:"</span><span class="token punctuation">,</span> result<span class="token punctuation">.</span>failed<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span>failed<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">// For one-shot notification tasks you may wish to shutdown the connection</span>
<span class="token comment" spellcheck="true">// after everything is sent, but only call shutdown if you need your</span>
<span class="token comment" spellcheck="true">// application to terminate.</span>
service<span class="token punctuation">.</span><span class="token function">shutdown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p> è¿™é‡Œé¢åªè¿›è¡Œäº†ä¸€äº›åŸºæœ¬çš„è®¾ç½®ï¼Œåªè®¾ç½®äº†æ ‡é¢˜å…³äºæ¶ˆæ¯å†…å®¹ç­‰è®¾ç½® å¯ä»¥æŸ¥é˜…æ–‡æ¡£æˆ–è€…ç›´æ¥åœ¨</p>
<p>apn/lib/notification/ ç›®å½•ä¸‹æŸ¥çœ‹ è®¾ç½®</p>
<p>ç›®å‰çš„ç‰ˆæœ¬æ˜¯å­˜åœ¨è¿™äº›çš„</p>
<pre class="line-numbers language-json"><code class="language-json"><span class="token punctuation">[</span><span class="token string">"payload"</span><span class="token punctuation">,</span> <span class="token string">"expiry"</span><span class="token punctuation">,</span> <span class="token string">"priority"</span><span class="token punctuation">,</span> <span class="token string">"alert"</span><span class="token punctuation">,</span> <span class="token string">"body"</span><span class="token punctuation">,</span> <span class="token string">"locKey"</span><span class="token punctuation">,</span>
<span class="token string">"locArgs"</span><span class="token punctuation">,</span> <span class="token string">"title"</span><span class="token punctuation">,</span> <span class="token string">"subtitle"</span><span class="token punctuation">,</span> <span class="token string">"titleLocKey"</span><span class="token punctuation">,</span> <span class="token string">"titleLocArgs"</span><span class="token punctuation">,</span> <span class="token string">"action"</span><span class="token punctuation">,</span>
<span class="token string">"actionLocKey"</span><span class="token punctuation">,</span> <span class="token string">"launchImage"</span><span class="token punctuation">,</span> <span class="token string">"badge"</span><span class="token punctuation">,</span> <span class="token string">"sound"</span><span class="token punctuation">,</span> <span class="token string">"contentAvailable"</span><span class="token punctuation">,</span>
<span class="token string">"mutableContent"</span><span class="token punctuation">,</span> <span class="token string">"mdm"</span><span class="token punctuation">,</span> <span class="token string">"urlArgs"</span><span class="token punctuation">,</span> <span class="token string">"category"</span><span class="token punctuation">,</span> <span class="token string">"threadId"</span><span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="æµ‹è¯•"><a href="#æµ‹è¯•" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h3><pre class="line-numbers language-shell"><code class="language-shell">node index.js
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>å¤§åŠŸå‘Šæˆ</p>
]]></content>
      
        <categories>
            
            <category> æœåŠ¡å™¨ </category>
            
        </categories>
        
        
        <tags>
            
            <tag> ios </tag>
            
            <tag> NodeJS </tag>
            
            <tag> APNs </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[IOS10å‰ UITextFiled çš„ placeholder çš„é—®é¢˜]]></title>
      <url>http://www.msiter.com/2017/11/16/IOS10%E5%89%8D%20UITextFiled%20%E7%9A%84%20placeholder%20%E7%9A%84%E9%97%AE%E9%A2%98/</url>
      <content type="html"><![CDATA[<blockquote>
<p>The styled string that is displayed when there is no other text in the text field.<br>This property is nil by default. If set, the placeholder string is drawn using system-defined color and the remaining style information (except the text color) of the attributed string. Assigning a new value to this property also replaces the value of the placeholder property with the same string data, albeit without any formatting information. Assigning a new value to this property does not affect any other style-related properties of the text field</p>
</blockquote>
<p>è¿™æ˜¯å®˜æ–¹çš„ä¸€ç‰‡è§£é‡Šï¼Œçœ‹ç€éƒ½å¾ˆä¸é”™çš„ï½</p>
<a id="more"></a>
<p>ç„¶è€Œ</p>
<p>ä»Šå¤©æˆ‘ä»¬çš„å·¨å¤´è®¾è®¡å¸ˆæ¥æ‰¾æˆ‘ï¼Œè¯´æˆ‘çš„è¾“å…¥æ¡†ä¸å±…ä¸­.æˆ‘ä¸ä»¥ä¸ºç„¶ï¼Œæ€ä¹ˆå¯èƒ½ï½å› ä¸ºæˆ‘çš„è®¾å¤‡ä¸Šæ˜¯å¥½çš„<br>æ‹¿æ¥æ‰‹æœºä¸€çœ‹ï¼Œè¿˜çœŸæ˜¯ï¼Œï¼Œï¼Œå¥½å§ èµ¶ç´§æ‰¾åŸå› å§ï¼Œå› ä¸ºæˆ‘çš„è®¾å¤‡æ˜¯IOS11 æ‰€ä»¥æˆ‘æ€€ç–‘æ˜¯ä¸æ˜¯IOS10çš„é—®é¢˜ã€‚<br>ä¹‹åæ‰¾äº†ä¸€äº›èµ„æ–™å‘ç°</p>
<blockquote>
<p><a href="https://stackoverflow.com/questions/28677519/vertically-centering-a-uitextfields-attributedplaceholder" target="_blank" rel="noopener">Vertically centering a UITextFieldâ€™s attributedPlaceholder</a><br><a href="https://www.google.com.hk/search?safe=strict&amp;ei=WB8NWvSGG8LNmQHB0q2oBw&amp;q=uitextfield+attributedplaceholder+center&amp;oq=uitextfield+attributedplaceholder+c&amp;gs_l=psy-ab.3.0.0i203k1.98408.107770.0.109474.25.19.0.0.0.0.469.2569.2-6j1j1.8.0....0...1.1j4.64.psy-ab..18.7.2272...0j0i10i203k1j0i10k1j0i10i30k1j35i39k1j0i67k1j0i30k1j0i8i30k1.0.n33G4smHqp4" target="_blank" rel="noopener">uitextfield attributedplaceholder center Google</a></p>
</blockquote>
<p>å‘è§‰è¿™ä¸ªé—®é¢˜è¿˜æ˜¯æ™®éå­˜åœ¨çš„ æœ‰ä¸å°‘äººç»™å¤„ç†è‡ªå·±çš„åšæ³•æ¯”å¦‚ï¼š</p>
<p><a href="https://stackoverflow.com/users/1486308/kean" target="_blank" rel="noopener">kean</a>åœ¨ Stackflowä¸­çš„å›ç­”</p>
<pre class="line-numbers language-objectivec"><code class="language-objectivec">NSMutableParagraphStyle <span class="token operator">*</span>style <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token keyword">self</span><span class="token punctuation">.</span>addressBar<span class="token punctuation">.</span>defaultTextAttributes<span class="token punctuation">[</span>NSParagraphStyleAttributeName<span class="token punctuation">]</span> mutableCopy<span class="token punctuation">]</span><span class="token punctuation">;</span>
style<span class="token punctuation">.</span>minimumLineHeight <span class="token operator">=</span> <span class="token keyword">self</span><span class="token punctuation">.</span>addressBar<span class="token punctuation">.</span>font<span class="token punctuation">.</span>lineHeight <span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">.</span>addressBar<span class="token punctuation">.</span>font<span class="token punctuation">.</span>lineHeight <span class="token operator">-</span> <span class="token punctuation">[</span>UIFont fontWithName<span class="token punctuation">:</span><span class="token string">@"Gotham-BookItalic"</span> size<span class="token punctuation">:</span><span class="token number">14.0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>lineHeight<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2.0</span><span class="token punctuation">;</span>

<span class="token keyword">self</span><span class="token punctuation">.</span>addressBar<span class="token punctuation">.</span>attributedPlaceholder <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span>NSAttributedString alloc<span class="token punctuation">]</span> initWithString<span class="token punctuation">:</span><span class="token string">@"Placeholder text"</span>
                            attributes<span class="token punctuation">:</span><span class="token operator">@</span><span class="token punctuation">{</span>
                                         NSForegroundColorAttributeName<span class="token punctuation">:</span> <span class="token punctuation">[</span>UIColor colorWithRed<span class="token punctuation">:</span><span class="token number">79</span><span class="token operator">/</span><span class="token number">255.0f</span> green<span class="token punctuation">:</span><span class="token number">79</span><span class="token operator">/</span><span class="token number">255.0f</span> blue<span class="token punctuation">:</span><span class="token number">79</span><span class="token operator">/</span><span class="token number">255.0f</span> alpha<span class="token punctuation">:</span><span class="token number">0.5f</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                                         NSFontAttributeName <span class="token punctuation">:</span> <span class="token punctuation">[</span>UIFont fontWithName<span class="token punctuation">:</span><span class="token string">@"Gotham-BookItalic"</span> size<span class="token punctuation">:</span><span class="token number">14.0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                                         NSParagraphStyleAttributeName <span class="token punctuation">:</span> style
                                         <span class="token punctuation">}</span>
 <span class="token punctuation">]</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>å¦å¤–ä»–ä¹Ÿç»™å‡ºäº†å¦ä¸€ç§æ–¹æ³•</p>
<blockquote>
<p>You could also override a <code>- (CGRect)placeholderRectForBounds:(CGRect)bounds;</code> method in UITextField subclass.</p>
<p>Itâ€™s messy, but it works :)</p>
</blockquote>
<p>è¿˜æœ‰å¾ˆå¤šæœåˆ°çš„æ–¹æ³• æˆ‘å°±ä¸ä¸€ä¸€èµ˜è¿°äº†ã€‚ä»–ä»¬çš„æ–¹æ³•æˆ–å¤šæˆ–å°‘çš„éƒ½æ²¡å¾ˆéº»çƒ¦ï¼Œè€Œä¸”éœ€è¦è¿›è¡Œé€‚é…ï¼Œæ¯”å¦‚è¿™ç§è°ƒæ•´ä½ç½®çš„æ˜¯å¯ä»¥çš„ã€‚ä½†æ˜¯IOS11 ä½ç½®åˆå¥½äº†æ€ä¹ˆåŠå‘¢ï¼Ÿ<br>æœ€ç»ˆæ‰¾åˆ°å¦‚ä¸‹çš„æ–¹æ³•ï¼Œç‰¹æ­¤è®°å½•ä¸€ä¸‹</p>
<pre class="line-numbers language-objectivec"><code class="language-objectivec">
<span class="token operator">-</span> <span class="token punctuation">(</span>CGRect<span class="token punctuation">)</span>placeholderRectForBounds<span class="token punctuation">:</span><span class="token punctuation">(</span>CGRect<span class="token punctuation">)</span>bounds <span class="token punctuation">{</span>

    <span class="token keyword">return</span> <span class="token function">CGRectMake</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span> <span class="token punctuation">,</span> <span class="token keyword">self</span><span class="token punctuation">.</span>bounds<span class="token punctuation">.</span>size<span class="token punctuation">.</span>width<span class="token punctuation">,</span> <span class="token keyword">self</span><span class="token punctuation">.</span>bounds<span class="token punctuation">.</span>size<span class="token punctuation">.</span>height<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>drawPlaceholderInRect<span class="token punctuation">:</span><span class="token punctuation">(</span>CGRect<span class="token punctuation">)</span>rect <span class="token punctuation">{</span>

    <span class="token punctuation">[</span><span class="token keyword">super</span> drawPlaceholderInRect<span class="token punctuation">:</span><span class="token function">CGRectMake</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span> <span class="token punctuation">,</span> <span class="token keyword">self</span><span class="token punctuation">.</span>bounds<span class="token punctuation">.</span>size<span class="token punctuation">.</span>width<span class="token punctuation">,</span> <span class="token keyword">self</span><span class="token punctuation">.</span>bounds<span class="token punctuation">.</span>size<span class="token punctuation">.</span>height<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
]]></content>
      
        <categories>
            
            <category> IOS </category>
            
        </categories>
        
        
        <tags>
            
            <tag> IOS </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[WebView ä¸ Html Input File ä»¥åŠ Upload File å‡ºç°çš„é—®é¢˜]]></title>
      <url>http://www.msiter.com/2017/10/26/WebView%20%E4%B8%8E%20Html%20Input%20Bug/</url>
      <content type="html"><![CDATA[<p>åœ¨é¡¹ç›®ä¸­ä½¿ç”¨äº†WebViewæ¥æ˜¾ç¤ºä¸€äº›å†…å®¹ï¼Œä¹‹åå°±é‡åˆ°äº†ä¸€äº›é—®é¢˜ã€‚æ€»ç»“äº†ä¸€ä¸‹</p>
<p><img class = "g-pl-90"  src="http://image.msiter.com/stock-photo-233150091.jpg" alt="ä¸€æ¯æ•¬è‡ªç”±ï¼Œä¸€æ¯æ•¬æ­»äº¡" title="ä½ è¿˜å¾ˆå¹´è½»,å°†æ¥ä½ ä¼šé‡åˆ°å¾ˆå¤šäºº,ç»å†å¾ˆå¤šäº‹,å¾—åˆ°å¾ˆå¤š,ä¹Ÿä¼šå¤±å»å¾ˆå¤š&lt;br/&gt;&lt;br/&gt;ä½†æ— è®ºå¦‚ä½•,æœ‰ä¸¤æ ·ä¸œè¥¿,ä½ ç»ä¸èƒ½ä¸¢å¼ƒ,ä¸€ä¸ªå«è‰¯å¿ƒ,å¦ä¸€ä¸ªå«ç†æƒ³"></p>
<a id="more"></a>
<h2 id="é‡åˆ°-Input-File-å‡ºç°çš„-å´©æºƒé—®é¢˜"><a href="#é‡åˆ°-Input-File-å‡ºç°çš„-å´©æºƒé—®é¢˜" class="headerlink" title="é‡åˆ° Input File å‡ºç°çš„ å´©æºƒé—®é¢˜"></a>é‡åˆ° Input File å‡ºç°çš„ å´©æºƒé—®é¢˜</h2><p>è¿™ä¸ªé—®é¢˜å…¶å®è¿˜æ˜¯æ¯”è¾ƒå¥½è§£å†³ æ— éå°±æ˜¯æƒé™é—®é¢˜ å…·ä½“çš„keyå€¼</p>
<p>è¯·ç›´æ¥è®¿é—® <a href="https://developer.apple.com/library/content/documentation/General/Reference/InfoPlistKeyReference/Articles/CocoaKeys.html" target="_blank" rel="noopener">Cocoa Keys</a></p>
<h2 id="Model-çš„ViewController-åœ¨ä¸Šä¼ æ–‡ä»¶å-ä¼šç›´æ¥-dismissæ‰"><a href="#Model-çš„ViewController-åœ¨ä¸Šä¼ æ–‡ä»¶å-ä¼šç›´æ¥-dismissæ‰" class="headerlink" title="Model çš„ViewController åœ¨ä¸Šä¼ æ–‡ä»¶å ä¼šç›´æ¥ dismissæ‰"></a>Model çš„ViewController åœ¨ä¸Šä¼ æ–‡ä»¶å ä¼šç›´æ¥ dismissæ‰</h2><p>è§£å†³åŠæ³• åœ¨ Model å‡ºæ¥çš„ ViewController åŠ å…¥ UINavigationController</p>
<p>ä¹‹åé‡å†™ UINavigationController çš„æ–¹æ³•</p>
<pre class="line-numbers language-objectivec"><code class="language-objectivec"><span class="token operator">-</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>dismissViewControllerAnimated<span class="token punctuation">:</span><span class="token punctuation">(</span>BOOL<span class="token punctuation">)</span>flag completion<span class="token punctuation">:</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token punctuation">(</span><span class="token operator">^</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">)</span>completion<span class="token punctuation">{</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">.</span>presentedViewController<span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token punctuation">[</span><span class="token keyword">super</span> dismissViewControllerAnimated<span class="token punctuation">:</span>flag completion<span class="token punctuation">:</span>completion<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="è‡ªå·±é‡å†™pan-dismiss-æ–¹æ³•çš„éšœç¢è§£å†³"><a href="#è‡ªå·±é‡å†™pan-dismiss-æ–¹æ³•çš„éšœç¢è§£å†³" class="headerlink" title="è‡ªå·±é‡å†™pan dismiss æ–¹æ³•çš„éšœç¢è§£å†³"></a>è‡ªå·±é‡å†™pan dismiss æ–¹æ³•çš„éšœç¢è§£å†³</h3><p>åœ¨æˆ‘ä»¬æƒ³é‡å†™dismissçš„æ–¹æ³•æ—¶ï¼Œä¼šç»‘å®šä¸€ä¸ªæ‰‹åŠ¿ã€‚ä½†æ˜¯åœ¨ WebViewä¸­å·²ç»å­˜åœ¨äº†å¾ˆå¤šæ‰‹åŠ¿äº†ã€‚<br>å…¶ä¸­å°±åŒ…æ‹¬ ä¸¤ä¸ª <code>UIScreenEdgePanGestureRecognizer</code>ï¼Œä¸€ä¸ªè¿›è¡Œå‰è¿›æ“ä½œ ä¸€ä¸ªè¿›è¡Œåé€€æ“ä½œ</p>
<p>æˆ‘ä»¬æƒ³é‡å†™panæ–¹æ³•è¿›è¡Œå‰è¿›åé€€dismissçš„è¯ï¼Œæš‚æ—¶åªæœ‰ä¸¤ç§åŠæ³•ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬çœ‹çœ‹é‚£ç§æ–¹æ³•å¯ä»¥ä½¿ç”¨å§</p>
<h4 id="ç¬¬ä¸€ç§-è‡ªå·±å»å†™-WebView-ä¸­çš„-pan-æ‰‹åŠ¿"><a href="#ç¬¬ä¸€ç§-è‡ªå·±å»å†™-WebView-ä¸­çš„-pan-æ‰‹åŠ¿" class="headerlink" title="ç¬¬ä¸€ç§ è‡ªå·±å»å†™ WebView ä¸­çš„ pan æ‰‹åŠ¿"></a>ç¬¬ä¸€ç§ è‡ªå·±å»å†™ WebView ä¸­çš„ pan æ‰‹åŠ¿</h4><p>é¦–å…ˆæƒ³åˆ°çš„å°±æ˜¯è¿™ä¸ªæ–¹æ³•ï¼Œå› ä¸ºè¿™ä¸ªæ–¹æ³•å¾ˆçœäº‹å„¿ï¼Œå¯å®šä¹‰ç¨‹åº¦é«˜ï¼Œå½“ç„¶è¿™æ˜¯å¯è¡Œçš„æƒ…å†µä¸‹</p>
<p>äº‹å®è¯æ˜ï¼Œæˆ‘ä»¬åœ¨ç¬¬ä¸€ä¸ªé—®é¢˜å°±è¢«æ‹Œä½äº†ï¼Œæˆ‘ä»¬æ²¡æœ‰åŠæ³•å»æ¸è¿›å¼çš„ å‰è¿›ç½‘é¡µ å’Œ åé€€ æ‰€ä»¥è¿™ä¸ªé—®é¢˜ä¸å¾—ä¸æ”¾å¼ƒ</p>
<h4 id="ç¬¬äºŒç§-ä½¿ç”¨-UIGestureRecognizerDelegate-æ¥æš‚æ—¶å…³é—­-webviewä¸­çš„æ‰‹åŠ¿"><a href="#ç¬¬äºŒç§-ä½¿ç”¨-UIGestureRecognizerDelegate-æ¥æš‚æ—¶å…³é—­-webviewä¸­çš„æ‰‹åŠ¿" class="headerlink" title="ç¬¬äºŒç§ ä½¿ç”¨ UIGestureRecognizerDelegate æ¥æš‚æ—¶å…³é—­ webviewä¸­çš„æ‰‹åŠ¿"></a>ç¬¬äºŒç§ ä½¿ç”¨ UIGestureRecognizerDelegate æ¥æš‚æ—¶å…³é—­ webviewä¸­çš„æ‰‹åŠ¿</h4><p>è¿™ä¸ªæ–¹æ³•æœ€ç»ˆå®è·µæ˜¯å¯ä»¥çš„</p>
<p>é¦–å…ˆæˆ‘ä»¬è·å–åˆ° åé€€çš„æ‰‹åŠ¿ åœ¨åˆ›å»º WebView ä¹‹åï¼Œæˆ‘ä»¬è¿™æ ·è·å–</p>
<h5 id="è·å–åˆ°-æ‰‹åŠ¿-å¹¶ä¸”è®¾ç½®-delegate"><a href="#è·å–åˆ°-æ‰‹åŠ¿-å¹¶ä¸”è®¾ç½®-delegate" class="headerlink" title="è·å–åˆ° æ‰‹åŠ¿ å¹¶ä¸”è®¾ç½® delegate"></a>è·å–åˆ° æ‰‹åŠ¿ å¹¶ä¸”è®¾ç½® delegate</h5><pre class="line-numbers language-objectivec"><code class="language-objectivec"><span class="token keyword">for</span> <span class="token punctuation">(</span>UIGestureRecognizer <span class="token operator">*</span>reconizer <span class="token keyword">in</span> <span class="token keyword">self</span><span class="token punctuation">.</span>wkWebView<span class="token punctuation">.</span>gestureRecognizers<span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token comment" spellcheck="true">/// å¦‚æœè·å–çš„ æ‰‹åŠ¿ ç±»å‹æ˜¯ ScreenEdgePanGestureRecognizer ç±»å‹</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">[</span>reconizer isKindOfClass<span class="token punctuation">:</span>UIScreenEdgePanGestureRecognizer<span class="token punctuation">.</span>class<span class="token punctuation">]</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>

            <span class="token comment" spellcheck="true">/// å¦‚æœæ‰‹åŠ¿å¯¹è±¡æ˜¯ è¿”å›çš„æ”¶è§†å¯¹è±¡ ä½œå‡ºä»¥ä¸‹å¤„ç†</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>UIScreenEdgePanGestureRecognizer<span class="token operator">*</span><span class="token punctuation">)</span>reconizer<span class="token punctuation">)</span><span class="token punctuation">.</span>edges <span class="token operator">==</span> UIRectEdgeLeft<span class="token punctuation">)</span> <span class="token punctuation">{</span>

                reconizer<span class="token punctuation">.</span>delegate <span class="token operator">=</span> <span class="token keyword">self</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            <span class="token comment" spellcheck="true">/// è¯¥æ‰‹åŠ¿å°±æ˜¯ å‰è¿›æ‰‹åŠ¿</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>UIScreenEdgePanGestureRecognizer<span class="token operator">*</span><span class="token punctuation">)</span>reconizer<span class="token punctuation">)</span><span class="token punctuation">.</span>edges <span class="token operator">==</span> UIRectEdgeRight<span class="token punctuation">)</span> <span class="token punctuation">{</span>

            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h5 id="æ ¹æ®WebView-æ˜¯å¦å¯ä»¥è¿”å›-æ§åˆ¶æ‰‹åŠ¿æ˜¯å¦å¯ç”¨"><a href="#æ ¹æ®WebView-æ˜¯å¦å¯ä»¥è¿”å›-æ§åˆ¶æ‰‹åŠ¿æ˜¯å¦å¯ç”¨" class="headerlink" title="æ ¹æ®WebView æ˜¯å¦å¯ä»¥è¿”å› æ§åˆ¶æ‰‹åŠ¿æ˜¯å¦å¯ç”¨"></a>æ ¹æ®WebView æ˜¯å¦å¯ä»¥è¿”å› æ§åˆ¶æ‰‹åŠ¿æ˜¯å¦å¯ç”¨</h5><p>è·å–åˆ° delegateä¹‹åæˆ‘ä»¬å°±å¯ä»¥è¿›è¡Œæ“ä½œäº† æ¥ä¸‹æ¥å®ç° delegate çš„æ–¹æ³•</p>
<pre class="line-numbers language-objectivec"><code class="language-objectivec">
<span class="token comment" spellcheck="true">/// å½“WebView ä¸å¯ä»¥è¿”å›åˆ°æ—¶å€™ï¼Œæˆ‘ä»¬ä¸è®©è¯¥æ‰‹åŠ¿è§¦å‘</span>
<span class="token operator">-</span><span class="token punctuation">(</span>BOOL<span class="token punctuation">)</span>gestureRecognizerShouldBegin<span class="token punctuation">:</span><span class="token punctuation">(</span>UIGestureRecognizer <span class="token operator">*</span><span class="token punctuation">)</span>gestureRecognizer<span class="token punctuation">{</span>

    <span class="token keyword">return</span> <span class="token keyword">self</span><span class="token punctuation">.</span>wkWebView<span class="token punctuation">.</span>canGoBack<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h5 id="å†™-æ¨å‡ºè§†å›¾çš„æ–¹æ³•"><a href="#å†™-æ¨å‡ºè§†å›¾çš„æ–¹æ³•" class="headerlink" title="å†™ æ¨å‡ºè§†å›¾çš„æ–¹æ³•"></a>å†™ æ¨å‡ºè§†å›¾çš„æ–¹æ³•</h5><pre class="line-numbers language-objectivec"><code class="language-objectivec"><span class="token operator">-</span><span class="token punctuation">(</span>instancetype<span class="token punctuation">)</span>initWithRootViewController<span class="token punctuation">:</span><span class="token punctuation">(</span>UIViewController <span class="token operator">*</span><span class="token punctuation">)</span>rootViewController<span class="token punctuation">{</span>

    <span class="token keyword">self</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token keyword">super</span> initWithRootViewController<span class="token punctuation">:</span>rootViewController<span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

        _presentdAnimation <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span>BaseViewControllerPresentdAnimation alloc<span class="token punctuation">]</span> init<span class="token punctuation">]</span><span class="token punctuation">;</span>
        _dismissedAnimation <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span>BaseViewControllerDismissedAnimation alloc<span class="token punctuation">]</span> init<span class="token punctuation">]</span><span class="token punctuation">;</span>
        _interactiveTransitioning <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span>BasePresentdAnimationInteractiveTransition alloc<span class="token punctuation">]</span>init<span class="token punctuation">]</span><span class="token punctuation">;</span>

        <span class="token keyword">self</span><span class="token punctuation">.</span>navigationBarHidden <span class="token operator">=</span> true<span class="token punctuation">;</span>

        <span class="token keyword">self</span><span class="token punctuation">.</span>transitioningDelegate <span class="token operator">=</span> <span class="token keyword">self</span><span class="token punctuation">;</span>
        <span class="token keyword">self</span><span class="token punctuation">.</span>modalPresentationCapturesStatusBarAppearance <span class="token operator">=</span> true<span class="token punctuation">;</span>

        <span class="token comment" spellcheck="true">/// åœ¨è·å–åˆ° RootViewController å®Œæˆ æ‰‹åŠ¿çš„ç»‘å®š è¿™æ ·åœ¨ Wkwebview æ‰‹åŠ¿ä¸å¯ç”¨çš„æ—¶å€™ è¯¥æ‰‹åŠ¿å°±å¯ä»¥ä½¿ç”¨äº†</span>
        _panGestureRecognizer <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span>UIScreenEdgePanGestureRecognizer alloc<span class="token punctuation">]</span> initWithTarget<span class="token punctuation">:</span><span class="token keyword">self</span> action<span class="token punctuation">:</span><span class="token keyword">@selector</span><span class="token punctuation">(</span>handlePanGestureRecognizerMethod<span class="token punctuation">:</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        _panGestureRecognizer<span class="token punctuation">.</span>edges <span class="token operator">=</span> UIRectEdgeLeft<span class="token punctuation">;</span>
        <span class="token punctuation">[</span>rootViewController<span class="token punctuation">.</span>view addGestureRecognizer<span class="token punctuation">:</span>_panGestureRecognizer<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> <span class="token keyword">self</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token operator">-</span><span class="token punctuation">(</span>id<span class="token operator">&lt;</span>UIViewControllerAnimatedTransitioning<span class="token operator">></span><span class="token punctuation">)</span>animationControllerForPresentedController<span class="token punctuation">:</span><span class="token punctuation">(</span>UIViewController <span class="token operator">*</span><span class="token punctuation">)</span>presented presentingController<span class="token punctuation">:</span><span class="token punctuation">(</span>UIViewController <span class="token operator">*</span><span class="token punctuation">)</span>presenting sourceController<span class="token punctuation">:</span><span class="token punctuation">(</span>UIViewController <span class="token operator">*</span><span class="token punctuation">)</span>source<span class="token punctuation">{</span>

    <span class="token keyword">return</span> _presentdAnimation <span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token operator">-</span><span class="token punctuation">(</span>id<span class="token operator">&lt;</span>UIViewControllerAnimatedTransitioning<span class="token operator">></span><span class="token punctuation">)</span>animationControllerForDismissedController<span class="token punctuation">:</span><span class="token punctuation">(</span>UIViewController <span class="token operator">*</span><span class="token punctuation">)</span>dismissed<span class="token punctuation">{</span>

    <span class="token keyword">return</span> _dismissedAnimation<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token operator">-</span><span class="token punctuation">(</span>id<span class="token operator">&lt;</span>UIViewControllerInteractiveTransitioning<span class="token operator">></span><span class="token punctuation">)</span>interactionControllerForDismissal<span class="token punctuation">:</span><span class="token punctuation">(</span>id<span class="token operator">&lt;</span>UIViewControllerAnimatedTransitioning<span class="token operator">></span><span class="token punctuation">)</span>animator<span class="token punctuation">{</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>_dismissedAnimation<span class="token punctuation">.</span>isInteraction<span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token keyword">return</span> _interactiveTransitioning<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> nil<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token operator">-</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>handlePanGestureRecognizerMethod<span class="token punctuation">:</span><span class="token punctuation">(</span>UIPanGestureRecognizer <span class="token operator">*</span><span class="token punctuation">)</span>pan<span class="token punctuation">{</span>

    CGPoint point <span class="token operator">=</span> <span class="token punctuation">[</span>pan translationInView<span class="token punctuation">:</span><span class="token keyword">self</span><span class="token punctuation">.</span>view<span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">switch</span> <span class="token punctuation">(</span>pan<span class="token punctuation">.</span>state<span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token keyword">case</span> UIGestureRecognizerStateBegan<span class="token punctuation">:</span>

            <span class="token keyword">self</span><span class="token punctuation">.</span>dismissedAnimation<span class="token punctuation">.</span>isInteraction <span class="token operator">=</span> true<span class="token punctuation">;</span>

            <span class="token punctuation">[</span><span class="token keyword">self</span><span class="token punctuation">.</span>viewControllers<span class="token punctuation">.</span>firstObject dismissViewControllerAnimated<span class="token punctuation">:</span>true completion<span class="token punctuation">:</span>nil<span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>

        <span class="token keyword">case</span> UIGestureRecognizerStateChanged<span class="token punctuation">:</span>

            <span class="token punctuation">[</span>_interactiveTransitioning updateInteractiveTransition<span class="token punctuation">:</span> <span class="token punctuation">(</span>CGFloat<span class="token punctuation">)</span>point<span class="token punctuation">.</span>x<span class="token operator">/</span><span class="token function">CGRectGetWidth</span><span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">.</span>view<span class="token punctuation">.</span>frame<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">default</span><span class="token punctuation">:</span>

            _dismissedAnimation<span class="token punctuation">.</span>isInteraction <span class="token operator">=</span> false<span class="token punctuation">;</span>

            CGFloat locationX <span class="token operator">=</span> <span class="token function">ABS</span><span class="token punctuation">(</span>point<span class="token punctuation">.</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
            CGFloat velocityX <span class="token operator">=</span> <span class="token punctuation">[</span>pan velocityInView<span class="token punctuation">:</span><span class="token keyword">self</span><span class="token punctuation">.</span>view<span class="token punctuation">]</span><span class="token punctuation">.</span>x<span class="token punctuation">;</span>

            <span class="token keyword">if</span> <span class="token punctuation">(</span>velocityX <span class="token operator">>=</span> <span class="token number">500</span> <span class="token operator">||</span> locationX <span class="token operator">>=</span> <span class="token function">CGRectGetWidth</span><span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">.</span>view<span class="token punctuation">.</span>frame<span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

                <span class="token punctuation">[</span>_interactiveTransitioning finishInteractiveTransition<span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>

                <span class="token punctuation">[</span>_interactiveTransitioning cancelInteractiveTransition<span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>æ•ˆæœå¦‚ä¸‹ï¼š</p>
<p><img src="http://image.msiter.com/wkwebview-screen-pan-cancel.gif" alt=""></p>
]]></content>
      
        <categories>
            
            <category> IOS </category>
            
        </categories>
        
        
        <tags>
            
            <tag> WKWebView </tag>
            
            <tag> WebView </tag>
            
            <tag> UIWebView </tag>
            
            <tag> Input </tag>
            
            <tag> File </tag>
            
            <tag> Bug </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[IOS shadowColor åŠ¨ç”» å¡é¡¿]]></title>
      <url>http://www.msiter.com/2017/10/12/IOS%20shadowColor%20%E5%8A%A8%E7%94%BB%20%E5%8D%A1%E9%A1%BF/</url>
      <content type="html"><![CDATA[<p>æœ€è¿‘å¼€å‘çš„æ—¶å€™é‡è§äº†ä¸€ä»¶æ€ªäº‹å„¿ï¼Œåšäº†ä¸€ä¸ª <code>UIViewControllerContextTransitioning</code>,åœ¨åŒäº‹çš„æ‰‹æœºä¸Šè·³è½¬ä¼šå¡é¡¿ã€‚åœ¨æ­¤ä¹‹å‰å†™çš„è·³è½¬åŠ¨ç”»éƒ½æ²¡æœ‰å¡é¡¿çš„ç°è±¡ã€‚<br>æœ€ç»ˆç»ˆäºå‘ç°äº†é—®é¢˜çš„æ‰€åœ¨åœ¨äº shadowColor ï¼Œåœ¨è·³è½¬çš„æ—¶å€™æˆ‘è®¾ç½®äº†ä¸€ä¸ªé˜´å½±å¢åŠ å±‚çº§å±‚æ¬¡æ•ˆæœã€‚<br><a id="more"></a></p>
<pre class="line-numbers language-objectivec"><code class="language-objectivec"><span class="token keyword">@implementation</span> BaseViewControllerPresentdAnimation

<span class="token operator">-</span><span class="token punctuation">(</span>NSTimeInterval<span class="token punctuation">)</span>transitionDuration<span class="token punctuation">:</span><span class="token punctuation">(</span>id<span class="token operator">&lt;</span>UIViewControllerContextTransitioning<span class="token operator">></span><span class="token punctuation">)</span>transitionContext <span class="token punctuation">{</span>

    <span class="token keyword">return</span> <span class="token number">0.5</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token operator">-</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>animateTransition<span class="token punctuation">:</span><span class="token punctuation">(</span>id<span class="token operator">&lt;</span>UIViewControllerContextTransitioning<span class="token operator">></span><span class="token punctuation">)</span>transitionContext<span class="token punctuation">{</span>

    UIViewController <span class="token operator">*</span>toViewController <span class="token operator">=</span> <span class="token punctuation">[</span>transitionContext viewControllerForKey<span class="token punctuation">:</span><span class="token punctuation">(</span>UITransitionContextToViewControllerKey<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    UIView <span class="token operator">*</span>containerView <span class="token operator">=</span> <span class="token punctuation">[</span>transitionContext containerView<span class="token punctuation">]</span><span class="token punctuation">;</span>

    UIView <span class="token operator">*</span>coverView <span class="token operator">=</span> <span class="token punctuation">[</span>UIView<span class="token punctuation">.</span>alloc initWithFrame<span class="token punctuation">:</span>containerView<span class="token punctuation">.</span>bounds<span class="token punctuation">]</span><span class="token punctuation">;</span>
    coverView<span class="token punctuation">.</span>backgroundColor <span class="token operator">=</span> <span class="token punctuation">[</span>UIColor<span class="token punctuation">.</span>blackColor colorWithAlphaComponent<span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">[</span>containerView addSubview<span class="token punctuation">:</span>coverView<span class="token punctuation">]</span><span class="token punctuation">;</span>

    toViewController<span class="token punctuation">.</span>view<span class="token punctuation">.</span>transform <span class="token operator">=</span> <span class="token function">CGAffineTransformTranslate</span><span class="token punctuation">(</span>toViewController<span class="token punctuation">.</span>view<span class="token punctuation">.</span>transform<span class="token punctuation">,</span> <span class="token function">CGRectGetWidth</span><span class="token punctuation">(</span>toViewController<span class="token punctuation">.</span>view<span class="token punctuation">.</span>frame<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">[</span>containerView addSubview<span class="token punctuation">:</span>toViewController<span class="token punctuation">.</span>view<span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token punctuation">[</span><span class="token keyword">self</span> makeShadowMethod<span class="token punctuation">:</span>toViewController<span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token punctuation">[</span>UIView animateWithDuration<span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token keyword">self</span> transitionDuration<span class="token punctuation">:</span>transitionContext<span class="token punctuation">]</span> animations<span class="token punctuation">:</span><span class="token operator">^</span><span class="token punctuation">{</span>

        toViewController<span class="token punctuation">.</span>view<span class="token punctuation">.</span>transform <span class="token operator">=</span> CGAffineTransformIdentity<span class="token punctuation">;</span>

        coverView<span class="token punctuation">.</span>backgroundColor <span class="token operator">=</span> <span class="token punctuation">[</span>UIColor<span class="token punctuation">.</span>blackColor colorWithAlphaComponent<span class="token punctuation">:</span><span class="token number">0.3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span> completion<span class="token punctuation">:</span><span class="token operator">^</span><span class="token punctuation">(</span>BOOL finished<span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token punctuation">[</span>coverView removeFromSuperview<span class="token punctuation">]</span><span class="token punctuation">;</span>

        <span class="token punctuation">[</span>transitionContext completeTransition<span class="token punctuation">:</span>true<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token operator">-</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>makeShadowMethod<span class="token punctuation">:</span><span class="token punctuation">(</span>UIViewController <span class="token operator">*</span><span class="token punctuation">)</span>toViewController<span class="token punctuation">{</span>


    toViewController<span class="token punctuation">.</span>view<span class="token punctuation">.</span>clipsToBounds <span class="token operator">=</span> false<span class="token punctuation">;</span>

    <span class="token comment" spellcheck="true">/// éœ€è¦æ·»åŠ è¿™å¥è¯ï¼Œå¯ä»¥ä½¿åŠ¨ç”»ä¸å†å¡é¡¿</span>
    toViewController<span class="token punctuation">.</span>view<span class="token punctuation">.</span>layer<span class="token punctuation">.</span>shadowPath <span class="token operator">=</span> <span class="token punctuation">[</span>UIBezierPath bezierPathWithRect<span class="token punctuation">:</span>toViewController<span class="token punctuation">.</span>view<span class="token punctuation">.</span>bounds<span class="token punctuation">]</span><span class="token punctuation">.</span>CGPath<span class="token punctuation">;</span>
    toViewController<span class="token punctuation">.</span>view<span class="token punctuation">.</span>layer<span class="token punctuation">.</span>shadowRadius <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
    toViewController<span class="token punctuation">.</span>view<span class="token punctuation">.</span>layer<span class="token punctuation">.</span>shadowColor <span class="token operator">=</span> <span class="token punctuation">[</span>UIColor<span class="token punctuation">.</span>blackColor colorWithAlphaComponent<span class="token punctuation">:</span><span class="token number">0.4</span><span class="token punctuation">]</span><span class="token punctuation">.</span>CGColor<span class="token punctuation">;</span>
    toViewController<span class="token punctuation">.</span>view<span class="token punctuation">.</span>layer<span class="token punctuation">.</span>shadowOffset <span class="token operator">=</span> <span class="token function">CGSizeMake</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">3.0f</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    toViewController<span class="token punctuation">.</span>view<span class="token punctuation">.</span>layer<span class="token punctuation">.</span>shadowOpacity <span class="token operator">=</span> <span class="token number">0.4</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">@end</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>çŸ¥é“è¿™ä¸ªè§£å†³æ–¹æ¡ˆæ˜¯çœ‹åˆ°äº† <a href="http://blog.csdn.net/Lu_Ca/article/details/47422913" target="_blank" rel="noopener">Lu_Caçš„åšå®¢</a></p>
<p>ä¹‹åå°±å¾ˆå¥½å¥‡ä¸ºä»€ä¹ˆè¿™ä¸ªä»£ç ä¼šæœ‰è¿™ä¹ˆç¥å¥‡çš„ä½œç”¨å‘¢ï¼Ÿ <a href="http://blog.csdn.net/meegomeego/article/details/22728465" target="_blank" rel="noopener">SpeedBoy007çš„ä¸“æ </a></p>
<blockquote>
<p> åªè¦ä½ æå‰å‘Šè¯‰CoreAnimationä½ è¦æ¸²æŸ“çš„Viewçš„å½¢çŠ¶Shape,å°±ä¼šå‡å°‘ç¦»å±æ¸²æŸ“è®¡ç®—</p>
<pre class="line-numbers language-objectivec"><code class="language-objectivec"><span class="token punctuation">[</span>myView<span class="token punctuation">.</span>layer setShadowPathï¼š<span class="token punctuation">[</span><span class="token punctuation">[</span>UIBezierPath
   bezierPathWithRectï¼šmyView<span class="token punctuation">.</span>bounds<span class="token punctuation">]</span> CGPath<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>åŠ ä¸Šè¿™è¡Œä»£ç ï¼Œå°±å‡å°‘ç¦»å±æ¸²æŸ“æ—¶é—´ï¼Œå¤§å¤§æé«˜äº†æ€§èƒ½</p>
</blockquote>
]]></content>
      
        <categories>
            
            <category> IOS </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Objective-C </tag>
            
            <tag> ios </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[ä¸€æ¯æ•¬è‡ªç”±ï¼Œä¸€æ¯æ•¬æ­»äº¡]]></title>
      <url>http://www.msiter.com/2017/09/04/2017-9-4%20%E6%9C%89%E6%84%9F/</url>
      <content type="html"><![CDATA[<p><img class = "g-pl-90"  src="http://image.msiter.com/stock-photo-226662239.jpg" alt="ä¸€æ¯æ•¬è‡ªç”±ï¼Œä¸€æ¯æ•¬æ­»äº¡" title="ä¸€æ¯æ•¬è‡ªç”±ï¼Œä¸€æ¯æ•¬æ­»äº¡ &lt;br/&gt;&lt;br/&gt;å®½æ•æˆ‘çš„å¹³å‡¡ï¼Œé©±æ•£äº†è¿·æƒ˜&lt;br/&gt;&lt;br/&gt;å¥½å§å¤©äº®ä¹‹åæ€»æ˜¯æ½¦è‰ç¦»åœº&lt;br/&gt;&lt;br/&gt;æ¸…é†’çš„äººæœ€è’å”&lt;br/&gt;&lt;br/&gt;å¥½å§å¤©äº®ä¹‹åæ€»æ˜¯æ½¦è‰ç¦»åœº&lt;br/&gt;&lt;br/&gt;"></p>
<a id="more"></a>
<p>è½¬çœ¼äºŒåå¤šå¹´è¿‡å»äº†ï¼Œä»Šå¹´22å²ï¼Œèº«é«˜178ï¼Œä½“é‡145æ–¤ã€‚è¿™ä¸¤å¹´ï¼Œä½“é‡æ²¡æœ‰å˜é«˜ï¼Œä½†æ˜¯ä½“é‡å’Œå¹´é¾„ç¡®å®å˜å¤§äº†ä¸å°‘ï¼Œèº«ä½“å˜å¼±äº†å¾ˆå¤šï¼Œå‡ºå»ç©çš„æ—¶å€™ï¼Œç¨å¾®è¿åŠ¨ä¸‹ï¼Œç¬¬äºŒå¤©èº«ä½“å°±ä¼šç»™å‡ºéå¸¸æ˜æ˜¾çš„ååº”ï¼Œé…¸ç—›æ„Ÿåè¶³</p>
<p>å¯æ€•çš„ä¸æ˜¯å˜å¤§äº†ï¼Œèº«ä½“å˜å·®äº†ï¼Œè€Œæ˜¯é»˜é»˜çš„æ¥å—äº†è¿™å„ç§è®¾å®šï¼Œç»™è‡ªå·±ä¸€ä¸ªæ”¹å˜ä¸äº†çš„ç†ç”±äº†ã€‚</p>
<p>è¿™äº›å¹´ï¼Œåœ¨åŒ—äº¬ï¼Œä»æœ€å¼€å§‹çš„åˆ›ä¸šå…¬å¸éå¤©ä¸‹ï¼Œåˆ°ç°åœ¨çš„å¯¥å¯¥æ•°å‡ ä¸ªã€‚çœ‹æƒ¯äº†ï¼Œå¤±è´¥ï¼Œçœ‹æƒ¯äº†ï¼Œåˆ«äººçš„æˆåŠŸã€‚çœ‹æƒ¯äº†ä»¥å‰çœ‹ä¸æƒ¯çš„</p>
<p>å˜è€çš„ä¸åªæ˜¯èº«ä½“ï¼Œæ›´å¤šçš„æ˜¯é‚£ä»½å¿ƒã€‚</p>
<p>ä»¥å‰ä¸çŸ¥é“çš„çŸ¥é“ï¼Œä½†æ˜¯å°‘äº†çš„æ˜¯ï¼Œæ—¶é—´ï¼Œæ‹¼ï¼ŒåŠ²å„¿ï¼Œå…¶å®å½’æ ¹ç»“åº•è¿˜æ˜¯å¯¹äºç›®å‰çš„ä¸æ•¢æ”¾å¼ƒï¼Œä»å¤´æ¥ï¼Œä¹Ÿè®¸ä¼šæ›´å¥½ï¼Œä½†æ˜¯ä¸æ•¢å†å»è¯•éªŒäº†ã€‚</p>
<center style="font-size:14px;color:gray;"><br>å½“ä½ èµ°è¿›è¿™æ¬¢ä¹åœº<br>èƒŒä¸Šæ‰€æœ‰çš„æ¢¦ä¸æƒ³<br>å„è‰²çš„è„¸ä¸Šå„è‰²çš„å¦†<br>æ²¡äººè®°å¾—ä½ çš„æ¨¡æ ·<br>ä¸‰å·¡é…’è¿‡ä½ åœ¨è§’è½<br>å›ºæ‰§çš„å”±ç€è‹¦æ¶©çš„æ­Œ<br>å¬ä»–åœ¨å–§åš£é‡Œè¢«æ·¹æ²¡<br>ä½ æ‹¿èµ·é…’æ¯å¯¹è‡ªå·±è¯´<br>ä¸€æ¯æ•¬æœé˜³ï¼Œä¸€æ¯æ•¬æœˆå…‰<br>å”¤é†’æˆ‘çš„å‘å¾€ï¼Œæ¸©æŸ”äº†å¯’çª—<br>äºæ˜¯å¯ä»¥ä¸å›å¤´çš„é€†é£é£ç¿”<br>ä¸æ€•å¿ƒå¤´æœ‰é›¨ï¼Œçœ¼åº•æœ‰éœœ<br>ä¸€æ¯æ•¬æ•…ä¹¡ï¼Œä¸€æ¯æ•¬è¿œæ–¹<br>å®ˆç€æˆ‘çš„å–„è‰¯ï¼Œå‚¬ç€æˆ‘æˆé•¿<br>æ‰€ä»¥å—åŒ—çš„è·¯ä»æ­¤ä¸å†æ¼«é•¿<br>çµé­‚ä¸å†æ— å¤„å®‰æ”¾<br>ä¸€æ¯æ•¬æ˜å¤©ï¼Œä¸€æ¯æ•¬è¿‡å¾€<br>æ”¯æ’‘æˆ‘çš„èº«ä½“ï¼Œåšé‡äº†è‚©è†€<br>è™½ç„¶ä»ä¸ç›¸ä¿¡æ‰€è°“å±±é«˜æ°´é•¿<br>äººç”Ÿè‹¦çŸ­ä½•å¿…å¿µå¿µä¸å¿˜<br>ä¸€æ¯æ•¬è‡ªç”±ï¼Œä¸€æ¯æ•¬æ­»äº¡<br>å®½æ•æˆ‘çš„å¹³å‡¡ï¼Œé©±æ•£äº†è¿·æƒ˜<br>å¥½å§å¤©äº®ä¹‹åæ€»æ˜¯æ½¦è‰ç¦»åœº<br>æ¸…é†’çš„äººæœ€è’å”<br>å¥½å§å¤©äº®ä¹‹åæ€»æ˜¯æ½¦è‰ç¦»åœº<br>æ¸…é†’çš„äººæœ€è’å”<br><br></center>

<p>æ˜¯å¯¹è¿˜æ˜¯é”™ï¼Œå…¶å®ä½ çŸ¥é“çš„ï¼Œåªæ˜¯ä¸æ•¢</p>
]]></content>
      
        <categories>
            
            <category> ç‰¢éªš </category>
            
        </categories>
        
        
        <tags>
            
            <tag> ç”Ÿæ´» </tag>
            
            <tag> æ‚²è§‚ </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[AsyncDisplayKit 2.1 Gifé”™è¯¯ï¼Œä»¥åŠè§£å†³æ–¹æ³•]]></title>
      <url>http://www.msiter.com/2017/08/22/AsyncDisplayKit%202.1%20Gif%E9%94%99%E8%AF%AF/</url>
      <content type="html"><![CDATA[<p>åœ¨ä½¿ç”¨ AsyncDisplayKit é‡åˆ°äº†ä¸€äº›é—®é¢˜ï¼Œå› ä¸ºå·¥ä½œéœ€è¦å¿…é¡»æ”¯æŒIOS7ï¼Œæ‰€ä»¥é€‰æ‹©äº† AsyncDisplayKit 2.1ç‰ˆæœ¬ã€‚ä½†æ˜¯åœ¨ä½¿ç”¨ å…¶ä¸­çš„ å±•ç¤ºgifçš„æ—¶å€™å‡ºç°äº†ä¸€äº›é—®é¢˜ã€‚<br><a id="more"></a></p>
<p>ç›®å‰çš„ ä¿®æ”¹åº“ ç‰ˆæœ¬ä¸º</p>
<p><img class = "g-pl-90"  src="https://img.shields.io/cocoapods/v/AsyncDisplayKitFix.svg" alt="version"></p>
<p>åœ¨ä½¿ç”¨çš„æ—¶å€™å‡ºç°äº† GIF æœ‰çš„æ—¶å€™å‡ºç°ï¼Œæœ‰çš„æ˜¯ä¸å‡ºç°ï¼Œæœ‰çš„æ—¶å€™å‡ºç°äº†ï¼Œå´ä¸åŠ¨çš„æƒ…å†µã€‚</p>
<p>æœ€ç»ˆæ‰¾åˆ°è§£å†³æ–¹æ¡ˆåœ¨ã€‚  <a href="https://github.com/facebookarchive/AsyncDisplayKit/pull/3057" target="_blank" rel="noopener">AsyncDisplayKit Pull Request 3057</a></p>
<p>ä»£ç åœ¨äº <a href="https://github.com/facebookarchive/AsyncDisplayKit/commit/d270577f23dca63c69bc6cd0e4cea6652733a376" target="_blank" rel="noopener">AsyncDisplayKit commit d270577f23dca63c69bc6cd0e4cea6652733a376</a></p>
<p>ä½†æ˜¯ç°åœ¨ AsyncDisokayKit å·²ç»å¼€å§‹æ”¯æŒ IOS8ç‰ˆæœ¬ä»¥ä¸Šäº†ã€‚å¹¶ä¸”å·²ç»ç§»åŠ¨åˆ°äº† <a href="https://github.com/texturegroup/texture/" target="_blank" rel="noopener">Texture</a></p>
<p>æ‰€ä»¥æˆ‘ä»¬åªèƒ½æ‰‹åŠ¨è‡ªå·±åˆ›å»ºäº†ä¸€ä¸ªç‰ˆæœ¬äº†ã€‚</p>
<ol>
<li>è§£å†³æ–¹æ¡ˆ è‡ªå·±æœ¬åœ° local åº“ ä¿®æ”¹ 2.1 ç‰ˆæœ¬çš„ä»£ç </li>
<li>ä½¿ç”¨æˆ‘å·²ç»ä¿®æ”¹å¥½çš„ä»£ç åº“ å¼•å…¥ <code>pod AsyncDisplayKitFix</code></li>
</ol>
<p>â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” 2017å¹´9æœˆ4å·</p>
<p>å†æ¬¡ä¿®å¤äº†ï¼Œä¸¤ä¸ªé—®é¢˜ï¼Œå½“ç„¶åªæ˜¯æˆ‘çš„é¡¹ç›®ä¸­çš„ã€‚è®°å½•ä¸€ä¸‹</p>
<p>ç¬¬ä¸€ä¸ª. å…³äº ASTableNode åˆ·æ–°æŸä¸€ä¸ªsectionæˆ–è€…æŸä¸€ä¸ªè¡Œçš„æ—¶å€™ï¼Œä¼šå¯åŠ¨ä¸€ä¸ªéªŒè¯æ–¹æ³•ï¼Œä½†æ˜¯è¿™ä¸ªæ–¹æ³•æ˜¯éªŒè¯æ‰€æœ‰çš„sectionï¼Œæˆ‘åˆ†åˆ«æ§åˆ¶ç¬¬ä¸€ä¸ªæˆ–è€…ç¬¬äºŒä¸ªsecrionå°±ä¼šå‡ºç°åˆ·æ–°å‰å’Œåˆ·æ–°åçš„æ•°é‡å¯¹ä¸ä¸Šï¼Œè€Œå¯¼è‡´æŠ¥é”™ã€‚</p>
<p>åœ¨æ–‡ä»¶ <code>_ASHierarchyChangeSet.mm</code>  <code>_validateUpdate</code> ä¿®æ”¹éªŒè¯</p>
<p>ç¬¬äºŒä¸ª. åœ¨ASTextNodeèµ‹å€¼çš„æ—¶å€™ï¼Œæˆ‘è®°å¾—æ²¡é”™è¯¯çš„è¯ã€‚å®˜æ–¹çš„ä¾‹å­æ˜¯ å¯ä»¥åˆ¤æ–­ ASTextNodeçš„attritedString æ˜¯å¦ä¸ºç©ºï¼Œæ¥åšä¸€äº›å¸ƒå±€çš„å˜åŒ–ã€‚ä½†æ˜¯åœ¨å®é™…ä½¿ç”¨ä¸­ï¼Œå‘ç°äº†å®ƒçš„æ–¹æ³•ï¼Œå†™çš„ç¡®å®</p>
<pre class="line-numbers language-objectivec"><code class="language-objectivec"><span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>setAttributedText<span class="token punctuation">:</span><span class="token punctuation">(</span>NSAttributedString <span class="token operator">*</span><span class="token punctuation">)</span>attributedText
<span class="token punctuation">{</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span>attributedText <span class="token operator">==</span> nil<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      attributedText <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span>NSAttributedString alloc<span class="token punctuation">]</span> initWithString<span class="token punctuation">:</span><span class="token string">@""</span> attributes<span class="token punctuation">:</span>nil<span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment" spellcheck="true">// Don't hold textLock for too long.</span>
  <span class="token punctuation">{</span>
    ASDN<span class="token punctuation">:</span><span class="token punctuation">:</span>MutexLocker <span class="token function">l</span><span class="token punctuation">(</span>__instanceLock__<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">ASObjectIsEqual</span><span class="token punctuation">(</span>attributedText<span class="token punctuation">,</span> _attributedText<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>è¿™ç§é—®é¢˜å°±æ˜¯ä¼šä¸€ç›´éƒ½ä¸èƒ½ä¸ºnilã€‚æ•…è€Œä¿®å¤ä¸º</p>
<pre class="line-numbers language-objectivec"><code class="language-objectivec"><span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>setAttributedText<span class="token punctuation">:</span><span class="token punctuation">(</span>NSAttributedString <span class="token operator">*</span><span class="token punctuation">)</span>attributedText
<span class="token punctuation">{</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span>attributedText <span class="token operator">==</span> nil<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment" spellcheck="true">// Don't hold textLock for too long.</span>
  <span class="token punctuation">{</span>
    ASDN<span class="token punctuation">:</span><span class="token punctuation">:</span>MutexLocker <span class="token function">l</span><span class="token punctuation">(</span>__instanceLock__<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">ASObjectIsEqual</span><span class="token punctuation">(</span>attributedText<span class="token punctuation">,</span> _attributedText<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
]]></content>
      
        <categories>
            
            <category> IOS </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Objective-C </tag>
            
            <tag> AsyncDisplayKit </tag>
            
            <tag> ios </tag>
            
            <tag> çº¦æŸæ•™ç¨‹ </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Spring boot Mybatis å­¦ä¹ ]]></title>
      <url>http://www.msiter.com/2017/07/21/Spring%20boot%20Mybatis%20%E5%AD%A6%E4%B9%A0/</url>
      <content type="html"><![CDATA[<p><img class = "g-pl-90"  src="http://image.msiter.com/stock-photo-220506113.jpg" alt="" title="æˆ‘å¹´åè™šåº¦ï¼Œç©ºæœ‰ä¸€èº«ç–²å€¦"></p>
<h2 id="å¼€å§‹å‰çš„é—²èŠ"><a href="#å¼€å§‹å‰çš„é—²èŠ" class="headerlink" title="å¼€å§‹å‰çš„é—²èŠ"></a>å¼€å§‹å‰çš„é—²èŠ</h2><p>ä¸€ç›´éƒ½æƒ³å›å®¶ï¼ŒåŒ—äº¬å‘†ä¸èµ·ã€‚æƒ³å›å®¶ï¼Œå´å‘ç°ï¼Œå®¶é‡Œçš„å¼€å‘èŒä½éƒ½æ˜¯javaçš„ï¼Œï¼Œï¼Œé‚£æ²¡åŠæ³•ï¼Œæ¡èµ·æ¥å§</p>
<a id="more"></a>
<h2 id="åŸºæœ¬è®¾ç½®"><a href="#åŸºæœ¬è®¾ç½®" class="headerlink" title="åŸºæœ¬è®¾ç½®"></a>åŸºæœ¬è®¾ç½®</h2><p>åœ¨åˆ›å»ºé¡¹ç›®çš„æ—¶å€™ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†æœ€åŸºæœ¬çš„é…ç½®ï¼Œæ‰€ä»¥é¡¹ç›®æ²¡æœ‰ç›®å½•ç­‰ã€‚æˆ‘ä»¬éœ€è¦ä½¿ç”¨mavené»˜è®¤çš„æ–‡ä»¶é…ç½®</p>
<pre><code>src
  main -- å¼€å‘åŒ…
    java -- ä»£ç åŒ…
    resources -- èµ„æºåŒ…
  test -- æµ‹è¯•åŒ…
    java -- ä»£ç åŒ…
    resources -- èµ„æºåŒ…
</code></pre><h2 id="gradle-é…ç½®"><a href="#gradle-é…ç½®" class="headerlink" title="gradle é…ç½®"></a>gradle é…ç½®</h2><p>åœ¨idea åˆ›å»ºä¸€ä¸ª gradle é¡¹ç›®ã€‚ä½†æ˜¯æœ¬æ¥åœ¨æœ¬åœ°å®‰è£…äº†ä¸€ä¸ª 4.0 ç‰ˆæœ¬çš„ gradleï¼Œæˆ‘åœ¨ideaè®¾ç½®äº†ä¸€ä¸ª local gradleï¼Œä½†æ˜¯å´å‡ºç°äº†ä¸€ä¸ªé—®é¢˜ã€‚ å¯åŠ¨æœåŠ¡å™¨çš„æ—¶å€™ï¼Œå‡ºç°äº†è«åçš„é—®é¢˜<br>æœ€ååœ¨statckflowä¸­å‘ç°äº†è§£å†³åŠæ³•å°±æ˜¯ä½¿ç”¨é»˜è®¤çš„gradleã€‚</p>
<p>ä¹‹åé…ç½® gradle å®‰è£…ä¿¡æ¯</p>
<pre><code>group &#39;Farrom&#39;
version &#39;1.0-SNAPSHOT&#39;


apply plugin: &#39;java&#39;
apply plugin: &#39;war&#39;
apply plugin: &#39;idea&#39;


sourceCompatibility = 1.8

repositories {
    jcenter()
    maven { url &quot;http://repo.spring.io/snapshot&quot; }
    maven { url &quot;http://repo.spring.io/milestone&quot; }
}


dependencies {

    // é˜¿é‡Œå·´å·´ durid æ•°æ®æº
    compile group: &#39;com.alibaba&#39;, name: &#39;druid&#39;, version: &#39;1.1.1&#39;

    // æ•°æ® é“¾æ¥
    compile group: &#39;mysql&#39;, name: &#39;mysql-connector-java&#39;, version: &#39;6.0.6&#39;


    // Spring Boot
    compile group: &#39;org.springframework.boot&#39;, name: &#39;spring-boot-starter-web&#39;, version: &#39;1.5.4.RELEASE&#39;


    // Mybatis
    compile group: &#39;org.mybatis&#39;, name: &#39;mybatis&#39;, version: &#39;3.4.4&#39;
    compile group: &#39;org.mybatis&#39;, name: &#39;mybatis-spring&#39;, version: &#39;1.3.1&#39;
    compile group: &#39;org.mybatis.spring.boot&#39;, name: &#39;mybatis-spring-boot-starter&#39;, version: &#39;1.3.0&#39;
}
</code></pre><h3 id="åˆ›å»º-Spring-é…ç½®æ–‡ä»¶"><a href="#åˆ›å»º-Spring-é…ç½®æ–‡ä»¶" class="headerlink" title="åˆ›å»º Spring é…ç½®æ–‡ä»¶"></a>åˆ›å»º Spring é…ç½®æ–‡ä»¶</h3><pre class="line-numbers language-yaml"><code class="language-yaml"><span class="token key atrule">name</span><span class="token punctuation">:</span> Demo
<span class="token key atrule">server</span><span class="token punctuation">:</span>
    <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">8090</span>
<span class="token key atrule">datasource</span><span class="token punctuation">:</span>
    <span class="token key atrule">url</span><span class="token punctuation">:</span> jdbc<span class="token punctuation">:</span>mysql<span class="token punctuation">:</span>//localhost<span class="token punctuation">:</span>3306/parrom<span class="token punctuation">?</span>autoReconnect=true<span class="token important">&amp;useSSL</span>=false<span class="token important">&amp;useUnicode</span>=true<span class="token important">&amp;characterEncoding</span>=utf8
    <span class="token key atrule">username</span><span class="token punctuation">:</span> root
    <span class="token key atrule">password</span><span class="token punctuation">:</span> <span class="token number">123456</span>
    <span class="token key atrule">driverClassName</span><span class="token punctuation">:</span> com.mysql.jdbc.Driver
<span class="token key atrule">mybatis</span><span class="token punctuation">:</span>
    <span class="token key atrule">typeAliasesPackage</span><span class="token punctuation">:</span> com.farrom.domain
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">package</span> com<span class="token punctuation">.</span>farrom<span class="token punctuation">.</span>config<span class="token punctuation">;</span>

<span class="token keyword">import</span> com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>druid<span class="token punctuation">.</span>pool<span class="token punctuation">.</span>DruidDataSourceFactory<span class="token punctuation">;</span>
<span class="token keyword">import</span> org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>ibatis<span class="token punctuation">.</span>session<span class="token punctuation">.</span>SqlSessionFactory<span class="token punctuation">;</span>
<span class="token keyword">import</span> org<span class="token punctuation">.</span>mybatis<span class="token punctuation">.</span>spring<span class="token punctuation">.</span>SqlSessionFactoryBean<span class="token punctuation">;</span>
<span class="token keyword">import</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>Value<span class="token punctuation">;</span>
<span class="token keyword">import</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>Bean<span class="token punctuation">;</span>
<span class="token keyword">import</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>Configuration<span class="token punctuation">;</span>
<span class="token keyword">import</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>transaction<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>EnableTransactionManagement<span class="token punctuation">;</span>

<span class="token keyword">import</span> javax<span class="token punctuation">.</span>sql<span class="token punctuation">.</span>DataSource<span class="token punctuation">;</span>
<span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>Properties<span class="token punctuation">;</span>

<span class="token annotation punctuation">@Configuration</span>
<span class="token annotation punctuation">@EnableTransactionManagement</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MybatisConfig</span> <span class="token punctuation">{</span>

     <span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">"${datasource.url}"</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> String url<span class="token punctuation">;</span>

     <span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">"${datasource.driverClassName}"</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> String driverClassName<span class="token punctuation">;</span>

     <span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">"${datasource.username}"</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> String username<span class="token punctuation">;</span>

     <span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">"${datasource.password}"</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> String password<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">"${mybatis.typeAliasesPackage}"</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> String typeAliasesPackage<span class="token punctuation">;</span>

    <span class="token comment" spellcheck="true">/**
     * åˆ›å»ºæ•°æ®æº
     * @Primary è¯¥æ³¨è§£è¡¨ç¤ºåœ¨åŒä¸€ä¸ªæ¥å£æœ‰å¤šä¸ªå®ç°ç±»å¯ä»¥æ³¨å…¥çš„æ—¶å€™ï¼Œé»˜è®¤é€‰æ‹©å“ªä¸€ä¸ªï¼Œè€Œä¸æ˜¯è®©@autowireæ³¨è§£æŠ¥é”™
     */</span>
    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> DataSource <span class="token function">getDataSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> Exception<span class="token punctuation">{</span>
        Properties props <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Properties</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">//        props.put("driverClassName", this.driverClassName); ##Loading class `com.mysql.jdbc.Driver'. This is deprecated. The new driver class is `com.mysql.cj.jdbc.Driver'. The driver is automatically registered via the SPI and manual loading of the driver class is generally unnecessary.</span>
        props<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"url"</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>url<span class="token punctuation">)</span><span class="token punctuation">;</span>
        props<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"username"</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>username<span class="token punctuation">)</span><span class="token punctuation">;</span>
        props<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"password"</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>password<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> DruidDataSourceFactory<span class="token punctuation">.</span><span class="token function">createDataSource</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment" spellcheck="true">/**
     * æ ¹æ®æ•°æ®æºåˆ›å»ºSqlSessionFactory
     */</span>
    <span class="token annotation punctuation">@Bean</span><span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">"sqlSessionFactory"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> SqlSessionFactory <span class="token function">sqlSessionFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> Exception <span class="token punctuation">{</span>
        SqlSessionFactoryBean sqlSessionFactory <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SqlSessionFactoryBean</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        sqlSessionFactory<span class="token punctuation">.</span><span class="token function">setDataSource</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getDataSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> sqlSessionFactory<span class="token punctuation">.</span><span class="token function">getObject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="æ•°æ®åº“-emoji-mysql-é€‚é…ã€‚"><a href="#æ•°æ®åº“-emoji-mysql-é€‚é…ã€‚" class="headerlink" title="æ•°æ®åº“ emoji mysql é€‚é…ã€‚"></a>æ•°æ®åº“ emoji mysql é€‚é…ã€‚</h4><p>åœ¨æ ¹ç›®å½•ä¸‹çš„etcåˆ›å»ºä¸€ä¸ªæ–‡ä»¶,<code>my.cnf</code>ã€‚åœ¨æ–‡ä»¶ä¸­è®¾ç½®é…ç½®</p>
<pre><code>[client]
default-character-set=utf8mb4

[mysql]
default-character-set=utf8mb4

[mysqld]
character-set-client-handshake=FALSE
character-set-server=utf8mb4
collation-server=utf8mb4_unicode_ci
init-connect=&#39;SET NAMES utf8mb4&#39;
</code></pre><p>åˆ›å»ºDatabaseçš„æ—¶å€™é€‰æ‹© å¯¹ä¸€ä¸ªçš„ç¼–ç </p>
<p>è¯¥é…ç½®ä¸éœ€è¦è®¾ç½®ä»»ä½•ä»£ç ã€‚è¿™ä¸ªæ—¶å€™ sqlsessionå°±å·²ç»åˆ›å»ºå¥½äº†</p>
<p>ç›®å‰å°±å­¦ä¹ äº†è¿™ç‚¹ã€‚ã€‚ã€‚</p>
]]></content>
      
        <categories>
            
            <category> æœåŠ¡å™¨ </category>
            
        </categories>
        
        
        <tags>
            
            <tag> java </tag>
            
            <tag> spring boot </tag>
            
            <tag> mybatis </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Charles version 4.1 ç ´è§£ ä»¥åŠ Https çš„ç ´è¯‘]]></title>
      <url>http://www.msiter.com/2017/07/10/charles%204.1%20%E7%A0%B4%E8%A7%A3/</url>
      <content type="html"><![CDATA[<p><img class = "g-pl-90"  src="http://image.msiter.com/stock-photo-219218271.jpg" alt="" title="åæ¥æˆ‘ç»ˆäºçŸ¥é“,å®ƒå¹¶ä¸æ˜¯æˆ‘çš„èŠ±,æˆ‘åªæ˜¯æ°å¥½é€”å¾„äº†å®ƒçš„ç››æ”¾ã€‚"></p>
<h2 id="Charles-é™æ—¶ä¼˜æƒ "><a href="#Charles-é™æ—¶ä¼˜æƒ " class="headerlink" title="Charles é™æ—¶ä¼˜æƒ "></a>Charles é™æ—¶ä¼˜æƒ </h2><p>Charles 4 æ­£ç‰ˆé™æ—¶ä¼˜æƒ ä¼˜æƒ æ´»åŠ¨ï¼ˆé™æ—¶ï¼š2016 å¹´ 8 æœˆ 8 æ—¥ - 15 æ—¥ï¼‰ï¼Œä¼˜æƒ  30 å…ƒï¼Œ<a href="https://taoquan.taobao.com/coupon/unify_apply.htm?sellerId=881336826&amp;activityId=8764822622de490a82ccc6383abce406" target="_blank" rel="noopener">ç‚¹å‡»é¢†å–ä¼˜æƒ åˆ¸</a>ã€‚</p>
<!--
æ·˜å£ä»¤ï¼šCharles æ–°ç‰ˆå‘å¸ƒï¼Œä½¿ç”¨ï¿¥Charlesï¿¥é™æ—¶ç‰¹æƒ è´­ä¹°æ­£ç‰ˆï¼ˆé•¿æŒ‰å¤åˆ¶æ•´æ®µæ–‡æ¡ˆï¼Œæ‰“å¼€æ‰‹æœºæ·˜å®å³å¯è¿›å…¥æ´»åŠ¨å†…å®¹ï¼‰
-->
<h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><img src="http://image.msiter.com/charles-logo.png">
<p><a href="http://www.charlesproxy.com/" target="_blank" rel="noopener">Charles</a> æ˜¯åœ¨ Mac ä¸‹å¸¸ç”¨çš„ç½‘ç»œå°åŒ…æˆªå–å·¥å…·ï¼Œåœ¨åš<br>ç§»åŠ¨å¼€å‘æ—¶ï¼Œæˆ‘ä»¬ä¸ºäº†è°ƒè¯•ä¸æœåŠ¡å™¨ç«¯çš„ç½‘ç»œé€šè®¯åè®®ï¼Œå¸¸å¸¸éœ€è¦æˆªå–ç½‘ç»œå°åŒ…æ¥åˆ†æã€‚</p>
<a id="more"></a>
<p>Charles é€šè¿‡å°†è‡ªå·±è®¾ç½®æˆç³»ç»Ÿçš„ç½‘ç»œè®¿é—®ä»£ç†æœåŠ¡å™¨ï¼Œä½¿å¾—æ‰€æœ‰çš„ç½‘ç»œè®¿é—®è¯·æ±‚éƒ½é€šè¿‡å®ƒæ¥å®Œæˆï¼Œä»è€Œå®ç°äº†ç½‘ç»œå°åŒ…çš„æˆªå–å’Œåˆ†æã€‚</p>
<p>é™¤äº†åœ¨åšç§»åŠ¨å¼€å‘ä¸­è°ƒè¯•ç«¯å£å¤–ï¼ŒCharles ä¹Ÿå¯ä»¥ç”¨äºåˆ†æç¬¬ä¸‰æ–¹åº”ç”¨çš„é€šè®¯åè®®ã€‚é…åˆ Charles çš„ SSL åŠŸèƒ½ï¼ŒCharles è¿˜å¯ä»¥åˆ†æ Https åè®®ã€‚</p>
<p>Charles æ˜¯æ”¶è´¹è½¯ä»¶ï¼Œå¯ä»¥å…è´¹è¯•ç”¨ 30 å¤©ã€‚è¯•ç”¨æœŸè¿‡åï¼Œæœªä»˜è´¹çš„ç”¨æˆ·ä»ç„¶å¯ä»¥ç»§ç»­ä½¿ç”¨ï¼Œä½†æ˜¯æ¯æ¬¡ä½¿ç”¨æ—¶é—´ä¸èƒ½è¶…è¿‡ 30 åˆ†é’Ÿï¼Œå¹¶ä¸”å¯åŠ¨æ—¶å°†ä¼šæœ‰ 10 ç§’ç§çš„å»¶æ—¶ã€‚å› æ­¤ï¼Œè¯¥ä»˜è´¹æ–¹æ¡ˆå¯¹å¹¿å¤§ç”¨æˆ·è¿˜æ˜¯ç›¸å½“å‹å¥½çš„ï¼Œå³ä½¿ä½ é•¿æœŸä¸ä»˜è´¹ï¼Œä¹Ÿèƒ½ä½¿ç”¨å®Œæ•´çš„è½¯ä»¶åŠŸèƒ½ã€‚åªæ˜¯å½“ä½ éœ€è¦é•¿æ—¶é—´è¿›è¡Œå°åŒ…è°ƒè¯•æ—¶ï¼Œä¼šå› ä¸º Charles å¼ºåˆ¶å…³é—­è€Œé‡åˆ°å½±å“ã€‚</p>
<p>Charles ä¸»è¦çš„åŠŸèƒ½åŒ…æ‹¬ï¼š</p>
<ol>
<li>æˆªå– Http å’Œ Https ç½‘ç»œå°åŒ…ã€‚</li>
<li>æ”¯æŒé‡å‘ç½‘ç»œè¯·æ±‚ï¼Œæ–¹ä¾¿åç«¯è°ƒè¯•ã€‚</li>
<li>æ”¯æŒä¿®æ”¹ç½‘ç»œè¯·æ±‚å‚æ•°ã€‚</li>
<li>æ”¯æŒç½‘ç»œè¯·æ±‚çš„æˆªè·å¹¶åŠ¨æ€ä¿®æ”¹ã€‚</li>
<li>æ”¯æŒæ¨¡æ‹Ÿæ…¢é€Ÿç½‘ç»œã€‚</li>
</ol>
<p>Charles 4 æ–°å¢çš„ä¸»è¦åŠŸèƒ½åŒ…æ‹¬ï¼š</p>
<ol>
<li>æ”¯æŒ Http 2ã€‚</li>
<li>æ”¯æŒ IPv6ã€‚</li>
</ol>
<h2 id="å®‰è£…-Charles"><a href="#å®‰è£…-Charles" class="headerlink" title="å®‰è£… Charles"></a>å®‰è£… Charles</h2><p>å» Charles çš„å®˜æ–¹ç½‘ç«™ï¼ˆ<a href="http://www.charlesproxy.com" target="_blank" rel="noopener">http://www.charlesproxy.com</a>ï¼‰ä¸‹è½½æœ€æ–°ç‰ˆçš„ Charles å®‰è£…åŒ…ï¼Œæ˜¯ä¸€ä¸ª dmg åç¼€çš„æ–‡ä»¶ã€‚æ‰“å¼€åå°† Charles æ‹–åˆ° Application ç›®å½•ä¸‹å³å®Œæˆå®‰è£…ã€‚</p>
<h2 id="å°†-Charles-è®¾ç½®æˆç³»ç»Ÿä»£ç†"><a href="#å°†-Charles-è®¾ç½®æˆç³»ç»Ÿä»£ç†" class="headerlink" title="å°† Charles è®¾ç½®æˆç³»ç»Ÿä»£ç†"></a>å°† Charles è®¾ç½®æˆç³»ç»Ÿä»£ç†</h2><p>ä¹‹å‰æåˆ°ï¼ŒCharles æ˜¯é€šè¿‡å°†è‡ªå·±è®¾ç½®æˆä»£ç†æœåŠ¡å™¨æ¥å®Œæˆå°åŒ…æˆªå–çš„ï¼Œæ‰€ä»¥ä½¿ç”¨ Charles çš„ç¬¬ä¸€æ­¥æ˜¯å°†å…¶è®¾ç½®æˆç³»ç»Ÿçš„ä»£ç†æœåŠ¡å™¨ã€‚</p>
<p>å¯åŠ¨ Charles åï¼Œç¬¬ä¸€æ¬¡ Charles ä¼šè¯·æ±‚ä½ ç»™å®ƒè®¾ç½®ç³»ç»Ÿä»£ç†çš„æƒé™ã€‚ä½ å¯ä»¥è¾“å…¥ç™»å½•å¯†ç æˆäºˆ Charles è¯¥æƒé™ã€‚ä½ ä¹Ÿå¯ä»¥å¿½ç•¥è¯¥è¯·æ±‚ï¼Œç„¶ååœ¨éœ€è¦å°† Charles è®¾ç½®æˆç³»ç»Ÿä»£ç†æ—¶ï¼Œé€‰æ‹©èœå•ä¸­çš„ â€œProxyâ€ -&gt; â€œMac OS X Proxyâ€ æ¥å°† Charles è®¾ç½®æˆç³»ç»Ÿä»£ç†ã€‚å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<img src="http://image.msiter.com/charles-pro-3.png">
<p>ä¹‹åï¼Œä½ å°±å¯ä»¥çœ‹åˆ°æºæºä¸æ–­çš„ç½‘ç»œè¯·æ±‚å‡ºç°åœ¨ Charles çš„ç•Œé¢ä¸­ã€‚</p>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒChrome å’Œ Firefox æµè§ˆå™¨é»˜è®¤å¹¶ä¸ä½¿ç”¨ç³»ç»Ÿçš„ä»£ç†æœåŠ¡å™¨è®¾ç½®ï¼Œè€Œ Charles æ˜¯é€šè¿‡å°†è‡ªå·±è®¾ç½®æˆä»£ç†æœåŠ¡å™¨æ¥å®Œæˆå°åŒ…æˆªå–çš„ï¼Œæ‰€ä»¥åœ¨é»˜è®¤æƒ…å†µä¸‹æ— æ³•æˆªå– Chrome å’Œ Firefox æµè§ˆå™¨çš„ç½‘ç»œé€šè®¯å†…å®¹ã€‚å¦‚æœä½ éœ€è¦æˆªå–çš„è¯ï¼Œåœ¨ Chrome ä¸­è®¾ç½®æˆä½¿ç”¨ç³»ç»Ÿçš„ä»£ç†æœåŠ¡å™¨è®¾ç½®å³å¯ï¼Œæˆ–è€…ç›´æ¥å°†ä»£ç†æœåŠ¡å™¨è®¾ç½®æˆ <code>127.0.0.1:8888</code> ä¹Ÿå¯è¾¾åˆ°ç›¸åŒæ•ˆæœã€‚</p>
<h2 id="Charles-ä¸»ç•Œé¢ä»‹ç»"><a href="#Charles-ä¸»ç•Œé¢ä»‹ç»" class="headerlink" title="Charles ä¸»ç•Œé¢ä»‹ç»"></a>Charles ä¸»ç•Œé¢ä»‹ç»</h2><img src="http://image.msiter.com/charles-pro-4.png">
<p>Charles ä¸»è¦æä¾›ä¸¤ç§æŸ¥çœ‹å°åŒ…çš„è§†å›¾ï¼Œåˆ†åˆ«åä¸º â€œStructureâ€ å’Œ â€œSequenceâ€ã€‚</p>
<ol>
<li>Structure è§†å›¾å°†ç½‘ç»œè¯·æ±‚æŒ‰è®¿é—®çš„åŸŸååˆ†ç±»ã€‚</li>
<li>Sequence è§†å›¾å°†ç½‘ç»œè¯·æ±‚æŒ‰è®¿é—®çš„æ—¶é—´æ’åºã€‚</li>
</ol>
<p>å¤§å®¶å¯ä»¥æ ¹æ®å…·ä½“çš„éœ€è¦åœ¨è¿™ä¸¤ç§è§†å›¾ä¹‹å‰æ¥å›åˆ‡æ¢ã€‚è¯·æ±‚å¤šäº†æœ‰äº›æ—¶å€™ä¼šçœ‹ä¸è¿‡æ¥ï¼ŒCharles æä¾›äº†ä¸€ä¸ªç®€å•çš„ Filter åŠŸèƒ½ï¼Œå¯ä»¥è¾“å…¥å…³é”®å­—æ¥å¿«é€Ÿç­›é€‰å‡º URL ä¸­å¸¦æŒ‡å®šå…³é”®å­—çš„ç½‘ç»œè¯·æ±‚ã€‚</p>
<p>å¯¹äºæŸä¸€ä¸ªå…·ä½“çš„ç½‘ç»œè¯·æ±‚ï¼Œä½ å¯ä»¥æŸ¥çœ‹å…¶è¯¦ç»†çš„è¯·æ±‚å†…å®¹å’Œå“åº”å†…å®¹ã€‚å¦‚æœè¯·æ±‚å†…å®¹æ˜¯ POST çš„è¡¨å•ï¼ŒCharles ä¼šè‡ªåŠ¨å¸®ä½ å°†è¡¨å•è¿›è¡Œåˆ†é¡¹æ˜¾ç¤ºã€‚å¦‚æœå“åº”å†…å®¹æ˜¯ JSON æ ¼å¼çš„ï¼Œé‚£ä¹ˆ Charles å¯ä»¥è‡ªåŠ¨å¸®ä½ å°† JSON å†…å®¹æ ¼å¼åŒ–ï¼Œæ–¹ä¾¿ä½ æŸ¥çœ‹ã€‚å¦‚æœå“åº”å†…å®¹æ˜¯å›¾ç‰‡ï¼Œé‚£ä¹ˆ Charles å¯ä»¥æ˜¾ç¤ºå‡ºå›¾ç‰‡çš„é¢„è§ˆã€‚</p>
<h2 id="è¿‡æ»¤ç½‘ç»œè¯·æ±‚"><a href="#è¿‡æ»¤ç½‘ç»œè¯·æ±‚" class="headerlink" title="è¿‡æ»¤ç½‘ç»œè¯·æ±‚"></a>è¿‡æ»¤ç½‘ç»œè¯·æ±‚</h2><p>é€šå¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬éœ€è¦å¯¹ç½‘ç»œè¯·æ±‚è¿›è¡Œè¿‡æ»¤ï¼Œåªç›‘æ§å‘æŒ‡å®šç›®å½•æœåŠ¡å™¨ä¸Šå‘é€çš„è¯·æ±‚ã€‚å¯¹äºè¿™ç§éœ€æ±‚ï¼Œä»¥ä¸‹å‡ ç§åŠæ³•ï¼š</p>
<p>æ–¹æ³•ä¸€ï¼šåœ¨ä¸»ç•Œé¢çš„ä¸­éƒ¨çš„ Filter æ ä¸­å¡«å…¥éœ€è¦è¿‡æ»¤å‡ºæ¥çš„å…³é”®å­—ã€‚ä¾‹å¦‚æˆ‘ä»¬çš„æœåŠ¡å™¨çš„åœ°å€æ˜¯ï¼š<code>http://yuantiku.com</code> , é‚£ä¹ˆåªéœ€è¦åœ¨ Filter æ ä¸­å¡«å…¥ yuantiku å³å¯ã€‚</p>
<p>æ–¹æ³•äºŒï¼šåœ¨ Charles çš„èœå•æ é€‰æ‹© â€œProxyâ€-&gt;â€Recording Settingsâ€ï¼Œç„¶åé€‰æ‹© Include æ ï¼Œé€‰æ‹©æ·»åŠ ä¸€ä¸ªé¡¹ç›®ï¼Œç„¶åå¡«å…¥éœ€è¦ç›‘æ§çš„åè®®ï¼Œä¸»æœºåœ°å€ï¼Œç«¯å£å·ã€‚è¿™æ ·å°±å¯ä»¥åªæˆªå–ç›®æ ‡ç½‘ç«™çš„å°åŒ…äº†ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<img src="http://image.msiter.com/charles-filter-setting.jpg">
<p>é€šå¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä½¿ç”¨æ–¹æ³•ä¸€åšä¸€äº›ä¸´æ—¶æ€§çš„å°åŒ…è¿‡æ»¤ï¼Œä½¿ç”¨æ–¹æ³•äºŒåšä¸€äº›ç»å¸¸æ€§çš„å°åŒ…è¿‡æ»¤ã€‚</p>
<p>æ–¹æ³•ä¸‰ï¼šåœ¨æƒ³è¿‡æ»¤çš„ç½‘ç»œè¯·æ±‚ä¸Šå³å‡»ï¼Œé€‰æ‹© â€œFocusâ€ï¼Œä¹‹ååœ¨ Filter ä¸€æ å‹¾é€‰ä¸Š Focussed ä¸€é¡¹ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<img src="http://image.msiter.com/charles-focus.png">
<p>è¿™ç§æ–¹å¼å¯ä»¥ä¸´æ—¶æ€§çš„ï¼Œå¿«é€Ÿåœ°è¿‡æ»¤å‡ºä¸€äº›æ²¡æœ‰é€šè¿‡å…³é”®å­—çš„ä¸€ç±»ç½‘ç»œè¯·æ±‚ã€‚</p>
<h2 id="æˆªå–-iPhone-ä¸Šçš„ç½‘ç»œå°åŒ…"><a href="#æˆªå–-iPhone-ä¸Šçš„ç½‘ç»œå°åŒ…" class="headerlink" title="æˆªå– iPhone ä¸Šçš„ç½‘ç»œå°åŒ…"></a>æˆªå– iPhone ä¸Šçš„ç½‘ç»œå°åŒ…</h2><p>Charles é€šå¸¸ç”¨æ¥æˆªå–æœ¬åœ°ä¸Šçš„ç½‘ç»œå°åŒ…ï¼Œä½†æ˜¯å½“æˆ‘ä»¬éœ€è¦æ—¶ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ç”¨æ¥æˆªå–å…¶å®ƒè®¾å¤‡ä¸Šçš„ç½‘ç»œè¯·æ±‚ã€‚ä¸‹é¢æˆ‘å°±ä»¥ iPhone ä¸ºä¾‹ï¼Œè®²è§£å¦‚ä½•è¿›è¡Œç›¸åº”æ“ä½œã€‚</p>
<h3 id="Charles-ä¸Šçš„è®¾ç½®"><a href="#Charles-ä¸Šçš„è®¾ç½®" class="headerlink" title="Charles ä¸Šçš„è®¾ç½®"></a>Charles ä¸Šçš„è®¾ç½®</h3><p>è¦æˆªå– iPhone ä¸Šçš„ç½‘ç»œè¯·æ±‚ï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦å°† Charles çš„ä»£ç†åŠŸèƒ½æ‰“å¼€ã€‚åœ¨ Charles çš„èœå•æ ä¸Šé€‰æ‹© â€œProxyâ€-&gt;â€Proxy Settingsâ€ï¼Œå¡«å…¥ä»£ç†ç«¯å£ 8888ï¼Œå¹¶ä¸”å‹¾ä¸Š â€œEnable transparent HTTP proxyingâ€ å°±å®Œæˆäº†åœ¨ Charles ä¸Šçš„è®¾ç½®ã€‚å¦‚ä¸‹å›¾æ‰€ç¤º:</p>
<img src="http://image.msiter.com/charles-proxy-setting.jpg">
<h3 id="iPhone-ä¸Šçš„è®¾ç½®"><a href="#iPhone-ä¸Šçš„è®¾ç½®" class="headerlink" title="iPhone ä¸Šçš„è®¾ç½®"></a>iPhone ä¸Šçš„è®¾ç½®</h3><p>é¦–å…ˆæˆ‘ä»¬éœ€è¦è·å– Charles è¿è¡Œæ‰€åœ¨ç”µè„‘çš„ IP åœ°å€ï¼ŒCharles çš„é¡¶éƒ¨èœå•çš„ â€œHelpâ€-&gt;â€Local IP Addressâ€ï¼Œå³å¯åœ¨å¼¹å‡ºçš„å¯¹è¯æ¡†ä¸­çœ‹åˆ° IP åœ°å€ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<img src="http://image.msiter.com/charles-local-ip.png">
<p>åœ¨ iPhone çš„ â€œ è®¾ç½® â€œ-&gt;â€ æ— çº¿å±€åŸŸç½‘ â€œ ä¸­ï¼Œå¯ä»¥çœ‹åˆ°å½“å‰è¿æ¥çš„ wifi åï¼Œé€šè¿‡ç‚¹å‡»å³è¾¹çš„è¯¦æƒ…é”®ï¼Œå¯ä»¥çœ‹åˆ°å½“å‰è¿æ¥ä¸Šçš„ wifi çš„è¯¦ç»†ä¿¡æ¯ï¼ŒåŒ…æ‹¬ IP åœ°å€ï¼Œå­ç½‘æ©ç ç­‰ä¿¡æ¯ã€‚åœ¨å…¶æœ€åº•éƒ¨æœ‰ã€ŒHTTP ä»£ç†ã€ä¸€é¡¹ï¼Œæˆ‘ä»¬å°†å…¶åˆ‡æ¢æˆæ‰‹åŠ¨ï¼Œç„¶åå¡«ä¸Š Charles è¿è¡Œæ‰€åœ¨çš„ç”µè„‘çš„ IPï¼Œä»¥åŠç«¯å£å· 8888ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<img src="http://image.msiter.com/charles-iphone-setting.jpg">
<p>è®¾ç½®å¥½ä¹‹åï¼Œæˆ‘ä»¬æ‰“å¼€ iPhone ä¸Šçš„ä»»æ„éœ€è¦ç½‘ç»œé€šè®¯çš„ç¨‹åºï¼Œå°±å¯ä»¥çœ‹åˆ° Charles å¼¹å‡º iPhone è¯·æ±‚è¿æ¥çš„ç¡®è®¤èœå•ï¼ˆå¦‚ä¸‹å›¾æ‰€ç¤ºï¼‰ï¼Œç‚¹å‡» â€œAllowâ€ å³å¯å®Œæˆè®¾ç½®ã€‚</p>
<img src="http://image.msiter.com/charles-proxy-confirm.jpg">
<h2 id="æˆªå–-Https-é€šè®¯ä¿¡æ¯"><a href="#æˆªå–-Https-é€šè®¯ä¿¡æ¯" class="headerlink" title="æˆªå– Https é€šè®¯ä¿¡æ¯"></a>æˆªå– Https é€šè®¯ä¿¡æ¯</h2><h3 id="å®‰è£…è¯ä¹¦"><a href="#å®‰è£…è¯ä¹¦" class="headerlink" title="å®‰è£…è¯ä¹¦"></a>å®‰è£…è¯ä¹¦</h3><p>å¦‚æœä½ éœ€è¦æˆªå–åˆ†æ Https åè®®ç›¸å…³çš„å†…å®¹ã€‚é‚£ä¹ˆéœ€è¦å®‰è£… Charles çš„ CA è¯ä¹¦ã€‚å…·ä½“æ­¥éª¤å¦‚ä¸‹ã€‚</p>
<p>é¦–å…ˆæˆ‘ä»¬éœ€è¦åœ¨ Mac ç”µè„‘ä¸Šå®‰è£…è¯ä¹¦ã€‚ç‚¹å‡» Charles çš„é¡¶éƒ¨èœå•ï¼Œé€‰æ‹© â€œHelpâ€ -&gt; â€œSSL Proxyingâ€ -&gt; â€œInstall Charles Root Certificateâ€ï¼Œç„¶åè¾“å…¥ç³»ç»Ÿçš„å¸å·å¯†ç ï¼Œå³å¯åœ¨ KeyChain çœ‹åˆ°æ·»åŠ å¥½çš„è¯ä¹¦ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<img src="http://image.msiter.com/charles-pro-1.png">
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå³ä½¿æ˜¯å®‰è£…å®Œè¯ä¹¦ä¹‹åï¼ŒCharles é»˜è®¤ä¹Ÿå¹¶ä¸æˆªå– Https ç½‘ç»œé€šè®¯çš„ä¿¡æ¯ï¼Œå¦‚æœä½ æƒ³å¯¹æˆªå–æŸä¸ªç½‘ç«™ä¸Šçš„æ‰€æœ‰ Https ç½‘ç»œè¯·æ±‚ï¼Œå¯ä»¥åœ¨è¯¥è¯·æ±‚ä¸Šå³å‡»ï¼Œé€‰æ‹© SSL proxyï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<img src="http://image.msiter.com/charles-ssl-add-host.jpg">
<p>è¿™æ ·ï¼Œå¯¹äºè¯¥ Host çš„æ‰€æœ‰ SSL è¯·æ±‚å¯ä»¥è¢«æˆªå–åˆ°äº†ã€‚</p>
<h3 id="æˆªå–ç§»åŠ¨è®¾å¤‡ä¸­çš„-Https-é€šè®¯ä¿¡æ¯"><a href="#æˆªå–ç§»åŠ¨è®¾å¤‡ä¸­çš„-Https-é€šè®¯ä¿¡æ¯" class="headerlink" title="æˆªå–ç§»åŠ¨è®¾å¤‡ä¸­çš„ Https é€šè®¯ä¿¡æ¯"></a>æˆªå–ç§»åŠ¨è®¾å¤‡ä¸­çš„ Https é€šè®¯ä¿¡æ¯</h3><p>å¦‚æœæˆ‘ä»¬éœ€è¦åœ¨ iOS æˆ– Android æœºå™¨ä¸Šæˆªå– Https åè®®çš„é€šè®¯å†…å®¹ï¼Œè¿˜éœ€è¦åœ¨æ‰‹æœºä¸Šå®‰è£…ç›¸åº”çš„è¯ä¹¦ã€‚ç‚¹å‡» Charles çš„é¡¶éƒ¨èœå•ï¼Œé€‰æ‹© â€œHelpâ€ -&gt; â€œSSL Proxyingâ€ -&gt; â€œInstall Charles Root Certificate on a Mobile Device or Remote Browserâ€ï¼Œç„¶åå°±å¯ä»¥çœ‹åˆ° Charles å¼¹å‡ºçš„ç®€å•çš„å®‰è£…æ•™ç¨‹ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<img src="http://image.msiter.com/charles-pro-2.png">
<p>æŒ‰ç…§æˆ‘ä»¬ä¹‹å‰è¯´çš„æ•™ç¨‹ï¼Œåœ¨è®¾å¤‡ä¸Šè®¾ç½®å¥½ Charles ä¸ºä»£ç†åï¼Œåœ¨æ‰‹æœºæµè§ˆå™¨ä¸­è®¿é—®åœ°å€ï¼š<a href="http://charlesproxy.com/getssl" target="_blank" rel="noopener">http://charlesproxy.com/getssl</a>ï¼Œå³å¯æ‰“å¼€è¯ä¹¦å®‰è£…çš„ç•Œé¢ï¼Œå®‰è£…å®Œè¯ä¹¦åï¼Œå°±å¯ä»¥æˆªå–æ‰‹æœºä¸Šçš„ Https é€šè®¯å†…å®¹äº†ã€‚ä¸è¿‡åŒæ ·éœ€è¦æ³¨æ„ï¼Œé»˜è®¤æƒ…å†µä¸‹ Charles å¹¶ä¸åšæˆªå–ï¼Œä½ è¿˜éœ€è¦åœ¨è¦æˆªå–çš„ç½‘ç»œè¯·æ±‚ä¸Šå³å‡»ï¼Œé€‰æ‹© SSL proxy èœå•é¡¹ã€‚</p>
<h2 id="æ¨¡æ‹Ÿæ…¢é€Ÿç½‘ç»œ"><a href="#æ¨¡æ‹Ÿæ…¢é€Ÿç½‘ç»œ" class="headerlink" title="æ¨¡æ‹Ÿæ…¢é€Ÿç½‘ç»œ"></a>æ¨¡æ‹Ÿæ…¢é€Ÿç½‘ç»œ</h2><p>åœ¨åšç§»åŠ¨å¼€å‘çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¸¸å¸¸éœ€è¦æ¨¡æ‹Ÿæ…¢é€Ÿç½‘ç»œæˆ–è€…é«˜å»¶è¿Ÿçš„ç½‘ç»œï¼Œä»¥æµ‹è¯•åœ¨ç§»åŠ¨ç½‘ç»œä¸‹ï¼Œåº”ç”¨çš„è¡¨ç°æ˜¯å¦æ­£å¸¸ã€‚Charles å¯¹æ­¤éœ€æ±‚æä¾›äº†å¾ˆå¥½çš„æ”¯æŒã€‚</p>
<p>åœ¨ Charles çš„èœå•ä¸Šï¼Œé€‰æ‹© â€œProxyâ€-&gt;â€Throttle Settingâ€ é¡¹ï¼Œåœ¨ä¹‹åå¼¹å‡ºçš„å¯¹è¯æ¡†ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥å‹¾é€‰ä¸Š â€œEnable Throttlingâ€ï¼Œå¹¶ä¸”å¯ä»¥è®¾ç½® Throttle Preset çš„ç±»å‹ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<img src="http://image.msiter.com/charles-throttle-setting.jpg">
<p>å¦‚æœæˆ‘ä»¬åªæƒ³æ¨¡æ‹ŸæŒ‡å®šç½‘ç«™çš„æ…¢é€Ÿç½‘ç»œï¼Œå¯ä»¥å†å‹¾é€‰ä¸Šå›¾ä¸­çš„ â€œOnly for selected hostsâ€ é¡¹ï¼Œç„¶ååœ¨å¯¹è¯æ¡†çš„ä¸‹åŠéƒ¨åˆ†è®¾ç½®ä¸­å¢åŠ æŒ‡å®šçš„ hosts é¡¹å³å¯ã€‚</p>
<h2 id="ä¿®æ”¹ç½‘ç»œè¯·æ±‚å†…å®¹"><a href="#ä¿®æ”¹ç½‘ç»œè¯·æ±‚å†…å®¹" class="headerlink" title="ä¿®æ”¹ç½‘ç»œè¯·æ±‚å†…å®¹"></a>ä¿®æ”¹ç½‘ç»œè¯·æ±‚å†…å®¹</h2><p>æœ‰äº›æ—¶å€™ä¸ºäº†è°ƒè¯•æœåŠ¡å™¨çš„æ¥å£ï¼Œæˆ‘ä»¬éœ€è¦åå¤å°è¯•ä¸åŒå‚æ•°çš„ç½‘ç»œè¯·æ±‚ã€‚Charles å¯ä»¥æ–¹ä¾¿åœ°æä¾›ç½‘ç»œè¯·æ±‚çš„ä¿®æ”¹å’Œé‡å‘åŠŸèƒ½ã€‚åªéœ€è¦åœ¨ä»¥å¾€çš„ç½‘ç»œè¯·æ±‚ä¸Šç‚¹å‡»å³é”®ï¼Œé€‰æ‹© â€œEditâ€ï¼Œå³å¯åˆ›å»ºä¸€ä¸ªå¯ç¼–è¾‘çš„ç½‘ç»œè¯·æ±‚ã€‚å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<img src="http://image.msiter.com/charles-edit.png">
<p>æˆ‘ä»¬å¯ä»¥ä¿®æ”¹è¯¥è¯·æ±‚çš„ä»»ä½•ä¿¡æ¯ï¼ŒåŒ…æ‹¬ URL åœ°å€ã€ç«¯å£ã€å‚æ•°ç­‰ï¼Œä¹‹åç‚¹å‡» â€œExecuteâ€ å³å¯å‘é€è¯¥ä¿®æ”¹åçš„ç½‘ç»œè¯·æ±‚ï¼ˆå¦‚ä¸‹å›¾æ‰€ç¤ºï¼‰ã€‚Charles æ”¯æŒæˆ‘ä»¬å¤šæ¬¡ä¿®æ”¹å’Œå‘é€è¯¥è¯·æ±‚ï¼Œè¿™å¯¹äºæˆ‘ä»¬å’ŒæœåŠ¡å™¨ç«¯è°ƒè¯•æ¥å£éå¸¸æ–¹ä¾¿ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<img src="http://image.msiter.com/charles-execute.png">
<h2 id="ç»™æœåŠ¡å™¨åšå‹åŠ›æµ‹è¯•"><a href="#ç»™æœåŠ¡å™¨åšå‹åŠ›æµ‹è¯•" class="headerlink" title="ç»™æœåŠ¡å™¨åšå‹åŠ›æµ‹è¯•"></a>ç»™æœåŠ¡å™¨åšå‹åŠ›æµ‹è¯•</h2><p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ Charles çš„ Repeat åŠŸèƒ½æ¥ç®€å•åœ°æµ‹è¯•æœåŠ¡å™¨çš„å¹¶å‘å¤„ç†èƒ½åŠ›ï¼Œæ–¹æ³•å¦‚ä¸‹ã€‚</p>
<p>æˆ‘ä»¬åœ¨æƒ³æ‰“å‹çš„ç½‘ç»œè¯·æ±‚ä¸Šï¼ˆPOST æˆ– GET è¯·æ±‚å‡å¯ï¼‰å³å‡»ï¼Œç„¶åé€‰æ‹© ã€ŒRepeat Advancedã€èœå•é¡¹ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<img src="http://image.msiter.com/charles-repeat-1.png">
<p>æ¥ç€æˆ‘ä»¬å°±å¯ä»¥åœ¨å¼¹å‡ºçš„å¯¹è¯æ¡†ä¸­ï¼Œé€‰æ‹©æ‰“å‹çš„å¹¶å‘çº¿ç¨‹æ•°ä»¥åŠæ‰“å‹æ¬¡æ•°ï¼Œç¡®å®šä¹‹åï¼Œå³å¯å¼€å§‹æ‰“å‹ã€‚</p>
<img src="http://image.msiter.com/charles-repeat-2.png">
<p>æ‚„æ‚„è¯´ä¸€å¥ï¼Œä¸€äº›å†™å¾—å¾ˆå¼±çš„æŠ•ç¥¨ç½‘ç«™ï¼Œä¹Ÿå¯ä»¥ç”¨è¿™ä¸ªåŠæ³•æ¥å¿«é€ŸæŠ•ç¥¨ã€‚å½“ç„¶ï¼Œæˆ‘ä¹Ÿæ‹¿ Charles çš„ Repeat åŠŸèƒ½ç»™ä¸€äº›è¯ˆéª—çš„é’“é±¼ç½‘ç«™å–‚äº†ä¸å°‘åƒåœ¾æ•°æ®ï¼Œä¸Šæ¬¡ä¸å°å¿ƒè¿˜æŠŠä¸€ä¸ªé’“é±¼ç½‘ç«™çš„æ•°æ®åº“æ‰“æŒ‚äº†ï¼Œå—¯ï¼Œè¯·å«æˆ‘é›·é”‹ã€‚</p>
<h2 id="ä¿®æ”¹æœåŠ¡å™¨è¿”å›å†…å®¹"><a href="#ä¿®æ”¹æœåŠ¡å™¨è¿”å›å†…å®¹" class="headerlink" title="ä¿®æ”¹æœåŠ¡å™¨è¿”å›å†…å®¹"></a>ä¿®æ”¹æœåŠ¡å™¨è¿”å›å†…å®¹</h2><p>æœ‰äº›æ—¶å€™æˆ‘ä»¬æƒ³è®©æœåŠ¡å™¨è¿”å›ä¸€äº›æŒ‡å®šçš„å†…å®¹ï¼Œæ–¹ä¾¿æˆ‘ä»¬è°ƒè¯•ä¸€äº›ç‰¹æ®Šæƒ…å†µã€‚ä¾‹å¦‚åˆ—è¡¨é¡µé¢ä¸ºç©ºçš„æƒ…å†µï¼Œæ•°æ®å¼‚å¸¸çš„æƒ…å†µï¼Œéƒ¨åˆ†è€—æ—¶çš„ç½‘ç»œè¯·æ±‚è¶…æ—¶çš„æƒ…å†µç­‰ã€‚å¦‚æœæ²¡æœ‰ Charlesï¼Œè¦æœåŠ¡å™¨é…åˆæ„é€ ç›¸åº”çš„æ•°æ®æ˜¾å¾—ä¼šæ¯”è¾ƒéº»çƒ¦ã€‚è¿™ä¸ªæ—¶å€™ï¼Œä½¿ç”¨ Charles ç›¸å…³çš„åŠŸèƒ½å°±å¯ä»¥æ»¡è¶³æˆ‘ä»¬çš„éœ€æ±‚ã€‚</p>
<p>æ ¹æ®å…·ä½“çš„éœ€æ±‚ï¼ŒCharles æä¾›äº† Map åŠŸèƒ½ã€ Rewrite åŠŸèƒ½ä»¥åŠ Breakpoints åŠŸèƒ½ï¼Œéƒ½å¯ä»¥è¾¾åˆ°ä¿®æ”¹æœåŠ¡å™¨è¿”å›å†…å®¹çš„ç›®çš„ã€‚è¿™ä¸‰è€…åœ¨åŠŸèƒ½ä¸Šçš„å·®å¼‚æ˜¯ï¼š</p>
<ol>
<li>Map åŠŸèƒ½é€‚åˆé•¿æœŸåœ°å°†æŸä¸€äº›è¯·æ±‚é‡å®šå‘åˆ°å¦ä¸€ä¸ªç½‘ç»œåœ°å€æˆ–æœ¬åœ°æ–‡ä»¶ã€‚</li>
<li>Rewrite åŠŸèƒ½é€‚åˆå¯¹ç½‘ç»œè¯·æ±‚è¿›è¡Œä¸€äº›æ­£åˆ™æ›¿æ¢ã€‚</li>
<li>Breakpoints åŠŸèƒ½é€‚åˆåšä¸€äº›ä¸´æ—¶æ€§çš„ä¿®æ”¹ã€‚</li>
</ol>
<h3 id="Map-åŠŸèƒ½"><a href="#Map-åŠŸèƒ½" class="headerlink" title="Map åŠŸèƒ½"></a>Map åŠŸèƒ½</h3><p>Charles çš„ Map åŠŸèƒ½åˆ† Map Remote å’Œ Map Local ä¸¤ç§ï¼Œé¡¾åæ€ä¹‰ï¼ŒMap Remote æ˜¯å°†æŒ‡å®šçš„ç½‘ç»œè¯·æ±‚é‡å®šå‘åˆ°å¦ä¸€ä¸ªç½‘å€è¯·æ±‚åœ°å€ï¼ŒMap Local æ˜¯å°†æŒ‡å®šçš„ç½‘ç»œè¯·æ±‚é‡å®šå‘åˆ°æœ¬åœ°æ–‡ä»¶ã€‚</p>
<p>åœ¨ Charles çš„èœå•ä¸­ï¼Œé€‰æ‹© â€œToolsâ€-&gt;â€Map Remoteâ€ æˆ– â€œMap Localâ€ å³å¯è¿›å…¥åˆ°ç›¸åº”åŠŸèƒ½çš„è®¾ç½®é¡µé¢ã€‚</p>
<img src="http://image.msiter.com/charles-map.png">
<p>å¯¹äº Map Remote åŠŸèƒ½ï¼Œæˆ‘ä»¬éœ€è¦åˆ†åˆ«å¡«å†™ç½‘ç»œé‡å®šå‘çš„æºåœ°å€å’Œç›®çš„åœ°å€ï¼Œå¯¹äºä¸éœ€è¦é™åˆ¶çš„æ¡ä»¶ï¼Œå¯ä»¥ç•™ç©ºã€‚ä¸‹å›¾æ˜¯ä¸€ä¸ªç¤ºä¾‹ï¼Œæˆ‘å°†æ‰€æœ‰ <code>ytk1.yuanku.ws</code>ï¼ˆæµ‹è¯•æœåŠ¡å™¨ï¼‰çš„è¯·æ±‚é‡å®šå‘åˆ°äº† <code>www.yuantiku.com</code>ï¼ˆçº¿ä¸ŠæœåŠ¡å™¨ï¼‰ã€‚</p>
<img src="http://image.msiter.com/charles-map-remote.png">
<p>å¯¹äº Map Local åŠŸèƒ½ï¼Œæˆ‘ä»¬éœ€è¦å¡«å†™çš„é‡å®šå‘çš„æºåœ°å€å’Œæœ¬åœ°çš„ç›®æ ‡æ–‡ä»¶ã€‚å¯¹äºæœ‰ä¸€äº›å¤æ‚çš„ç½‘ç»œè¯·æ±‚ç»“æœï¼Œæˆ‘ä»¬å¯ä»¥å…ˆä½¿ç”¨ Charles æä¾›çš„ â€œSave Responseâ€¦â€ åŠŸèƒ½ï¼Œå°†è¯·æ±‚ç»“æœä¿å­˜åˆ°æœ¬åœ°ï¼ˆå¦‚ä¸‹å›¾æ‰€ç¤ºï¼‰ï¼Œç„¶åç¨åŠ ä¿®æ”¹ï¼Œæˆä¸ºæˆ‘ä»¬çš„ç›®æ ‡æ˜ å°„æ–‡ä»¶ã€‚</p>
<img src="http://image.msiter.com/charles-save-response.png">
<p>ä¸‹å›¾æ˜¯ä¸€ä¸ªç¤ºä¾‹ï¼Œæˆ‘å°†ä¸€ä¸ªæŒ‡å®šçš„ç½‘ç»œè¯·æ±‚é€šè¿‡ Map Local åŠŸèƒ½æ˜ å°„åˆ°äº†æœ¬åœ°çš„ä¸€ä¸ªç»è¿‡ä¿®æ”¹çš„æ–‡ä»¶ä¸­ã€‚</p>
<img src="http://image.msiter.com/charles-map-local.png">
<p>Map Local åœ¨ä½¿ç”¨çš„æ—¶å€™ï¼Œæœ‰ä¸€ä¸ªæ½œåœ¨çš„é—®é¢˜ï¼Œå°±æ˜¯å…¶è¿”å›çš„ Http Response Header ä¸æ­£å¸¸çš„è¯·æ±‚å¹¶ä¸ä¸€æ ·ã€‚è¿™ä¸ªæ—¶å€™å¦‚æœå®¢æˆ·ç«¯æ ¡éªŒäº† Http Response Header ä¸­çš„éƒ¨åˆ†å†…å®¹ï¼Œå°±ä¼šä½¿å¾—è¯¥åŠŸèƒ½å¤±æ•ˆã€‚è§£å†³åŠæ³•æ˜¯åŒæ—¶ä½¿ç”¨ Map Local ä»¥ä¸‹é¢æåˆ°çš„ Rewrite åŠŸèƒ½ï¼Œå°†ç›¸å…³çš„ Http å¤´ Rewrite æˆæˆ‘ä»¬å¸Œæœ›çš„å†…å®¹ã€‚</p>
<h3 id="Rewrite-åŠŸèƒ½"><a href="#Rewrite-åŠŸèƒ½" class="headerlink" title="Rewrite åŠŸèƒ½"></a>Rewrite åŠŸèƒ½</h3><p>Rewrite åŠŸèƒ½åŠŸèƒ½é€‚åˆå¯¹æŸä¸€ç±»ç½‘ç»œè¯·æ±‚è¿›è¡Œä¸€äº›æ­£åˆ™æ›¿æ¢ï¼Œä»¥è¾¾åˆ°ä¿®æ”¹ç»“æœçš„ç›®çš„ã€‚</p>
<p>ä¾‹å¦‚ï¼Œæˆ‘ä»¬çš„å®¢æˆ·ç«¯æœ‰ä¸€ä¸ª API è¯·æ±‚æ˜¯è·å¾—ç”¨æˆ·æ˜µç§°ï¼Œè€Œæˆ‘å½“å‰çš„æ˜µç§°æ˜¯ â€œtangqiaoboyâ€ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<img src="http://image.msiter.com/charles-rewrite-1.jpeg">
<p>æˆ‘ä»¬æƒ³è¯•ç€ç›´æ¥ä¿®æ”¹ç½‘ç»œè¿”å›å€¼ï¼Œå°† tangqiaoboy æ¢æˆæˆ iosboyã€‚äºæ˜¯æˆ‘ä»¬å¯ç”¨ Rewrite åŠŸèƒ½ï¼Œç„¶åè®¾ç½®å¦‚ä¸‹çš„è§„åˆ™ï¼š</p>
<img src="http://image.msiter.com/charles-rewrite-2.png">
<p>å®Œæˆè®¾ç½®ä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥ä» Charles ä¸­çœ‹åˆ°ï¼Œä¹‹åçš„ API è·å¾—çš„æ˜µç§°è¢«è‡ªåŠ¨ Rewrite æˆäº† iosboyï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<img src="http://image.msiter.com/charles-rewrite-3.png">
<h3 id="Breakpoints-åŠŸèƒ½"><a href="#Breakpoints-åŠŸèƒ½" class="headerlink" title="Breakpoints åŠŸèƒ½"></a>Breakpoints åŠŸèƒ½</h3><p>ä¸Šé¢æä¾›çš„ Rewrite åŠŸèƒ½æœ€é€‚åˆåšæ‰¹é‡å’Œé•¿æœŸçš„æ›¿æ¢ï¼Œä½†æ˜¯å¾ˆå¤šæ—¶å€™ï¼Œæˆ‘ä»¬åªæ˜¯æƒ³ä¸´æ—¶ä¿®æ”¹ä¸€æ¬¡ç½‘ç»œè¯·æ±‚ç»“æœï¼Œè¿™ä¸ªæ—¶å€™ï¼Œä½¿ç”¨ Rewrite åŠŸèƒ½è™½ç„¶ä¹Ÿå¯ä»¥è¾¾åˆ°ç›®çš„ï¼Œä½†æ˜¯è¿‡äºéº»çƒ¦ï¼Œå¯¹äºä¸´æ—¶æ€§çš„ä¿®æ”¹ï¼Œæˆ‘ä»¬æœ€å¥½ä½¿ç”¨ Breakpoints åŠŸèƒ½ã€‚</p>
<p>Breakpoints åŠŸèƒ½ç±»ä¼¼æˆ‘ä»¬åœ¨ Xcode ä¸­è®¾ç½®çš„æ–­ç‚¹ä¸€æ ·ï¼Œå½“æŒ‡å®šçš„ç½‘ç»œè¯·æ±‚å‘ç”Ÿæ—¶ï¼ŒCharles ä¼šæˆªè·è¯¥è¯·æ±‚ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ Charles ä¸­ä¸´æ—¶ä¿®æ”¹ç½‘ç»œè¯·æ±‚çš„è¿”å›å†…å®¹ã€‚</p>
<p>ä¸‹å›¾æ˜¯æˆ‘ä»¬ä¸´æ—¶ä¿®æ”¹è·å–ç”¨æˆ·ä¿¡æ¯çš„ APIï¼Œå°†ç”¨æˆ·çš„æ˜µç§°è¿›è¡Œäº†æ›´æ”¹ï¼Œä¿®æ”¹å®Œæˆåç‚¹å‡» â€œExecuteâ€ åˆ™å¯ä»¥è®©ç½‘ç»œè¯·æ±‚ç»§ç»­è¿›è¡Œã€‚</p>
<img src="http://image.msiter.com/charles-breakpoint.png">
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä½¿ç”¨ Breakpoints åŠŸèƒ½å°†ç½‘ç»œè¯·æ±‚æˆªè·å¹¶ä¿®æ”¹è¿‡ç¨‹ä¸­ï¼Œæ•´ä¸ªç½‘ç»œè¯·æ±‚çš„è®¡æ—¶å¹¶ä¸ä¼šæš‚åœï¼Œæ‰€ä»¥é•¿æ—¶é—´çš„æš‚åœå¯èƒ½å¯¼è‡´å®¢æˆ·ç«¯çš„è¯·æ±‚è¶…æ—¶ã€‚</p>
<h2 id="åå‘ä»£ç†"><a href="#åå‘ä»£ç†" class="headerlink" title="åå‘ä»£ç†"></a>åå‘ä»£ç†</h2><p>Charles çš„åå‘ä»£ç†åŠŸèƒ½å…è®¸æˆ‘ä»¬å°†æœ¬åœ°çš„ç«¯å£æ˜ å°„åˆ°è¿œç¨‹çš„å¦ä¸€ä¸ªç«¯å£ä¸Šã€‚ä¾‹å¦‚ï¼Œåœ¨ä¸‹å›¾ä¸­ï¼Œæˆ‘å°†æœ¬æœºçš„ 61234 ç«¯å£æ˜ å°„åˆ°äº†è¿œç¨‹ï¼ˆwww.yuantiku.comï¼‰çš„80ç«¯å£ä¸Šäº†ã€‚è¿™æ ·ï¼Œå½“æˆ‘è®¿é—®æœ¬åœ°çš„ 61234 ç«¯å£æ—¶ï¼Œå®é™…è¿”å›çš„å†…å®¹ä¼šç”± www.yuantiku.com çš„ 80 ç«¯å£æä¾›ã€‚</p>
<img src="http://image.msiter.com/charles-reverse-proxy.jpg">
<h2 id="è®¾ç½®å¤–éƒ¨ä»£ç†ï¼Œè§£å†³ä¸ç¿»å¢™è½¯ä»¶çš„å†²çª"><a href="#è®¾ç½®å¤–éƒ¨ä»£ç†ï¼Œè§£å†³ä¸ç¿»å¢™è½¯ä»¶çš„å†²çª" class="headerlink" title="è®¾ç½®å¤–éƒ¨ä»£ç†ï¼Œè§£å†³ä¸ç¿»å¢™è½¯ä»¶çš„å†²çª"></a>è®¾ç½®å¤–éƒ¨ä»£ç†ï¼Œè§£å†³ä¸ç¿»å¢™è½¯ä»¶çš„å†²çª</h2><p>Charles çš„åŸç†æ˜¯æŠŠè‡ªå·±è®¾ç½®æˆç³»ç»Ÿçš„ä»£ç†æœåŠ¡å™¨ï¼Œä½†æ˜¯åœ¨ä¸­å›½ï¼Œç”±äºå·¥ä½œéœ€è¦ï¼Œæˆ‘ä»¬å¸¸å¸¸éœ€è¦ä½¿ç”¨ Google æœç´¢ï¼Œæ‰€ä»¥å¤§éƒ¨åˆ†ç¨‹åºå‘˜éƒ½æœ‰è‡ªå·±çš„ç¿»å¢™è½¯ä»¶ï¼Œè€Œè¿™äº›è½¯ä»¶çš„åŸºæœ¬åŸç†ï¼Œä¹Ÿæ˜¯æŠŠè‡ªå·±è®¾ç½®æˆç³»ç»Ÿçš„ä»£ç†æœåŠ¡å™¨ï¼Œæ¥åšåˆ°é€æ˜çš„ç¿»å¢™ã€‚</p>
<p>ä¸ºäº†ä½¿å¾—ä¸¤è€…èƒ½å¤Ÿå’Œå¹³å…±å¤„ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ Charles çš„ <code>External Proxy Settings</code> ä¸­ï¼Œè®¾ç½®ç¿»å¢™çš„ä»£ç†ç«¯å£ä»¥åŠç›¸å…³ä¿¡æ¯ã€‚åŒæ—¶ï¼Œæˆ‘ä»¬ä¹Ÿè¦å…³é—­ç›¸å…³ç¿»å¢™è½¯ä»¶çš„è‡ªåŠ¨è®¾ç½®ï¼Œä½¿å…¶ä¸ä¸»åŠ¨ä¿®æ”¹ç³»ç»Ÿä»£ç†ï¼Œé¿å… Charles å¤±æ•ˆã€‚</p>
<h2 id="ç ´è§£"><a href="#ç ´è§£" class="headerlink" title="ç ´è§£"></a>ç ´è§£</h2><ol>
<li>ä¸‹è½½ç‰¹å®šçš„ç‰ˆæœ¬çš„<a href="http://image.msiter.com/charles-proxy-4.1.dmg" target="_blank" rel="noopener">Charles</a>ä»¥åŠç ´è§£æ–‡ä»¶ <a href="http://image.msiter.com/charles.jar" target="_blank" rel="noopener">charles.jar</a></li>
<li>åœ¨åº”ç”¨ç¨‹åºä¸­å³é”®Charlesï¼Œé€‰æ‹©â€œæ˜¾ç¤ºåŒ…å†…å®¹â€ã€‚</li>
<li>ä¾æ¬¡æ‰“å¼€ç›®å½•ï¼šContents -&gt; Java</li>
<li>ç”¨ä¸‹è½½çš„charles.jaræ›¿æ¢ç›®å½•ä¸­çš„charles.jarã€‚</li>
<li>é‡æ–°æ‰“å¼€åè¿˜æ˜¯ç ´è§£å¤±è´¥çš„æ‰€ä»¥éœ€è¦ ç‚¹å‡» Help -&gt; Register Charles éšä¾¿è¾“å…¥å³å¯ç ´è§£å®Œæˆ</li>
</ol>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>é€šè¿‡ Charles è½¯ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥å¾ˆæ–¹ä¾¿åœ°åœ¨æ—¥å¸¸å¼€å‘ä¸­ï¼Œæˆªå–å’Œè°ƒè¯•ç½‘ç»œè¯·æ±‚å†…å®¹ï¼Œåˆ†æå°åŒ…åè®®ä»¥åŠæ¨¡æ‹Ÿæ…¢é€Ÿç½‘ç»œã€‚ç”¨å¥½ Charles å¯ä»¥æå¤§çš„æ–¹ä¾¿æˆ‘ä»¬å¯¹äºå¸¦æœ‰ç½‘ç»œè¯·æ±‚çš„ App çš„å¼€å‘å’Œè°ƒè¯•ã€‚</p>
<p>æ„¿æœ¬æ–‡å¸®åŠ©å¤§å®¶æˆä¸º Charles çš„ä¸“å®¶ï¼Œç¥å¤§å®¶ç©å¾—å¼€å¿ƒï½</p>
<blockquote>
<p>æœ¬æ–‡å…¨éƒ¨å¼•ç”¨è‡ª å”å·§çš„ <a href="http://blog.devtang.com/2015/11/14/charles-introduction/" target="_blank" rel="noopener">Charles ä»å…¥é—¨åˆ°ç²¾é€š</a></p>
</blockquote>
]]></content>
      
        <categories>
            
            <category> å¼€å‘å¸®åŠ© </category>
            
        </categories>
        
        
        <tags>
            
            <tag> ios </tag>
            
            <tag> çº¦æŸæ•™ç¨‹ </tag>
            
            <tag> ç ´è§£ </tag>
            
            <tag> æŠ“åŒ… </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[travis-ci æ¥ç»´æŠ¤ Cocoapods]]></title>
      <url>http://www.msiter.com/2017/05/25/travis-ci%20%E6%9D%A5%E7%BB%B4%E6%8A%A4%20Cocoapods/</url>
      <content type="html"><![CDATA[<p><img class = "g-pl-90"  src="http://image.msiter.com/stock-photo-213307611.jpg" alt="" title="äººçš„ä¸€åˆ‡ç—›è‹¦ï¼Œæœ¬è´¨ä¸Šéƒ½æ˜¯å¯¹è‡ªå·±çš„æ— èƒ½çš„æ„¤æ€’ã€‚â€”â€”ç‹å°æ³¢"></p>
<h2 id="æ•™ç¨‹å¼€å§‹å‰çš„åºŸè¯è¿ç¯‡"><a href="#æ•™ç¨‹å¼€å§‹å‰çš„åºŸè¯è¿ç¯‡" class="headerlink" title="æ•™ç¨‹å¼€å§‹å‰çš„åºŸè¯è¿ç¯‡"></a>æ•™ç¨‹å¼€å§‹å‰çš„åºŸè¯è¿ç¯‡</h2><p>æˆ‘ä»¬å…¬å¸çš„appï¼Œæ˜¯åœ¨æ˜¯ç«ä¸èŠäº†ã€‚é‚£ä¹ˆåŠæ³•äº†ï¼Œæˆ‘ä»¬æŠ½è±¡å‡ºæ¥ä¸€ä¸ªsdkç»™åˆ«äººæ¥å§ã€‚è¿™æ ·å­çš„è¯ï¼Œæˆ‘ä»¬æ€ä¹ˆä¹Ÿå¯ä»¥æœ‰äº›é‡å•Šã€‚</p>
<p>æœ€å¼€å§‹ä½¿ç”¨çš„Cocoapods å…¨éƒ¨ä»£ç å¼€å‘çš„æ–¹å¼æ¥åˆ¶ä½œçš„ï¼Œåœ¨è·¨è¿‡ä¸€ä¸ªåˆä¸€ä¸ªçš„å¤§å‘ä¹‹åï¼Œç»ˆäºåˆ°äº†ï¼Œè¦æŠŠä»£ç è¾¾æˆ <code>.a</code> åŒ…åœ°æ­¥ï¼Œå…¶å®æ˜¯å¯ä»¥è¾¾æˆ <code>.framework</code> çš„ã€‚ä¸»è¦æ˜¯è¿˜æ˜¯å› ä¸ºä»£ç éœ€è¦å…¼å®¹ ios 7 ã€‚<br>æ‰€ä»¥å¿…é¡»è¦ä½¿ç”¨ è¾¾æˆ static çš„æ–¹å¼ã€‚</p>
<h3 id="æ‰“åŒ…"><a href="#æ‰“åŒ…" class="headerlink" title="æ‰“åŒ…"></a>æ‰“åŒ…</h3><p>é¦–å…ˆä½¿ç”¨çš„æ‰“åŒ…å‘½ä»¤ï¼Œè‚¯å®šæ˜¯ <code>xcodebuild</code> ä¸è¦é—®æˆ‘ï¼Œå¦‚ä½•ä½¿ç”¨ï¼Œgoogleå§ã€‚</p>
<p>æˆ‘ä»¬ä½¿ç”¨çš„å‘½ä»¤æ—¶</p>
<pre class="line-numbers language-shell"><code class="language-shell">xcodebuild build -project Pods/Pods.xcodeproj -target OddityOcUI
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>è¿™æ ·å­æ‰“ä¸‹æ¥æ˜¯é»˜è®¤ Iphone sdkç‰ˆæœ¬+realese ç‰ˆæœ¬çš„ï¼Œè¿™æ ·å­åªåœ¨çœŸæœºä¸Šè¿è¡Œè‚¯å®šæ˜¯æ²¡é—®é¢˜å•¦ï½</p>
<p>ä½†æ˜¯ä½ æ€ä¹ˆéƒ½å¾—åšåˆ°å¯ä»¥åœ¨æ¨¡æ‹Ÿå™¨ä¸Šè·‘å§ã€‚æ‰€ä»¥å°±éœ€è¦æ¥ä¸‹æ¥çš„è¿™ä¸€å¥äº†ã€‚</p>
<pre class="line-numbers language-shell"><code class="language-shell">xcodebuild build -project Pods/Pods.xcodeproj -target OddityOcUI -sdk iphonesimulator10.3
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>åé¢çš„æ˜¯ sdk ç‰ˆæœ¬ï¼Œä¸çŸ¥é“ç‰ˆæœ¬çš„å¯ä»¥è¿è¡Œå‘½ä»¤</p>
<pre class="line-numbers language-shell"><code class="language-shell">xcodebuild -showsdks
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="ç°åœ¨å¼€å§‹æ•´åˆ-travis-ci"><a href="#ç°åœ¨å¼€å§‹æ•´åˆ-travis-ci" class="headerlink" title="ç°åœ¨å¼€å§‹æ•´åˆ travis-ci"></a>ç°åœ¨å¼€å§‹æ•´åˆ travis-ci</h3><p>æ—¢ç„¶éƒ½æ‰¾åˆ°è¿™é‡Œäº†ï¼Œæˆ‘å°±ä¸è·Ÿä½ bbé‚£ä¹ˆå¤šäº†ã€‚å…¶å®æˆ‘ä»¬æœ€å¤šä¸ä¼šå†™ ymlæ–‡ä»¶å˜›ã€‚</p>
<p>å› ä¸º budild ä¼šé‡è§éå¸¸å¤šçš„logï¼Œæˆ‘ä¸ºäº†è§£å†³ï¼Œå°è¯•ä½¿ç”¨äº†ã€‚<code>xcpretty</code> äº‹å®è¯æ˜â€¦â€¦   æ²¡å•¥ç”¨å¤„ã€‚å…ˆæ”¾ç€å§ã€‚</p>
<pre class="line-numbers language-yaml"><code class="language-yaml"><span class="token key atrule">language</span><span class="token punctuation">:</span> objective<span class="token punctuation">-</span>c
<span class="token key atrule">osx_image</span><span class="token punctuation">:</span> xcode8.3

<span class="token key atrule">os</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> osx
<span class="token key atrule">branches</span><span class="token punctuation">:</span>
  <span class="token key atrule">only</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> master
<span class="token key atrule">before_install</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> gem install xcpretty
<span class="token key atrule">install</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> pod install <span class="token punctuation">-</span><span class="token punctuation">-</span>repo<span class="token punctuation">-</span>update
<span class="token key atrule">before_script</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> git config <span class="token punctuation">-</span><span class="token punctuation">-</span>global user.name ""
  <span class="token punctuation">-</span> git config <span class="token punctuation">-</span><span class="token punctuation">-</span>global user.email ""
  <span class="token punctuation">-</span> git clone $<span class="token punctuation">{</span>CocoaPodsRepo<span class="token punctuation">}</span>

<span class="token key atrule">script</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> set <span class="token punctuation">-</span>o pipefail &amp;&amp; xcodebuild build <span class="token punctuation">-</span>project Pods/Pods.xcodeproj <span class="token punctuation">-</span>target OddityOcUI <span class="token punctuation">|</span> xcpretty <span class="token punctuation">-</span>c
  <span class="token punctuation">-</span> set <span class="token punctuation">-</span>o pipefail &amp;&amp; xcodebuild build <span class="token punctuation">-</span>project Pods/Pods.xcodeproj <span class="token punctuation">-</span>target OddityOcUI <span class="token punctuation">-</span>sdk iphonesimulator10.3 <span class="token punctuation">|</span> xcpretty <span class="token punctuation">-</span>c
  <span class="token punctuation">-</span> lipo <span class="token punctuation">-</span>create build/Release<span class="token punctuation">-</span>iphoneos/OddityOcUI/libOddityOcUI.a build/Release<span class="token punctuation">-</span>iphonesimulator/OddityOcUI/libOddityOcUI.a  <span class="token punctuation">-</span>output libOddityOcUI.a

<span class="token key atrule">after_success</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> bash operation.sh
    <span class="token punctuation">-</span> cd OddityUI
    <span class="token punctuation">-</span> git add .
    <span class="token punctuation">-</span> git commit <span class="token punctuation">-</span>m 'æ›´æ–°é€šç”¨é™æ€åŒ…'
    <span class="token punctuation">-</span> git push <span class="token punctuation">-</span><span class="token punctuation">-</span>force <span class="token punctuation">-</span><span class="token punctuation">-</span>quiet "https<span class="token punctuation">:</span>//$<span class="token punctuation">{</span>PersonalAccessTokens<span class="token punctuation">}</span>@$<span class="token punctuation">{</span>GtiHubUrlRepo<span class="token punctuation">}</span>" master<span class="token punctuation">:</span>master
    <span class="token punctuation">-</span> git tag $<span class="token punctuation">{</span>GtiHubTagVersion<span class="token punctuation">}</span>
    <span class="token punctuation">-</span> git push <span class="token punctuation">-</span><span class="token punctuation">-</span>force <span class="token punctuation">-</span><span class="token punctuation">-</span>quiet "https<span class="token punctuation">:</span>//$<span class="token punctuation">{</span>PersonalAccessTokens<span class="token punctuation">}</span>@$<span class="token punctuation">{</span>GtiHubUrlRepo<span class="token punctuation">}</span>" $<span class="token punctuation">{</span>GtiHubTagVersion<span class="token punctuation">}</span><span class="token punctuation">:</span>$<span class="token punctuation">{</span>GtiHubTagVersion<span class="token punctuation">}</span>
<span class="token key atrule">env</span><span class="token punctuation">:</span>
 <span class="token key atrule">global</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">GtiHubTagVersion</span><span class="token punctuation">:</span> 0.3.2
    <span class="token punctuation">-</span> <span class="token key atrule">GtiHubUrlRepo</span><span class="token punctuation">:</span> github.com/OddityUI/OddityUI.git
    <span class="token punctuation">-</span> <span class="token key atrule">CocoaPodsRepo</span> <span class="token punctuation">:</span> https<span class="token punctuation">:</span>//github.com/OddityUI/OddityUI
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
]]></content>
      
        <categories>
            
            <category> IOS </category>
            
        </categories>
        
        
        <tags>
            
            <tag> ios </tag>
            
            <tag> travis-ci </tag>
            
            <tag> cocoapods </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[å¥‡æ€ªçš„ unrecognized selector sent to instance é—®é¢˜]]></title>
      <url>http://www.msiter.com/2017/05/18/%E5%A5%87%E6%80%AA%E7%9A%84%20unrecognized%20selector%20sent%20to%20instance%20%E9%97%AE%E9%A2%98/</url>
      <content type="html"><![CDATA[<p><img class = "g-pl-90"  src="http://image.msiter.com/stock-photo-212311441.jpg" alt="" title=" &quot;Nutsï¼&quot; â€”â€” 101ç©ºé™å¸ˆå‰¯å¸ˆé•¿éº¦è€ƒé‡Œå¤«å°†å†›"></p>
<a id="more"></a>
<p>æˆ‘åšäº†ä¸€ä¸ª é»‘å¤œæ¨¡å¼ å’Œ ç™½å¤©æ¨¡å¼çš„åˆ‡æ¢ã€‚<br>åœ¨ios8.3 çš„è®¾å¤‡ä¸Šå‘ç°äº†ä¸€ä¸ªé—®é¢˜ï¼Œä¼šå¯¼è‡´å´©æºƒã€‚æ§åˆ¶å°æ‰“å‡ºå„ç§å¥‡æ€ªçš„é—®é¢˜â€¦â€¦</p>
<pre><code>unrecognized selector sent to instance
</code></pre><p>å„ç§å¯¹è±¡çš„</p>
<p>åŒ…æ‹¬ <code>NSURL</code>,<code>UIView</code>,<code>_FCString</code>â€¦ ç­‰ç­‰ï¼Œæˆ‘å½“æ—¶å°±è’™äº†ï¼Œï¼Œæˆ‘åˆ°åº•å†™å‡ºäº†ä»€ä¹ˆæ ·å­çš„ä»£ç â€¦â€¦    </p>
<p>ä»–æœ€ç»ˆæŠ¥é”™çš„åœ°æ–¹æˆ‘å‘é€ <code>NSnotifition</code>çš„åœ°æ–¹ï¼Œä¹Ÿä¸å…·ä½“è·³åˆ°æŸä¸€ä¸ªå´©æºƒçš„ä½ç½®ã€‚</p>
<p>åæ¥æƒ³äº†ä¸€ä¸‹ <code>unrecognized selector sent to instance</code> æ˜¯ç”±äºå·²ç»é”€æ¯äº†ï¼Œè¿˜è°ƒç”¨ã€‚å¹¶ä¸”æˆ‘çš„å´©æºƒå¯¹è±¡åƒå¥‡ç™¾æ€ªçš„ã€‚å´©æºƒåœ¨å‘é€é€šçŸ¥çš„åœ°æ–¹ã€‚é‚£ä¹ˆé—®é¢˜å¤§æ¦‚å°±æ˜¯å‡ºç°åœ¨è¿™é‡Œäº†å§ã€‚æˆ‘å°è¯•åœ¨æ¯ä¸€ä¸ªåœ°æ–¹éƒ½è¿›è¡Œäº† <code>dealloc</code>ç§»é™¤é€šçŸ¥çš„æ–¹æ³•ã€‚æœç„¶ï¼Œé—®é¢˜æ¶ˆå¤±ã€‚å…¶å®æˆ‘åªç§»é™¤äº†ä¸€ä¸ªæˆ‘è‡ªå®šä¹‰çš„UIViewçš„é€šçŸ¥ï¼Œå…¶ä»–çš„UIViewControolerï¼Œæ²¡æœ‰ç§»é™¤ä¹Ÿæ˜¯æ²¡é—®é¢˜ã€‚åªæ˜¯ä¸ºäº†ä¿è¯ç™¾åˆ†ä¹‹ç™¾â€¦â€¦</p>
<p>çŒœæµ‹ï¼š</p>
<ol>
<li>ios8.3çš„é—®é¢˜ï¼Œåœ¨é”€æ¯åæ²¡æœ‰ç§»é™¤æˆ‘çš„é€šçŸ¥</li>
<li>å¼•èµ·å„ç§å¯¹è±¡çš„å´©æºƒçš„åŸå› ï¼Œä¼°è®¡æ˜¯å› ä¸ºæ–°çš„å¯¹è±¡å æ®äº†ç†è®ºä¸Šé”€æ¯çš„å¯¹è±¡çš„ ç‰©ç†åœ°å€<br><div class="pixels-photo"><br><p><br> <img src="https://drscdn.500px.org/photo/212311441/m%3D900/50cfce955bc5969aeeb03ca97aaabf7c" alt="Autumn Poetry by Daniel F. on 500px.com"><br></p><br><a href="https://500px.com/photo/212311441/autumn-poetry-by-daniel-f-" alt="Autumn Poetry by Daniel F. on 500px.com" target="_blank" rel="noopener"></a><br></div><script type="text/javascript" src="https://500px.com/embed.js"></script>
</li>
</ol>
]]></content>
      
        <categories>
            
            <category> IOS </category>
            
        </categories>
        
        
        <tags>
            
            <tag> ios </tag>
            
            <tag> error </tag>
            
            <tag> å¥‡æ€ªçš„é—®é¢˜ </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[å…«çˆªé±¼ è·å–ç”¨æˆ·é¼ æ ‡æ‚¬æµ®å±‚çº§]]></title>
      <url>http://www.msiter.com/2017/05/17/%E5%85%AB%E7%88%AA%E9%B1%BC%20%E8%8E%B7%E5%8F%96%E7%94%A8%E6%88%B7%E9%BC%A0%E6%A0%87%E6%82%AC%E6%B5%AE%E5%B1%82%E7%BA%A7/</url>
      <content type="html"><![CDATA[<p>å…¬å¸ä¸€ç›´å†åšæ–°é—»èšåˆï¼Œå¯¼è‡´æˆ‘ä»¬å…¬å¸ä¸€ç›´åœ¨çˆ¬å–æ–°é—»ï¼Œçˆ¬å–å„ç§è½¯ä»¶çš„æ–°é—»èµ„è®¯ã€‚</p>
<p>åæ¥è€æ¿çªå‘å¥‡æƒ³ï¼Œæˆ‘ä»¬ä¸å¦‚åšä¸€ä¸ªå…«æŠ“é±¼æŠŠâ€¦â€¦ é‚£ä¹ˆæ‰¾äº†ä¸¤ä¸ªåŒäº‹ï¼Œé¢„è¨€äº†ä¸€ä¸‹ã€‚é‚£å°±åšå§ï¼Œä¹‹ååŒæ—¶qtå¼€å‘ï¼Œç´§é”£å¯†é¼“çš„å±•å¼€äº†ã€‚</p>
<p><img class = "g-pl-90"  src="http://image.msiter.com/stock-photo-212226679.jpg" alt="" title="åªæœ‰å¼ºè€…æ‰æ‡‚å¾—æ–—äº‰ï¼Œå¼±è€…ç”šè‡³å¤±è´¥éƒ½ä¸å¤Ÿèµ„æ ¼ï¼Œä»–ä»¬ç”Ÿæ¥å°±æ˜¯è¢«å¾æœçš„"></p>
<a id="more"></a>
<p>ä¸­é€”ï¼Œæˆ‘ä»¬ä¸€èµ·èŠå¤©çš„æ—¶å€™ï¼Œå°±è¯´åˆ°äº†å…«æŠ“é±¼ï¼Œæ˜¯å°ç™½ç”¨æˆ·ä½¿ç”¨çš„ï¼Œæ‰€ä»¥ä»–ä»¬æƒ³çˆ¬å–çš„å†…å®¹å±‚çº§ï¼Œéƒ½æ˜¯é¼ æ ‡é€‰ä¸­çš„ã€‚æ‰€ä»¥æƒ³åšä¸€ä¸ªé¼ æ ‡é€‰æ‹©domçš„jsã€‚è·Ÿæˆ‘åäº†ä¸€ä¼šè‹¦æ°´ã€‚<br>é‚£ä¸ªæ—¶å€™ä¸å¤ªå¿™ï¼Œå†åŠ ä¸Šé‚£ä¼šå„¿æˆ‘åˆšåšå®Œ æ–°é—»è¯¦æƒ…é¡µçš„jsï¼Œè§‰çš„æœ‰äº›ç»éªŒã€‚ç«‹é©¬æ‹èƒ¸è„¯ï¼Œæˆ‘æ¥ã€‚å°±æœ‰äº†æ¥ä¸‹æ¥çš„ä»£ç ã€‚</p>
<pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token comment" spellcheck="true">/**
 * Created by Administrator on 2016/11/2.
 */</span>


<span class="token comment" spellcheck="true">/* æ–¹æ³•è¯´æ˜
 * @method æ–¹æ³•å
 * @for æ‰€å±ç±»å
 * @param {å‚æ•°ç±»å‹} å‚æ•°å å‚æ•°è¯´æ˜
 * @return {è¿”å›å€¼ç±»å‹} è¿”å›å€¼è¯´æ˜
 */</span>

<span class="token comment" spellcheck="true">// window.onload=function(){</span>
<span class="token comment" spellcheck="true">//</span>
<span class="token comment" spellcheck="true">//     var p = CreateShowDomXmlLabel();</span>
<span class="token comment" spellcheck="true">//</span>
<span class="token comment" spellcheck="true">//     document.body.onmousemove = function(e) {</span>
<span class="token comment" spellcheck="true">//</span>
<span class="token comment" spellcheck="true">//         var dom = e.target;</span>
<span class="token comment" spellcheck="true">//</span>
<span class="token comment" spellcheck="true">//         HandleSuspendViewMethod(dom);</span>
<span class="token comment" spellcheck="true">//</span>
<span class="token comment" spellcheck="true">//         p.innerText = GetDomObjectAllFatherDomName(dom);</span>
<span class="token comment" spellcheck="true">//</span>
<span class="token comment" spellcheck="true">//         RemoveSuspendView(); // ç§»é™¤ä¹‹å‰çš„æ˜¾ç¤ºé®æŒ¡å±‚</span>
<span class="token comment" spellcheck="true">//</span>
<span class="token comment" spellcheck="true">//         var div = CreateSuspendView(dom); // åˆ›å»ºç°åœ¨çš„é®æŒ¡å±‚</span>
<span class="token comment" spellcheck="true">//</span>
<span class="token comment" spellcheck="true">//         document.body.insertBefore(div,p);</span>
<span class="token comment" spellcheck="true">//     }</span>
<span class="token comment" spellcheck="true">// }</span>

<span class="token keyword">var</span> p <span class="token operator">=</span> <span class="token function">CreateShowDomXmlLabel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

document<span class="token punctuation">.</span>body<span class="token punctuation">.</span>onmousemove <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token keyword">var</span> dom <span class="token operator">=</span> e<span class="token punctuation">.</span>target<span class="token punctuation">;</span>

    <span class="token function">HandleSuspendViewMethod</span><span class="token punctuation">(</span>dom<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">RemoveSuspendView</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// ç§»é™¤ä¹‹å‰çš„æ˜¾ç¤ºé®æŒ¡å±‚</span>

    <span class="token keyword">var</span> div <span class="token operator">=</span> <span class="token function">CreateSuspendView</span><span class="token punctuation">(</span>dom<span class="token punctuation">)</span>

    document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">insertBefore</span><span class="token punctuation">(</span>div<span class="token punctuation">,</span> p<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">updateLabelLocationMethod</span><span class="token punctuation">(</span><span class="token function">GetDomObjectAllFatherDomName</span><span class="token punctuation">(</span>dom<span class="token punctuation">)</span><span class="token punctuation">,</span> div<span class="token punctuation">)</span>

<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">///  ç”¨æˆ·å½“å‰æ“ä½œçš„ dom ç»“æ„ä½“</span>
<span class="token keyword">var</span> CurrentDomXML<span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">/// ç”¨æˆ·åˆ›å»ºçš„é®æŒ¡å±‚çš„id åç§°</span>
<span class="token keyword">var</span> SuspendViewID <span class="token operator">=</span> <span class="token string">"OddityUISuspendView"</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">/*
 * å¤„ç†ç”¨æˆ·æ»‘åŠ¨æ—¶é—´çš„å¼€å§‹ï¼Œå¦‚æœç”¨æˆ·æ›´æ¢äº†é¼ æ ‡çš„å¯¹è±¡åˆ™ è¿›è¡Œæ¥ä¸‹æ¥çš„æ“ä½œã€‚å¦åˆ™å°±ç›´æ¥è¿”å›
 * @method HandleSuspendViewMethod
 * @param {HTMLElment} e ç”¨æˆ·å½“å‰æ»‘åŠ¨ä½ç½®çš„domç»“æ„å¯¹è±¡
 */</span>
<span class="token keyword">function</span> <span class="token function">HandleSuspendViewMethod</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>e <span class="token operator">==</span> CurrentDomXML<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span>
    <span class="token punctuation">}</span>
    CurrentDomXML <span class="token operator">=</span> e
<span class="token punctuation">}</span><span class="token punctuation">;</span>


<span class="token comment" spellcheck="true">/* ç§»é™¤ä¹‹å‰åˆ›å»ºçš„ SuspendView
 * @method RemoveSuspendView
 */</span>
<span class="token keyword">function</span> <span class="token function">RemoveSuspendView</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> removeStr <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span>SuspendViewID<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>removeStr <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        removeStr<span class="token punctuation">.</span>parentNode<span class="token punctuation">.</span><span class="token function">removeChild</span><span class="token punctuation">(</span>removeStr<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>


<span class="token comment" spellcheck="true">//è·å–æ§ä»¶å·¦ç»å¯¹ä½ç½®</span>

<span class="token keyword">function</span> <span class="token function">getAbsoluteLeft</span><span class="token punctuation">(</span>o<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    oLeft <span class="token operator">=</span> o<span class="token punctuation">.</span>offsetLeft
    <span class="token keyword">while</span> <span class="token punctuation">(</span>o<span class="token punctuation">.</span>offsetParent <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        oParent <span class="token operator">=</span> o<span class="token punctuation">.</span>offsetParent
        oLeft <span class="token operator">+</span><span class="token operator">=</span> oParent<span class="token punctuation">.</span>offsetLeft
        o <span class="token operator">=</span> oParent
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> oLeft
<span class="token punctuation">}</span>
<span class="token comment" spellcheck="true">//è·å–æ§ä»¶ä¸Šç»å¯¹ä½ç½®</span>
<span class="token keyword">function</span> <span class="token function">getAbsoluteTop</span><span class="token punctuation">(</span>o<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    oTop <span class="token operator">=</span> o<span class="token punctuation">.</span>offsetTop<span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>o<span class="token punctuation">.</span>offsetParent <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        oParent <span class="token operator">=</span> o<span class="token punctuation">.</span>offsetParent<span class="token punctuation">;</span>
        oTop <span class="token operator">+</span><span class="token operator">=</span> oParent<span class="token punctuation">.</span>offsetTop<span class="token punctuation">;</span>
        o <span class="token operator">=</span> oParent
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> oTop
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">/* åˆ›å»ºé®æŒ¡å±‚ æ ¹æ® ä¼ å…¥çš„ å¯¹è±¡çš„ ç»å¯¹å®šä½ è®¾ç½® é®æŒ¡å±‚çš„ ä½ç½®ã€‚ä»¥åŠ é®æŒ¡å±‚çš„ é€æ˜åº¦ã€‚ç©¿é€å±æ€§
 * @method CreateSuspendView
 * @param {HTMLElment} e ç”¨æˆ·å½“å‰æ»‘åŠ¨ä½ç½®çš„domç»“æ„å¯¹è±¡
 */</span>
<span class="token keyword">function</span> <span class="token function">CreateSuspendView</span><span class="token punctuation">(</span>dom<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> div <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">"div"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    div<span class="token punctuation">.</span>id <span class="token operator">=</span> SuspendViewID<span class="token punctuation">;</span>

    <span class="token comment" spellcheck="true">///  è®¾ç½®divçš„ é»‘è‰² å’Œé€æ˜</span>
    div<span class="token punctuation">.</span>style<span class="token punctuation">.</span>opacity <span class="token operator">=</span> <span class="token number">0.4</span><span class="token punctuation">;</span>
    div<span class="token punctuation">.</span>style<span class="token punctuation">.</span>backgroundColor <span class="token operator">=</span> <span class="token string">"black"</span><span class="token punctuation">;</span>

    div<span class="token punctuation">.</span>style<span class="token punctuation">.</span>display <span class="token operator">=</span> <span class="token string">"block"</span><span class="token punctuation">;</span>

    div<span class="token punctuation">.</span>style<span class="token punctuation">.</span>position <span class="token operator">=</span> <span class="token string">"absolute"</span><span class="token punctuation">;</span>

    div<span class="token punctuation">.</span>style<span class="token punctuation">.</span>borderColor <span class="token operator">=</span> <span class="token string">"red"</span>

    div<span class="token punctuation">.</span>style<span class="token punctuation">.</span>width <span class="token operator">=</span> dom<span class="token punctuation">.</span>offsetWidth <span class="token operator">+</span> <span class="token string">"px"</span><span class="token punctuation">;</span>

    div<span class="token punctuation">.</span>style<span class="token punctuation">.</span>height <span class="token operator">=</span> dom<span class="token punctuation">.</span>offsetHeight <span class="token operator">+</span> <span class="token string">"px"</span><span class="token punctuation">;</span>

    div<span class="token punctuation">.</span>style<span class="token punctuation">.</span>zIndex <span class="token operator">=</span> <span class="token number">99999</span>

    div<span class="token punctuation">.</span>style<span class="token punctuation">.</span>borderStyle <span class="token operator">=</span> <span class="token string">"solid"</span>

    div<span class="token punctuation">.</span>style<span class="token punctuation">.</span>top <span class="token operator">=</span> <span class="token function">getAbsoluteTop</span><span class="token punctuation">(</span>dom<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"px"</span><span class="token punctuation">;</span>
    div<span class="token punctuation">.</span>style<span class="token punctuation">.</span>left <span class="token operator">=</span> <span class="token function">getAbsoluteLeft</span><span class="token punctuation">(</span>dom<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"px"</span><span class="token punctuation">;</span>

    <span class="token comment" spellcheck="true">/// è®¾ç½®é¼ æ ‡çš„ç©¿é€ æ•ˆæœ</span>
    div<span class="token punctuation">.</span>style<span class="token punctuation">.</span>pointerEvents <span class="token operator">=</span> <span class="token string">"none"</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> div
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">/// åˆ›å»ºã€€æ˜¾ç¤ºã€€DOMã€€ç»“æ„çš„ã€€Label</span>
<span class="token keyword">function</span> <span class="token function">CreateShowDomXmlLabel</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token keyword">var</span> p <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">"p"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    p<span class="token punctuation">.</span>innerText <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
    p<span class="token punctuation">.</span>style<span class="token punctuation">.</span>textAlign <span class="token operator">=</span> <span class="token string">"center"</span><span class="token punctuation">;</span>

    p<span class="token punctuation">.</span>style<span class="token punctuation">.</span>backgroundColor <span class="token operator">=</span> <span class="token string">"black"</span><span class="token punctuation">;</span>
    p<span class="token punctuation">.</span>style<span class="token punctuation">.</span>lineHeight <span class="token operator">=</span> <span class="token string">"30px"</span><span class="token punctuation">;</span>
    p<span class="token punctuation">.</span>style<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token string">"white"</span><span class="token punctuation">;</span>
    p<span class="token punctuation">.</span>style<span class="token punctuation">.</span>opacity <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    p<span class="token punctuation">.</span>style<span class="token punctuation">.</span>position <span class="token operator">=</span> <span class="token string">"absolute"</span><span class="token punctuation">;</span>
    p<span class="token punctuation">.</span>style<span class="token punctuation">.</span>height <span class="token operator">=</span> <span class="token string">"30px"</span><span class="token punctuation">;</span>
    p<span class="token punctuation">.</span>style<span class="token punctuation">.</span>zIndex <span class="token operator">=</span> <span class="token number">999991</span>
    p<span class="token punctuation">.</span>style<span class="token punctuation">.</span>top <span class="token operator">=</span> <span class="token string">"0px"</span><span class="token punctuation">;</span>
    <span class="token comment" spellcheck="true">/// è®¾ç½®é¼ æ ‡çš„ç©¿é€ æ•ˆæœ</span>
    p<span class="token punctuation">.</span>style<span class="token punctuation">.</span>pointerEvents <span class="token operator">=</span> <span class="token string">"none"</span><span class="token punctuation">;</span>

    document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> p
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">/// æ ¹æ®ä¼ å…¥çš„ dom è¿”å› dom æ ‘ å­—ç¬¦ä¸²</span>
<span class="token keyword">function</span> <span class="token function">GetDomObjectAllFatherDomName</span><span class="token punctuation">(</span>dom<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> domName <span class="token operator">=</span> <span class="token string">"[ - "</span> <span class="token operator">+</span> dom<span class="token punctuation">.</span>nodeName<span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>dom<span class="token punctuation">.</span>parentNode<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        domName <span class="token operator">=</span> dom<span class="token punctuation">.</span>parentNode<span class="token punctuation">.</span>nodeName <span class="token operator">+</span> <span class="token string">" > "</span> <span class="token operator">+</span> domName<span class="token punctuation">;</span>
        dom <span class="token operator">=</span> dom<span class="token punctuation">.</span>parentNode<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> domName<span class="token punctuation">.</span><span class="token function">toLocaleLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">" - ]"</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">updateLabelLocationMethod</span><span class="token punctuation">(</span>str<span class="token punctuation">,</span> div<span class="token punctuation">)</span> <span class="token punctuation">{</span>

    p<span class="token punctuation">.</span>innerText <span class="token operator">=</span> str<span class="token punctuation">;</span>

    <span class="token keyword">var</span> topLocation <span class="token operator">=</span> div<span class="token punctuation">.</span>offsetTop<span class="token number">-40</span>
    <span class="token keyword">var</span> leftLocation <span class="token operator">=</span> div<span class="token punctuation">.</span>offsetLeft
    <span class="token keyword">if</span> <span class="token punctuation">(</span>topLocation <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        topLocation <span class="token operator">=</span> div<span class="token punctuation">.</span>offsetHeight <span class="token operator">+</span> div<span class="token punctuation">.</span>offsetTop <span class="token operator">+</span> <span class="token number">10</span>
    <span class="token punctuation">}</span>

    p<span class="token punctuation">.</span>style<span class="token punctuation">.</span>top <span class="token operator">=</span> topLocation <span class="token operator">+</span> <span class="token string">"px"</span><span class="token punctuation">;</span>
    p<span class="token punctuation">.</span>style<span class="token punctuation">.</span>left <span class="token operator">=</span> leftLocation <span class="token operator">+</span> <span class="token string">"px"</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> div
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>æµ‹è¯•æ–¹æ³•ï¼Œæ‰¾åˆ°ä»»æ„æµè§ˆå™¨ï¼Œæ‰“å¼€å¼€å‘è€…æ¨¡å¼ã€‚åœ¨consoleæ§åˆ¶å°ï¼Œå¤åˆ¶ç²˜è´´è¿™äº›ä»£ç å°±å¯ä»¥çœ‹åˆ°æ•ˆæœäº†ã€‚</p>
<p>å…¶å®çœŸçš„æ˜¯ä¸ºäº†å‡‘åšå®¢æ•°çš„â€¦â€¦</p>
]]></content>
      
        <categories>
            
            <category> Web å‰ç«¯ </category>
            
        </categories>
        
        
        <tags>
            
            <tag> å…«çˆªé±¼ </tag>
            
            <tag> html </tag>
            
            <tag> js </tag>
            
            <tag> Javascript </tag>
            
            <tag> é¼ æ ‡æ‚¬æµ® </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[WKWebView IOS8 ä¸‹ loadHtmlStringé”™è¯¯]]></title>
      <url>http://www.msiter.com/2017/05/17/WKWebView%20IOS8%20%E4%B8%8B%20loadHtmlString%E9%94%99%E8%AF%AF/</url>
      <content type="html"><![CDATA[<p><img class = "g-pl-90"  src="http://image.msiter.com/stock-photo-212184725.jpg" alt="" title="ä¸æ˜¯ç°å®æ”¯æ’‘çš„æ¢¦æƒ³ï¼Œè€Œæ˜¯æ¢¦æƒ³æ”¯æ’‘äº†ç°å®ã€‚â€”â€”æ˜Ÿç©ºæ—¥è®°"></p>
<a id="more"></a>
<p>åšé¡¹ç›®çš„æ—¶å€™ï¼Œéœ€è¦å±•ç¤ºæ–°é—»è¯¦æƒ…ã€‚ç»è¿‡ä¸€ç³»åˆ—çš„è°ƒç ”ï¼Œæœ€ç»ˆé€‰å®šä¸ºä½¿ç”¨ webviewã€‚<br>å› ä¸ºéœ€è¦æ”¯æŒios7ï¼Œæ‰€ä»¥æˆ‘åœ¨è¯¦æƒ…é¡µå°±éœ€è¦åŒæ—¶å…·å¤‡ UIWebView å’Œ WKWebViewï¼Œä¸¤ç§ã€‚<br>ç”±äºIOS8æ‰å¼€å§‹å‡ºç°çš„WKWebViewï¼Œæ‰€ä»¥è‡ªç„¶è€Œç„¶çš„æˆ‘å½“ç„¶æƒ³ä»ios8å°±æ˜¯ç”¨WkwebVIewã€‚æ¯•ç«Ÿæ€§èƒ½å¥½ï¼Œï¼Œï¼Œå„ç§å¤¸<br>ä½†æ˜¯å¾ˆå¿«å°±é‡è§ä¸€ä¸ªé—®é¢˜ï¼Œæœ¬æ¥å‘¢ï¼Œåœ¨ios9ï¼Œios10 ï¼Œæˆ‘ç›´æ¥è°ƒç”¨æ–¹æ³•å°±å¯ä»¥ã€‚</p>
<pre class="line-numbers language-objectivec"><code class="language-objectivec"><span class="token punctuation">[</span>_wkWebView loadHTMLString<span class="token punctuation">:</span>htmlStr baseURL<span class="token punctuation">:</span><span class="token punctuation">[</span>NSBundle oddity_shareBundle<span class="token punctuation">]</span><span class="token punctuation">.</span>bundleURL<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>åœ¨htmlStr é‡Œé¢ï¼Œæˆ‘æœ‰è®¾ç½®çš„ æœ¬åœ°å›¾ç‰‡ï¼Œæœ¬åœ°jsï¼Œæœ¬åœ°cssã€‚åœ¨ ios9-10 ä¸€åˆ‡OKã€‚ä½†æ˜¯ååios8ä¸è¡Œï¼ŒåŠ è½½å‡ºæ¥æœ¬åœ°å›¾ç‰‡ï¼Œä½†æ˜¯æœ¬åœ°jsæœ¬åœ°cssåŠ è½½ä¸å‡ºæ¥â€¦â€¦      </p>
<p>ä¸€é¡¿è°·æ­Œï¼Œæ²¡æ‰¾åˆ°â€¦â€¦  æœ€ç»ˆå¿ƒæ€ï¼Œé‚£æˆï¼Œæ”¾å¼ƒå§â€¦â€¦  ç›´æ¥ios7-8 éƒ½æ˜¯ç”¨ UIWebViewå§ã€‚</p>
<p>æ‰¾åˆ°äº†ä¸€äº›<a href="http://stackoverflow.com/questions/24882834/wkwebview-not-loading-local-files-under-ios-8" target="_blank" rel="noopener">å‚è€ƒ</a></p>
<p>ä½†æ˜¯ï¼Œåæ¥æœ‰æ¬¡æ— èŠçš„æ—¶å€™ï¼Œæƒ³åˆ°äº†ï¼ŒæŠŠjså’Œcsså…¨éƒ¨æ”¾åœ¨htmlå­—ç¬¦ä¸²ä¸å°±å¥½äº†å—ï¼Ÿ</p>
<p>äºæ˜¯ä¹ï¼Œæœ‰äº†è¿™æ ·å­çš„ä¸€æ®µä»£ç </p>
<pre class="line-numbers language-objectivec"><code class="language-objectivec"><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token punctuation">[</span>UIDevice currentDevice<span class="token punctuation">]</span> systemVersion<span class="token punctuation">]</span> floatValue<span class="token punctuation">]</span> <span class="token operator">>=</span> <span class="token number">8.0</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token punctuation">[</span>UIDevice currentDevice<span class="token punctuation">]</span> systemVersion<span class="token punctuation">]</span> floatValue<span class="token punctuation">]</span> <span class="token operator">&lt;</span> <span class="token number">9.0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

        NSString <span class="token operator">*</span>file1 <span class="token operator">=</span>  <span class="token punctuation">[</span><span class="token punctuation">[</span>NSBundle oddity_shareBundle<span class="token punctuation">]</span> pathForResource<span class="token punctuation">:</span><span class="token string">@"jquery"</span> ofType<span class="token punctuation">:</span><span class="token string">@"js"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        NSString <span class="token operator">*</span>file2 <span class="token operator">=</span>  <span class="token punctuation">[</span><span class="token punctuation">[</span>NSBundle oddity_shareBundle<span class="token punctuation">]</span> pathForResource<span class="token punctuation">:</span><span class="token string">@"bootstrap.min"</span> ofType<span class="token punctuation">:</span><span class="token string">@"css"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        NSString <span class="token operator">*</span>file3 <span class="token operator">=</span>  <span class="token punctuation">[</span><span class="token punctuation">[</span>NSBundle oddity_shareBundle<span class="token punctuation">]</span> pathForResource<span class="token punctuation">:</span><span class="token string">@"content"</span> ofType<span class="token punctuation">:</span><span class="token string">@"css"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>file1 <span class="token operator">&amp;&amp;</span> file2 <span class="token operator">&amp;&amp;</span> file3<span class="token punctuation">)</span> <span class="token punctuation">{</span>

            NSString <span class="token operator">*</span>fileStr1 <span class="token operator">=</span> <span class="token punctuation">[</span>NSString stringWithContentsOfFile<span class="token punctuation">:</span>file1 encoding<span class="token punctuation">:</span><span class="token punctuation">(</span>NSUTF8StringEncoding<span class="token punctuation">)</span> error<span class="token punctuation">:</span>nil<span class="token punctuation">]</span><span class="token punctuation">;</span>
            NSString <span class="token operator">*</span>fileStr2 <span class="token operator">=</span> <span class="token punctuation">[</span>NSString stringWithContentsOfFile<span class="token punctuation">:</span>file2 encoding<span class="token punctuation">:</span><span class="token punctuation">(</span>NSUTF8StringEncoding<span class="token punctuation">)</span> error<span class="token punctuation">:</span>nil<span class="token punctuation">]</span><span class="token punctuation">;</span>
            NSString <span class="token operator">*</span>fileStr3 <span class="token operator">=</span> <span class="token punctuation">[</span>NSString stringWithContentsOfFile<span class="token punctuation">:</span>file3 encoding<span class="token punctuation">:</span><span class="token punctuation">(</span>NSUTF8StringEncoding<span class="token punctuation">)</span> error<span class="token punctuation">:</span>nil<span class="token punctuation">]</span><span class="token punctuation">;</span>

            topHeader <span class="token operator">=</span> <span class="token punctuation">[</span>NSString stringWithFormat<span class="token punctuation">:</span><span class="token string">@"&lt;script type=\"text/javascript\">%@&lt;/script>&lt;style type=\"text/css\">%@&lt;/style>&lt;style type=\"text/css\">%@&lt;/style>"</span><span class="token punctuation">,</span>fileStr1<span class="token punctuation">,</span>fileStr2<span class="token punctuation">,</span>fileStr3<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>å…¶å®è¿˜å¯ä»¥ä¼˜åŒ–çš„ï¼Œæ¯”å¦‚è¿™ä¸ªæ–‡ä»¶å…¶å®ç¤¼ç‰©ä¸Šåªéœ€è¦è¯»å–ä¸€æ¬¡å°±å¯ä»¥çš„ï¼Œä½†æ˜¯æˆ‘ç°åœ¨ä¼šæ¯æ¬¡éƒ½è¯»å–ï¼Œè¿™ä¸ªæ—¶å€™å°±å¯ä»¥åšä¸€ä¸ªç¼“å­˜ã€‚æˆ–è€…å…¶ä»–äº‘äº‘ã€‚</p>
<p>æˆ‘è¿™é‡Œåªæ˜¯æä¾›ä¸€ä¸ªæ€è·¯ã€‚ã€‚ã€‚</p>
]]></content>
      
        <categories>
            
            <category> IOS </category>
            
        </categories>
        
        
        <tags>
            
            <tag> WKWebView </tag>
            
            <tag> Systematic distinction </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Html å­—ç¬¦ä¸²è½¬æ¢æˆ AttributedString iosç‰ˆæœ¬ä¸‹çš„é”™è¯¯]]></title>
      <url>http://www.msiter.com/2017/05/17/Html%20%E5%AD%97%E7%AC%A6%E4%B8%B2%E8%BD%AC%E6%8D%A2%E6%88%90%20AttributedString%20ios%E7%89%88%E6%9C%AC%E4%B8%8B%E7%9A%84%E9%94%99%E8%AF%AF/</url>
      <content type="html"><![CDATA[<p>åœ¨iosä¸­æƒ³è¦æŠŠhtmlå­—ç¬¦ä¸²è½¬æ¢æˆ AttributedString ï¼Œéœ€è¦ä½¿ç”¨ä»¥ä¸‹æ–¹æ³•</p>
<p><img class = "g-pl-90"  src="http://image.msiter.com/stock-photo-212192603.jpg" alt="" title="è¯·å‹‡æ•¢åœ°å‘é»‘å¤œé‡Œèµ°å»&lt;br/&gt;&lt;br/&gt;è™½ç„¶ä½ æ²¡æœ‰ä»€ä¹ˆæˆåŠŸçš„æœºä¼šï¼Œè™½ç„¶ä½ åˆšä¸Šè·¯ä¾¿å¯èƒ½æ¨ªæ­»&lt;br/&gt;&lt;br/&gt;ä½†æˆ‘ä¾ç„¶ç¥ç¦ä½ ï¼Œå¹¶è¯…å’’ä½ ã€‚â€”â€”çŒ«è…»"></p>
<a id="more"></a>
<pre class="line-numbers language-objectivec"><code class="language-objectivec">NSMutableAttributedString <span class="token operator">*</span>attributedString <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span>NSMutableAttributedString alloc<span class="token punctuation">]</span> initWithData<span class="token punctuation">:</span><span class="token punctuation">[</span>title dataUsingEncoding<span class="token punctuation">:</span>NSUnicodeStringEncoding<span class="token punctuation">]</span>  options<span class="token punctuation">:</span><span class="token operator">@</span><span class="token punctuation">{</span> NSDocumentTypeDocumentAttribute<span class="token punctuation">:</span> NSHTMLTextDocumentType <span class="token punctuation">}</span> documentAttributes<span class="token punctuation">:</span>nil error<span class="token punctuation">:</span>nil<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>è¿™æ ·å­çš„è¯,htmlå­—ç¬¦ä¸²å°±å¯ä»¥è½¬æ¢ä¸º <code>NSMutableAttributedString</code> å¯¹è±¡ï¼Œå¯ä»¥å±•ç¤ºåœ¨å¯ä»¥å±•ç¤º AttributedStringçš„ç©ºé—´ä¸Šï¼Œä½†æ˜¯è¿™ä¸ªä¸œè¥¿æ˜¯æœ‰ä¸€å®šæ—¶é—´çš„è€—æ—¶çš„ã€‚<br>å°¤å…¶æ˜¯åœ¨ tableviewä¸Šä¼šæ¶ˆè€—å¾ˆå¤§çš„è®¡ç®—æ—¶é—´ï¼Œä½¿æ»‘åŠ¨å‡ºç°é—®é¢˜ã€‚é‚£ä¹ˆæˆ‘ä»¬å°±éœ€è¦è¿›è¡Œä¸€ä¸ªä¸€æ­¥è®¡ç®—ï¼Œå¹¶ä¸”ä¸ºäº†æ›´å¥½çš„èŠ‚çœæ€§èƒ½ï¼Œæˆ‘ä»¬æœ€å¥½åšä¸€ä¸ªç¼“å­˜ã€‚æ¥ä¸‹æ¥å°±æ˜¯æˆ‘çš„åˆ¶ä½œæ–¹å¼</p>
<pre class="line-numbers language-objectivec"><code class="language-objectivec"><span class="token keyword">@interface</span> <span class="token function">OddityHtmlTitleCache</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">@property</span><span class="token punctuation">(</span>nonatomic<span class="token punctuation">,</span>strong<span class="token punctuation">)</span>  NSCache <span class="token operator">*</span>sharedCache<span class="token punctuation">;</span>

<span class="token keyword">@end</span>

<span class="token keyword">@implementation</span> OddityHtmlTitleCache

<span class="token comment" spellcheck="true">// åˆ›å»ºä¸€ä¸ª å•åˆ©çš„ ç®¡ç†å™¨</span>
<span class="token operator">+</span><span class="token punctuation">(</span>OddityHtmlTitleCache <span class="token operator">*</span><span class="token punctuation">)</span>sharedCache<span class="token punctuation">{</span>

    <span class="token keyword">static</span> OddityHtmlTitleCache <span class="token operator">*</span>sharedManager<span class="token punctuation">;</span>
    <span class="token keyword">static</span> dispatch_once_t onceToken<span class="token punctuation">;</span>
    <span class="token function">dispatch_once</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>onceToken<span class="token punctuation">,</span> <span class="token operator">^</span><span class="token punctuation">{</span>
        sharedManager <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span>OddityHtmlTitleCache alloc<span class="token punctuation">]</span>init<span class="token punctuation">]</span><span class="token punctuation">;</span>

        sharedManager<span class="token punctuation">.</span>sharedCache <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span>NSCache alloc<span class="token punctuation">]</span> init<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> sharedManager<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

 <span class="token comment" spellcheck="true">// æ ¹æ® htmlå­—ç¬¦ä¸²è·å–  NSAttributedString</span>
<span class="token operator">-</span><span class="token punctuation">(</span>NSAttributedString <span class="token operator">*</span><span class="token punctuation">)</span>htmlTitleByString<span class="token punctuation">:</span><span class="token punctuation">(</span>NSString <span class="token operator">*</span><span class="token punctuation">)</span>title<span class="token punctuation">{</span>

    <span class="token comment" spellcheck="true">// åœ¨cache æå–</span>
    id viewController <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token keyword">self</span><span class="token punctuation">.</span>sharedCache objectForKey<span class="token punctuation">:</span>title<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span> viewController<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> viewController<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    NSMutableAttributedString <span class="token operator">*</span>attributedString <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span>NSMutableAttributedString alloc<span class="token punctuation">]</span> initWithData<span class="token punctuation">:</span><span class="token punctuation">[</span>title dataUsingEncoding<span class="token punctuation">:</span>NSUnicodeStringEncoding<span class="token punctuation">]</span>  options<span class="token punctuation">:</span><span class="token operator">@</span><span class="token punctuation">{</span> NSDocumentTypeDocumentAttribute<span class="token punctuation">:</span> NSHTMLTextDocumentType <span class="token punctuation">}</span> documentAttributes<span class="token punctuation">:</span>nil error<span class="token punctuation">:</span>nil<span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token punctuation">[</span>attributedString addAttributes<span class="token punctuation">:</span><span class="token operator">@</span><span class="token punctuation">{</span>
                                      NSFontAttributeName<span class="token punctuation">:</span><span class="token punctuation">[</span>UIFont oddity_font3<span class="token punctuation">]</span><span class="token punctuation">,</span>
                                      <span class="token punctuation">}</span> range<span class="token punctuation">:</span><span class="token punctuation">[</span>attributedString<span class="token punctuation">.</span>string fullRange<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>attributedString<span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token punctuation">[</span><span class="token keyword">self</span><span class="token punctuation">.</span>sharedCache setObject<span class="token punctuation">:</span>attributedString forKey<span class="token punctuation">:</span>title<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> attributedString<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">@end</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>æœ€å¼€å§‹ï¼Œæˆ‘æ˜¯åœ¨ios10ï¼Œæµ‹è¯•çš„ï¼Œæ²¡æœ‰é—®é¢˜ï¼Œä½†æ˜¯æˆ‘çš„åŒæ—¶åé¦ˆç»™æˆ‘ã€‚ä»–æœ‰å´©æºƒã€‚<br>æœ€ç»ˆæˆ‘æŸ¥åˆ°äº†,åœ¨<a href="http://stackoverflow.com/questions/28915954/nsattributedstring-initwithdata-and-nshtmltextdocumenttype-crash-if-not-on-main" target="_blank" rel="noopener">stackoverflow</a>ï¼Œè¿™ä¸ªè½¬çš„æ–¹æ³•ï¼Œåœ¨ios9.2ä¹‹å‰ï¼Œå¼‚æ­¥æ‰§è¡Œè¯¥æ–¹æ³•éƒ½ä¼šé”™è¯¯çš„ã€‚<br>ä¸”è¡Œä¸”çæƒœæŠŠâ€¦â€¦</p>
]]></content>
      
        <categories>
            
            <category> IOS </category>
            
        </categories>
        
        
        <tags>
            
            <tag> AttributedString </tag>
            
            <tag> iOS8 html2AttributedString error </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[WebKit WkwebView dealloc Crashé”™è¯¯]]></title>
      <url>http://www.msiter.com/2017/05/17/WebKit%20WkwebView%20dealloc%20Crash%E9%94%99%E8%AF%AF/</url>
      <content type="html"><![CDATA[<p><img class = "g-pl-90"  src="http://image.msiter.com/stock-photo-212206847.jpg" alt="" title="ç”Ÿæ´»æ€»æ˜¯è®©æˆ‘ä»¬éä½“é³ä¼¤ï¼Œä½†åˆ°åæ¥ï¼Œé‚£äº›å—ä¼¤çš„åœ°æ–¹ä¸€å®šä¼šæˆä¸ºæˆ‘ä»¬æœ€å¼ºå£®çš„åœ°æ–¹ã€‚â€”â€”æµ·æ˜å¨"></p>
<a id="more"></a>
<p>ä»Šå¤©é‡åˆ°ä¸€ä¸ªå¥‡æ€ªçš„é—®é¢˜ï¼Œåœ¨æˆ‘ dismiss UIViewControlleråï¼Œæˆ‘çš„UIViewControlleræ²¡æœ‰é”€æ¯ï¼Œè¿™å¯¼è‡´å†…å­˜åœ¨æ…¢æ…¢çš„å¢é•¿ï¼Œæ²¡æœ‰é”€æ¯ã€‚<br>æŸ¥äº†ä¸€ä¼šå„¿ï¼ŒæŠŠé—®é¢˜é”å®šåœ¨äº† WKWebViewä¸Šäº†ï¼Œæˆ‘å¼€å§‹æ…¢æ…¢çš„æ³¨é‡Šï¼Œè°ƒè¯•ï¼Œæœ€åå‘ç°ã€‚æ˜¯æˆ‘çš„ä»¥ä¸‹ä»£ç çš„é—®é¢˜ã€‚</p>
<pre class="line-numbers language-objectivec"><code class="language-objectivec"><span class="token keyword">self</span><span class="token punctuation">.</span>configuration <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span>WKWebViewConfiguration alloc<span class="token punctuation">]</span> init<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">[</span><span class="token keyword">self</span><span class="token punctuation">.</span>configuration<span class="token punctuation">.</span>userContentController addScriptMessageHandler<span class="token punctuation">:</span><span class="token keyword">self</span> name<span class="token punctuation">:</span> OddityWkWebViewConfiguration<span class="token punctuation">]</span><span class="token punctuation">;</span>
_wkWebView <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span>OddityCustomWkWebView alloc<span class="token punctuation">]</span>initWithFrame<span class="token punctuation">:</span><span class="token punctuation">(</span>CGRectZero<span class="token punctuation">)</span> configuration<span class="token punctuation">:</span><span class="token keyword">self</span><span class="token punctuation">.</span>configuration<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>åœ¨æˆ‘æ³¨é‡Šäº†ï¼Œ<code>addScriptMessageHandler</code>æ–¹æ³•ä¹‹åï¼Œdeallocè°ƒç”¨äº†ã€‚<br>é‚£ä¹ˆå°±çŸ¥é“äº†é—®é¢˜äº†ã€‚åœ¨ ViewDidDisapper æ–¹æ³•ï¼Œ<code>removeScriptMessageHandlerForName</code> å°±å¥½äº†</p>
<pre class="line-numbers language-objectivec"><code class="language-objectivec"><span class="token operator">-</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>viewDidDisappear<span class="token punctuation">:</span><span class="token punctuation">(</span>BOOL<span class="token punctuation">)</span>animated<span class="token punctuation">{</span>

    <span class="token punctuation">[</span><span class="token keyword">super</span> viewDidDisappear<span class="token punctuation">:</span>animated<span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token punctuation">[</span><span class="token keyword">self</span><span class="token punctuation">.</span>configuration<span class="token punctuation">.</span>userContentController removeScriptMessageHandlerForName<span class="token punctuation">:</span> OddityWkWebViewConfiguration<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>å†åæ¥æˆ‘å‘ç°åœ¨iosçš„æµ‹è¯•æœºä¸Šï¼Œæˆ‘æ¨å‡ºå»ä¹‹åä¼šç›´æ¥å´©æºƒã€‚æ§åˆ¶å°æ‰“å°å‡ºï¼Œé‡æŒ‡é’ˆçš„é—®é¢˜ï¼Œæœ€åç¡®è®¤ä¸ºé‡æŒ‡é’ˆå°±æ˜¯ WkWebViewã€‚<br>åæ¥åœ¨ <a href="http://stackoverflow.com/questions/35529080/wkwebview-crashes-on-deinit" target="_blank" rel="noopener">stackoverflow</a>æ‰¾åˆ°äº†è¿™ä¸ªé—®é¢˜çš„è§£å†³ã€‚æœ€åæ›´æ–°ä¸º</p>
<pre class="line-numbers language-objectivec"><code class="language-objectivec">
<span class="token operator">-</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>viewDidDisappear<span class="token punctuation">:</span><span class="token punctuation">(</span>BOOL<span class="token punctuation">)</span>animated<span class="token punctuation">{</span>

    <span class="token punctuation">[</span><span class="token keyword">super</span> viewDidDisappear<span class="token punctuation">:</span>animated<span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">self</span><span class="token punctuation">.</span>wkWebView<span class="token punctuation">.</span>scrollView<span class="token punctuation">.</span>delegate <span class="token operator">=</span> nil<span class="token punctuation">;</span>

    <span class="token punctuation">[</span><span class="token keyword">self</span><span class="token punctuation">.</span>configuration<span class="token punctuation">.</span>userContentController removeScriptMessageHandlerForName<span class="token punctuation">:</span> OddityWkWebViewConfiguration<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>å¥½äº†ï¼Œä¸å´©æºƒäº†ã€‚</p>
]]></content>
      
        <categories>
            
            <category> IOS </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Systematic distinction </tag>
            
            <tag> WebKit </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Autolayout å’Œ size-class ç®€æ˜æ•™ç¨‹]]></title>
      <url>http://www.msiter.com/2016/11/21/Autolayout%20%E5%92%8C%20size-class%20%E7%AE%80%E6%98%8E%E6%95%99%E7%A8%8B/</url>
      <content type="html"><![CDATA[<p><img class = "g-pl-90"  src="http://image.msiter.com/stock-photo-184089425.jpg" alt="" title="è®©ä½ éš¾è¿‡çš„äº‹æƒ…ï¼Œæœ‰ä¸€å¤©ï¼Œä½ ä¸€å®šä¼šç¬‘ç€è¯´å‡ºæ¥ã€‚"></p>
<h2 id="æ•™ç¨‹å¼€å§‹å‰çš„åºŸè¯è¿ç¯‡"><a href="#æ•™ç¨‹å¼€å§‹å‰çš„åºŸè¯è¿ç¯‡" class="headerlink" title="æ•™ç¨‹å¼€å§‹å‰çš„åºŸè¯è¿ç¯‡"></a>æ•™ç¨‹å¼€å§‹å‰çš„åºŸè¯è¿ç¯‡</h2><p>åœ¨iphone5å‡ºç°ä¹‹åï¼Œä¹Ÿå°±æ˜¯ios6çš„æ—¶å€™ã€‚çº¦æŸ(autolayout)å‡ºç°äº†ï¼Œå…¶å®æœ€å¼€å§‹çš„æ—¶å€™ï¼Œios deverä»¬éƒ½è¿˜æ˜¯åšæŒæ‰‹å†™ä»£ç ï¼Œæ¯•ç«Ÿè‡ªå·±ç”¨äº†å¥½å‡ å¹´äº†ï¼Œä½ è¯´æ¢å°±æ¢ï¼Œç°åœ¨çš„éœ€æ±‚ä½ å¸®æˆ‘å†™å•Šï¼Ÿæ‰€ä»¥å¯¼è‡´å½“æ—¶ä½¿ç”¨çº¦æŸçš„å°‘ä¹‹åˆå°‘ï¼Œç›´è‡³åæ¥å‡ºç°äº†æ¨ªå±å’Œç«–å±ä¹‹ç±»é€‚é…ï¼Œè€Œä¸”å±å¹•æ›´å¤šç¹å¤šçš„æ—¶å€™ï¼Œæ‰‹å†™ä»£ç å·²ç»è¶Šæ¥è¶Šä¸å¤ªèƒ½æ‹…ä»»è¿™ä¸ªä»»åŠ¡çš„æ—¶å€™ï¼Œæ‰å¼€å§‹æ…¢æ…¢çš„è¿›å…¥äº†è¿™ä¸ªå¤§æ½®<br><a id="more"></a><br>è€Œæˆ‘æ¯”è¾ƒå¹¸è¿ï¼Œåœ¨iphone5çš„æ—¶å€™ç¬¬ä¸€æ¬¡æ‹¥æœ‰äº†iphoneæ‰‹æœºï¼Œåœ¨æˆ‘å­¦ä¹ iosçš„æ—¶å€™ï¼Œiphone6å’Œswiftè¿™ä¸¤ä¸ªä¸œè¥¿å‡ºç°äº†ã€‚æ‰€ä»¥æˆ‘æœ€å¼€å§‹å­¦ä¹ çš„æ—¶å€™å°±æ˜¯ä½¿ç”¨ storyboardå’Œçº¦æŸä¸€èµ·å­¦ä¹ çš„<br>å¥½äº†åºŸè¯ä¸å¤šè¯´äº†ã€‚çº¦æŸåˆ°åº•æ˜¯ä»€ä¹ˆä¸œè¥¿å‘¢ï¼Ÿ<br>å…¶å®è¯´ç™½äº†ä»–æ˜¯ä¸€ç§æè¿°æ€§çš„å¸ƒå±€æ–¹å¼ã€‚ä»€ä¹ˆæ˜¯æè¿°ï¼Ÿæ¯”å¦‚è¯´ã€‚â€œå’³å’³ï¼Œè¿™ä¸ªå›¾ç‰‡è·ç¦»è¿™ä¸ªæŒ‰é’®çš„å³è¾¹10åƒç´ ï¼Œè·ç¦»å±å¹•ä¸Šæ–¹10åƒç´ ï¼å›¾ç‰‡çš„å¤§å°æ˜¯80x80â€ã€‚è¿™å°±å«åšæè¿°ï¼Œè¿™æ ·æˆ‘ä»¬çš„å‰è¾ˆä»¬(appleçš„å¼€å‘äººå‘˜ä»¬)ï¼Œå°±ä¼šæŠŠæˆ‘ä»¬çš„æè¿°è§£ææˆç›¸å¯¹åº”çš„å¸ƒå±€æ–¹å¼ï¼Œå®Œæˆå›¾ç‰‡ä½ç½®çš„æ”¾ç½®ã€‚<br>å…¶å®è¯´åˆ°å¸ƒå±€ï¼Œæ— è®ºæ‰‹å†™ä»£ç è¿˜æ˜¯xib,sb(storyboard)éƒ½å¯ä»¥è¿›è¡Œçº¦æŸçš„ç¼–ç çš„ã€‚</p>
<p>æˆ‘ä»¬æ•™ç¨‹é¦–å…ˆå­¦ä¹  sb,xibè¿™ä¸€ç±»çš„å¸ƒå±€ï¼Œå› ä¸ºè¿™æ ·å’±ä»¬å¯ä»¥å¾ˆç›´è§‚çš„çœ‹åˆ°çº¦æŸå¯¹äºviewçš„å¸ƒå±€å½±å“ã€‚å½“æˆ‘ä»¬è¶³å¤Ÿç†Ÿæ‚‰å¸ƒå±€çš„æ—¶å€™ï¼Œå†è½¬å…¥æ‰‹å†™å¸ƒå±€ä¼šæ–¹ä¾¿å¾ˆå¤š<br>è¿™ç¯‡æ•™ç¨‹å°†ä»¥è¿™å‡ ä¸ªæ–¹é¢è¿›è¡Œè®²è§£</p>
<ol>
<li>XIB StoryBoard çº¦æŸè®¾ç½®</li>
<li>NSLayoutConstraint çº¦æŸè®¾ç½®</li>
<li>VFL çº¦æŸè®¾ç½®</li>
<li>NSLayoutAnchor çº¦æŸè®¾ç½®</li>
<li>ç¬¬ä¸‰æ–¹çº¦æŸè®¾ç½®</li>
<li>ä¾‹å­æ€»ç»“ ï¼ å®ä¾‹</li>
<li>æ€»ç»“</li>
</ol>
<h2 id="XIB-StoryBoard-çº¦æŸè®¾ç½®"><a href="#XIB-StoryBoard-çº¦æŸè®¾ç½®" class="headerlink" title="XIB StoryBoard çº¦æŸè®¾ç½®"></a>XIB StoryBoard çº¦æŸè®¾ç½®</h2><p>åœ¨æˆ‘ä»¬å­¦ä¹ ä¹‹å‰ï¼Œè¯·ä½ ä»¬è‡ªå·±å»ºç«‹ä¸€ä¸ªé¡¹ç›®ã€‚æ‰“å¼€storyboardçš„é¢„è§ˆç•Œé¢ï¼Œå’±ä»¬åœ¨ç•Œé¢çš„æœ€ä¸‹æ–¹<br><img src="http://7xt8nx.com1.z0.glb.clouddn.com/AutoLayout/BE5B8FF5-250A-44DF-BB08-343FEA76D7FC.jpeg" alt="" title="storyboardçš„é¢„è§ˆç•Œé¢"></p>
<p>ä¸‹æ–¹æœ‰ä¸‰ä¸ªbuttonï¼Œåˆ†åˆ«æ˜¯ <code>align</code>  <code>pin</code>  <code>resole auto layout issues</code></p>
<h3 id="align"><a href="#align" class="headerlink" title="align:"></a>align:</h3><p>è‹±æ–‡è§£é‡Šçš„æ„æ€ä¸ºæ’åºï¼Œé‚£ä¹ˆæˆ‘ä»¬å³å¯ä»¥ç†è§£ä¸ºï¼Œæ’åºâ€¦ç‚¹å‡»å±•å¼€é€‰é¡¹ï¼Œæˆ‘ä¼šæŒ¨ä¸ªè§£é‡Šä¸€ä¸‹ã€‚</p>
<p><img src="http://image.msiter.com/AutoLayout/A09775AE-9029-4D6B-B158-7B0DF235BDCF.png" alt="" title="align å±•å¼€ç¤ºä¾‹"></p>
<blockquote>
<p>psé€‰é¡¹ä¸€å…±æœ‰4ä¸ªç±»åˆ«ã€‚ç¬¬ä¸€ç±»å’Œç¬¬äºŒç±»æ˜¯éœ€è¦é€‰ä¸­ä¸¤ä¸ªæˆ–è€…å¤šä¸ªçš„viewçš„æ—¶å€™ï¼Œæ‰å¯ä»¥æ“ä½œ  </p>
</blockquote>
<ol>
<li><code>Leading Edges</code> é€‰ä¸­çš„viewsä»¬ <code>å·¦</code> å¯¹é½</li>
<li><code>Trailing Edges</code>  é€‰ä¸­çš„viewsä»¬ <code>å³</code> å¯¹é½</li>
<li><code>Top Edges</code>  é€‰ä¸­çš„viewsä»¬ <code>ä¸Š</code> å¯¹é½</li>
<li><code>Bottom Edges</code>  é€‰ä¸­çš„viewsä»¬ <code>ä¸‹</code> å¯¹é½</li>
<li><code>Horizontal Centers</code> é€‰ä¸­çš„viewsä»¬ <code>æ°´å¹³æ–¹å‘</code> ä¸­å¿ƒå¯¹é½</li>
<li><code>Vertical Centers</code> é€‰ä¸­çš„viewsä»¬  <code>å‚ç›´æ–¹å‘</code> ä¸­å¿ƒå¯¹é½</li>
<li><code>Baselines</code> é€‰ä¸­çš„viewsä»¬åŸºäº <code>åŸºçº¿</code> å¯¹é½</li>
<li><code>Horizontally in Container</code> é€‰ä¸­çš„è§†å›¾ ç›¸å¯¹äº çˆ¶è§†å›¾ è¿›è¡Œ <code>æ°´å¹³æ–¹å‘</code> å¯¹é½</li>
<li><code>Vertical in Container</code> é€‰ä¸­çš„è§†å›¾ ç›¸å¯¹äº çˆ¶è§†å›¾ è¿›è¡Œ <code>å‚ç›´æ–¹å‘</code> å¯¹é½</li>
<li><code>Update Frames None</code> å†è®¾ç½®äº†è¿™äº›çº¦æŸä¹‹åä¸è¿›è¡ŒFrameçš„æ›´æ”¹</li>
<li><code>Update Frames Items of New Constraints</code> è®¾ç½®äº†è¿™äº›çº¦æŸä¹‹å åªæ›´æ”¹é€‰ä¸­çš„è¿™äº›viewsçš„Frame</li>
<li><code>Update Frames All Frames in Container</code> æ›´æ”¹è¯¥ vc é‡Œæ‰€æœ‰Viewçš„çº¦æŸ (æ…ç”¨!!!!!!)        </li>
</ol>
<h3 id="pin"><a href="#pin" class="headerlink" title="pin:"></a>pin:</h3><p>è‹±æ–‡è§£é‡Šä¸º å¤§å¤´é’ˆï¼Œå…¶å®æˆ‘ä»¬å°±å¯ä»¥ä¸ºï¼Œè¿™ä¸ªå±•å¼€é¡¹å†…çš„æ‰€æœ‰çš„ç°è±¡éƒ½æ˜¯ä¸ºäº†å°†è§†å›¾è®¢åœ¨æŸä¸€ä¸ªä½ç½®çš„ã€‚é‚£ä¹ˆæˆ‘ä»¬å†æ¬¡å±•å¼€é€‰é¡¹</p>
<p><img src="http://7xt8nx.com1.z0.glb.clouddn.com/AutoLayout/C0610ECB-64F0-453B-B587-55E5967F5287.png" alt="" title="pin å±•å¼€ç¤ºä¾‹"></p>
<ol>
<li><code>ä¸Šæ–¹çš„è¾“å…¥æ¡†</code> è¿™ä¸ªè¾“å…¥æ¡†æ—¶è¡¨ç¤ºå½“å‰é€‰ä¸­çš„viewsæˆ–è€…viewè·ç¦»çˆ¶è§†å›¾çš„ä¸Šæ–¹è·ç¦»ä¸ºå¤šå°‘ï¼Œå·¦å³ä¸‹åŒç†ï¼Œä¸ä¸€ä¸€èµ˜è¿°äº†</li>
<li>è€Œç‚¹å‡»è¿™ä¸ªå€’ä¸‰è§’å¼€å¯çš„é€‰é¡¹ä¸­<ol>
<li><code>User Standard Value</code> æ˜¯è¯´ä½¿ç”¨æ ‡å‡†çš„çš„å€¼ï¼Œè€Œä¸”è¿™ä¸ªå€¼åªæœ‰åœ¨æ˜¯è®¾ç½®ä¸Šä¸‹æ–¹å‘çš„æ—¶å€™æ‰æœ‰ç”¨ã€‚é»˜è®¤çš„å€¼å…¶å®å°±æ˜¯è·ç¦» Bottom Layout Guideï¼Œä¹Ÿå°±æ˜¯ä¸Šä¸‹åŸºçº¿ã€‚ä¸‹åŸºçº¿å°±æ˜¯è·ç¦»è§†å›¾æœ€åº•éƒ¨ã€‚ä¸ŠåŸºçº¿å°±æ˜¯è·ç¦»StatusViewä¸‹æ–¹çš„ä½ç½®ã€‚è€Œè¿™é‡Œçš„é»˜è®¤å€¼å…¶å®æ˜¯8</li>
<li><code>User Current Canvas Value</code> ä½¿ç”¨å½“å‰ä½ç½®è®¾ç½®ã€‚é»˜è®¤ä¸ºå½“å‰è®¾ç½®æ–¹å‘æœ€è¿‘çš„ä¸€ä¸ªVIewï¼Œä¸”æ²¡æœ‰è¦†ç›–é®æŒ¡çš„è§†å›¾</li>
<li>å‰©ä¸‹çš„é€‰é¡¹ï¼Œä¼šæ ¹æ®å½“å‰è§†å›¾çš„å¸ƒç½®æƒ…å†µæœ‰æ‰€ä¸åŒï¼Œä½†æ˜¯é“ç†ç›¸å½“ï¼Œè¿™ä¸ªé€‰é¡¹æ˜¯è®©ä½ è®¾ç½®ä½ è¦æ ¹æ®é‚£ä¸ªè§†å›¾è¿›è¡Œå½“å‰ä½ç½®è·ç¦»çš„è®¾ç½®çš„</li>
</ol>
</li>
<li><code>Width</code> å’Œ <code>Height</code> è¿™ä¸ªä¸éœ€è¦æˆ‘èµ˜è¿°äº†å§ã€‚åˆ†åˆ«æ˜¯ å®½åº¦å’Œé«˜åº¦ çš„è®¾ç½®</li>
<li><code>Constarain to Margins</code>. è¿™ä¸ªæ˜¯å¦éœ€è¦å¤–è¾¹è· é»˜è®¤ä¸º 8 ã€‚ä¸€èˆ¬æ²¡å•¥åµç”¨ï¼Œéƒ½ä¼šå»æ‰</li>
<li><code>Equal Widths</code> å’Œ Equal Heights è¿™ä¸¤ä¸ªé€‰é¡¹éœ€è¦é€‰æ‹©ä¸¤ä¸ªè§†å›¾ã€‚æ¯”å¦‚é€‰ä¸­View1å’ŒView2ï¼Œé‚£ä¹ˆå¯ä»¥åˆ†åˆ«è®¾ç½®è¿™ä¸ªä¸¤ä¸ªè§†å›¾å®½åº¦å’Œé«˜åº¦ç›¸ç­‰</li>
<li><code>Aspect Ratio</code> è¿™ä¸ªå±æ€§æ˜¯è®¾ç½®é€‰ä¸­Viewçš„æ¯”ä¾‹ã€‚å½“ä½ ç‚¹å‡»è®¾ç½®çš„æ—¶å€™ï¼Œé»˜è®¤ä»–ä¼šè®¾ç½®å½“å‰è§†å›¾çš„æ¯”ä¾‹ã€‚æ¯”å¦‚ä½ çš„Viewé«˜åº¦ä¸º40å®½åº¦ä¸º30ã€‚é‚£ä¹ˆä½ çš„æ¯”ä¾‹å°±å°†è®¾ç½®ä¸º3:4. å¦‚æœä½ å¸Œæœ›ä¿®æ”¹è¿™ä¸ªæ¯”ä¾‹çš„å±æ€§ï¼Œå’±ä»¬åœ¨è®²å®Œè¿™ä¸‰ä¸ªä¸œè¥¿ä¹‹åï¼Œæˆ‘ä¼šè®²è§£</li>
<li><code>Align</code> è¿™ä¸ªä¸œè¥¿ä½ ä¸å¾—ä¸æ‰¿è®¤è¿™ä¸ªä¸œè¥¿å’Œå’±ä»¬å­¦ä¹ çš„ç¬¬ä¸€ä¸ªAligné‡å¤çš„â€¦ åœ¨è¿™é‡Œå°±ä¸èµ˜è¿°äº†</li>
<li><code>Update Frames</code> è¿™ä¸ªæŸ¥çœ‹ä¸Šé¢ Aligné€‰é¡¹çš„è¿™ä¸ªå±æ€§å°±å¥½äº†</li>
</ol>
<h3 id="resole-auto-layout-issues"><a href="#resole-auto-layout-issues" class="headerlink" title="resole auto layout issues"></a>resole auto layout issues</h3><p>ä»–çš„è¿™ä¸ªè§£é‡Šå·²ç»å¾ˆå¥½ç†è§£äº†ï¼Œè‡ªåŠ¨å¸ƒå±€é—®é¢˜çš„è§£å†³ã€‚å°±æ˜¯å¦‚æœä½ åœ¨å¸ƒå±€çš„<br>æ—¶å€™å‡ºç°äº†ä¸€äº›é—®é¢˜ã€‚æ¯”å¦‚ï¼Œå’±ä»¬å†è®¾ç½®çº¦æŸä¹‹åï¼Œå‡ºç°é»„è‰²æˆ–è€…çº¢è‰²çš„çš„é¢œè‰²çš„æ—¶å€™ã€‚å°±éœ€è¦ä½¿ç”¨ä»¥ä¸‹æ–¹å¼ä¿®æ”¹ã€‚çº¢è‰²è¯´æ˜å’±ä»¬è®¾ç½®çš„çº¦æŸæœ‰ç¼ºå¤±æˆ–è€…æœ‰å†²çªçš„é—®é¢˜ï¼Œé»„è‰²åˆ™è¯´æ˜ï¼Œçº¦æŸæ­£ç¡®ï¼Œä½†æ˜¯å½“å‰Viewçš„Frameå’Œçº¦æŸæè¿°çš„Frameä¸ä¸€è‡´</p>
<p><img src="http://7xt8nx.com1.z0.glb.clouddn.com/AutoLayout/FF75AD66-382E-4735-A5EA-8F462C83EAF7.png" alt="" title="resole auto layout issues å±•å¼€ç¤ºä¾‹"></p>
<p>çœ‹åˆ°ä»¥ä¸Šè§†å›¾å’±ä»¬å¯ä»¥çœ‹å‡ºå®ƒåˆ†ä¸ºä¸¤ä¸ªè€Œä¸”è¿™ä¸¤ç§é™¤äº†åå­—ä¸ä¸€æ ·ï¼Œé€‰é¡¹æ˜¯ä¸€æ‘¸ä¸€æ ·çš„é¢ã€‚Selected Views è¿™ä¸ªè¯´çš„å°±æ˜¯ä½ è¦å¤„ç†çš„çº¦æŸé—®é¢˜æ˜¯å½“å‰ä½ é€‰ä¸­çš„Viewï¼Œè€ŒAll Views in View Controllerï¼Œåˆ™æ˜¯è¯´æ˜è¦è§£å†³çš„çº¦æŸé—®é¢˜æ˜¯è¿™ä¸ªViewControlleræ‰€æœ‰çš„VIewçš„(è¿™ä¸ªå¯å¾—æ…é‡çš„)ã€‚</p>
<ol>
<li><code>Update Frames</code> ä¿®æ”¹Frameï¼Œå½“ä½ çš„çº¦æŸè®¾ç½®æ­£ç¡®ä½†æ˜¯Frameä¸å¯¹çš„æ—¶å€™ä½¿ç”¨è€…é€‰é¡¹å¯ä»¥è®²Viewçš„Frameå±•ç¤ºæˆä¸ºçº¦æŸæ‰€æè¿°çš„æ ·å­</li>
<li><code>Update Constaints</code> è€Œè¿™ä¸ªé€‰é¡¹ï¼Œè¯´å®è¯æˆ‘æ²¡ç”¨è¿‡ã€‚ä»–çš„æ„æ€å’±ä»¬ä¹Ÿå¯ä»¥çŸ¥é“ä»–æ˜¯é€šè¿‡Frame å»ä¿®æ”¹ çº¦æŸâ€¦â€¦</li>
<li><code>Add Missing Constraints</code> æ·»åŠ ç¼ºå¤±çš„çº¦æŸï¼Œè¿™ä¸ªé€‰é¡¹æˆ‘ä¹Ÿæ²¡ä½¿ç”¨è¿‡ï¼Œå› ä¸ºè¿™ä¸ªæ–¹æ³•æ·»åŠ çš„ç¼ºå¤±çš„çº¦æŸä¸ä¸€å®šå°±æ˜¯æ­£ç¡®çš„çº¦æŸï¼Œåœ¨å®é™…è¿è¡Œä¸­è‚¯å®šä¼šå‡ºç°é—®é¢˜æ‰€ä»¥å°½é‡è‡ªå·±æŠŠç¼ºå¤±çš„çº¦æŸè‡ªå·±æ·»åŠ äº†ã€‚</li>
<li><code>Reset to Suggested Constaints</code> é‡æ–°è®¾ç½®å»ºè®®çš„çº¦æŸï¼Ÿæ²¡ä½¿ç”¨è¿‡ï¼Œä¸çŸ¥é“ä»€ä¹ˆæ„æ€</li>
<li><code>Clear Constraints</code> æ¸…é™¤çº¦æŸï¼Œä¼šåˆ é™¤é€‰ä¸­çš„è§†å›¾çš„æ‰€æœ‰çš„çº¦æŸã€‚åœ¨All Views in View Controller ä½ è¦æ˜¯åšè¿™ä¸ªé€‰é¡¹çš„æ—¶å€™å¯å¾—æ…é‡ï¼Œä½¿ç”¨äº†å°±è¯´æ˜ä½ è¦åˆ é™¤å½“å‰VCæ‰€æœ‰çš„çº¦æŸã€‚å½“ç„¶ä½ å¯ä»¥ <code>ctrl-z</code></li>
</ol>
<h3 id="åé¢çš„è¯"><a href="#åé¢çš„è¯" class="headerlink" title="åé¢çš„è¯"></a>åé¢çš„è¯</h3><p>åœ¨è¯´äº†è¿™äº›ä¹‹åï¼Œå…¶å®å’±ä»¬åº”è¯¥å·²ç»å¯ä»¥è¿›è¡Œçº¦æŸçš„è®¾ç½®äº†ï¼Œä½†æ˜¯è¿˜æœ‰å¾ˆå¤šé—®é¢˜ï¼Œå…¶ä¸­æˆ‘ç°åœ¨è¯´ä¸€ä¸‹å¿«é€Ÿè®¾ç½®çš„é—®é¢˜ã€‚å½“ä½ åœ¨è¿™ä¸ªå±‚æ¬¡viewé€‰æ‹©å™¨ä¸­ï¼ˆå›¾1ï¼‰ã€‚</p>
<p><img src="http://7xt8nx.com1.z0.glb.clouddn.com/AutoLayout/5FF17D89-6D56-4A5E-B24F-42245511D5EC.png" alt="" title="å›¾ä¸€"><br><img src="http://7xt8nx.com1.z0.glb.clouddn.com/AutoLayout/0666C110-0858-486F-8258-9E10FE48FC7E.png" alt="" title="å›¾äºŒ"><br><img src="http://7xt8nx.com1.z0.glb.clouddn.com/AutoLayout/3185DBB0-5168-43A4-8515-356F1AA8D1FE.png" alt="" title="å›¾ä¸‰"></p>
<ol>
<li>å¿«é€Ÿè®¾ç½®çš„é—®é¢˜ã€‚æˆ‘ä»¬å¯ä»¥åœ¨Viewä¸ŠæŒ‰ä½Ctrl é”®ä¹‹åå·¦é”®æ‹–æ‹½åˆ°viewæœ¬èº«æˆ–è€…å…¶ä»–Viewæ¥å¿«é€Ÿçš„è®¾ç½®ä¸€äº›å±æ€§ï¼Œå…·ä½“çš„å±æ€§ï¼Œå’±ä»¬è‡ªå·±çœ‹å§ã€‚ä»–åªæ˜¯ä¸€ç§å¿«æ·æ–¹å¼ï¼Œåœ¨å±æ€§è®¾ç½®ä¸Šæ²¡æœ‰ä»»ä½•åŒºåˆ«çš„ï¼Œè¿™é‡Œå°±ä¸ä¸€ä¸€èµ˜è¿°äº†</li>
<li>å¿«é€Ÿè§£å†³çº¦æŸé—®é¢˜çš„å¿«æ·é”®ã€‚å½“æˆ‘ä»¬çš„Viewçš„çº¦æŸæ­£ç¡®çš„è€Œframæ²¡æœ‰æ˜¾ç¤ºæ­£ç¡®çš„ä½ç½®çš„æ—¶å€™æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ resole auto layout issues è¿›è¡Œä¿®æ”¹ï¼Œä½†æ˜¯æ¯æ¬¡éƒ½è¦æ‰“å¼€è¿™é€‰é¡¹å®åœ¨æ˜¯å¤ªéº»çƒ¦äº†ã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥é€‰æ‹©ä¸€ä¸ªå¿«æ·é”®ã€‚å°±æ˜¯ osx ï¼š <code>comment+alt+=</code>  è€Œwindow åˆ™ä¸º <code>window+alt+=</code>  å¿«é€Ÿä¿®æ”¹çº¦æŸ</li>
<li>è®¾ç½®UIScrollViewçš„æ—¶å€™ï¼Œå› ä¸ºç‰µæ‰¯åˆ°è¦è®¾ç½®ScrollView ContainView çš„é«˜åº¦å®½åº¦çš„é—®é¢˜ï¼Œæ‰€ä»¥å†è®¾ç½® ScrollView å­View çš„æ—¶å€™ä¸€å®šè¦æ˜ç¡®ä¸€ä¸ªé“ç†ï¼  å°±æ˜¯æ¯”å¦‚ä¿è¯ å­è§†å›¾çš„çº¦æŸç»“åˆèµ·æ¥ä¹‹åå¯ä»¥è®© containViewçŸ¥é“è‡ªå·±çš„é«˜åº¦å’Œå®½åº¦ï¼Œå¦‚æœç¼ºå¤±ï¼Œå°†å¯¼è‡´çº¦æŸå¤±è´¥ã€‚</li>
<li>ä¿®æ”¹çº¦æŸçš„é—®é¢˜ï¼Œå’±ä»¬åœ¨ä¿®æ”¹çº¦æŸçš„æ—¶å€™ä¹Ÿæ˜¯åœ¨viewçš„é€‰æ‹©å™¨ä¸­ã€‚é€‰ä¸­ä½ è¦ä¿®æ”¹çš„VIewä¹‹ååœ¨æœ€å·¦ä¾§çš„å·¥å…·ç®±ä¸­ï¼ˆå›¾2ï¼‰ã€‚å¯ä»¥çœ‹åˆ°æˆ‘ä»¬é»„æ¡†æ ‡æ³¨å‡ºçš„çº¦æŸã€‚ç‚¹å‡»Editå°±å¯ä»¥ä¿®æ”¹å’±ä»¬çº¦æŸçš„å±æ€§äº†<ol>
<li>Constant  è¿™ä¸ªè¾“å…¥æ¡†å°±æ˜¯çº¦æŸçš„å€¼ï¼Œè€Œå¤§äºç­‰äºï¼Œå°äºç­‰äºä»¥åŠç­‰äºéœ€è¦å’±ä»¬æ ¹æ®å®é™…æƒ…å†µè¿›è¡Œè‡ªå·±åˆ†è¾¨è®¾ç½®</li>
<li>Priority ä¼˜å…ˆçº§åˆ«ï¼Œè¿™ä¸ªåˆ†åˆ«ä¸º 1000(æœ€é«˜)ï¼Œ 750(ä¸­),250(ä½)ã€‚ä¸‰ä¸ªé€‰é¡¹ï¼Œè¿™ä¸ªæˆ‘æ²¡æœ‰ä½¿ç”¨è¿‡ï¼Œä¸è¿‡ä¼°è®¡æ˜¯æƒ³ä¸¤ä¸ªçº¦æŸå‘ç”Ÿå®é™…è¿è¡Œä¸­çš„å†²çªçš„æ—¶å€™ è¿›è¡Œä¼˜å…ˆçº§æ˜¾ç¤ºçš„æ–¹æ³•å§</li>
<li>Multiplier è¿™ä¸ªå°±æ˜¯è®¾ç½®æ¯”ä¾‹çš„åœ°æ–¹ï¼Œå°±æ˜¯å’±ä»¬ä¹‹å‰è¯´çš„ã€‚è€Œè¿™ä¸ªè®¾ç½®æ˜¯éå¸¸å¥½ç©çš„ä¸€ä¸ªè®¾ç½®ï¼Œå½“ç„¶ä»–ä¹Ÿæœ‰ä½¿ç”¨çš„å±€é™ï¼Œåœ¨è®¾ç½®è§†å›¾çš„å®½åº¦å’Œé«˜åº¦çš„æ—¶å€™è¿™ä¸ªæ˜¯ç”¨ä¸äº†çš„ï¼Œæ˜¯è®¾ç½®æ¯”å¦‚ è·ç¦»å››å‘¨çš„ä½ç½®ï¼Ÿå±…ä¸­ï¼Œæˆ–è€…ä¸¤ä¸ªè§†å›¾çš„å®½åº¦é«˜åº¦ç›¸ç­‰çš„æ—¶å€™,æˆ–è€…æ¯”ä¾‹è®¾ç½®çš„æ—¶å€™ï¼Œæ‰ä¼šå¯ä»¥è®¾ç½®ã€‚è¿™ä¸ªæˆ‘è¿˜æ²¡æœ‰å¾ˆå¤šç–‘é—®ã€‚æ‰€ä»¥åœ¨æˆ‘æµ‹è¯•å®Œæˆåï¼Œä¼šè¿›è¡Œä¿®æ”¹</li>
</ol>
</li>
</ol>
<h2 id="NSLayoutConstraint-çº¦æŸè®¾ç½®"><a href="#NSLayoutConstraint-çº¦æŸè®¾ç½®" class="headerlink" title="NSLayoutConstraint çº¦æŸè®¾ç½®"></a>NSLayoutConstraint çº¦æŸè®¾ç½®</h2><p>ä½¿ç”¨NSLayoutConstraintæ˜¯Appleåœ¨å‡ºçº¦æŸçš„æ—¶å€™å‡ºç°çš„ï¼Œä¹Ÿå°±æ˜¯å®˜æ–¹æ¨èç”¨æˆ·ä½¿ç”¨è¿™ä¸ªä¸œè¥¿ï¼Œæˆ–è€…sbå’Œxibã€‚è‡³å°‘å½“æ—¶æ˜¯è¿™æ ·çš„é¢ã€‚ä½†æ˜¯â€¦è¿™ä¸ªä¸œè¥¿çš„è´¹äº‹å„¿æˆéƒ½è¶…å‡ºä½ çš„æƒ³è±¡</p>
<h3 id="æ–¹æ³•ä»‹ç»"><a href="#æ–¹æ³•ä»‹ç»" class="headerlink" title="æ–¹æ³•ä»‹ç»"></a>æ–¹æ³•ä»‹ç»</h3><pre class="line-numbers language-swift"><code class="language-swift"><span class="token keyword">public</span> <span class="token keyword">enum</span> <span class="token builtin">NSLayoutAttribute</span> <span class="token punctuation">:</span> <span class="token builtin">Int</span> <span class="token punctuation">{</span>
    <span class="token keyword">case</span> <span class="token keyword">left</span>
    <span class="token keyword">case</span> <span class="token keyword">right</span>
    <span class="token keyword">case</span> top
    <span class="token keyword">case</span> bottom
    <span class="token keyword">case</span> leading
    <span class="token keyword">case</span> trailing
    <span class="token keyword">case</span> width
    <span class="token keyword">case</span> height
    <span class="token keyword">case</span> centerX
    <span class="token keyword">case</span> centerY
    <span class="token keyword">case</span> lastBaseline
    @<span class="token function">available</span><span class="token punctuation">(</span>iOS <span class="token number">8.0</span><span class="token punctuation">,</span> <span class="token operator">*</span><span class="token punctuation">)</span>
    <span class="token keyword">case</span> firstBaseline
    @<span class="token function">available</span><span class="token punctuation">(</span>iOS <span class="token number">8.0</span><span class="token punctuation">,</span> <span class="token operator">*</span><span class="token punctuation">)</span>
    <span class="token keyword">case</span> leftMargin
    @<span class="token function">available</span><span class="token punctuation">(</span>iOS <span class="token number">8.0</span><span class="token punctuation">,</span> <span class="token operator">*</span><span class="token punctuation">)</span>
    <span class="token keyword">case</span> rightMargin
    @<span class="token function">available</span><span class="token punctuation">(</span>iOS <span class="token number">8.0</span><span class="token punctuation">,</span> <span class="token operator">*</span><span class="token punctuation">)</span>
    <span class="token keyword">case</span> topMargin
    @<span class="token function">available</span><span class="token punctuation">(</span>iOS <span class="token number">8.0</span><span class="token punctuation">,</span> <span class="token operator">*</span><span class="token punctuation">)</span>
    <span class="token keyword">case</span> bottomMargin
    @<span class="token function">available</span><span class="token punctuation">(</span>iOS <span class="token number">8.0</span><span class="token punctuation">,</span> <span class="token operator">*</span><span class="token punctuation">)</span>
    <span class="token keyword">case</span> leadingMargin
    @<span class="token function">available</span><span class="token punctuation">(</span>iOS <span class="token number">8.0</span><span class="token punctuation">,</span> <span class="token operator">*</span><span class="token punctuation">)</span>
    <span class="token keyword">case</span> trailingMargin
    @<span class="token function">available</span><span class="token punctuation">(</span>iOS <span class="token number">8.0</span><span class="token punctuation">,</span> <span class="token operator">*</span><span class="token punctuation">)</span>
    <span class="token keyword">case</span> centerXWithinMargins
    @<span class="token function">available</span><span class="token punctuation">(</span>iOS <span class="token number">8.0</span><span class="token punctuation">,</span> <span class="token operator">*</span><span class="token punctuation">)</span>
    <span class="token keyword">case</span> centerYWithinMargins
    <span class="token keyword">case</span> notAnAttribute
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>åœ¨ç½‘ä¸Šçœ‹åˆ°ä¸€å¼ å›¾å¯ä»¥å¾ˆå¥½çš„è¯´æ˜é—®é¢˜ã€‚</p>
<p><img src="http://image.msiter.com/AutoLayout/NSLayoutAttribute.png" alt="" title="NSLayoutAttribute ç¤ºä¾‹"></p>
<p>ä»¥ä¸Šçš„å±æ€§å¾ˆå¤šå¤§å®¶è‚¯å®šéƒ½è‡ªå·±å¯ä»¥çœ‹æ‡‚ï¼Œæˆ‘ä¹Ÿå°±ä¸è¯´äº†ã€‚æˆ‘è¿™é‡Œå°±è¯´å‡ ä¸ªæ¯”è¾ƒè®©äººè§‰çš„ä¸è§£çš„åœ°æ–¹ã€‚</p>
<ol>
<li>æœ‰ <code>Margins</code> å’Œ æ²¡æœ‰ <code>Margins</code> çš„åŒºåˆ«åœ¨äºï¼Œå’±ä»¬åœ¨SB å’Œ xib ä¸­è®¾ç½®çš„ <code>Constarain to Margins</code> æ˜¯ä¸€ä¸ªæ•ˆæœ</li>
<li><code>Leading</code>  åœ¨ä¹ æƒ¯ä»å³è‡³å·¦çœ‹çš„åœ°åŒºï¼Œç›¸å½“äº<code>NSLayoutAttributeRight</code>; <br \=""> <code>Trailing</code>: åœ¨ä¹ æƒ¯ç”±å·¦å‘å³çœ‹çš„åœ°åŒºï¼Œç›¸å½“äº<code>NSLayoutAttributeRight</code>ï¼›åœ¨ä¹ æƒ¯ä»å³è‡³å·¦çœ‹çš„åœ°åŒºï¼Œç›¸å½“äº<code>NSLayoutAttributeLeft</code></li>
<li><code>lastBaseline</code> æ–‡å­—çš„ä¸‹åŸºçº¿  <code>firstBaseline</code> æ–‡å­—çš„ä¸ŠåŸºçº¿</li>
</ol>
<p>é¦–å…ˆä»–çš„æ–¹æ³•å¦‚ä¸‹ï¼š</p>
<pre class="line-numbers language-swift"><code class="language-swift"><span class="token comment" spellcheck="true">///  è·å¾—ä¸€ä¸ªçº¦æŸ</span>
<span class="token comment" spellcheck="true">///</span>
<span class="token comment" spellcheck="true">///  - parameter view1: ç¬¬ä¸€ä¸ªå¯¹è±¡ï¼Œé€šå¸¸å°±æ˜¯å’±ä»¬è¦è®¾ç½®çš„ç”¨æˆ·çš„View</span>
<span class="token comment" spellcheck="true">///  - parameter attr1:    ä½ è¦æ˜¯è®¾ç½®ä»–çš„é‚£ä¸ªå±æ€§ æŸ¥é˜…ä¸Šæ–¹ NSLayoutAttribute è§£é‡Š</span>
<span class="token comment" spellcheck="true">///  - parameter relation:   ä¸€ä¸ªEnumå¯¹è±¡ï¼Œ å¤§äºç­‰äº å°äºç­‰äº ç­‰äºï¼Œè‡ªå·±çœ‹çœ‹å§ï¼Œ ä¸èµ˜è¿°äº†</span>
<span class="token comment" spellcheck="true">///  - parameter view2:    ç¬¬äºŒä¸ªå¯¹è±¡ ä¸€èˆ¬æ˜¯ä½ è¦è®¾ç½®çš„Viewçš„SuperViewã€‚å¦‚æœä½ åªè®¾ç½®Viewçš„å®½åº¦æˆ–è€…é«˜åº¦è¿™äº›åªéœ€è¦ä¸€ä¸ªVIewå°±å¯ä»¥åšçš„è¿™ä¸ªå‚æ•°å°±ä¸ºnil</span>
<span class="token comment" spellcheck="true">///  - parameter attr2:    ç¬¬äºŒä¸ªå¯¹è±¡çš„ å±æ€§ã€‚ å¦‚æœç¬¬äºŒä¸ªå¯¹è±¡ä¸º nilã€‚åˆ™è¯¥å¯¹è±¡ä¸º  notAnAttribute</span>
<span class="token comment" spellcheck="true">///  - parameter multiplier:    å€æ•°ã€‚ è¿™é‡Œä¸èµ˜è¿°äº†ï¼ŒæŸ¥çœ‹ SB xib æ•™ç¨‹å°±å¥½äº†</span>
<span class="token comment" spellcheck="true">///  - parameter constant:    çº¦æŸçš„å€¼</span>
<span class="token comment" spellcheck="true">///</span>
<span class="token comment" spellcheck="true">///  - returns: NSLayoutConstraint</span>
<span class="token keyword">public</span> <span class="token keyword">convenience</span> <span class="token keyword">init</span><span class="token punctuation">(</span>item view1<span class="token punctuation">:</span> <span class="token builtin">Any</span><span class="token punctuation">,</span> attribute attr1<span class="token punctuation">:</span> <span class="token builtin">NSLayoutAttribute</span><span class="token punctuation">,</span> relatedBy relation<span class="token punctuation">:</span> <span class="token builtin">NSLayoutRelation</span><span class="token punctuation">,</span> toItem view2<span class="token punctuation">:</span> <span class="token builtin">Any</span><span class="token operator">?</span><span class="token punctuation">,</span> attribute attr2<span class="token punctuation">:</span> <span class="token builtin">NSLayoutAttribute</span><span class="token punctuation">,</span> multiplier<span class="token punctuation">:</span> <span class="token builtin">CGFloat</span><span class="token punctuation">,</span> constant c<span class="token punctuation">:</span> <span class="token builtin">CGFloat</span><span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>æˆ–è€…è¿™æ ·è¯´å¯èƒ½æ›´å¥½ç†è§£ä¸€ç‚¹<br><code>view1.attr1 [= , &gt;= , &lt;=] view2.attr2 * multiplier + constant</code></p>
<p>åœ¨è·å–çº¦æŸå®Œæˆä¹‹å<br>ä½¿ç”¨æ¯ä¸ªView æä¾›çš„æ–¹æ³•</p>
<pre class="line-numbers language-swift"><code class="language-swift"><span class="token keyword">extension</span> <span class="token builtin">UIView</span> <span class="token punctuation">{</span>


    @<span class="token function">available</span><span class="token punctuation">(</span>iOS <span class="token number">6.0</span><span class="token punctuation">,</span> <span class="token operator">*</span><span class="token punctuation">)</span>
    open <span class="token keyword">var</span> constraints<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token builtin">NSLayoutConstraint</span><span class="token punctuation">]</span> <span class="token punctuation">{</span> <span class="token keyword">get</span> <span class="token punctuation">}</span>


    @<span class="token function">available</span><span class="token punctuation">(</span>iOS <span class="token number">6.0</span><span class="token punctuation">,</span> <span class="token operator">*</span><span class="token punctuation">)</span>
    open <span class="token keyword">func</span> <span class="token function">addConstraint</span><span class="token punctuation">(</span><span class="token number">_</span> constraint<span class="token punctuation">:</span> <span class="token builtin">NSLayoutConstraint</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">// This method will be deprecated in a future release and should be avoided.  Instead, set NSLayoutConstraint's active property to YES.</span>

    @<span class="token function">available</span><span class="token punctuation">(</span>iOS <span class="token number">6.0</span><span class="token punctuation">,</span> <span class="token operator">*</span><span class="token punctuation">)</span>
    open <span class="token keyword">func</span> <span class="token function">addConstraints</span><span class="token punctuation">(</span><span class="token number">_</span> constraints<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token builtin">NSLayoutConstraint</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">// This method will be deprecated in a future release and should be avoided.  Instead use +[NSLayoutConstraint activateConstraints:].</span>

    @<span class="token function">available</span><span class="token punctuation">(</span>iOS <span class="token number">6.0</span><span class="token punctuation">,</span> <span class="token operator">*</span><span class="token punctuation">)</span>
    open <span class="token keyword">func</span> <span class="token function">removeConstraint</span><span class="token punctuation">(</span><span class="token number">_</span> constraint<span class="token punctuation">:</span> <span class="token builtin">NSLayoutConstraint</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">// This method will be deprecated in a future release and should be avoided.  Instead set NSLayoutConstraint's active property to NO.</span>

    @<span class="token function">available</span><span class="token punctuation">(</span>iOS <span class="token number">6.0</span><span class="token punctuation">,</span> <span class="token operator">*</span><span class="token punctuation">)</span>
    open <span class="token keyword">func</span> <span class="token function">removeConstraints</span><span class="token punctuation">(</span><span class="token number">_</span> constraints<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token builtin">NSLayoutConstraint</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">// This method will be deprecated in a future release and should be avoided.  Instead use +[NSLayoutConstraint deactivateConstraints:].</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>è¿™äº›å¤§å®¶æ ¹æ®åå­—å°±å¯ä»¥çœ‹æ‡‚çš„æˆ‘å°±ä¸è§£é‡Šäº†ã€‚è¿˜éœ€è¦æ³¨æ„çš„ä¸€ç‚¹å°±æ˜¯ï¼Œä¸€å®šè¦è®¾ç½®Viewçš„ <code>translatesAutoresizingMaskIntoConstraints</code> å±æ€§ä¸ºfalseã€‚å¦åˆ™ä¼šå‡ºç°é—®é¢˜ã€‚äººå®¶è¯´çš„ä¹Ÿå¾ˆæ˜ç™½ã€‚æˆ‘è¦ä¸è¦è‡ªå·±ç»™ä½ è°ƒæ•´ä½ç½®å‘¢ï¼Ÿå¦‚æœä½ æƒ³è‡ªå·±è°ƒæ•´çº¦æŸæ¥è°ƒæ•´ä½ç½®ï¼Œå°±æŠŠæˆ‘è®¾ç½®ä¸ºfalseå§ã€‚é»˜è®¤ä¸ºtrue</p>
<h2 id="VFL-çº¦æŸè®¾ç½®"><a href="#VFL-çº¦æŸè®¾ç½®" class="headerlink" title="VFL çº¦æŸè®¾ç½®"></a>VFL çº¦æŸè®¾ç½®</h2><p>ç»ˆäºè¿˜æ˜¯åˆ°äº†è¿™é‡Œäº†ï¼Œä¹‹å‰å­¦ä¹ è¿™ä¸ªçš„æ—¶å€™çœŸæ˜¯åƒéš¾ä¸‡éš¾ï¼Œè¿™ä¸ªä¸œè¥¿çœŸå¿ƒçš„ä¸æ€ä¹ˆå‹å¥½â€¦â€¦<br>åºŸè¯ä¸å¤šè¯´äº† VFLï¼ˆVisual Format Languageï¼‰è¢«ç§°ä¸º â€œå¯è§†åŒ–æ ¼å¼è¯­è¨€â€ï¼Œæ˜¯è‹¹æœå…¬å¸ä¸ºäº†ç®€åŒ–autolayoutçš„ç¼–ç è€Œæ¨å‡ºçš„æŠ½è±¡è¯­è¨€ã€‚</p>
<table class = "table table-bordered">
<thead>
<tr>
<th>åŠŸèƒ½</th>
<th style="text-align:center">å†™æ³•</th>
<th style="text-align:left">å«ä¹‰</th>
</tr>
</thead>
<tbody>
<tr>
<td>æ°´å¹³æ–¹å‘</td>
<td style="text-align:center">H: æˆ– V:</td>
<td style="text-align:left">H è¯´æ˜ä¹‹åçš„å¥å­éƒ½æ˜¯åœ¨æ°´å¹³æ–¹å‘è®¾ç½®çº¦æŸçš„ V åˆ™æ˜¯å‚ç›´æ–¹å‘ã€‚é»˜è®¤æ–¹å‘ä¸º H æ°´å¹³æ–¹å‘</td>
</tr>
<tr>
<td>Views</td>
<td style="text-align:center">[view]</td>
<td style="text-align:left">è¦è®¾ç½®çš„viewä»¬</td>
</tr>
<tr>
<td>SuperView</td>
<td style="text-align:center">&#124;</td>
<td style="text-align:left">viewä»¬æ‰€åœ¨çš„çˆ¶è§†å›¾</td>
</tr>
<tr>
<td>å…³ç³»</td>
<td style="text-align:center">&gt;=,==,&lt;=</td>
<td style="text-align:left">NSLayoutRelation</td>
</tr>
<tr>
<td>ç©ºé—´ï¼Œé—´éš™</td>
<td style="text-align:center">-</td>
<td style="text-align:left">-30- è¯´æ˜ä¹‹é—´çš„ç©ºéš™ä¸º30</td>
</tr>
<tr>
<td>ä¼˜å…ˆçº§</td>
<td style="text-align:center">@</td>
<td style="text-align:left">ä¸º250 750 1000 ä¸‰ä¸ªçº§åˆ«ï¼Œä¹‹å‰å’±ä»¬è¯´è¿‡äº†</td>
</tr>
<tr>
<td>è®¾ç½®å®½åº¦é«˜åº¦</td>
<td style="text-align:center">()</td>
<td style="text-align:left">[view(30)] é…åˆæ–¹å‘ æ°´å¹³æ–¹å‘å°±æ˜¯ä¸ºå®½åº¦ å‚ç›´åˆ™ä¸ºé«˜åº¦</td>
</tr>
</tbody>
</table>
<p>ä¸‹é¢å’±ä»¬æ¥ä¸¾å‡ ä¸ªä¾‹å­ï¼š</p>
<table>
<thead>
<tr>
<th>ä»£ç </th>
<th style="text-align:right">å«ä¹‰</th>
</tr>
</thead>
<tbody>
<tr>
<td>&#124;[view]&#124;</td>
<td style="text-align:right">å’Œçˆ¶è§†å›¾çš„å·¦å³å¯¹é½</td>
</tr>
<tr>
<td>&#124;-(&gt;=100)-[view]</td>
<td style="text-align:right">è·çˆ¶è§†å›¾çš„å·¦è¾¹è·ç¦»å¤§äºç­‰äº100</td>
</tr>
<tr>
<td>[view]</td>
<td style="text-align:right">å®½åº¦å¤§äºç­‰äº100</td>
</tr>
<tr>
<td>V:&#124;-(&gt;=100)-[view(&gt;=100)]</td>
<td style="text-align:right">è·çˆ¶è§†å›¾çš„ä¸Šè¾¹è·ç¦»å¤§äºç­‰äº100å¹¶ä¸”é«˜åº¦åº¦å¤§äºç­‰äº100</td>
</tr>
</tbody>
</table>
<h3 id="çº¦æŸç±»å‹"><a href="#çº¦æŸç±»å‹" class="headerlink" title="çº¦æŸç±»å‹"></a>çº¦æŸç±»å‹</h3><pre class="line-numbers language-swift"><code class="language-swift"><span class="token keyword">public</span> <span class="token keyword">struct</span> <span class="token builtin">NSLayoutFormatOptions</span> <span class="token punctuation">:</span> <span class="token builtin">OptionSet</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">init</span><span class="token punctuation">(</span>rawValue<span class="token punctuation">:</span> <span class="token builtin">UInt</span><span class="token punctuation">)</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">var</span> alignAllLeft<span class="token punctuation">:</span> <span class="token builtin">NSLayoutFormatOptions</span> <span class="token punctuation">{</span> <span class="token keyword">get</span> <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">var</span> alignAllRight<span class="token punctuation">:</span> <span class="token builtin">NSLayoutFormatOptions</span> <span class="token punctuation">{</span> <span class="token keyword">get</span> <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">var</span> alignAllTop<span class="token punctuation">:</span> <span class="token builtin">NSLayoutFormatOptions</span> <span class="token punctuation">{</span> <span class="token keyword">get</span> <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">var</span> alignAllBottom<span class="token punctuation">:</span> <span class="token builtin">NSLayoutFormatOptions</span> <span class="token punctuation">{</span> <span class="token keyword">get</span> <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">var</span> alignAllLeading<span class="token punctuation">:</span> <span class="token builtin">NSLayoutFormatOptions</span> <span class="token punctuation">{</span> <span class="token keyword">get</span> <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">var</span> alignAllTrailing<span class="token punctuation">:</span> <span class="token builtin">NSLayoutFormatOptions</span> <span class="token punctuation">{</span> <span class="token keyword">get</span> <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">var</span> alignAllCenterX<span class="token punctuation">:</span> <span class="token builtin">NSLayoutFormatOptions</span> <span class="token punctuation">{</span> <span class="token keyword">get</span> <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">var</span> alignAllCenterY<span class="token punctuation">:</span> <span class="token builtin">NSLayoutFormatOptions</span> <span class="token punctuation">{</span> <span class="token keyword">get</span> <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">var</span> alignAllLastBaseline<span class="token punctuation">:</span> <span class="token builtin">NSLayoutFormatOptions</span> <span class="token punctuation">{</span> <span class="token keyword">get</span> <span class="token punctuation">}</span>
    @<span class="token function">available</span><span class="token punctuation">(</span>iOS <span class="token number">8.0</span><span class="token punctuation">,</span> <span class="token operator">*</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">var</span> alignAllFirstBaseline<span class="token punctuation">:</span> <span class="token builtin">NSLayoutFormatOptions</span> <span class="token punctuation">{</span> <span class="token keyword">get</span> <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">var</span> alignmentMask<span class="token punctuation">:</span> <span class="token builtin">NSLayoutFormatOptions</span> <span class="token punctuation">{</span> <span class="token keyword">get</span> <span class="token punctuation">}</span>


    <span class="token comment" spellcheck="true">/* choose only one of these three
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">var</span> directionLeadingToTrailing<span class="token punctuation">:</span> <span class="token builtin">NSLayoutFormatOptions</span> <span class="token punctuation">{</span> <span class="token keyword">get</span> <span class="token punctuation">}</span> <span class="token comment" spellcheck="true">// default</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">var</span> directionLeftToRight<span class="token punctuation">:</span> <span class="token builtin">NSLayoutFormatOptions</span> <span class="token punctuation">{</span> <span class="token keyword">get</span> <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">var</span> directionRightToLeft<span class="token punctuation">:</span> <span class="token builtin">NSLayoutFormatOptions</span> <span class="token punctuation">{</span> <span class="token keyword">get</span> <span class="token punctuation">}</span>


    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">var</span> directionMask<span class="token punctuation">:</span> <span class="token builtin">NSLayoutFormatOptions</span> <span class="token punctuation">{</span> <span class="token keyword">get</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>ä¸è®²è§£äº†ï¼Œæˆ‘ä¸æ˜¯ç”¨è¿™ä¸ªVFLæ‰€ä»¥ä¸ä¼šå°±ä¸è§£é‡Šäº†ã€‚é»˜è®¤ä½¿ç”¨ ï¼Œinit(0). å°±å¥½äº†ã€‚</p>
<h3 id="æ–¹æ³•è§£é‡Š"><a href="#æ–¹æ³•è§£é‡Š" class="headerlink" title="æ–¹æ³•è§£é‡Š"></a>æ–¹æ³•è§£é‡Š</h3><pre class="line-numbers language-swift"><code class="language-swift"><span class="token comment" spellcheck="true">///  è·å¾—ä¸€ç»„çº¦æŸ</span>
<span class="token comment" spellcheck="true">///</span>
<span class="token comment" spellcheck="true">///  - parameter format: vfl æ ¼å¼åŒ–string</span>
<span class="token comment" spellcheck="true">///  - parameter opts:    NSLayoutFormatOptions Opt</span>
<span class="token comment" spellcheck="true">///  - parameter metrics:   æ•°æ®çš„æ•°æ® æ¯”å¦‚ [view(height)] é‚£ä¹ˆæ­¤æ—¶ metrics å°±ä¸º ["height":100]. ä¸éœ€è¦åˆ™ä¸º nil</span>
<span class="token comment" spellcheck="true">///  - parameter views:    views ["view1":self.backView]</span>
<span class="token comment" spellcheck="true">///</span>
<span class="token comment" spellcheck="true">///  - returns: NSLayoutConstraints</span>
open <span class="token keyword">class</span> <span class="token class-name">func</span> <span class="token function">constraints</span><span class="token punctuation">(</span>withVisualFormat format<span class="token punctuation">:</span> <span class="token builtin">String</span><span class="token punctuation">,</span> options opts<span class="token punctuation">:</span> <span class="token builtin">NSLayoutFormatOptions</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> metrics<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token builtin">String</span> <span class="token punctuation">:</span> <span class="token builtin">Any</span><span class="token punctuation">]</span><span class="token operator">?</span><span class="token punctuation">,</span> views<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token builtin">String</span> <span class="token punctuation">:</span> <span class="token builtin">Any</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token punctuation">[</span><span class="token builtin">NSLayoutConstraint</span><span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>å¦‚æœæ²¡æœ‰å£°æ˜æ–¹å‘é»˜è®¤ä¸ºæ°´å¹³H:ï¼ˆåŸæ–‡å†™çš„V:ï¼‰</p>
<p>å¦ˆçš„ï¼ŒçœŸå¿ƒä¸èƒ½ä½¿ç”¨vflï¼Œç®€ç›´åäººç±»ã€‚è€Œä¸”å¾ˆå¤šé—®é¢˜ã€‚æ¯”å¦‚ç­‰äºçˆ¶è§†å›¾çš„å®½é«˜ï¼Œå‰§ä¸­é—®é¢˜â€¦â€¦   </p>
<p>ç­‰åˆ°è¿™äº›é—®é¢˜è§£å†³äº†ï¼Œæˆ‘åœ¨ç”¨å§ï¼Œç°åœ¨è¿˜æ˜¯å°½é‡ä¸ä½¿ç”¨â€¦â€¦ è€Œä¸”ä¸ºäº†ä½¿ç”¨vflï¼Œè¿˜å¾—æ˜¯ç”¨å…¶ä»–æ–¹å¼çº¦æŸå»çº¦æŸä»–ä¸èƒ½çº¦æŸï¼Œæˆ–è€…æˆ‘ä¸ä¼šçº¦æŸçš„åœ°æ–¹ï¼ŒçœŸå¿ƒäº†ç´¯ã€‚è€Œä¸”ä»–çš„å®½é«˜é—®é¢˜åœ¨æ¨ªå±çš„æ—¶å€™ä¹Ÿæ˜¯ä¸€ä¸ªå‘ã€‚</p>
<h2 id="NSLayoutAnchor-çº¦æŸè®¾ç½®"><a href="#NSLayoutAnchor-çº¦æŸè®¾ç½®" class="headerlink" title="NSLayoutAnchor çº¦æŸè®¾ç½®"></a>NSLayoutAnchor çº¦æŸè®¾ç½®</h2><p>åœ¨ios9 ä¹‹åï¼Œä¹Ÿè®¸æ˜¯å—åˆ°äº†ç¬¬ä¸‰æ–¹çº¦æŸæ¡†æ¶çš„é¼“èˆï¼Œå’±ä»¬çš„è‹¹æœå…¬å¸æ›´æ–°äº†å¯¹äº autolayoutçš„å¸ƒå±€apiã€‚ <code>NSLayoutAnchor</code> ã€‚æ¯ä¸€ä¸ªUIViewéƒ½ä¼šæœ‰è‡ªå·±çš„è¿™äº›å±æ€§</p>
<pre class="line-numbers language-swift"><code class="language-swift"><span class="token keyword">extension</span> <span class="token builtin">UIView</span> <span class="token punctuation">{</span>

    <span class="token comment" spellcheck="true">/* Constraint creation conveniences. See NSLayoutAnchor.h for details.
     */</span>
    @<span class="token function">available</span><span class="token punctuation">(</span>iOS <span class="token number">9.0</span><span class="token punctuation">,</span> <span class="token operator">*</span><span class="token punctuation">)</span>
    open <span class="token keyword">var</span> leadingAnchor<span class="token punctuation">:</span> <span class="token builtin">NSLayoutXAxisAnchor</span> <span class="token punctuation">{</span> <span class="token keyword">get</span> <span class="token punctuation">}</span>

    @<span class="token function">available</span><span class="token punctuation">(</span>iOS <span class="token number">9.0</span><span class="token punctuation">,</span> <span class="token operator">*</span><span class="token punctuation">)</span>
    open <span class="token keyword">var</span> trailingAnchor<span class="token punctuation">:</span> <span class="token builtin">NSLayoutXAxisAnchor</span> <span class="token punctuation">{</span> <span class="token keyword">get</span> <span class="token punctuation">}</span>

    @<span class="token function">available</span><span class="token punctuation">(</span>iOS <span class="token number">9.0</span><span class="token punctuation">,</span> <span class="token operator">*</span><span class="token punctuation">)</span>
    open <span class="token keyword">var</span> leftAnchor<span class="token punctuation">:</span> <span class="token builtin">NSLayoutXAxisAnchor</span> <span class="token punctuation">{</span> <span class="token keyword">get</span> <span class="token punctuation">}</span>

    @<span class="token function">available</span><span class="token punctuation">(</span>iOS <span class="token number">9.0</span><span class="token punctuation">,</span> <span class="token operator">*</span><span class="token punctuation">)</span>
    open <span class="token keyword">var</span> rightAnchor<span class="token punctuation">:</span> <span class="token builtin">NSLayoutXAxisAnchor</span> <span class="token punctuation">{</span> <span class="token keyword">get</span> <span class="token punctuation">}</span>

    @<span class="token function">available</span><span class="token punctuation">(</span>iOS <span class="token number">9.0</span><span class="token punctuation">,</span> <span class="token operator">*</span><span class="token punctuation">)</span>
    open <span class="token keyword">var</span> topAnchor<span class="token punctuation">:</span> <span class="token builtin">NSLayoutYAxisAnchor</span> <span class="token punctuation">{</span> <span class="token keyword">get</span> <span class="token punctuation">}</span>

    @<span class="token function">available</span><span class="token punctuation">(</span>iOS <span class="token number">9.0</span><span class="token punctuation">,</span> <span class="token operator">*</span><span class="token punctuation">)</span>
    open <span class="token keyword">var</span> bottomAnchor<span class="token punctuation">:</span> <span class="token builtin">NSLayoutYAxisAnchor</span> <span class="token punctuation">{</span> <span class="token keyword">get</span> <span class="token punctuation">}</span>

    @<span class="token function">available</span><span class="token punctuation">(</span>iOS <span class="token number">9.0</span><span class="token punctuation">,</span> <span class="token operator">*</span><span class="token punctuation">)</span>
    open <span class="token keyword">var</span> widthAnchor<span class="token punctuation">:</span> <span class="token builtin">NSLayoutDimension</span> <span class="token punctuation">{</span> <span class="token keyword">get</span> <span class="token punctuation">}</span>

    @<span class="token function">available</span><span class="token punctuation">(</span>iOS <span class="token number">9.0</span><span class="token punctuation">,</span> <span class="token operator">*</span><span class="token punctuation">)</span>
    open <span class="token keyword">var</span> heightAnchor<span class="token punctuation">:</span> <span class="token builtin">NSLayoutDimension</span> <span class="token punctuation">{</span> <span class="token keyword">get</span> <span class="token punctuation">}</span>

    @<span class="token function">available</span><span class="token punctuation">(</span>iOS <span class="token number">9.0</span><span class="token punctuation">,</span> <span class="token operator">*</span><span class="token punctuation">)</span>
    open <span class="token keyword">var</span> centerXAnchor<span class="token punctuation">:</span> <span class="token builtin">NSLayoutXAxisAnchor</span> <span class="token punctuation">{</span> <span class="token keyword">get</span> <span class="token punctuation">}</span>

    @<span class="token function">available</span><span class="token punctuation">(</span>iOS <span class="token number">9.0</span><span class="token punctuation">,</span> <span class="token operator">*</span><span class="token punctuation">)</span>
    open <span class="token keyword">var</span> centerYAnchor<span class="token punctuation">:</span> <span class="token builtin">NSLayoutYAxisAnchor</span> <span class="token punctuation">{</span> <span class="token keyword">get</span> <span class="token punctuation">}</span>

    @<span class="token function">available</span><span class="token punctuation">(</span>iOS <span class="token number">9.0</span><span class="token punctuation">,</span> <span class="token operator">*</span><span class="token punctuation">)</span>
    open <span class="token keyword">var</span> firstBaselineAnchor<span class="token punctuation">:</span> <span class="token builtin">NSLayoutYAxisAnchor</span> <span class="token punctuation">{</span> <span class="token keyword">get</span> <span class="token punctuation">}</span>

    @<span class="token function">available</span><span class="token punctuation">(</span>iOS <span class="token number">9.0</span><span class="token punctuation">,</span> <span class="token operator">*</span><span class="token punctuation">)</span>
    open <span class="token keyword">var</span> lastBaselineAnchor<span class="token punctuation">:</span> <span class="token builtin">NSLayoutYAxisAnchor</span> <span class="token punctuation">{</span> <span class="token keyword">get</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>å¤§å®¶çœ‹çœ‹è¿™äº›å•è¯å°±åº”è¯¥çŸ¥é“ä»€ä¹ˆæ„æ€äº†å§ã€‚</p>
<p>å’±ä»¬å¯ä»¥çœ‹åˆ°è¿™é‡Œå¤§æ¦‚æœ‰ä¸‰ä¸ªç±»å‹ã€‚ <code>NSLayoutXAxisAnchor</code> , <code>NSLayoutYAxisAnchor</code> , <code>NSLayoutDimension</code></p>
<p>åˆ†åˆ«å·¦å³è¾¹è·ä¸Šä¸‹è¾¹è·ï¼Œä»¥åŠæœ€åçš„ å®½åº¦å’Œé«˜åº¦</p>
<p>è€Œè¿™äº›ç±»å‹éƒ½å®ç° <code>NSLayoutAnchor</code>,ä»–ä»¬æœ‰å…±åŒçš„æ–¹æ³•</p>
<pre class="line-numbers language-swift"><code class="language-swift"><span class="token comment" spellcheck="true">/* These methods return an inactive constraint of the form thisAnchor = otherAnchor.
 */</span>
open <span class="token keyword">func</span> <span class="token function">constraint</span><span class="token punctuation">(</span>equalTo anchor<span class="token punctuation">:</span> <span class="token builtin">NSLayoutAnchor</span><span class="token operator">&lt;</span><span class="token builtin">AnchorType</span><span class="token operator">></span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">NSLayoutConstraint</span>

open <span class="token keyword">func</span> <span class="token function">constraint</span><span class="token punctuation">(</span>greaterThanOrEqualTo anchor<span class="token punctuation">:</span> <span class="token builtin">NSLayoutAnchor</span><span class="token operator">&lt;</span><span class="token builtin">AnchorType</span><span class="token operator">></span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">NSLayoutConstraint</span>

open <span class="token keyword">func</span> <span class="token function">constraint</span><span class="token punctuation">(</span>lessThanOrEqualTo anchor<span class="token punctuation">:</span> <span class="token builtin">NSLayoutAnchor</span><span class="token operator">&lt;</span><span class="token builtin">AnchorType</span><span class="token operator">></span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">NSLayoutConstraint</span>


<span class="token comment" spellcheck="true">/* These methods return an inactive constraint of the form thisAnchor = otherAnchor + constant.
 */</span>
open <span class="token keyword">func</span> <span class="token function">constraint</span><span class="token punctuation">(</span>equalTo anchor<span class="token punctuation">:</span> <span class="token builtin">NSLayoutAnchor</span><span class="token operator">&lt;</span><span class="token builtin">AnchorType</span><span class="token operator">></span><span class="token punctuation">,</span> constant c<span class="token punctuation">:</span> <span class="token builtin">CGFloat</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">NSLayoutConstraint</span>

open <span class="token keyword">func</span> <span class="token function">constraint</span><span class="token punctuation">(</span>greaterThanOrEqualTo anchor<span class="token punctuation">:</span> <span class="token builtin">NSLayoutAnchor</span><span class="token operator">&lt;</span><span class="token builtin">AnchorType</span><span class="token operator">></span><span class="token punctuation">,</span> constant c<span class="token punctuation">:</span> <span class="token builtin">CGFloat</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">NSLayoutConstraint</span>

open <span class="token keyword">func</span> <span class="token function">constraint</span><span class="token punctuation">(</span>lessThanOrEqualTo anchor<span class="token punctuation">:</span> <span class="token builtin">NSLayoutAnchor</span><span class="token operator">&lt;</span><span class="token builtin">AnchorType</span><span class="token operator">></span><span class="token punctuation">,</span> constant c<span class="token punctuation">:</span> <span class="token builtin">CGFloat</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">NSLayoutConstraint</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>è€Œ é’ˆå¯¹äºé«˜åº¦ä¼šæœ‰æ¯”ä¾‹è¿™ä¸€ä¸ªçº¦æŸï¼Œæ‰€ä»¥åœ¨ <code>NSLayoutDimension</code>æœ‰è‡ªå·±çš„æ–¹æ³•</p>
<pre class="line-numbers language-swift"><code class="language-swift"><span class="token comment" spellcheck="true">/* These methods return an inactive constraint of the form
        thisVariable = constant.
*/</span>
open <span class="token keyword">func</span> <span class="token function">constraint</span><span class="token punctuation">(</span>equalToConstant c<span class="token punctuation">:</span> <span class="token builtin">CGFloat</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">NSLayoutConstraint</span>

open <span class="token keyword">func</span> <span class="token function">constraint</span><span class="token punctuation">(</span>greaterThanOrEqualToConstant c<span class="token punctuation">:</span> <span class="token builtin">CGFloat</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">NSLayoutConstraint</span>

open <span class="token keyword">func</span> <span class="token function">constraint</span><span class="token punctuation">(</span>lessThanOrEqualToConstant c<span class="token punctuation">:</span> <span class="token builtin">CGFloat</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">NSLayoutConstraint</span>


<span class="token comment" spellcheck="true">/* These methods return an inactive constraint of the form
        thisAnchor = otherAnchor * multiplier.
*/</span>
open <span class="token keyword">func</span> <span class="token function">constraint</span><span class="token punctuation">(</span>equalTo anchor<span class="token punctuation">:</span> <span class="token builtin">NSLayoutDimension</span><span class="token punctuation">,</span> multiplier m<span class="token punctuation">:</span> <span class="token builtin">CGFloat</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">NSLayoutConstraint</span>

open <span class="token keyword">func</span> <span class="token function">constraint</span><span class="token punctuation">(</span>greaterThanOrEqualTo anchor<span class="token punctuation">:</span> <span class="token builtin">NSLayoutDimension</span><span class="token punctuation">,</span> multiplier m<span class="token punctuation">:</span> <span class="token builtin">CGFloat</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">NSLayoutConstraint</span>

open <span class="token keyword">func</span> <span class="token function">constraint</span><span class="token punctuation">(</span>lessThanOrEqualTo anchor<span class="token punctuation">:</span> <span class="token builtin">NSLayoutDimension</span><span class="token punctuation">,</span> multiplier m<span class="token punctuation">:</span> <span class="token builtin">CGFloat</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">NSLayoutConstraint</span>


<span class="token comment" spellcheck="true">/* These methods return an inactive constraint of the form
        thisAnchor = otherAnchor * multiplier + constant.
*/</span>
open <span class="token keyword">func</span> <span class="token function">constraint</span><span class="token punctuation">(</span>equalTo anchor<span class="token punctuation">:</span> <span class="token builtin">NSLayoutDimension</span><span class="token punctuation">,</span> multiplier m<span class="token punctuation">:</span> <span class="token builtin">CGFloat</span><span class="token punctuation">,</span> constant c<span class="token punctuation">:</span> <span class="token builtin">CGFloat</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">NSLayoutConstraint</span>

open <span class="token keyword">func</span> <span class="token function">constraint</span><span class="token punctuation">(</span>greaterThanOrEqualTo anchor<span class="token punctuation">:</span> <span class="token builtin">NSLayoutDimension</span><span class="token punctuation">,</span> multiplier m<span class="token punctuation">:</span> <span class="token builtin">CGFloat</span><span class="token punctuation">,</span> constant c<span class="token punctuation">:</span> <span class="token builtin">CGFloat</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">NSLayoutConstraint</span>

open <span class="token keyword">func</span> <span class="token function">constraint</span><span class="token punctuation">(</span>lessThanOrEqualTo anchor<span class="token punctuation">:</span> <span class="token builtin">NSLayoutDimension</span><span class="token punctuation">,</span> multiplier m<span class="token punctuation">:</span> <span class="token builtin">CGFloat</span><span class="token punctuation">,</span> constant c<span class="token punctuation">:</span> <span class="token builtin">CGFloat</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">NSLayoutConstraint</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>å¤§å®¶è‡ªå·±çœ‹çœ‹æ–¹æ³•å°±çŸ¥é“äº†ï¼Œå¦‚æœä¸çŸ¥é“å°±å»æ–‡ç« ä¸‹æ–¹ä¾‹å­ï¼Œä¸‹è½½æŸ¥çœ‹ã€‚</p>
<h2 id="ç¬¬ä¸‰æ–¹çº¦æŸè®¾ç½®"><a href="#ç¬¬ä¸‰æ–¹çº¦æŸè®¾ç½®" class="headerlink" title="ç¬¬ä¸‰æ–¹çº¦æŸè®¾ç½®"></a>ç¬¬ä¸‰æ–¹çº¦æŸè®¾ç½®</h2><ul>
<li>Masonry (githubåœ°å€)[<a href="https://github.com/SnapKit/Masonry" target="_blank" rel="noopener">https://github.com/SnapKit/Masonry</a>]</li>
<li>SnapKit (githubåœ°å€)[<a href="https://github.com/SnapKit/SnapKit" target="_blank" rel="noopener">https://github.com/SnapKit/SnapKit</a>]</li>
<li>Cartography (githubåœ°å€)[<a href="https://github.com/robb/Cartography" target="_blank" rel="noopener">https://github.com/robb/Cartography</a>]</li>
</ul>
<p>å…·ä½“çš„ç”¨æ³•æŸ¥çœ‹ä»–ä»¬çš„æ•™ç¨‹å§ï¼Œæˆ‘å°±ä¸çŒ®ä¸‘äº†ã€‚</p>
<h2 id="ä¾‹å­æ€»ç»“-ï¼-å®ä¾‹"><a href="#ä¾‹å­æ€»ç»“-ï¼-å®ä¾‹" class="headerlink" title="ä¾‹å­æ€»ç»“ ï¼ å®ä¾‹"></a>ä¾‹å­æ€»ç»“ ï¼ å®ä¾‹</h2><p> é‚£ä¹ˆæˆ‘ä»¬æ¥åšä¸€ä¸ªä¸ªäººä¸»é¡µçš„å¸ƒå±€å§ï¼Œå› ä¸ºè¿™é‡ŒåŒ…å«çš„çŸ¥è¯†ç‚¹æ¯”è¾ƒå¤šã€‚è€Œä¸”æ¯”è¾ƒå¥½å®ç°â€¦â€¦</p>
<h3 id="XIB-StoryBoard-æ–¹å¼"><a href="#XIB-StoryBoard-æ–¹å¼" class="headerlink" title="XIB StoryBoard æ–¹å¼"></a>XIB StoryBoard æ–¹å¼</h3><p>é‚£ä¹ˆé¦–å…ˆæˆ‘ä»¬åšä¸€ä¸ªä¸ªäººä¸»é¡µçš„èƒŒæ™¯è§†å›¾ï¼Œè®©ä»–è·ç¦»ä¸Šå·¦å³æ–¹ä¸º0ã€‚è€Œé«˜åº¦åˆ™ä¸ºæ•´ä¸ªVCçš„viewçš„1/3ï¼Œæˆ‘å½•åˆ¶ä¸ºäº†åŠ¨æ€å›¾äº†ã€‚<br><img src="http://7xt8nx.com1.z0.glb.clouddn.com/AutoLayout/backview.gif" alt="" title="ä¸ªäººä¸­å¿ƒèƒŒæ™¯è§†å›¾è®¾ç½®"><br>ç´§æ¥ç€æˆ‘ä»¬åœ¨ä¸ªäººä¸­å¿ƒçš„èƒŒæ™¯è§†å›¾è®¾ç½®å¤´åƒä»¥åŠåå­—çš„å¸ƒå±€çº¦æŸ<br><img src="http://7xt8nx.com1.z0.glb.clouddn.com/AutoLayout/headrPhotosNamelabel.gif" alt="" title="ç”¨æˆ·å¤´åƒï¼Œç”¨æˆ·å§“åçº¦æŸ"><br>è®¾ç½®ä¸€ä¸ªtagåˆ†æ è§†å›¾çš„çº¦æŸ<br><img src="http://7xt8nx.com1.z0.glb.clouddn.com/AutoLayout/addtag.gif" alt="" title="åˆ†æ Viewçº¦æŸè®¾ç½® "><br>è®¾ç½®UISCrollViewçš„çº¦æŸ,ä»¥åŠè¿è¡Œæ•ˆæœ<br><img src="http://7xt8nx.com1.z0.glb.clouddn.com/AutoLayout/scrollview.gif" alt="" title="UISCrollView çº¦æŸè®¾ç½®"><br>å®Œæˆæ»‘åŠ¨Progressä¿®æ”¹çº¦æŸå®ç° åˆ‡æ¢ViewControollerçš„å‡è±¡<br><img src="http://7xt8nx.com1.z0.glb.clouddn.com/AutoLayout/progress.gif" alt="" title="UISCrollView ä¿®æ”¹çº¦æŸ"><br>è¿™æ ·æˆ‘ä»¬å°±å®Œæˆäº† xibçš„ å¸ƒå±€</p>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>é™¤äº†ç¬¬ä¸‰æ–¹çš„çº¦æŸæ¡†æ¶ï¼Œæˆ‘éƒ½å†™äº†ä¸€ä»½ä»£ç ï¼Œå®ç°åŒä¸€ä¸ªæ•ˆæœã€‚å¤§å®¶æœ‰éœ€è¦çš„å¯ä»¥æŸ¥çœ‹githubä¸Šçš„é¡¹ç›®ã€‚</p>
<p>(Github åœ°å€)[<a href="https://github.com/AimobierExample/AutoLayout" target="_blank" rel="noopener">https://github.com/AimobierExample/AutoLayout</a>]</p>
<p>è¿™æ˜¯æ¡ˆä¾‹çš„githubåœ°å€ï¼Œæˆ‘æŠŠè¿™ä¸ªä¾‹å­åˆ†ä¸ºäº†4ä¸ªåˆ†æ”¯ã€‚å¯ä»¥æŒ‰ä¸ªæŸ¥çœ‹å®ç°çš„çº¦æŸã€‚</p>
<p>å†™åˆ°æœ€åæ‰å‘è§‰å…¶å®å¹¶æ²¡æœ‰å°†åˆ° sizeï¼classã€‚æœ‰æœºä¼šè¡¥ä¸Šå§ï½</p>
]]></content>
      
        <categories>
            
            <category> IOS </category>
            
        </categories>
        
        
        <tags>
            
            <tag> ios </tag>
            
            <tag> çº¦æŸæ•™ç¨‹ </tag>
            
            <tag> swift </tag>
            
            <tag> autolayout </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[åˆ¶ä½œä¸€ä¸ªè‡ªå·±çš„ Cydia æº]]></title>
      <url>http://www.msiter.com/2016/11/12/%E5%88%B6%E4%BD%9C%E4%B8%80%E4%B8%AA%E8%87%AA%E5%B7%B1%E7%9A%84%20Cydia%20%E6%BA%90/</url>
      <content type="html"><![CDATA[<p><img class = "g-pl-90"  src="http://image.msiter.com/stock-photo-155012621.jpg" alt="" title="å¤œé‡Œä¸ç¡çš„äººï¼Œç™½å¤©å¤šå¤šå°‘å°‘æ€»æœ‰ä»€ä¹ˆé€ƒé¿æ©é¥°çš„å§ã€‚ç™½æ˜¼è§£ä¸å¼€çš„ç»“é»‘å¤œæ…¢æ…¢è€—"></p>
<p>å¤§å®¶è‚¯å®šéƒ½çŸ¥é“ Cydia å§ï¼Œ</p>
<blockquote>
<p>iPhoneã€iPod touchã€iPadç­‰è®¾å¤‡ä¸Šçš„ä¸€ç§ç ´è§£è½¯ä»¶ï¼Œç±»ä¼¼è‹¹æœåœ¨çº¿è½¯ä»¶å•†åº—iTunes Store çš„è½¯ä»¶å¹³å°çš„å®¢æˆ·ç«¯ï¼Œåœ¨è¶Šç‹±çš„è¿‡ç¨‹ä¸­è¢«è£…å…¥åˆ°ç³»ç»Ÿä¸­çš„ï¼Œå…¶ä¸­å¤šæ•°ä¸ºiPhoneã€iPod Touchã€ipadçš„ç¬¬ä¸‰æ–¹è½¯ä»¶å’Œè¡¥ä¸ï¼Œä¸»è¦éƒ½æ˜¯å¼¥è¡¥ç³»ç»Ÿä¸è¶³ç”¨ã€‚æ˜¯ç”±Jay Freemanï¼ˆSaurikï¼‰é¢†å¯¼ï¼ŒOkori Groupä»¥åŠUCSBå¤§å­¦åˆä½œå¼€å‘ã€‚</p>
</blockquote>
<p>ä¹‹å‰ç”¨äº†å¾ˆå¤šå¥½ç”¨çš„æºï¼Œä½†æ˜¯å¾ˆå¥½å¥‡çš„æ˜¯ï¼Œä»–ä»¬æ˜¯æ€ä¹ˆåˆ¶ä½œçš„å‘¢ï¼Ÿä¸ºä»€ä¹ˆè¶Šç‹±ä¹‹åå°±å¯ä»¥è¿™ä¹ˆå‰å®³å‘¢ï¼Ÿ<br>é‚£ä¹ˆæ€ä¹ˆåˆ¶ä½œè¿™ä¹ˆä¸€ä¸ªä¸œè¥¿</p>
<a id="more"></a>
<h2 id="åˆ¶ä½œè‡ªå·±çš„-Cydiaæº"><a href="#åˆ¶ä½œè‡ªå·±çš„-Cydiaæº" class="headerlink" title="åˆ¶ä½œè‡ªå·±çš„ Cydiaæº"></a>åˆ¶ä½œè‡ªå·±çš„ Cydiaæº</h2><p>Cydia è¯´ç™½äº†å¯ç¤ºå°±æ˜¯ä¸€ä¸ªäº‘ç›˜ï¼Œä½ ä»¬éœ€è¦çš„å‘¢ï¼Œåªæ˜¯éœ€è¦å‡ ä¸ªæ–‡ä»¶ï¼Œæ¥å‘Šè¯‰è¿‡æ¥è®¿é—®è¿™ä¸ªäº‘ç›˜çš„Cydiaç¨‹åºï¼Œæˆ‘è¿™ä¸ªæºå«å•¥ï¼Ÿè°åˆ¶ä½œçš„è¿™ä¸ªæºï¼Ÿè¿™ä¸ªæºé‡Œéƒ½æœ‰ä»€ä¹ˆè½¯ä»¶ï¼Ÿè¿™äº›æºçš„æ”¾ç½®ä½ç½®éƒ½æ˜¯å•¥ï¼Ÿ<br>é‚£ä¹ˆå¦‚ä½•åˆ¶ä½œè‡ªå·±çš„äº‘ç›˜å‘¢ï¼Ÿ å‡ ç§åŠæ³•</p>
<ol>
<li>ç¬¬ä¸€ç§å°±æ˜¯è‡ªå·±åšä¸€ä¸ªæœåŠ¡å™¨ï¼Œæœ¬åœ°è·‘èµ·æ¥ã€‚</li>
<li>github</li>
<li>ä»»ä½•ä¸€ä¸ªç›´æ¥è®¿é—®çš„æ–‡ä»¶å­˜å‚¨åœ°æ–¹ æ¯”å¦‚ ä¸ƒç‰›äº‘ã€‚</li>
</ol>
<p>Cydia æºçš„æ–‡ä»¶ç»“æ„</p>
<pre><code>+- /
   +- Release
   +- Packages
   +- CydiaIcon.png
   +- debs
      +- *.deb
</code></pre><h3 id="æ–‡ä»¶è®²è§£"><a href="#æ–‡ä»¶è®²è§£" class="headerlink" title="æ–‡ä»¶è®²è§£"></a>æ–‡ä»¶è®²è§£</h3><p><code>/</code> æœåŠ¡å™¨æ ¹ç›®å½•<br><code>/Release</code>  æ–‡ä»¶è®°å½•è½¯ä»¶æºæœ¬èº«çš„ç›¸å…³ä¿¡æ¯ ï¼Œä¾‹å¦‚ä½œè€… ä¹‹ç±»çš„<br><code>/Packages</code> è®°å½•å…·ä½“è½¯ä»¶åŒ…çš„å­˜æ”¾ä½ç½®å’Œå®‰è£…ä¿¡æ¯ç­‰æ•°æ®<br><code>/CydiaIcon.png</code> ICON æ˜¾ç¤ºçš„ICONå›¾ç‰‡<br><code>/debs</code> å­˜æ”¾æ‰€æœ‰debåŒ…çš„ç›®å½•<br><code>/debs/*.deb</code> debåŒ…â€¦â€¦</p>
<h4 id="Release-æ–‡ä»¶è®²è§£"><a href="#Release-æ–‡ä»¶è®²è§£" class="headerlink" title="Release æ–‡ä»¶è®²è§£"></a>Release æ–‡ä»¶è®²è§£</h4><p>å¿…é¡»<br>Origin: è½¯ä»¶æºåç§°ï¼Œå¯ä»¥ä½¿ç”¨ä¸­æ–‡ï¼ˆCydiaçš„è½¯ä»¶æºåˆ—è¡¨ä¸­æ˜¾ç¤ºçš„æ ‡é¢˜ï¼‰<br>Label:  åŒä¸Šï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ä¸­æ–‡<br>Suite: è½¯ä»¶æºçš„ç±»å‹ï¼Œæ¯”å¦‚æ­£å¼æºï¼Œæµ‹è¯•æºç­‰ï¼Œå¯ä»¥åˆ†åˆ«ç”¨stable, beta, unstableç­‰æ¥è¡¨ç¤ºï¼Œä¸€èˆ¬å¡«stableå°±å¯ä»¥äº†<br>Version: ç‰ˆæœ¬å·ï¼Œè¿™ä¸ªå…¶å®ä¸é‡è¦ï¼Œéšä¾¿å¡«ï¼Œä¸€èˆ¬éƒ½æ˜¯å†™1.0<br>Codename: ä»£ç ä»£å·ï¼Œæ¯”å¦‚BigBossçš„å°±å†™BigBossï¼Œå¨é”‹çš„å°±å†™WeiPhoneï¼Œä¹Ÿæ²¡ä»€ä¹ˆé™åˆ¶ï¼Œåªèƒ½ç”¨è‹±æ–‡<br>Architectures: ç»“æ„ã€‚iPhoneå¹³å°ç»Ÿä¸€å†™iphoneos-arm<br>Components: main<br>Description: è½¯ä»¶ä»‹ç»ï¼Œå¯ä»¥ä½¿ç”¨ä¸­æ–‡å’Œhtmlä»£ç ï¼Œå…·ä½“èƒ½ä½¿ç”¨å“ªäº›ä»£ç åœ¨ä¸‹é¢ä¼šä»‹ç»ã€‚</p>
<p>å¯é€‰<br>Support: æ”¯æŒï¼Œæ²¡ä»€ä¹ˆä½œç”¨ï¼Œé™¤éç‰¹åˆ«éœ€è¦ï¼Œå¦åˆ™å¯ä»¥ä¸è¦è¿™ä¸ªã€‚<br>MD5Sum: ä¸æ˜¯å¿…é¡»çš„ï¼Œä½†å¦‚æœPackagesæ–‡ä»¶ä½ç½®ä¸ä¸Releaseæ–‡ä»¶åœ¨åŒä¸€ç›®å½•ä¸‹ï¼Œåˆ™å¿…é¡»æœ‰æ­¤é¡¹ã€‚å¦å¤–ï¼Œå¦‚æœéœ€è¦ç­¾åReleaseæ–‡ä»¶ï¼Œä¹Ÿå¿…é¡»æœ‰è¿™ä¸ªã€‚å…³äºMD5Sumçš„æ ¼å¼ï¼Œåœ¨ä¸‹æ–‡ä¹Ÿä¼šä»‹ç»ã€‚</p>
<p>Descriptionæ ¼å¼</p>
<ul>
<li>æ˜¾ç¤ºåœ¨Cydiaä¸­æ¯ä¸ªè½¯ä»¶é¡µé¢æœ€ä¸‹æ–¹ã€‚</li>
<li>ä¸èƒ½ç›´æ¥æ¢è¡Œï¼Œå¦‚æœè¦å®ç°æ˜¾ç¤ºæ¢è¡Œæ˜¾ç¤ºï¼Œå¯ä»¥ä½¿ç”¨<br>ä»£ç ã€‚</li>
<li>è¦åŠ ç²—æ˜¾ç¤ºï¼Œå¯ä»¥ä½¿ç”¨<strong></strong>ä»£ç </li>
<li>å¯ä»¥ä½¿ç”¨htmlä»£ç è®¾ç½®å­—ä½“é¢œè‰²ã€‚</li>
<li>ä¸èƒ½ä½¿ç”¨è¶…é“¾æ¥ä»£ç ã€‚</li>
</ul>
<p>ä»£ç ï¼š</p>
<pre><code>Description: WeiPhone-å¨é”‹ç½‘ä¸ºæ‚¨æä¾›iPhoneæ‰€éœ€è½¯ä»¶/è¡¥ä¸ã€‚&lt;br&gt;è”ç³»æˆ‘ä»¬: &lt;strong&gt;weip.com@ gmail.com&lt;/strong&gt;;
</code></pre><h4 id="ç”ŸæˆPackagesæ–‡ä»¶"><a href="#ç”ŸæˆPackagesæ–‡ä»¶" class="headerlink" title="ç”ŸæˆPackagesæ–‡ä»¶"></a>ç”ŸæˆPackagesæ–‡ä»¶</h4><ol>
<li>å°† deb æ–‡ä»¶æ”¾åœ¨ä¸€ä¸ªæ–‡ä»¶å¤¹ä¸‹ï¼Œæ¯”å¦‚è¯´debsä¸‹</li>
<li>å‘½ä»¤è¡Œé‡Œè¿›å…¥åˆ°debsç›®å½•çš„ä¸Šçº§ç›®å½•</li>
<li>Packageså­˜æ”¾äºå½“å‰ç›®å½•</li>
<li>æ‰§è¡Œå‘½ä»¤ <code>dpkg-scanpackages debs &gt; Packages</code></li>
<li>æ‰§è¡Œå‘½ä»¤ <code>bzip2 -zfk Packages</code> ç”Ÿæˆ <code>Packages.bz2</code></li>
<li>æ‰§è¡Œå‘½ä»¤ <code>gzip -fk Packages</code> ç”Ÿæˆ <code>Packages.gz</code></li>
</ol>
<blockquote>
<p>ps 4.5.6 å¯ä»¥ä½¿ç”¨ <code>dpkg-scanpackages debs &gt; Packages &amp;&amp; bzip2 -zfk Packages &amp;&amp; gzip -fk Packages</code></p>
</blockquote>
<p>è¿™æ ·ä¼šè‡ªåŠ¨å°†debsæ–‡ä»¶å¤¹ä¸‹çš„æ‰€æœ‰ debæ–‡ä»¶ä¿¡æ¯ æ‰“å°è‡³ Packages æ–‡ä»¶é‡Œ</p>
<h2 id="æ—§-åˆ¶ä½œ-è‡ªå·±deb-æ–‡ä»¶"><a href="#æ—§-åˆ¶ä½œ-è‡ªå·±deb-æ–‡ä»¶" class="headerlink" title="(æ—§) åˆ¶ä½œ è‡ªå·±deb æ–‡ä»¶"></a>(æ—§) åˆ¶ä½œ è‡ªå·±deb æ–‡ä»¶</h2><h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><ol>
<li>å…ˆæŠŠæ–‡ä»¶å¤¹ç»“æ„å¼„å¥½</li>
<li>åœ¨ <code>Applications</code> æ–‡ä»¶å¤¹ä¸‹é¢æ”¾å…¥è‡ªå·±çš„ .app æ–‡ä»¶</li>
<li>åœ¨ <code>DEBIAN</code> æ–‡ä»¶å¤¹ä¸‹é¢æ”¾å…¥ <code>control</code>æè¿°æ–‡ä»¶ï¼Œä»¥åŠæ ¹æ®è‡ªå·±çš„éœ€æ±‚æ”¾å…¥è„šæœ¬æ–‡ä»¶</li>
<li>ä½¿ç”¨ <code>chmod -R 0755 Directory</code> è®¾ç½®æƒé™</li>
<li>ä½¿ç”¨ <code>dpkg-deb -b Directory a.deb</code> å‘½ä»¤æ‰“åŒ…</li>
<li>ä½¿ç”¨ <code>dpkg-name a.deb</code> è§„èŒƒå‘½å</li>
</ol>
<h4 id="å„ä¸ªæ–‡ä»¶è®²è§£"><a href="#å„ä¸ªæ–‡ä»¶è®²è§£" class="headerlink" title="å„ä¸ªæ–‡ä»¶è®²è§£"></a>å„ä¸ªæ–‡ä»¶è®²è§£</h4><p>å…ˆç”Ÿæˆå¦‚ä¸‹çš„æ–‡ä»¶ç›®å½•ç»“æ„ï¼š</p>
<pre><code>+- Directory
   +- Applications
   |   +- Example.app
   |   |    +- Info.plist
   |   |    +- Example
   |   |    +- icon.png
   +- DEBIAN
       +- control
       +- preinst/postinst/prerm/postrm/extrainst_
</code></pre><p><code>/Directory</code> : ä»»æ„çš„ä¸€ä¸ªæ–‡ä»¶å¤¹æ”¾ç½®ä¸»è¦çš„æ–‡ä»¶<br><code>/Directory/Applications</code> : æ”¾ç½®<code>.app</code>æ–‡ä»¶å¤¹<br><code>/Directory/Applications/Example.app</code> : <code>.app</code>æ–‡ä»¶å¤¹</p>
<p><code>/DEBIAN</code> : æ”¾ç½®æè¿°çš„æ–‡ä»¶<br><code>/DEBIAN/control</code> : è®°å½•äº†è½¯ä»¶åŒ…æ ‡è¯†ï¼Œè½¯ä»¶åï¼Œä»‹ç»ï¼Œä½œè€…ï¼Œå†²çªè½¯ä»¶ç­‰ä¿¡æ¯ï¼Œç”¨æ¥æ ‡è¯†ä¸€ä¸ªè½¯ä»¶åŒ…</p>
<h4 id="DEBIAN-control-æ–‡ä»¶æè¿°"><a href="#DEBIAN-control-æ–‡ä»¶æè¿°" class="headerlink" title="DEBIAN/control æ–‡ä»¶æè¿°"></a>DEBIAN/control æ–‡ä»¶æè¿°</h4><p>ä»¥ä¸‹ä¸ºå¿…é¡»é¡¹</p>
<p>Package : è½¯ä»¶åŒ…æ ‡è¯†ç¬¦ï¼Œç±»ä¼¼äº<em>*</em>ï¼Œä¸€ä¸ªè½¯ä»¶åŒ…å¿…é¡»è¦æœ‰ä¸€ä¸ªå”¯ä¸€çš„æ ‡è¯†ç¬¦ã€‚é€šå¸¸æ˜¯ç”¨com.xxx.abcè¿™æ ·çš„å½¢å¼æ¥å‘½åã€‚<br>Architecture: æ¶æ„ï¼Œç”¨äºæ ‡è¯†è¿è¡Œçš„ç³»ç»Ÿï¼ŒiPhoneä¸Šä¸ºiphoneos-arm<br>Version: ç‰ˆæœ¬å·ï¼Œä¸èƒ½ç”¨ä¸‹åˆ’çº¿å’Œé€—å·å’Œç©ºæ ¼ã€‚æ ¼å¼æœ‰ï¼ˆä»¥é€—å·åˆ†éš”ï¼‰ 1.0ï¼Œ1.0fï¼Œ0-1ï¼Œ1:1.0ï¼Œå…¶ä¸­1:1.0è¿™ç§æ ¼å¼æ¯”è¾ƒç‰¹æ®Šï¼Œåœ¨Cydiaä¸­ï¼Œ1:1.0ä»ç„¶ä¼šæ˜¾ç¤ºä¸º1.0ï¼Œä½†ç‰ˆæœ¬å·å®é™…æ˜¯é«˜äº1.0çš„ã€‚</p>
<p>ä»¥ä¸‹ä¸ºå¯é€‰é¡¹<br>Name: è½¯ä»¶åŒ…åœ¨Cydiaä¸­çš„æ˜¾ç¤ºåç§°ï¼Œä¸­è‹±æ–‡ä¸é™ï¼Œä¹Ÿå¯ä»¥ç”¨ç©ºæ ¼ï¼Œä½†ä¸å®œè¿‡é•¿ï¼ˆé•¿äº†æ˜¾ç¤ºä¸å®Œå…¨ï¼‰ã€‚<br>Author: è½¯ä»¶ä½œè€…ã€‚<br>Maintainer: ç»´æŠ¤è€…ï¼Œä¸€èˆ¬æ˜¯è½¯ä»¶æºçš„æ‹¥æœ‰è€…ã€‚<br>Sponsor: è´Ÿè´£äººï¼Œå¯ä»¥æ˜¯ä¸ªäººä¹Ÿå¯ä»¥æ˜¯ç½‘ç«™ã€‚</p>
<blockquote>
<p>Authorï¼ŒMaintainerï¼ŒSponsor çš„æ ¼å¼ç›¸åŒï¼Œå‡ä¸º åç§°+ç©ºæ ¼+&lt;é‚®ä»¶åœ°å€æˆ–ç½‘å€&gt;ï¼Œç»æµ‹è¯•ï¼Œå¦‚æœåç§°ä¸ºä¸­æ–‡çš„è¯ï¼Œå³ä½¿å†™äº†é‚®ä»¶åœ°å€å’Œç½‘å€ï¼Œåœ¨Cydiaä¸­ç‚¹å‡»ä¹Ÿä¸ä¼šè·³è½¬ã€‚ ç¤ºä¾‹ï¼š WEIP.Tech <a href="&#109;&#97;&#105;&#108;&#x74;&#111;&#58;&#119;&#101;&#105;&#112;&#46;&#x63;&#x6f;&#109;&#x40;&#103;&#109;&#97;&#x69;&#x6c;&#44;&#x63;&#x6f;&#x6d;">&#119;&#101;&#105;&#112;&#46;&#x63;&#x6f;&#109;&#x40;&#103;&#109;&#97;&#x69;&#x6c;&#44;&#x63;&#x6f;&#x6d;</a> æˆ– WeiPhone.com <a href="http://www.weiphone.com" target="_blank" rel="noopener">http://www.weiphone.com</a> å¦‚æœæ²¡æœ‰é‚®ä»¶åœ°å€æˆ–ç½‘å€ï¼Œåˆ™ä¸éœ€è¦ &lt;&gt; åŠ&lt;&gt;ä¸­çš„å†…å®¹ã€‚ä¸­æ–‡åæˆ–æœªæä¾›é‚®ä»¶/ç½‘å€ï¼Œæ—  &gt; ç¬¦å·</p>
</blockquote>
<p>Icon: æŒ‡å®šè½¯ä»¶åŒ…çš„å›¾æ ‡æ˜¾ç¤ºã€‚å½“æ— Iconè®¾å®šæ—¶ï¼ŒCydiaä¼šæ˜¾ç¤ºè¯¥è½¯ä»¶åŒ…æ‰€åœ¨çš„åˆ†ç±»çš„å›¾æ ‡ã€‚ æ ¼å¼ï¼š</p>
<ul>
<li>åœ¨çº¿åœ°å€ï¼Œå¦‚ <a href="http://www.abc.com/abc.png" target="_blank" rel="noopener">http://www.abc.com/abc.png</a></li>
<li>æœ¬åœ°åœ°å€ï¼šfile://+è·¯å¾„ï¼Œå¦‚file:///Applications/Cydia.app/Sources/app.weiphone.com.png<br><em>æ³¨ï¼šåœ¨è½¯ä»¶é¡µé¢ï¼ˆéåˆ—è¡¨é¡µé¢ï¼‰ï¼Œè‡ªå®šä¹‰çš„å›¾æ ‡æ˜¯ä¸ä¼šæ˜¾ç¤ºçš„ï¼Œæ˜¾ç¤ºçš„æ˜¯åˆ†ç±»å›¾æ ‡ã€‚</em></li>
</ul>
<p>Section: è½¯ä»¶åˆ†ç±»ï¼Œä¸­è‹±æ–‡æ— é™åˆ¶ï¼Œæ’åˆ—é¡ºåºæ˜¯ è‹±æ–‡-&gt;ä¸­æ–‡ã€‚<br>Installed-Size: è§£åŒ…åçš„æ–‡ä»¶å¤§å°ï¼Œå¯ä»¥æœ‰å°æ•°ä½ï¼Œä»¥kbä¸ºå•ä½ï¼Œä¸éœ€è¦æ³¨æ˜kbï¼Œè¿™ä¸ªä¸éœ€è¦å¾ˆç²¾ç¡®ï¼Œè€Œä¸”å°æ•°ä½åœ¨Cydiaé‡Œæ˜¾ç¤ºä¸å‡ºæ¥ï¼ˆä¸æ˜¯å››èˆäº”å…¥ï¼Œå…¨éƒ¨èˆäº†ï¼‰ã€‚è‡³äºæ–‡ä»¶å¤§å°æ˜¯å¦åŒ…å«DEBIANç›®å½•ä¸­çš„å†…å®¹å°±éšæ„äº†ã€‚<br>Priority: ä¼˜å…ˆçº§ï¼Œå¯å¡« Requiredï¼ŒImportantï¼ŒStandardï¼ŒOptionalï¼ŒExtraï¼Œä¾æ¬¡ä¸º å¿…é¡»ï¼Œé‡è¦ï¼Œä¸€èˆ¬ï¼Œå¯é€‰ï¼Œæ¬¡è¦ã€‚è™½ç„¶æ²¡æœ‰ä»€ä¹ˆå®é™…ä½œç”¨ï¼Œä½†ä¼˜å…ˆçº§ä¸ºRequiredå’ŒImportantçš„è½¯ä»¶åŒ…åœ¨å¸è½½æ—¶ä¼šæœ‰è­¦å‘Šï¼Œè¿™æ ·å¯ä»¥é¿å…åˆ é™¤ä¸€äº›ç³»ç»Ÿå¿…é¡»çš„è½¯ä»¶ã€‚ä½†Requiredå’ŒImportantä¸è¦æ»¥ç”¨ï¼Œä¸€èˆ¬ç”¨Standardï¼ŒOptionalæˆ–Extraå³å¯ã€‚ä¼˜å…ˆçº§åœ¨Cydiaä¸­æ˜¯ä¸ä¼šæ˜¾ç¤ºçš„<br>Essential: æ˜¯å¦å¿…é¡»è½¯ä»¶åŒ…ï¼Œå¯å¡« yes å’Œ noï¼Œ å¡«yesåˆ™ä¸ºå¿…é¡»è½¯ä»¶åŒ…ï¼Œå¸è½½æ—¶Cydiaä¼šæœ‰è­¦å‘Šã€‚å¸è½½Essentialæ ‡è®°ä¸ºyesçš„è½¯ä»¶åŒ…å¯èƒ½ä¼šå¯¼è‡´ç³»ç»Ÿé—®é¢˜ã€‚å½“ç„¶æ­¤åŠŸèƒ½éœ€æ…ç”¨ï¼Œä¸è¦å› ä¸ºä¸å¸Œæœ›ç”¨æˆ·åˆ é™¤è‡ªå·±çš„è½¯ä»¶è€ŒåŠ å…¥Essential: yesã€‚å¦‚æœæ²¡æœ‰Essentialè¿™é¡¹çš„è¯é»˜è®¤å°±æ˜¯éå¿…é¡»çš„ï¼Œç›¸å½“äºEssential: noã€‚<br>Depends: Depends å­—æ®µåº”è¯¥åŒ…å«æ‚¨çš„è½¯ä»¶åŒ…æ­£å¸¸å·¥ä½œç»å¯¹å¿…éœ€çš„ä»»ä½•è½¯ä»¶åŒ…çš„åç§°ã€‚<br>Pre-Depends: â€œPre-Dependsâ€æ˜¯ä¸ºç‰¹ä¾‹è€Œä¿ç•™çš„ã€‚å½“æŸä¸ªè½¯ä»¶åŒ…è¢«ä½œä¸ºâ€Pre-Dependsâ€åˆ—å‡ºæ—¶ï¼Œå®ƒå¼ºåˆ¶ç³»ç»Ÿåœ¨è¯•å›¾å®‰è£…æ‚¨çš„è½¯ä»¶åŒ…ä¹‹å‰å®Œå…¨å®‰è£…æ‰€æŒ‡å®šçš„è½¯ä»¶åŒ…ã€‚<br>Conflicts: å†²çªè½¯ä»¶åŒ…ã€‚æ¯”å¦‚è½¯ä»¶åŒ…Aå’ŒBæœ‰å†²çªï¼Œä¸èƒ½åŒæ—¶å®‰è£…ã€‚æ¯”å¦‚è¯´Aå’ŒBå†²çªï¼Œå½“ç³»ç»Ÿå·²ç»å®‰è£…äº†Açš„æ—¶å€™å°è¯•å®‰è£…Bï¼Œåˆ™ä¸èƒ½ç»§ç»­ã€‚<br>Provides: æä¾›çš„è½¯ä»¶åŒ…ï¼Œæ¯”å¦‚è¯´è½¯ä»¶åŒ…AåŒ…å«Bçš„å…¨éƒ¨åŠŸèƒ½ï¼Œé‚£ä¹ˆåˆ™æ˜¯A provides Bï¼Œå› æ­¤å¯ä»¥åœ¨å®‰è£…äº†Açš„å‰æä¸‹ä¸å®‰è£…Bã€‚ä½†æ­¤åŠŸèƒ½åœ¨éCydiaçš„è½¯ä»¶ç®¡ç†å·¥å…·ä¸­å¯èƒ½ä¼šæ— æ³•è¯†åˆ«ï¼ˆå®é™…æ˜¯è¿™äº›è½¯ä»¶ä¸åˆdebæ ‡å‡†ï¼‰<br>Replaces: æ›¿æ¢è½¯ä»¶åŒ…ï¼Œå®‰è£…Aä¼šæ›¿æ¢Bã€‚</p>
<blockquote>
<ul>
<li>ä»¥ä¸Š5é¡¹çš„æ ¼å¼ç›¸åŒï¼Œç›´æ¥å¡«è½¯ä»¶åŒ…çš„Packageæ ‡è¯†å³å¯ï¼Œå¦‚æœéœ€è¦åŠ å…¥ç‰ˆæœ¬å·ï¼Œåˆ™ä¸º è½¯ä»¶è¡¨æ ‡è¯†+ç©ºæ ¼+(åˆ¤æ–­ç¬¦å· ç‰ˆæœ¬å·).æ¯”å¦‚ Depends: apt-key, firmware (&gt;=3.0)ï¼Œ è¿™è¡¨ç¤ºä¾èµ–äºapt-keyï¼Œä¸é™ç‰ˆæœ¬ï¼Œfirmwareï¼Œä¸”ç‰ˆæœ¬å¤§äºæˆ–ç­‰äº3.0ã€‚</li>
<li>åˆ¤æ–­ç¬¦å·ï¼šè¿œè¿œä½äºï¼ˆ&lt;&lt;ï¼‰ã€ä½äº(&lt;)ã€ä½äºæˆ–ç­‰äºï¼ˆ&lt;=ï¼‰ã€ä»…ç­‰äºï¼ˆ=ï¼‰ã€ç­‰äºæˆ–é«˜äºï¼ˆ&gt;=ï¼‰ã€å¤§äºï¼ˆ&gt;ï¼‰ä»¥åŠè¿œè¿œé«˜äºï¼ˆ&gt;&gt;ï¼‰ã€‚</li>
<li>è¡¨ç¤ºå¤šä¸ªè½¯ä»¶åŒ…ï¼Œä»¥è‹±æ–‡é€—å·åˆ†éš”ã€‚</li>
<li>è¡¨ç¤ºâ€œæˆ–â€å…³ç³»ï¼Œç”¨ | åˆ†éš”ã€‚æ¯”å¦‚è½¯ä»¶åŒ…Cä¾èµ–äºAæˆ–Bï¼Œå¯å†™Depends: A | Bã€‚ ä½†â€œæˆ–â€å…³ç³»è¦æ…ç”¨ã€‚åŸå› æ˜¯ï¼Œå½“ä¸å­˜åœ¨â€œæˆ–â€å…³ç³»çš„æ—¶å€™ï¼Œå‡è®¾Bä¾èµ–äºAï¼Œä¸”ç³»ç»Ÿå¹¶æœªå®‰è£…Aï¼Œé‚£ä¹ˆåœ¨Cydiaä¸­å®‰è£…Bçš„æ—¶å€™ä¼šè‡ªåŠ¨ä¸‹è½½å®‰è£…Aã€‚è€Œå‡å¦‚è¯´Cä¾èµ–äºAæˆ–Bï¼Œä¸”Aä¸Béƒ½æœªå®‰è£…ï¼Œé‚£ä¹ˆåœ¨å®‰è£…Cçš„æ—¶å€™å°±ä¼šå¤±è´¥ï¼Œå› ä¸ºç³»ç»Ÿæ— æ³•åˆ¤æ–­æ˜¯åº”è¯¥ä¸‹è½½Aè¿˜æ˜¯Bã€‚é™¤éç³»ç»Ÿå·²ç»å®‰è£…äº†Aæˆ–Bï¼Œå¦åˆ™Cä¸èƒ½å®‰è£…ã€‚</li>
<li>ä¸€ä¸ªç‰¹æ®Šçš„ä¾èµ–ï¼šfirmwareã€‚è¿™ä¸ªPackageè®°å½•äº†å›ºä»¶ç‰ˆæœ¬ï¼Œåœ¨å¯¹å›ºä»¶ç‰ˆæœ¬æœ‰è¦æ±‚çš„è½¯ä»¶åŒ…ä¸Šç‰¹åˆ«é‡è¦ã€‚</li>
<li>å‡è®¾Bä¾èµ–äºAï¼Œé‚£ä¹ˆåœ¨å¸è½½Açš„æ—¶å€™ä¹Ÿä¼šä¸€èµ·å¸è½½B</li>
</ul>
</blockquote>
<p>Description: è½¯ä»¶æè¿°ï¼Œä¸èƒ½åœ¨controlé‡Œç›´æ¥æ¢è¡Œï¼Œå¦‚æœéœ€è¦å®ç°æ¢è¡Œæ˜¾ç¤ºï¼Œå¯ä»¥ä½¿ç”¨<br>ä»£ç ã€‚å½“æŒ‡å®šäº†Depictionæ—¶ï¼Œåœ¨è½¯ä»¶æŸ¥çœ‹é¡µé¢ä¸ä¼šæ˜¾ç¤ºDescriptionã€‚<br>Depiction: åŠŸèƒ½ç±»ä¼¼äºè½¯ä»¶æè¿°ï¼Œé“¾æ¥åˆ°ä¸€ä¸ªç½‘é¡µï¼Œä»¥ç½‘é¡µçš„å†…å®¹ä»£æ›¿è½¯ä»¶æè¿°ã€‚åªåœ¨è½¯ä»¶æŸ¥çœ‹é¡µé¢æ˜¾ç¤ºï¼Œåœ¨è½¯ä»¶åŒ…åˆ—è¡¨é¡µé¢ä¸æ˜¾ç¤ºã€‚ å¯ä»¥ä½¿ç”¨æœ¬åœ°ç½‘é¡µï¼Œæ ¼å¼åŒIconã€‚ æ³¨æ„ï¼šæ­¤åŠŸèƒ½å¯èƒ½ä¼šæ¶ˆè€—å¤§é‡ç½‘ç»œæµé‡ã€‚<br>Homepage: é“¾æ¥åˆ°é¡µé¢ï¼ŒCydiaä¸­æ˜¾ç¤ºä¸ºMore Informationã€‚ é¡µé¢ä¸ä¼šä¸»åŠ¨åŠ è½½ã€‚<br>Tag: å¯é€‰é¡¹æœ‰ commercial, console, daemon, extension, library, uikit, xï¼Œå¯¹åº”å›¾æ ‡æ–‡ä»¶åœ¨ /Applications/Cydia.app/Purposes ç›®å½•ä¸‹ã€‚ä¹Ÿå¯ä»¥è‡ªè¡Œæ·»åŠ  purpose åˆ†ç±»ï¼Œå¹¶åŠ å…¥åŒåå›¾æ ‡å³å¯ã€‚ role:: è½¯ä»¶åŒ…ä½¿ç”¨è€…å½’ç±»ã€‚developerå¼€å‘è€…ï¼Œhackeréª‡å®¢ï¼Œenduseræ™®é€šç”¨æˆ·ï¼Œè¯¥æ ‡ç­¾ç”¨äºCydiaä¸­è½¯ä»¶åŒ…æ˜¾ç¤ºè¿‡æ»¤ã€‚ cydia::commercial Cydia Storeè½¯ä»¶ã€‚</p>
<p>ä¾‹å­å¦‚ä¸‹:</p>
<pre class="line-numbers language-txt"><code class="language-txt">Package: com.weiphone.source
Name: WeiPhoneå¨é”‹ä¸­æ–‡æº
Version: 1.0
Essential: no
Icon: file:///Applications/Cydia.app/Sources/app.weiphone.com.png
Installed-Size: 133.7
Replaces: con.weiphone.logo
Conflicts: con.weiphone.logo
Provides: con.weiphone.logo
Depends: cydia
Priority: Standard
Maintainer: WEIP.Tech <weip.com@gmail.com>
Author: WEIP.Tech <weip.com@gmail.com>
Section: Repositories
Architecture: iphoneos-arm
Description: WeiPhone Chinese Repository<br><br>å¨é”‹ä¸­æ–‡æº
HomePage: http://www.weiphone.com/
Sponsor: WeiPhone.com <http://www.weiphone.com>
Tag: purpose::repository, role::enduser
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="DEBIAN-preinst-postinst-prerm-postrm-extrainst-æ–‡ä»¶æè¿°"><a href="#DEBIAN-preinst-postinst-prerm-postrm-extrainst-æ–‡ä»¶æè¿°" class="headerlink" title="DEBIAN/preinst/postinst/prerm/postrm/extrainst_  æ–‡ä»¶æè¿°"></a>DEBIAN/preinst/postinst/prerm/postrm/extrainst_  æ–‡ä»¶æè¿°</h4><p>å¾ˆå¤šæ—¶å€™debå®‰è£…å¹¶ä¸æ˜¯æŠŠæ–‡ä»¶å¤åˆ¶åˆ°iPhoneé‡Œå°±å¯ä»¥äº†ï¼Œè¿˜éœ€è¦æ‰§è¡Œä¸€äº›å‘½ä»¤ï¼Œæ¯”å¦‚è®¾ç½®æƒé™ï¼Œå¤‡ä»½æ–‡ä»¶ï¼ŒåŠ è½½å¯åŠ¨è¿›ç¨‹ç­‰ç­‰ï¼Œé‚£ä¹ˆè¿™æ—¶å€™å°±éœ€è¦ä¸€äº›è„šæœ¬æ¥å®ç°è¿™äº›æ“ä½œã€‚ æ ‡å‡†çš„debè„šæœ¬æœ‰4ä¸ª<code>preinst</code>,<code>postinst</code>,<code>prerm</code>å’Œ <code>postrm</code><br>preæ˜¯è¡¨ç¤ºXXä¹‹å‰çš„å‰ç¼€ï¼Œpostæ˜¯è¡¨ç¤ºXXä¹‹åçš„å‰ç¼€ï¼Œinstæ˜¯installï¼ˆå®‰è£…ï¼‰çš„ç¼©å†™ï¼Œrmæ˜¯removeï¼ˆç§»é™¤ï¼‰çš„ç¼©å†™ï¼Œæ‰€ä»¥è¿™4ä¸ªè„šæœ¬çš„åŠŸèƒ½å¾ˆæ˜æ˜¾ï¼š</p>
<ul>
<li>preinst: åœ¨å¤åˆ¶æ–‡ä»¶å‰æ‰§è¡Œçš„è„šæœ¬</li>
<li>postinst: åœ¨å¤åˆ¶æ–‡ä»¶ä¹‹åæ‰§è¡Œçš„è„šæœ¬</li>
<li>prerm: åœ¨å¸è½½å‰æ‰§è¡Œçš„è„šæœ¬</li>
<li>postrm: åœ¨å¸è½½ä¹‹åæ‰§è¡Œçš„è„šæœ¬</li>
</ul>
<p>åœ¨Cydiaä¸­è¿˜å­˜åœ¨ä¸€ä¸ªç‹¬ç«‹çš„è„šæœ¬,<code>extrainst_</code>,ä»å­—é¢ä¸Šæ¥è®²å°±æ˜¯é¢å¤–çš„å®‰è£…è„šæœ¬ã€‚<br>è¿™ä¸ªè„šæœ¬æ˜¯Cydiaçš„ä½œè€…Saurikä¸ºè§£å†³æŸäº›è„šæœ¬åªéœ€è¦åœ¨å®‰è£…æ—¶æ‰§è¡Œï¼Œåœ¨å‡çº§æ—¶ä¸æ‰§è¡Œè€Œä¸“é—¨å¼•å…¥çš„ä¸€ä¸ªè„šæœ¬ï¼ŒåŠŸèƒ½è·Ÿpostinstå·®ä¸å¤šï¼Œå’ŒInstalleræ—¶ä»£çš„â€œahhhhâ€æ¯”è¾ƒç›¸ä¼¼ã€‚<br>å…³äºextrainst_çš„è¯¦æƒ…å¯ä»¥çœ‹çœ‹è¿™ä¸ªï¼š<a href="http://www.telesphoreo.org/piper" target="_blank" rel="noopener">http://www.telesphoreo.org/piper</a> â€¦ ptember/000252.html 5ä¸ªè„šæœ¬çš„ç¼–å†™æ–¹æ³•åŸºæœ¬æ˜¯ä¸€æ ·çš„ï¼Œä½†ä¸ºäº†é€‚åº”Cydiaçš„å®‰è£…ï¼Œåœ¨æŸäº›æƒ…å†µä¸‹éœ€è¦è¿›è¡Œç‰¹å®šçš„é…ç½®ã€‚ æŸ¥çœ‹æŸäº›debå¯èƒ½ä¼šå‘ç°è¿™æ ·çš„è¯­å¥ï¼š</p>
<pre><code>if [[ $1 == install || $1 == upgrade ]]; then
</code></pre><p>è¿™ç§è¯­å¥æ˜¯ä¸ºäº†åŒºåˆ«å®‰è£…/å‡çº§/å¸è½½è€Œå‡†å¤‡çš„è„šæœ¬ã€‚$1æ˜¯ä¸€ä¸ªå¤–éƒ¨å˜é‡ï¼Œå°†è¿™ä¸ªå¤–éƒ¨å˜é‡ä¼ å…¥è„šæœ¬æ¥æ‰§è¡Œï¼Œè€Œè¿™ä¸ªå¤–éƒ¨å˜é‡æ˜¯ç”±Cydiaè½¯ä»¶è‡ªèº«ç”Ÿæˆçš„ã€‚ ç®€å•æ¥è¯´ï¼Œå¦‚æœæ˜¯å®‰è£…ï¼Œåˆ™æ˜¯ $1 == install ï¼›å¦‚æœæ˜¯å‡çº§ï¼Œåˆ™æ˜¯$1 == upgradeï¼›å¦‚æœæ˜¯å¸è½½åˆ™æ˜¯ $1 == removeã€‚ if æ˜¯ä¸ªåˆ¤æ–­è¯­å¥ï¼Œå½“æ»¡è¶³ifå[ ]ä¸­çš„æŒ‡å®šæ¡ä»¶æ—¶ï¼Œifä¸­çš„å†…å®¹å°±ä¼šæ‰§è¡Œã€‚é‚£ä¹ˆè¿™é‡Œå°±å¯ä»¥é€šè¿‡è®¾å®šinstall/upgrade/removeæ¥æ§åˆ¶åœ¨ä¸åŒæ“ä½œæ—¶æ‰§è¡Œçš„å‘½ä»¤ã€‚ ä½†è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™ä¸ªåŠŸèƒ½åªèƒ½åœ¨Cydiaä¸­ä½¿ç”¨ï¼Œå…¶å®ƒçš„aptè½¯ä»¶ç®¡ç†å·¥å…·ï¼Œå¦‚Icyï¼ŒRockç­‰ï¼Œä¸èƒ½è¯†åˆ«è¿™ä¸ªå‘½ä»¤ï¼Œå› æ­¤æ— æ³•æ‰§è¡Œifä¸­çš„è¯­å¥ï¼Œæ‰€ä»¥åœ¨å†™è„šæœ¬çš„æ—¶å€™åˆ°åº•éœ€ä¸éœ€è¦ç”¨è¿™ç§æ ¼å¼ï¼Œå°±çœ‹è‡ªå·±çš„éœ€è¦äº†ã€‚ æ€»ä½“æ¥è¯´ï¼ŒUnixçš„è„šæœ¬ï¼ˆShell Scriptï¼‰æœ‰å…¶å›ºå®šçš„æ ¼å¼ã€‚ æ–‡ä»¶é¡¶å¤´ä¸º</p>
<pre><code>#!/bin/bash
</code></pre><p>è¡¨ç¤ºè°ƒç”¨bashè¿™ä¸ªshell ä¹‹åå°±æ˜¯è¿è¡Œçš„å‘½ä»¤äº†ã€‚ è„šæœ¬ä¸­å¦‚æœéœ€è¦æ³¨é‡Šï¼Œå¯ä»¥ä½¿ç”¨ # ç¬¦å·ã€‚ ä»¥ # å¼€å¤´çš„è¡Œä¼šè¢«å½“ä½œæ³¨é‡Šï¼Œé‡Œé¢çš„å†…å®¹åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­æ²¡æœ‰æ„ä¹‰ã€‚ é€šé…ç¬¦ï¼š * æœ€å¸¸ç”¨çš„ä¸¤ä¸ªå‘½ä»¤è‡ªç„¶æ˜¯è®¾ç½®å±æ€§/æƒé™/ç”¨æˆ·/ç»„ è®¾ç½®å±æ€§/</p>
<h4 id="ä¼šä½¿ç”¨åˆ°çš„ç³»ç»Ÿå‘½ä»¤æ“ä½œ"><a href="#ä¼šä½¿ç”¨åˆ°çš„ç³»ç»Ÿå‘½ä»¤æ“ä½œ" class="headerlink" title="ä¼šä½¿ç”¨åˆ°çš„ç³»ç»Ÿå‘½ä»¤æ“ä½œ"></a>ä¼šä½¿ç”¨åˆ°çš„ç³»ç»Ÿå‘½ä»¤æ“ä½œ</h4><h5 id="æƒé™"><a href="#æƒé™" class="headerlink" title="æƒé™"></a>æƒé™</h5><pre><code>chmod ã€-Rã€‘ å±æ€§ æ–‡ä»¶å
</code></pre><p>ç”±äºdebçš„è„šæœ¬æ‰§è¡Œéƒ½æ˜¯åœ¨rootç”¨æˆ·ä¸‹ï¼Œå› æ­¤ä¸éœ€è¦æå‡æƒé™ï¼Œå³ä¸éœ€è¦ä½¿ç”¨sudoå‘½ä»¤ã€‚ -Rå‚æ•°ï¼šè¡¨ç¤ºé€’å½’ï¼ŒåŠ ä¸Šæ­¤å‚æ•°ä¼šå°†æŒ‡å®šçš„ç›®å½•åŠå…¶å­ç›®å½•çš„å…¨éƒ¨ç›®å½•å’Œæ–‡ä»¶çš„å±æ€§æ”¹å˜ã€‚ å±æ€§ï¼šæœ‰å¤šç§å†™æ³•ã€‚å…·ä½“å¯ä»¥çœ‹ <a href="http://baike.baidu.com/view/1229012.htm?fr=ala0_1" target="_blank" rel="noopener">http://baike.baidu.com/view/1229012.htm?fr=ala0_1</a> æ¯”è¾ƒå¸¸ç”¨çš„å‡ ç§å±æ€§ï¼š</p>
<ul>
<li>chmod +x XXXXX ä¸ºæ–‡ä»¶å¢åŠ å¯æ‰§è¡Œæƒé™</li>
<li>chmod 0644 XXXXX ä¸å¯æ‰§è¡Œæ–‡ä»¶æœ€å¸¸ä½¿ç”¨çš„æƒé™</li>
<li>chmod 0755 XXXXX å¯æ‰§è¡Œæ–‡ä»¶æœ€å¸¸ä½¿ç”¨çš„æƒé™</li>
</ul>
<p>å®ä¾‹ï¼š</p>
<pre><code>chmod -R 0755 /Applications/Cydia.app
</code></pre><h5 id="è®¾ç½®ç”¨æˆ·-ç»„"><a href="#è®¾ç½®ç”¨æˆ·-ç»„" class="headerlink" title="è®¾ç½®ç”¨æˆ·/ç»„"></a>è®¾ç½®ç”¨æˆ·/ç»„</h5><pre><code>chown ã€-Rã€‘ ç”¨æˆ·:ç»„ æ–‡ä»¶å
</code></pre><p>åŒæ ·ä¸éœ€è¦sudoæ¥æç¤ºæƒé™ã€‚-Rä¹Ÿæ˜¯è¡¨ç¤ºé€’å½’ã€‚ æ¯”å¦‚è¦å°†æ–‡ä»¶Aè®¾ä¸ºrootç”¨æˆ·ï¼Œwheelç»„ï¼Œå¯ä»¥ä½¿ç”¨å‘½ä»¤</p>
<pre><code>chown -R mobile:mobile /var/mobile/Documents
</code></pre><h5 id="å¤åˆ¶æ–‡ä»¶-æ–‡ä»¶å¤¹"><a href="#å¤åˆ¶æ–‡ä»¶-æ–‡ä»¶å¤¹" class="headerlink" title="å¤åˆ¶æ–‡ä»¶/æ–‡ä»¶å¤¹"></a>å¤åˆ¶æ–‡ä»¶/æ–‡ä»¶å¤¹</h5><pre><code>cp ã€å‚æ•°ã€‘ åŸå§‹æ–‡ä»¶ ç›®çš„æ–‡ä»¶
</code></pre><p>å‚æ•°åˆ—è¡¨ï¼š</p>
<ul>
<li>-lï¼ˆå°å†™å­—æ¯Lï¼‰ï¼šåˆ›å»ºç¡¬é“¾æ¥ï¼Œç›¸å½“äºä¸€ä¸ªé•œåƒï¼Œè€Œä¸æ˜¯å®é™…åˆ›å»ºä¸¤ä¸ªæ–‡ä»¶<br><code>cp -l abc def</code></li>
<li>-fï¼šå¼ºè¡Œå¤åˆ¶ï¼Œå¦‚æœç›®çš„æ–‡ä»¶å·²å­˜åœ¨ï¼Œè¦†ç›–ä¹‹ä¸”ä¸æç¤º<br><code>cp -f abc def</code></li>
<li>-pï¼šä¿ç•™æ–‡ä»¶çš„å±æ€§ã€ç”¨æˆ·ã€ç»„ã€æ—¶é—´æˆ³ç­‰ä¿¡æ¯ <br> <code>cp -p abc def</code></li>
<li>-rå’Œ-Rï¼šä½œç”¨éƒ½æ˜¯é€’å½’ï¼Œå°†æ–‡ä»¶å¤¹ä¸‹çš„å…¨éƒ¨å­æ–‡ä»¶å’Œå­æ–‡ä»¶å¤¹ä¸€èµ·å¤åˆ¶ <br> <code>cp -r abc/ def/</code></li>
<li>-sï¼šåˆ›å»ºç¬¦å·é“¾æ¥è€Œä¸æ˜¯åˆ›å»ºåŒä»½æ–‡ä»¶ <br> <code>cp -s abc/ def/</code></li>
<li>-nï¼šå¦‚æœç›®çš„æ–‡ä»¶å·²å­˜åœ¨ï¼Œåˆ™ä¸è¦†ç›–ä¸”ä¸æç¤º <br><code>cp -n abc def</code></li>
<li>-aï¼šç›¸å½“ä¸-dRï¼Œä¿ç•™æ–‡ä»¶è‡ªèº«çš„å±æ€§ç­‰æ•°æ®ï¼Œä¸€å¹¶å¤åˆ¶å­æ–‡ä»¶/æ–‡ä»¶å¤¹ <br> <code>cp -a abc/ def/</code></li>
</ul>
<h5 id="ç§»åŠ¨æ–‡ä»¶-æ–‡ä»¶å¤¹-amp-é‡å‘½å"><a href="#ç§»åŠ¨æ–‡ä»¶-æ–‡ä»¶å¤¹-amp-é‡å‘½å" class="headerlink" title="ç§»åŠ¨æ–‡ä»¶/æ–‡ä»¶å¤¹ &amp; é‡å‘½å"></a>ç§»åŠ¨æ–‡ä»¶/æ–‡ä»¶å¤¹ &amp; é‡å‘½å</h5><pre><code>mv ã€å‚æ•°ã€‘ æºæ–‡ä»¶ ç›®çš„æ–‡ä»¶
</code></pre><p> -fï¼šå¼ºè¡Œç§»åŠ¨ï¼Œå¦‚æœç›®çš„æ–‡ä»¶å·²å­˜åœ¨ï¼Œè¦†ç›–ä¹‹ä¸”ä¸æç¤º</p>
<blockquote>
<p>å…¶å® mv  å‘½ä»¤å°±æ˜¯å¤åˆ¶ä¹‹åå†åˆ é™¤ï¼Œä½† mv å‘½ä»¤ä¼šè‡ªåŠ¨ä¿ç•™æ–‡ä»¶çš„å±æ€§ç­‰æ•°æ®ï¼Œç§»åŠ¨æ–‡ä»¶å¤¹æ—¶ä¼šè‡ªåŠ¨ç§»åŠ¨å­æ–‡ä»¶/å­æ–‡ä»¶å¤¹ï¼Œå› æ­¤éƒ½ä¸éœ€è¦å¦å¤–çš„å‚æ•°ã€‚ <br><br> é‡å‘½åæ˜¯ç”±mvå‘½ä»¤æ¥å®ç°çš„ï¼Œmv å°±æ˜¯å°† æºæ–‡ä»¶ ç§»åŠ¨åˆ° ç›®æ ‡æ–‡ä»¶çš„ä½ç½®å¹¶ä»¥ç›®æ ‡æ–‡ä»¶çš„æ–‡ä»¶åä¿å­˜ã€‚</p>
</blockquote>
<h5 id="æ˜¾ç¤ºè¯­å¥"><a href="#æ˜¾ç¤ºè¯­å¥" class="headerlink" title="æ˜¾ç¤ºè¯­å¥"></a>æ˜¾ç¤ºè¯­å¥</h5><pre><code>echo &quot;Some Thing&quot;;
</code></pre><p>ç¤ºä¾‹ï¼šæ˜¾ç¤ºè¯­å¥ â€œæµ‹è¯•echoå‘½ä»¤â€ã€‚</p>
<pre><code>echo &quot;æµ‹è¯•echoå‘½ä»¤&quot;;
</code></pre><h5 id="ç®¡ç†è‡ªå¯åŠ¨æœåŠ¡"><a href="#ç®¡ç†è‡ªå¯åŠ¨æœåŠ¡" class="headerlink" title="ç®¡ç†è‡ªå¯åŠ¨æœåŠ¡"></a>ç®¡ç†è‡ªå¯åŠ¨æœåŠ¡</h5><pre><code>launchctl loadæˆ–unload  -w plistæ–‡ä»¶è·¯å¾„
</code></pre><p>å®ä¾‹ï¼š è®©wefit3è‡ªå¯åŠ¨</p>
<pre><code>launchctl load -w /System/Library/LaunchDaemons/com.weiphone.fitx.plist
</code></pre><p>ç¦ç”¨iPhoneæ—¥å¿—è®°å½•syslogd</p>
<pre><code>launchctl unload -w /System/Library/LaunchDaemons/com.apple.syslogd.plist
</code></pre><blockquote>
<p>PS: è®°å½•è‡ªå¯åŠ¨è¿›ç¨‹çš„plistæ–‡ä»¶ä¿å­˜åœ¨ä»¥ä¸‹ä¸¤ä¸ªç›®å½•ï¼š /System/Library/LaunchDaemons/ å’Œ /Library/LaunchDaemons/</p>
</blockquote>
<h5 id="æ€æ­»è¿›ç¨‹"><a href="#æ€æ­»è¿›ç¨‹" class="headerlink" title="æ€æ­»è¿›ç¨‹"></a>æ€æ­»è¿›ç¨‹</h5><pre><code>killall è¿›ç¨‹å
</code></pre><p>ç¤ºä¾‹ï¼šå…³é—­Safariè¿›ç¨‹</p>
<pre><code>killall safari
</code></pre><h5 id="åˆ¤æ–­"><a href="#åˆ¤æ–­" class="headerlink" title="åˆ¤æ–­"></a>åˆ¤æ–­</h5><p>åŸºæœ¬æ ¼å¼æ˜¯</p>
<pre><code>if [ åˆ¤æ–­æ¡ä»¶ä¸€ ]; then
    æ‰§è¡Œå‘½ä»¤
else
   æ‰§è¡Œå‘½ä»¤
fi
</code></pre><p>å®ä¾‹ï¼š å¦‚æœæ–‡ä»¶abcå­˜åœ¨ï¼Œåˆ™å¤‡ä»½ä¸ºabc.bakï¼Œå¦åˆ™å°†æ–‡ä»¶defé‡å‘½åä¸ºabc</p>
<pre><code>if [ -f abc]; then
    mv -f abc abc.bak
else
    mv def abc
fi
</code></pre><p>å…¶ä¸­[ -f abc ]å¯ä»¥ç”±[ -e abc]å–ä»£ å¦‚æœç›®å½•abcä¸å­˜åœ¨ï¼Œåˆ™æ–°å»ºä¸€ä¸ªç›®å½•abc</p>
<pre><code>if [ ! -e abc ]; then
    mkdir abc
fi
</code></pre><h5 id="è·å–å›ºä»¶ç³»ç»Ÿç‰ˆæœ¬å·"><a href="#è·å–å›ºä»¶ç³»ç»Ÿç‰ˆæœ¬å·" class="headerlink" title="è·å–å›ºä»¶ç³»ç»Ÿç‰ˆæœ¬å·"></a>è·å–å›ºä»¶ç³»ç»Ÿç‰ˆæœ¬å·</h5><pre><code>sw_vers -productVersion
</code></pre><h5 id="è·å–è®¾å¤‡å‹å·"><a href="#è·å–è®¾å¤‡å‹å·" class="headerlink" title="è·å–è®¾å¤‡å‹å·"></a>è·å–è®¾å¤‡å‹å·</h5><pre><code>uname -i
uname -m
</code></pre><h5 id="Cydiaä¸­å®‰è£…å®Œä¹‹åé‡æ–°å¯åŠ¨SpringBoard"><a href="#Cydiaä¸­å®‰è£…å®Œä¹‹åé‡æ–°å¯åŠ¨SpringBoard" class="headerlink" title="Cydiaä¸­å®‰è£…å®Œä¹‹åé‡æ–°å¯åŠ¨SpringBoard"></a>Cydiaä¸­å®‰è£…å®Œä¹‹åé‡æ–°å¯åŠ¨SpringBoard</h5><pre><code>declare -a cydia
cydia=($CYDIA)
if [[ ${CYDIA+@} ]]; then
    eval &amp;quot;echo &amp;#39;finish:reboot&amp;#39; &amp;gt;&amp;amp;${cydia[0]}&amp;quot;
fi
</code></pre><h5 id="å‡ ä¸ªæ¯”è¾ƒæœ‰ç”¨çš„å®ä¾‹"><a href="#å‡ ä¸ªæ¯”è¾ƒæœ‰ç”¨çš„å®ä¾‹" class="headerlink" title="å‡ ä¸ªæ¯”è¾ƒæœ‰ç”¨çš„å®ä¾‹"></a>å‡ ä¸ªæ¯”è¾ƒæœ‰ç”¨çš„å®ä¾‹</h5><ul>
<li><p>å¤‡ä»½ preinstï¼ˆå®‰è£…ä¹‹å‰å°±è¦æŠŠåŸå§‹æ–‡ä»¶å¤‡ä»½ï¼Œä¸èƒ½ç­‰åˆ°å®‰è£…å®Œå·²ç»è¦†ç›–ä»¥åæ‰å¤‡ä»½ï¼‰<br></p>
<pre><code>if [ ! -f åŸå§‹æ–‡ä»¶å¤‡ä»½ ]; then
  echo &amp;quot;åŸå§‹æ–‡ä»¶çš„å¤‡ä»½å·²å­˜åœ¨ï¼Œè·³è¿‡å¤‡ä»½&amp;quot;
else
  cp -p åŸå§‹æ–‡ä»¶ åŸå§‹æ–‡ä»¶å¤‡ä»½
  echo &amp;quot;åŸå§‹æ–‡ä»¶å·²å¤‡ä»½&amp;quot;
fi
</code></pre><p>postrmï¼ˆè¿˜åŸå¤‡ä»½ï¼‰<br></p>
<pre><code>echo &quot;è¿˜åŸå¤‡ä»½&quot;;
mv -f åŸå§‹æ–‡ä»¶å¤‡ä»½ åŸå§‹æ–‡ä»¶
</code></pre><p>å¤‡ä»½æ“ä½œåœ¨åˆ¶ä½œè¡¥ä¸çš„æ—¶å€™ï¼Œå°¤å…¶æ˜¯æ›¿æ¢ç±»å‹çš„è¡¥ä¸æ—¶ç‰¹åˆ«æœ‰ç”¨</p>
</li>
<li><p>åˆ¤åˆ«å…·ä½“å›ºä»¶ç‰ˆæœ¬ åœ¨controlé‡Œå¯ä»¥é€šè¿‡Dependsæ¥è®¾ç½®ä¾èµ–çš„å›ºä»¶ç‰ˆæœ¬ï¼Œä½†æœ‰æ—¶å€™éœ€è¦åœ¨æŸä¸ªç‰¹å®šå›ºä»¶ç‰ˆæœ¬ä¸‹è¿›è¡Œæ“ä½œ æ¯”å¦‚è¯´ä¸€ä¸ªè½¯ä»¶ï¼Œè¦æ±‚å›ºä»¶ç‰ˆæœ¬å¤§äºæˆ–ç­‰äº3.0ï¼Œä½†åœ¨å›ºä»¶ç‰ˆæœ¬ä¸º3.1çš„æ—¶å€™å¿…é¡»åˆ é™¤æŸä¸€ä¸ªæ–‡ä»¶æ‰èƒ½è¿è¡Œï¼Œé‚£ä¹ˆè„šæœ¬å¯ä»¥è¿™æ ·å†™ï¼š</p>
<pre><code>firmware=$(sw_vers -productVersion)
if  [[ $firmware == 3.1 ]]; then
  åˆ é™¤æ–‡ä»¶
fi
</code></pre></li>
<li>åˆ¤åˆ«è®¾å¤‡å‹å· å½“è®¾å¤‡å‹å·ä¸ºiPod Touchæ—¶åˆ é™¤æŸä¸ªæ–‡ä»¶<pre><code>platform=$(uname -i)
if [[ $platform == &amp;quot;N45AP&amp;quot; || $platform == &amp;quot;N72AP&amp;quot; || $platform == &amp;quot;N18AP&amp;quot; ]]; then
  åˆ é™¤æ–‡ä»¶
fi
</code></pre>æˆ–<pre><code>platform=$(uname -m)
if [ $platform == iPod* ]; then
  åˆ é™¤æ–‡ä»¶
fi
</code></pre></li>
</ul>
<blockquote>
<p>æ›´å¤šå…³äºShell Scriptçš„ä¿¡æ¯è¯·è§ <a href="http://www.hack" target="_blank" rel="noopener">http://www.hack</a> base.com/tech/2009-10-10/56808.html</p>
</blockquote>
<h4 id="æ‰“åŒ…"><a href="#æ‰“åŒ…" class="headerlink" title="æ‰“åŒ…"></a>æ‰“åŒ…</h4><p>å¦‚æœåœ¨DEBIANä¸­æœ‰è„šæœ¬å­˜åœ¨ï¼Œåˆ™éœ€è¦å°†æ•´ä¸ªDEBIANæ–‡ä»¶å¤¹åŠå­æ–‡ä»¶å±æ€§è®¾ä¸º0755,å¦‚æœæ²¡æœ‰è„šæœ¬çš„è¯ä¿ç•™0644å±æ€§å³å¯ï¼Œ0755å±æ€§ä¹Ÿæ²¡é—®é¢˜ã€‚</p>
<pre><code>chmod -R 0755 DEBIAN
</code></pre><p> æ‰“åŒ…å‘½ä»¤</p>
<pre><code> dpkg-deb -b PATH FILENAME
</code></pre><p>å…¶ä¸­PATHæ˜¯æ‰“åŒ…debçš„å·¥ä½œç›®å½•ï¼ŒDEBIANæ–‡ä»¶å¤¹éœ€ä½äºPATHæŒ‡å®šçš„ç›®å½•ä¸‹ FILENAMEæ˜¯debçš„æ–‡ä»¶åï¼Œè¿™ä¸ªå¯ä»¥è‡ªå·±å†³å®šã€‚</p>
<p>ä»¥ä¸Šå‘½ä»¤æ‰“åŒ…debé»˜è®¤æ˜¯é‡‡ç”¨gzæ ¼å¼å‹ç¼©ï¼Œå‹ç¼©ç‡æœ‰é™ï¼Œå¦‚æœè¦è·å¾—æ›´æ”¹çš„å‹ç¼©ç‡ï¼ˆæ›´å°çš„æ–‡ä»¶ä½“ç§¯ï¼‰ï¼Œå¯ä»¥ä½¿ç”¨bzip2å’Œlzmaæ ¼å¼ã€‚ å‹ç¼©ä¸ºbzip2æ ¼å¼</p>
<pre><code>dpkg-deb -bZ bzip2 PATH FILENAME
</code></pre><p>å‹ç¼©ä¸ºbzip2æ ¼å¼</p>
<pre><code>dpkg-deb -bZ lzma PATH FILENAME
</code></pre><p>é»˜è®¤çš„gzæ ¼å¼å‹ç¼©ç‡æœ€ä½ï¼Œbzip2æ ¼å¼å±…ä¸­ï¼Œlzmaæ ¼å¼å‹ç¼©ç‡æœ€é«˜ã€‚ï¼ˆå½“ç„¶ä¹Ÿä¼šæœ‰ä¾‹å¤–ï¼‰</p>
<blockquote>
<p>PS:</p>
<ul>
<li>å‹ç¼©ç‡è¶Šé«˜ï¼Œå‹ç¼©æ—¶é—´è¶Šé•¿ï¼Œåœ¨iPhoneä¸Šä½¿ç”¨è¾ƒé«˜çš„å‹ç¼©ç‡æœ‰æ›´å¤§æ¦‚ç‡å¯¼è‡´å¤±å»å“åº”ã€‚</li>
<li>iPhone OS 2.xæ— lzmaç»„ä»¶ï¼Œå› æ­¤æ— æ³•å®‰è£…lzmaå‹ç¼©çš„debã€‚iPhone OS 3.xå¯ä»¥è§£å‹lzmaå‹ç¼©ã€‚</li>
<li>å¦‚æœdebåŒ…å«çš„æ–‡ä»¶æ–‡æœ¬é‡æ¯”è¾ƒå¤§ï¼Œé‚£ä¹ˆä¸€èˆ¬å¯ä»¥è·å¾—ä¸é”™çš„å‹ç¼©ç‡ã€‚ä½†å¦‚æœæ˜¯åƒé“ƒå£°ï¼Œjpg/pngå›¾ç‰‡è¿™æ ·æ–‡ä»¶æœ¬èº«å°±æ˜¯å‹ç¼©æ ¼å¼çš„æƒ…å†µï¼Œç»§ç»­å‹ç¼©çš„å¯èƒ½æ€§å°±ä¸é«˜äº†ï¼Œè¿™ç±»æƒ…å†µå¾ˆéš¾è·å¾—æ¯”è¾ƒå¥½çš„å‹ç¼©ç‡</li>
</ul>
</blockquote>
<h4 id="ã€å¯é€‰ã€‘debæ–‡ä»¶è§„èŒƒå‘½å"><a href="#ã€å¯é€‰ã€‘debæ–‡ä»¶è§„èŒƒå‘½å" class="headerlink" title="ã€å¯é€‰ã€‘debæ–‡ä»¶è§„èŒƒå‘½å"></a>ã€å¯é€‰ã€‘debæ–‡ä»¶è§„èŒƒå‘½å</h4><pre><code>dpkg-name abc_1.0.deb
</code></pre><p>å¦‚æœæƒ³æŒ‡å®šæ–‡ä»¶åæ ¼å¼ï¼Œå¯ä»¥ä½¿ç”¨</p>
<pre><code>dpkg-name --help
</code></pre><blockquote>
<p>å›¾å½¢ç•Œé¢çš„debåˆ¶ä½œå·¥å…· Debian Package Maker ç½‘å€ï¼š <a href="http://code.google.com/p/debianpackagemaker/" target="_blank" rel="noopener">http://code.google.com/p/debianpackagemaker/</a> ä¸ªäººæ„Ÿè§‰ä¸å¦‚ç›´æ¥åœ¨å‘½ä»¤è¡Œé‡Œæ¥çš„ç›´è§‚ï¼Œæœ‰å…´è¶£çš„æœ‹å‹å¯ä»¥è‡ªå·±è¯•è¯•ã€‚  ï¼» éœ€è¦ç¿»å¢™ ï¼½</p>
</blockquote>
<h2 id="æ–°-åˆ¶ä½œè‡ªå·±çš„debæ–‡ä»¶"><a href="#æ–°-åˆ¶ä½œè‡ªå·±çš„debæ–‡ä»¶" class="headerlink" title="(æ–°) åˆ¶ä½œè‡ªå·±çš„debæ–‡ä»¶"></a>(æ–°) åˆ¶ä½œè‡ªå·±çš„debæ–‡ä»¶</h2><h3 id="å®‰è£…theos"><a href="#å®‰è£…theos" class="headerlink" title="å®‰è£…theos"></a>å®‰è£…theos</h3><p><a href="http://iphonedevwiki.net/index.php/Theos/Setup" target="_blank" rel="noopener">å®‰è£…æ–¹æ³•</a></p>
<p>é€‰æ‹©theosçš„å®‰è£…ç›®å½•ï¼Œå®˜æ–¹å»ºè®®æ”¾åœ¨é»˜è®¤çš„ /opt/theos.ç„¶åæ‰§è¡Œ</p>
<pre><code>export THEOS=/opt/theos
</code></pre><p>ä¸ºäº†éªŒè¯è®¾ç½®æˆåŠŸæ²¡æœ‰</p>
<pre><code>echo $THEOS
</code></pre><p>å¦‚æœæ‰“å° <code>/opt/theos</code> è¯´æ˜æ‘„åˆ¶å®Œæˆ</p>
<p>Using git:</p>
<pre><code>git clone --recursive git://github.com/DHowett/theos.git /opt/theos
</code></pre><p>Alternatively, you can use svn, if you prefer:</p>
<pre><code>svn co http://svn.howett.net/svn/theos/trunk $THEOS
</code></pre><blockquote>
<p><code>git clone -b stableversion https://github.com/haorenqq/theos/ $THEOS</code><br>ä¸è¦æ‰§è¡Œä¸Šé¢çš„è¯­å¥ï¼Œç”¨ä¸Šé¢çš„æ–¹æ³•æ›¿æ¢  ç‰¹åˆ«æ„Ÿè°¢ç½‘åä¸ºé€é¥ç¬›å­ çš„çƒ­å¿ƒæœ‹å‹ æä¾›çš„åˆ†æ”¯ï¼Œç”±äºåŸtheosæœ€æ–°çš„ç‰ˆæœ¬ä¸å…¼å®¹iosopendevï¼Œæ‰€ä»¥ç”¨15å¹´çš„è€ç‰ˆæœ¬</p>
</blockquote>
<p>ä»¥ä¸Šæ“ä½œï¼Œå¦‚æœå‡ºç°ä»»ä½•å…³äºæƒé™çš„é”™è¯¯ã€‚ä½¿ç”¨sudoå°±å¯ä»¥äº†ã€‚</p>
<h3 id="å®‰è£…idld"><a href="#å®‰è£…idld" class="headerlink" title="å®‰è£…idld"></a>å®‰è£…idld</h3><p>å…¶å®æˆ‘ä¸çŸ¥é“è¿™ä¸ªæ˜¯å¹²ä»€ä¹ˆçš„ï¼Ÿä½†æ˜¯å‘¢ï¼Œè¯´æ˜¯ç­¾åçš„ã€‚ã€‚ã€‚ä½†æ˜¯æˆ‘æ²¡ç”¨åˆ°è¿‡ï¼Œä½†æ˜¯è¿˜æ˜¯è®°å½•ä¸€ä¸‹æ¯•ç«Ÿæœ‰ä¸å°‘å‘</p>
<p>æŒ‰ç…§å®˜æ–¹çš„æ•™ç¨‹æ˜¯å¦‚æ­¤çš„è¯´çš„ã€‚</p>
<pre><code>git clone git://git.saurik.com/ldid.git
cd ldid
git submodule update --init
./make.sh
cp -f ./ldid $THEOS/bin/ldid
</code></pre><p>ä½†æ˜¯é€šå¸¸å‘ç”Ÿé”™è¯¯ï¼Œ<br>ç¬¬ä¸€ä¸ªé”™è¯¯å°±æ˜¯ å¼•å…¥äº† <code>#include &lt;openssl/err.h&gt;</code> ï¼Œé»˜è®¤æ˜¯ä¸å­˜åœ¨ è¿™ä¸ªæ–‡ä»¶å¤¹çš„é¢ã€‚<br>ç¬¬äºŒä¸ªé”™è¯¯å°±æ˜¯ make.shä¸­çš„ä»£ç é»˜è®¤æ˜¯åªåŒ¹é…Xcode5-1-1çš„åç§°ï¼Œæ‰€ä»¥éœ€è¦ä¿®æ”¹ make æ–‡ä»¶ã€‚</p>
<p>ä¸‹è½½ <a href="/publicFiles/iosOpenDevå®‰è£…é™„ä»¶-æ–°.zip">æ–‡ä»¶</a> ä¿®å¤</p>
<p>æ¥ä¸‹æ¥ä½¿ç”¨å‘½ä»¤ã€‚ç”Ÿæˆ ldid æ–‡ä»¶<code>./make.sh</code> . åæ­£æˆ‘æ˜¯ç”Ÿæˆå¤±è´¥äº†</p>
<p>ä½ å¯ä»¥ç›´æ¥ä¸‹è½½åˆ«äººå·²ç»ç¼–è¯‘å®Œæˆçš„æ–‡ä»¶ <a href="/publicFiles/ldid">ldidæ–‡ä»¶</a></p>
<p>ä¹‹åå°†æ–‡ä»¶æ‹·è´åˆ° <code>/opt/theos/bin</code> ä¸‹å°±å¯ä»¥äº†</p>
<h3 id="å®‰è£…iOSOpenDev"><a href="#å®‰è£…iOSOpenDev" class="headerlink" title="å®‰è£…iOSOpenDev"></a>å®‰è£…iOSOpenDev</h3><pre class="line-numbers language-shell"><code class="language-shell">git clone https://github.com/AimobierExample/iOSOpenDevInstallFix
cd iOSOpenDevInstallFix
sh repair.sh
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>ä¹‹åæ‰“å¼€ <code>iOSOpenDev-1.6-2.pkg</code> æŒ‰ç…§æç¤ºå°±å¯ä»¥å®‰è£…å®Œæˆäº†</p>
<p>æ‰“å¼€xcodeå°±å¯ä»¥çœ‹è§è¶Šç‹±çš„é¡¹ç›®äº† é€‰æ‹© <code>Logos TWeak</code></p>
<p>æŒ‰ç…§xmæ–‡ä»¶å†…çš„æç¤ºï¼Œlibsubstrate.dylibæ·»åŠ åˆ°å·¥ç¨‹ä¸­(åœ¨å®‰è£…å¥½çš„/opt/iOSOpenDev/lib ç›®å½•ä¸‹)ï¼Œç„¶åæŠŠxmä¸­çš„å†…å®¹æ¸…ç©ºã€‚mmæ–‡ä»¶çš„å†…å®¹ä¼šæ ¹æ®xmæ–‡ä»¶ä¸­çš„å†…å®¹ç¼–è¯‘åè‡ªåŠ¨ç”Ÿæˆã€‚</p>
<pre><code>%hook SpringBoard  
- (void)applicationDidFinishLaunching:(id)application{  
    %orig;    
    UIAlertView * alert = [[UIAlertView alloc]initWithTitle:@&quot;Welcome&quot; message:@&quot;HelloWorld!&quot; delegate:nil cancelButtonTitle:@&quot;Thanks&quot; otherButtonTitles:nil];  
    [alert show];  
}  
%end
</code></pre><p>ç‚¹å‡»èœå• <code>Product - Build For - Profiling</code> è¿™ä¸ªæ—¶å€™é€šå¸¸ä¼šæŠ¥é”™ï¼Œå› ä¸ºçœŸæœºè°ƒè¯•ä¼šå‡ºç°é—®é¢˜</p>
<pre><code>Failed to create directory /var/root/iOSOpenDevPackages on device ä½ çš„iOSè®¾å¤‡IPåœ°å€
</code></pre><p>ä½†æ˜¯æ­¤åˆ»å·²ç»åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹å‡ºç°äº† å˜å·²å®Œæˆçš„ debæ–‡ä»¶äº†ï¼Œä½ å¯ä»¥ç›´æ¥æ·»åŠ åˆ°å’±ä»¬çš„æºæœåŠ¡å™¨ä¸­ï¼ŒæŒ‰ç…§ä¹‹å‰çš„æ•™ç¨‹ç”Ÿæˆ packages å®Œæˆå®‰è£…ã€‚</p>
<h3 id="çœŸæœºè°ƒè¯•"><a href="#çœŸæœºè°ƒè¯•" class="headerlink" title="çœŸæœºè°ƒè¯•"></a>çœŸæœºè°ƒè¯•</h3><p>ç°åœ¨è°ƒè¯•è¶Šç‹±è®¾å¤‡ï¼Œåœ¨å·²ç»è¶Šç‹±çš„æ‰‹æœºä¸Šæ‰“å¼€Cydiaï¼Œæœç´¢ä¸‹åˆ—æ’ä»¶<br>å¦‚æœæœç´¢ä¸åˆ°ï¼Œæ‰“å¼€è½¯ä»¶æº-ç¼–è¾‘ åˆ é™¤BigBoså’ŒModMyiï¼Œå†å›åˆ°é¦–é¡µï¼Œç‚¹å‡»æ›´å¤šè½¯ä»¶æºï¼Œé‡æ–°æ·»åŠ è¿™ä¸¤ä¸ªå³å¯æœç´¢åˆ°ä¸‹åˆ—æ’ä»¶</p>
<pre><code>Core Utilities
Core Utilities(/bin)
diskdev-cmds
file-cmds
system-cmds
Mobileterminal
openSSH
sshpass
toggle ssh
preferencdloader
substrate safe mode
syslogd to /var/log/syslog
</code></pre><p>å†åœ¨Xcodeä¸­çš„Targetçš„Build Settingsä¸­çš„Code Signingä¸­ï¼Œæ”¹ä¸ºDonâ€™t Code Sign.<br>æœ€åæ‰“å¼€Target-Build Settings æ‰¾åˆ°iOSOpenDevDeviceé€‰é¡¹ï¼Œå¡«å…¥è¶Šç‹±æ‰‹æœºçš„æœ¬åœ°ip</p>
<p>ä¹‹åæ‰“å¼€ç»ˆç«¯åˆ›å»ºkey</p>
<pre><code>iosod sshkey -h 192.168.23.71ï¼ˆæ¢æˆä½ çš„iOSè®¾å¤‡IPåœ°å€ï¼‰
</code></pre><p>åˆ›å»ºå®Œæˆ</p>
<p>ç‚¹å‡»èœå• <code>Product - Build For - Profiling</code></p>
<p>å°±å¯ä»¥å®‰è£…åˆ°è®¾å¤‡ï¼Œå®‰è£…å®Œæˆä¹‹åï¼Œè®¾å¤‡å›è‡ªå·±é‡å¯ï¼Œä¹‹åå°±ä¼šå¼¹å‡ºäº†ä¸€ä¸ªalertViewã€‚</p>
<h2 id="Theos-åˆ›å»º-Cydia-åº”ç”¨"><a href="#Theos-åˆ›å»º-Cydia-åº”ç”¨" class="headerlink" title="Theos åˆ›å»º Cydia åº”ç”¨"></a>Theos åˆ›å»º Cydia åº”ç”¨</h2><h3 id="é¦–å…ˆå®‰è£…-Theos"><a href="#é¦–å…ˆå®‰è£…-Theos" class="headerlink" title="é¦–å…ˆå®‰è£… Theos"></a>é¦–å…ˆå®‰è£… Theos</h3><p><a href="http://iphonedevwiki.net/index.php/Theos/Setup" target="_blank" rel="noopener">å®‰è£…æ–¹æ³•</a></p>
<p>é€‰æ‹©theosçš„å®‰è£…ç›®å½•ï¼Œå®˜æ–¹å»ºè®®æ”¾åœ¨é»˜è®¤çš„ /opt/theos.ç„¶åæ‰§è¡Œ</p>
<pre><code>export THEOS=/opt/theos
</code></pre><p>ä¸ºäº†éªŒè¯è®¾ç½®æˆåŠŸæ²¡æœ‰</p>
<pre><code>echo $THEOS
</code></pre><p>å¦‚æœæ‰“å° <code>/opt/theos</code> è¯´æ˜æ‘„åˆ¶å®Œæˆ</p>
<p>Using git:</p>
<pre><code>git clone --recursive git://github.com/DHowett/theos.git /opt/theos
</code></pre><h3 id="ä½¿ç”¨Theosåˆ›å»ºåº”ç”¨"><a href="#ä½¿ç”¨Theosåˆ›å»ºåº”ç”¨" class="headerlink" title="ä½¿ç”¨Theosåˆ›å»ºåº”ç”¨"></a>ä½¿ç”¨Theosåˆ›å»ºåº”ç”¨</h3><p>å®‰è£…å®Œæˆä¹‹å ä½¿ç”¨ï¼š</p>
<pre><code>/opt/theos/bin/nic.pl
</code></pre><p>è°ƒç”¨ä¹‹å</p>
<pre class="line-numbers language-shell"><code class="language-shell">msiter:~ jingwenzheng$ /opt/theos/bin/nic.pl
NIC 2.0 - New Instance Creator
------------------------------
  [1.] iphone/activator_event
  [2.] iphone/application_modern
  [3.] iphone/cydget
  [4.] iphone/flipswitch_switch
  [5.] iphone/framework
  [6.] iphone/ios7_notification_center_widget
  [7.] iphone/library
  [8.] iphone/notification_center_widget
  [9.] iphone/preference_bundle_modern
  [10.] iphone/tool
  [11.] iphone/tweak
  [12.] iphone/xpc_service
Choose a Template (required): 2
Project Name (required): Demo
Package Name [com.yourcompany.demo]: com.demo
Author/Maintainer Name [è†æ–‡å¾]: jwz
[iphone/application_modern] Class name prefix (two or more characters) [XX]: demo
Instantiating iphone/application_modern in demo/...
Done.
msiter:~ jingwenzheng$
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>è¿™æ ·å°±åˆ›å»ºå®Œæˆäº†</p>
<h3 id="è¿è¡Œåˆ°çœŸæœº"><a href="#è¿è¡Œåˆ°çœŸæœº" class="headerlink" title="è¿è¡Œåˆ°çœŸæœº"></a>è¿è¡Œåˆ°çœŸæœº</h3><p>é¦–å…ˆè¦ç¡®ä¿éœ‡çº§ä¸Šé¢å®‰è£… openssh</p>
<pre><code>ssh root@ipåœ°å€
</code></pre><p>å¯†ç ã€‚é»˜è®¤ä¸º alpine</p>
<p>è¿™æ ·è¿æ¥ä¸Šå°±è¯´æ˜å®‰è£…å®Œæˆï¼Œå¯ä»¥è°ƒç”¨çš„åˆ°ï½</p>
<p>ä¹‹åè®¾ç½®ç¯å¢ƒå˜é‡<code>THEOS_DEVICE_IP</code> ä¸º çœŸæœº IPã€‚</p>
<p>ä¹‹å cd ç›®å½•ã€‚ ä½¿ç”¨å‘½ä»¤å®‰è£…åˆ°çœŸæœºä¸Š</p>
<pre><code>make package install
</code></pre><h4 id="ç¬¬ä¸€ä¸ªé—®é¢˜-ldid"><a href="#ç¬¬ä¸€ä¸ªé—®é¢˜-ldid" class="headerlink" title="ç¬¬ä¸€ä¸ªé—®é¢˜ ldid"></a>ç¬¬ä¸€ä¸ªé—®é¢˜ ldid</h4><p>ä½ å¯ä»¥ç›´æ¥ä¸‹è½½åˆ«äººå·²ç»ç¼–è¯‘å®Œæˆçš„æ–‡ä»¶ <a href="/publicFiles/ldid">ldidæ–‡ä»¶</a></p>
<p>ä¹‹åå°†æ–‡ä»¶æ‹·è´åˆ° <code>/opt/theos/bin</code> ä¸‹å°±å¯ä»¥äº†</p>
<p>é»˜è®¤æ˜¯æ²¡æœ‰æƒé™çš„ æ‰€ä»¥å¯èƒ½éœ€è¦ <code>sudo</code>. å¤åˆ¶å®Œæˆä¹‹åèµ‹äºˆæƒé™<code>sudo chmod 777 /opt/theos/bin/ldid</code></p>
<h4 id="ç¬¬äºŒä¸ªé—®é¢˜-dpkg"><a href="#ç¬¬äºŒä¸ªé—®é¢˜-dpkg" class="headerlink" title="ç¬¬äºŒä¸ªé—®é¢˜ dpkg"></a>ç¬¬äºŒä¸ªé—®é¢˜ dpkg</h4><p>æ²¡æœ‰å®‰è£…æ–‡ä»¶å·¥å…·</p>
<pre><code>brew install dpkg
</code></pre><h4 id="dpkg-1-18-14-ç‰ˆæœ¬é—®é¢˜"><a href="#dpkg-1-18-14-ç‰ˆæœ¬é—®é¢˜" class="headerlink" title="dpkg 1.18.14 ç‰ˆæœ¬é—®é¢˜"></a>dpkg 1.18.14 ç‰ˆæœ¬é—®é¢˜</h4><p>åœ¨ <code>1.18.14</code> ç‰ˆæœ¬ï¼Œdpkg <code>lzma</code> ä¸èƒ½ä½¿ç”¨äº†ï¼Œå¿…é¡»ä½¿ç”¨ <code>xz</code></p>
<h4 id="è¿™ä¸ªæ—¶å€™éœ€è¦ä¿®æ”¹-opt-theos-makefiles-package-deb-mk-æ–‡ä»¶"><a href="#è¿™ä¸ªæ—¶å€™éœ€è¦ä¿®æ”¹-opt-theos-makefiles-package-deb-mk-æ–‡ä»¶" class="headerlink" title="è¿™ä¸ªæ—¶å€™éœ€è¦ä¿®æ”¹ /opt/theos/makefiles/package/deb.mk æ–‡ä»¶"></a>è¿™ä¸ªæ—¶å€™éœ€è¦ä¿®æ”¹ <code>/opt/theos/makefiles/package/deb.mk</code> æ–‡ä»¶</h4><pre class="line-numbers language-Makefile"><code class="language-Makefile">ifeq ($(_THEOS_PACKAGE_FORMAT_LOADED),)
_THEOS_PACKAGE_FORMAT_LOADED := 1

_THEOS_DEB_PACKAGE_CONTROL_PATH := $(or $(wildcard $(THEOS_PROJECT_DIR)/control),$(wildcard $(THEOS_PROJECT_DIR)/layout/DEBIAN/control))
_THEOS_DEB_CAN_PACKAGE := $(if $(_THEOS_DEB_PACKAGE_CONTROL_PATH),$(_THEOS_TRUE),$(_THEOS_FALSE))

_THEOS_DEB_HAS_DPKG_DEB := $(call __executable,dpkg-deb)
ifneq ($(_THEOS_DEB_HAS_DPKG_DEB),$(_THEOS_TRUE))
internal-package-check::
    @echo "$(MAKE) package requires dpkg-deb."; exit 1
endif

ifeq ($(_THEOS_DEB_CAN_PACKAGE),$(_THEOS_TRUE)) # Control file found (or layout/ found.)
THEOS_PACKAGE_NAME := $(shell grep -i "^Package:" "$(_THEOS_DEB_PACKAGE_CONTROL_PATH)" | cut -d' ' -f2-)
THEOS_PACKAGE_ARCH := $(shell grep -i "^Architecture:" "$(_THEOS_DEB_PACKAGE_CONTROL_PATH)" | cut -d' ' -f2-)
THEOS_PACKAGE_BASE_VERSION := $(shell grep -i "^Version:" "$(_THEOS_DEB_PACKAGE_CONTROL_PATH)" | cut -d' ' -f2-)

$(_THEOS_ESCAPED_STAGING_DIR)/DEBIAN:
    $(ECHO_NOTHING)mkdir -p "$(THEOS_STAGING_DIR)/DEBIAN"$(ECHO_END)
ifeq ($(_THEOS_HAS_STAGING_LAYOUT),1) # If we have a layout/ directory, copy layout/DEBIAN to the staging directory.
    $(ECHO_NOTHING)[ -d "$(THEOS_PROJECT_DIR)/layout/DEBIAN" ] && rsync -a "$(THEOS_PROJECT_DIR)/layout/DEBIAN/" "$(THEOS_STAGING_DIR)/DEBIAN" $(_THEOS_RSYNC_EXCLUDE_COMMANDLINE) || true$(ECHO_END)
endif # _THEOS_HAS_STAGING_LAYOUT

$(_THEOS_ESCAPED_STAGING_DIR)/DEBIAN/control: $(_THEOS_ESCAPED_STAGING_DIR)/DEBIAN
    $(ECHO_NOTHING)sed -e '/^[Vv]ersion:/d' "$(_THEOS_DEB_PACKAGE_CONTROL_PATH)" > "$@"$(ECHO_END)
    $(ECHO_NOTHING)echo "Version: $(_THEOS_INTERNAL_PACKAGE_VERSION)" >> "$@"$(ECHO_END)
    $(ECHO_NOTHING)echo "Installed-Size: $(shell du $(_THEOS_PLATFORM_DU_EXCLUDE) DEBIAN -ks "$(THEOS_STAGING_DIR)" | cut -f 1)" >> "$@"$(ECHO_END)

before-package:: $(_THEOS_ESCAPED_STAGING_DIR)/DEBIAN/control

_THEOS_DEB_PACKAGE_FILENAME = $(THEOS_PACKAGE_DIR)/$(THEOS_PACKAGE_NAME)_$(_THEOS_INTERNAL_PACKAGE_VERSION)_$(THEOS_PACKAGE_ARCH).deb
internal-package::
    $(ECHO_NOTHING)COPYFILE_DISABLE=1 $(FAKEROOT) -r dpkg-deb -Zgzip -b "$(THEOS_STAGING_DIR)" "$(_THEOS_DEB_PACKAGE_FILENAME)" $(STDERR_NULL_REDIRECT)$(ECHO_END)

# This variable is used in package.mk
after-package:: __THEOS_LAST_PACKAGE_FILENAME = $(_THEOS_DEB_PACKAGE_FILENAME)

else # _THEOS_DEB_CAN_PACKAGE == 0
internal-package::
    @echo "$(MAKE) package requires you to have a layout/ directory in the project root, containing the basic package structure, or a control file in the project root describing the package."; exit 1

endif # _THEOS_DEB_CAN_PACKAGE
endif # _THEOS_PACKAGE_FORMAT_LOADED
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>è¿™æ ·æŒ‰ç†å°±å¯ä»¥è¿è¡Œäº†</p>
]]></content>
      
        <categories>
            
            <category> IOS </category>
            
        </categories>
        
        
        <tags>
            
            <tag> è¶Šç‹± </tag>
            
            <tag> cydia </tag>
            
            <tag> åˆ¶ä½œæº </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[WKWebView åˆ¶ä½œè¯¦æƒ…é¡µçš„ä¸€äº›ç»éªŒ]]></title>
      <url>http://www.msiter.com/2016/09/21/WKWebView%20%E5%88%B6%E4%BD%9C%E8%AF%A6%E6%83%85%E9%A1%B5%E7%9A%84%E4%B8%80%E4%BA%9B%E7%BB%8F%E9%AA%8C/</url>
      <content type="html"><![CDATA[<h2 id="Hello-World"><a href="#Hello-World" class="headerlink" title="Hello World"></a>Hello World</h2><p>å¥½ä¹…å¥½ä¹…æ²¡æœ‰æ›´æ–°è¿‡åšå®¢äº†ï¼Œä»Šå¤©å»é¢è¯•äº†ä¸€å®¶å…¬å¸ã€‚è¢«è¯¢é—®åˆ°å…³äºèµ„è®¯ç±»Appçš„è¯¦æƒ…é¡µé—®é¢˜ï¼Œæƒ³åˆ°äº†å¾ˆå¤šä¹‹å‰åšè¯¦æƒ…é¡µæ—¶å€™é‡è§çš„é—®é¢˜å’Œè§£å†³çš„é—®é¢˜ï¼Œæ‰€ä»¥å¿ƒè¡€æ¥æ½®çš„æƒ³è®°å½•ä¸‹æ¥ã€‚</p>
<p><img class = "g-pl-90"  src="http://image.msiter.com/stock-photo-184033745.jpg" alt="" title="åªæœ‰ä¸€ç§è‹±é›„ä¸»ä¹‰ï¼Œå°±æ˜¯åœ¨è®¤æ¸…è¿™ä¸ªä¸–ç•Œä¹‹åä¾ç„¶çƒ­çˆ±ä»–ã€‚ â€”â€”ç½—æ›¼ç½—å…°ã€‚"></p>
<a id="more"></a>
<h2 id="å¦‚ä½•å»å±•ç¤ºä¸€ä¸ªè¯¦æƒ…é¡µå‘¢"><a href="#å¦‚ä½•å»å±•ç¤ºä¸€ä¸ªè¯¦æƒ…é¡µå‘¢" class="headerlink" title="å¦‚ä½•å»å±•ç¤ºä¸€ä¸ªè¯¦æƒ…é¡µå‘¢"></a>å¦‚ä½•å»å±•ç¤ºä¸€ä¸ªè¯¦æƒ…é¡µå‘¢</h2><p>é‚£ä¹ˆåºŸè¯å°‘è¯´ï¼Œäº®å‰‘å§ï¼</p>
<h3 id="å¦‚ä½•å»æ˜¾ç¤ºä¸€ä¸ªWKWebViewå‘¢"><a href="#å¦‚ä½•å»æ˜¾ç¤ºä¸€ä¸ªWKWebViewå‘¢" class="headerlink" title="å¦‚ä½•å»æ˜¾ç¤ºä¸€ä¸ªWKWebViewå‘¢"></a>å¦‚ä½•å»æ˜¾ç¤ºä¸€ä¸ªWKWebViewå‘¢</h3><p>å…¶å®æ€ä¹ˆè¯´å‘¢ï¼Œæˆ‘è§‰çš„å…¶å®å§ã€‚æ¯ä¸ªäººéƒ½å¤§åŒå°å¼‚ã€‚æ— éå°±æ˜¯å¦‚ä½•å°†æ•°æ®è½¬æ¢æˆHtmlå¹¶ä¸”å°†å­—ç¬¦ä¸²ä¼ é€’ç»™WebViewã€‚ä¹‹åå±•ç¤ºå‡ºæ¥è€Œå·²ã€‚é‚£ä¹ˆæˆ‘ä»¬å¾ˆå¿«å°±ä¼šé‡åˆ°ç¬¬ä¸€ä¸ªé—®é¢˜ã€‚å¦‚ä½•å°†æ•°æ®è½¬æ¢æˆHtmlæ ¼å¼çš„å­—ç¬¦ä¸²å‘¢ï¼Ÿ</p>
<h4 id="æå®šæˆ‘ä»¬çš„æ¨¡æ¿å›"><a href="#æå®šæˆ‘ä»¬çš„æ¨¡æ¿å›" class="headerlink" title="æå®šæˆ‘ä»¬çš„æ¨¡æ¿å›"></a>æå®šæˆ‘ä»¬çš„æ¨¡æ¿å›</h4><p>æˆ‘ä¸æ¸…æ¥šå…¶ä»–å¼€å‘è€…ä»¬é‡è§çš„æ•°æ®ç»“æ„ï¼Œä½†æ˜¯æˆ‘çš„æ•°æ®ç»“æ„å¦‚ä¸‹/</p>
<pre class="line-numbers language-swift"><code class="language-swift"><span class="token comment" spellcheck="true">//</span>
<span class="token comment" spellcheck="true">//  NewContent.swift</span>
<span class="token comment" spellcheck="true">//  Journalism</span>
<span class="token comment" spellcheck="true">//</span>
<span class="token comment" spellcheck="true">//  Created by Mister on 16/5/30.</span>
<span class="token comment" spellcheck="true">//  Copyright Â© 2016å¹´ aimobier. All rights reserved.</span>
<span class="token comment" spellcheck="true">//</span>

<span class="token keyword">import</span> <span class="token builtin">RealmSwift</span>

<span class="token comment" spellcheck="true">///  é¢‘é“çš„æ•°æ®æ¨¡å‹</span>
open <span class="token keyword">class</span> <span class="token class-name">Content</span><span class="token punctuation">:</span> <span class="token builtin">Object</span> <span class="token punctuation">{</span>

    <span class="token comment" spellcheck="true">/// ç”¨äºè·å–è¯„è®ºçš„ docid</span>
    <span class="token keyword">dynamic</span> <span class="token keyword">var</span> txt<span class="token punctuation">:</span> <span class="token builtin">String</span><span class="token operator">?</span> <span class="token operator">=</span> <span class="token constant">nil</span>

    <span class="token comment" spellcheck="true">/// æ–°é—»Url</span>
    <span class="token keyword">dynamic</span> <span class="token keyword">var</span> img<span class="token punctuation">:</span> <span class="token builtin">String</span><span class="token operator">?</span> <span class="token operator">=</span> <span class="token constant">nil</span>

    <span class="token comment" spellcheck="true">/// æ–°é—»æ ‡é¢˜</span>
    <span class="token keyword">dynamic</span> <span class="token keyword">var</span> vid<span class="token punctuation">:</span> <span class="token builtin">String</span><span class="token operator">?</span> <span class="token operator">=</span> <span class="token constant">nil</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">///  é¢‘é“çš„æ•°æ®æ¨¡å‹</span>
open <span class="token keyword">class</span> <span class="token class-name">NewContent</span><span class="token punctuation">:</span> <span class="token builtin">Object</span> <span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">/// æ–°é—»ID</span>
    <span class="token keyword">dynamic</span> <span class="token keyword">var</span> nid <span class="token operator">=</span> <span class="token number">1</span>
    <span class="token comment" spellcheck="true">// æ–°é—»çš„è¯¦æƒ…</span>
    <span class="token keyword">let</span> content <span class="token operator">=</span> <span class="token builtin">List</span><span class="token operator">&lt;</span><span class="token builtin">Content</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">// Should be declared with `let`</span>
    <span class="token comment" spellcheck="true">// More â€¦â€¦</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>è¯¦æƒ…é¡µå¯¹è±¡åŒ…å«ä¸‰ä¸ªå­—æ®µ <code>img</code>,<code>txt</code>,<code>vid</code>ã€‚ä¹Ÿå°±æ˜¯å›¾ç‰‡ï¼Œæ–‡å­—ï¼Œè§†é¢‘ä¸‰ç§ç±»å‹ã€‚<br>é‚£è¿™æ ·å°±ç®€å•äº†ã€‚æŠŠä»–ä»¬æ‹¼è£…æˆä¸€ä¸ªHtml è¿˜ä¸ç®€å•~  </p>
<pre><code>
String += String // ?????  è¿™æ ·å­ï¼Ÿ  æˆ‘æ˜¯æ‹’ç»çš„â€¦â€¦
</code></pre><p>ä¹‹åæƒ³èµ·æ¥ä¹‹å‰åšæœåŠ¡çš„æ—¶å€™ jsqï¼Œejsâ€¦ è¿™äº›è§†å›¾æ¨¡æ¿éƒ½æ˜¯å¯ä»¥å®Œæˆç°åœ¨çš„éœ€æ±‚çš„ï¼Œä¸çŸ¥é“IOS æœ‰æ²¡æœ‰å‘¢ï¼Ÿ</p>
<p>æ‰€ä»¥è¯´ï¼  åºŸè¯ï¼  å½“ç„¶æœ‰å•Šï¼ <a href="https://github.com/mattgemmell/MGTemplateEngine" target="_blank" rel="noopener">MGTemplateEngine</a></p>
<p>è¿™å°±æ˜¯äº†~  ä½†æ˜¯ï¼ï¼ï¼  é—®é¢˜è¿™ä¸ªå¤§ç¥æ²¡æœ‰ä½¿ç”¨é‚£ä¸ªç¬¬ä¸‰æ–¹çš„ç®¡ç†æ’ä»¶æ¥è®©åˆ«äººå¯¼å…¥è‡ªå·±çš„æ¡†æ¶~  éš¾é“æˆ‘åˆè¦å›å½’åˆ° ä¹‹å‰é‚£æ®µ è¢«æ‹–æ‹½å¼•å…¥æ‰€æ”¯é…çš„ææƒ§å—ï¼Ÿ</p>
<pre><code>???? æˆ‘è¿˜æ˜¯æ‹’ç»çš„~~~
</code></pre><p>é‚£ä¹ˆæ¥ä¸‹æ¥å°±æœ‰ä¸¤ç§æ–¹å¼æ¥å¼•å…¥è¿™ä¸ªæ¡†æ¶äº†~  å½“ç„¶äº† å…¨éƒ½æ˜¯ Cocoapodsçš„â€¦â€¦</p>
<p>ç¬¬ä¸€ç§ä½¿ç”¨ æœ¬åœ°å¼•å…¥çš„æ–¹å¼ï¼š</p>
<p>å¦‚æœä½ æƒ³æœ¬åœ°å¼•å…¥çš„è¯ï¼Œé‚£å¾ˆç®€å•çš„</p>
<p>åœ¨ä½ çš„é¡¹ç›®æ ¹ç›®å½•ä¸‹å»ºç«‹ä¸€ä¸ªæ–‡ä»¶å¤¹ å–åå­—å‘¢~  å°±å«åš MGTemplateEngine ï¼Œä¹‹å æŠŠ clone ä¸‹æ¥çš„ MGTemplateEngine é¡¹ç›®æ”¾å…¥ä¸€ä¸ªæ–°å»ºçš„Classes ç›®å½•ä¸‹ã€‚ä¹‹åå†classes åŒçº§ç›®å½•ä¸­æ–°å»ºä¸€ä¸ª æ–‡ä»¶ <code>MGTemplateEngine.podspec</code></p>
<p>é‡Œé¢çš„ä»£ç å‘¢ï¼Œå¤§æ¦‚å†™æˆè¿™æ ·å­</p>
<pre class="line-numbers language-ruby"><code class="language-ruby"><span class="token comment" spellcheck="true">#</span>
<span class="token comment" spellcheck="true"># Be sure to run `pod lib lint SwaggerClient.podspec' to ensure this is a</span>
<span class="token comment" spellcheck="true"># valid spec and remove all comments before submitting the spec.</span>
<span class="token comment" spellcheck="true">#</span>
<span class="token comment" spellcheck="true"># Any lines starting with a # are optional, but encouraged</span>
<span class="token comment" spellcheck="true">#</span>
<span class="token comment" spellcheck="true"># To learn more about a Podspec see http://guides.cocoapods.org/syntax/podspec.html</span>
<span class="token comment" spellcheck="true">#</span>

<span class="token constant">Pod</span><span class="token punctuation">:</span><span class="token symbol">:Spec</span><span class="token punctuation">.</span><span class="token keyword">new</span> <span class="token class-name">do</span> <span class="token operator">|</span>s<span class="token operator">|</span>
    s<span class="token punctuation">.</span>name             <span class="token operator">=</span> <span class="token string">"MGTemplateEngine"</span>
    s<span class="token punctuation">.</span>version          <span class="token operator">=</span> <span class="token string">"1.0.0"</span>

    s<span class="token punctuation">.</span>summary          <span class="token operator">=</span> <span class="token string">"å¥‡ç‚¹èµ„è®¯"</span>
    s<span class="token punctuation">.</span>description      <span class="token operator">=</span> <span class="token operator">&lt;</span><span class="token operator">&lt;</span><span class="token operator">-</span><span class="token constant">DESC</span>
                        <span class="token keyword">if</span> youï½  <span class="token constant">Shabi</span> <span class="token constant">Boom</span> <span class="token constant">Sha</span> <span class="token constant">Ga</span> la ga
                         <span class="token constant">DESC</span>

    s<span class="token punctuation">.</span>platform     <span class="token operator">=</span> <span class="token symbol">:ios</span><span class="token punctuation">,</span> <span class="token string">'7.0'</span>
    s<span class="token punctuation">.</span>requires_arc <span class="token operator">=</span> <span class="token keyword">true</span>

    s<span class="token punctuation">.</span>framework    <span class="token operator">=</span> <span class="token string">'SystemConfiguration'</span>

    s<span class="token punctuation">.</span>homepage     <span class="token operator">=</span> <span class="token string">"https://github.com/swagger-api/swagger-codegen"</span>
    s<span class="token punctuation">.</span>license      <span class="token operator">=</span> <span class="token string">"MIT"</span>
    s<span class="token punctuation">.</span>source       <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token symbol">:git</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token string">"https://github.com/swagger-api/swagger-codegen.git"</span><span class="token punctuation">,</span> <span class="token symbol">:tag</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token string">"<span class="token interpolation"><span class="token delimiter tag">#{</span>s<span class="token punctuation">.</span>version<span class="token delimiter tag">}</span></span>"</span> <span class="token punctuation">}</span>
    s<span class="token punctuation">.</span>author       <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token string">"Swagger"</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token string">"apiteam@swagger.io"</span> <span class="token punctuation">}</span>

    s<span class="token punctuation">.</span>source_files <span class="token operator">=</span> <span class="token string">'Classes/**/*'</span>
    s<span class="token punctuation">.</span>public_header_files <span class="token operator">=</span> <span class="token string">'Classes/**/*.h'</span>
<span class="token keyword">end</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>æ‰€æœ‰è¯´å¤§æ¦‚çš„ç›®å½•åˆ†å¸ƒå‘¢~  æ˜¯è¿™ä¸ªæ ·å­çš„~</p>
<pre><code>â”€â”€ é¡¹ç›®æ ¹ç›®å½•
 â”œ MGTemplateEngine
 â”œâ”€â”€â”€â”€â”€â”€â”œ MGTemplateEngine.podspec
 â”œâ”€â”€â”€â”€â”€â”€â”œ Classes
 â”‚      â””â”€â”€â”€â”€ MGTemplateEngine æ‰€æœ‰çš„æ–‡ä»¶
 â”” ä½ çš„å…¶ä»–æ–‡ä»¶
</code></pre><p>ä¹‹åå‘¢ï¼Œåœ¨ä½ é¡¹ç›®ä¸­çš„Podfile å†™ä¸‹è¿™æ ·çš„ä»£ç ~</p>
<pre class="line-numbers language-ruby"><code class="language-ruby">    pod <span class="token string">'MGTemplateEngine'</span><span class="token punctuation">,</span> <span class="token symbol">:path</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token string">'MGTemplateEngine/'</span>     <span class="token comment" spellcheck="true">## MGTemplateEngineç»„ä»¶</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>è¿è¡Œå®Œæˆ pod install~  Woooooo~ æå®š~</p>
<p>ç¬¬äºŒç§å‘¢</p>
<pre class="line-numbers language-ruby"><code class="language-ruby">    pod <span class="token string">'JMGTemplateEngine'</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>è¿™ä¸ªä¸œè¥¿æ˜¯æˆ‘è‡ªå·±åšçš„ä¸ºäº†æ–¹ä¾¿â€¦â€¦â€¦â€¦â€¦â€¦</p>
<p>è¿è¡Œå®Œæˆ pod install~  Woooooo~ æå®š~</p>
<h4 id="æ˜¾ç¤ºå‡ºæ¥æˆ‘ä»¬çš„è¯¦æƒ…å§"><a href="#æ˜¾ç¤ºå‡ºæ¥æˆ‘ä»¬çš„è¯¦æƒ…å§" class="headerlink" title="æ˜¾ç¤ºå‡ºæ¥æˆ‘ä»¬çš„è¯¦æƒ…å§~"></a>æ˜¾ç¤ºå‡ºæ¥æˆ‘ä»¬çš„è¯¦æƒ…å§~</h4><p>æ²¡ä»€ä¹ˆå¥½è¯´çš„ç›´æ¥ä¸Šä»£ç å§</p>
<pre class="line-numbers language-swift"><code class="language-swift"><span class="token keyword">import</span> <span class="token builtin">MGTemplateEngine</span>

<span class="token keyword">extension</span> <span class="token builtin">MGTemplateEngine</span><span class="token punctuation">{</span>

    <span class="token keyword">static</span> <span class="token keyword">var</span> shareTemplateEngine<span class="token punctuation">:</span><span class="token builtin">MGTemplateEngine</span><span class="token operator">!</span><span class="token punctuation">{</span>

        <span class="token keyword">let</span> templateEngine <span class="token operator">=</span> <span class="token function">MGTemplateEngine</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

        templateEngine<span class="token punctuation">.</span>matcher <span class="token operator">=</span> <span class="token function">ICUTemplateMatcher</span><span class="token punctuation">(</span>templateEngine<span class="token punctuation">:</span> templateEngine<span class="token punctuation">)</span>

        <span class="token keyword">return</span> templateEngine
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">getHtmlResourcesString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">String</span><span class="token punctuation">{</span>

        <span class="token keyword">let</span> variables <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"title"</span><span class="token punctuation">:</span><span class="token keyword">self</span><span class="token punctuation">.</span>title<span class="token punctuation">,</span><span class="token string">"source"</span><span class="token punctuation">:</span><span class="token keyword">self</span><span class="token punctuation">.</span>pname<span class="token punctuation">,</span><span class="token string">"ptime"</span><span class="token punctuation">:</span><span class="token keyword">self</span><span class="token punctuation">.</span>ptime<span class="token punctuation">,</span><span class="token string">"theme"</span><span class="token punctuation">:</span><span class="token string">"normal"</span><span class="token punctuation">,</span><span class="token string">"body"</span><span class="token punctuation">:</span>body<span class="token punctuation">]</span>

        <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token builtin">MGTemplateEngine</span><span class="token punctuation">.</span>shareTemplateEngine<span class="token punctuation">.</span><span class="token function">processTemplateInFile</span><span class="token punctuation">(</span>atPath<span class="token punctuation">:</span> templatePath<span class="token punctuation">,</span> withVariables<span class="token punctuation">:</span> variables<span class="token punctuation">)</span>

        <span class="token keyword">return</span> result<span class="token operator">!</span>
    <span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>è¿™æ ·å­æˆ‘ä»¬å°±å¾—åˆ°äº†Html çš„String å¯¹è±¡ï¼Œåœ¨è¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬åªè¦ ä½¿ç”¨WkWebViewçš„ <code>loadHTMLString</code> æ–¹æ³•å°±OKäº†å•Šï½</p>
<p>æ˜¯çš„æˆ‘ä»¬å¾ˆå¿«çš„å°±å‘ç°äº†ï½ã€€ã€€æˆ‘ä»¬çœŸçš„å¯ä»¥å±•ç¤ºäº†ï½ã€€ã€€</p>
<p>ä½†æ˜¯ï¼Œè¡Œé«˜æ€ä¹ˆåŠå‘¢ï¼Ÿã€€ã€€é‚£æˆ‘ä»¬å¾ˆå¿«å°±é‡åˆ°äº†æˆ‘ä»¬çš„å‡ ä¸ªå</p>
<h2 id="é‡åˆ°çš„åå·"><a href="#é‡åˆ°çš„åå·" class="headerlink" title="é‡åˆ°çš„åå·"></a>é‡åˆ°çš„åå·</h2><p>è™½ç„¶å±•ç¤ºå®Œæˆäº†ï¼Œä½†æ˜¯æ¥ä¸‹æ¥æˆ‘ä»¬å°±é‡åˆ°äº†å‡ ä¸ªé—®é¢˜ã€‚</p>
<p>æ¥ä¸‹æ¥é’ˆå¯¹è¿™å‡ ä¸ªé—®é¢˜ï¼Œæˆ‘æ¥ç»™ä½ è¯´è¯´ï¼Œæˆ‘æ˜¯æ€ä¹ˆè§£å†³çš„</p>
<h3 id="WebViewå’ŒJSçš„äº¤äº’"><a href="#WebViewå’ŒJSçš„äº¤äº’" class="headerlink" title="WebViewå’ŒJSçš„äº¤äº’"></a>WebViewå’ŒJSçš„äº¤äº’</h3><p>åœ¨çœ‹æ¥ä¸‹æ¥çš„ä¹‹å‰å’±ä»¬éœ€è¦çŸ¥é“ä¸€ä¸ªçŸ¥è¯†ç‚¹å°±æ˜¯WKWebVIewå’Œjsçš„äº¤äº’</p>
<pre class="line-numbers language-swift"><code class="language-swift">       <span class="token keyword">let</span> configuration <span class="token operator">=</span> <span class="token function">WKWebViewConfiguration</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
       configuration<span class="token punctuation">.</span>userContentController<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">,</span> name<span class="token punctuation">:</span> <span class="token string">"JSBridge"</span><span class="token punctuation">)</span>
       <span class="token keyword">self</span><span class="token punctuation">.</span>webView <span class="token operator">=</span> <span class="token function">WKWebView</span><span class="token punctuation">(</span>frame<span class="token punctuation">:</span> <span class="token function">CGRect</span><span class="token punctuation">(</span>origin<span class="token punctuation">:</span> <span class="token builtin">CGPoint</span><span class="token punctuation">.</span>zero<span class="token punctuation">,</span> size<span class="token punctuation">:</span> <span class="token function">CGSize</span><span class="token punctuation">(</span>width<span class="token punctuation">:</span> <span class="token number">600</span><span class="token punctuation">,</span> height<span class="token punctuation">:</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> configuration<span class="token punctuation">:</span> configuration<span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>è¿™ä¸ª<code>JSBridge</code>å°±æ˜¯æˆ‘ä»¬è‡ªå®šä¹‰çš„æ¡¥è¿å¯¹è±¡ï¼Œä½¿ç”¨è¿™ä¸ªæ¡¥è¿å¯¹è±¡å°±å¯ä»¥å®ç°äº¤äº’äº†</p>
<p>WKWebView -&gt; javaScriptçš„æ“ä½œ</p>
<pre class="line-numbers language-swift"><code class="language-swift"><span class="token keyword">self</span><span class="token punctuation">.</span>webView<span class="token punctuation">.</span><span class="token function">evaluateJavaScript</span><span class="token punctuation">(</span><span class="token string">"js è¯­å¥"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">(</span>data<span class="token punctuation">,</span> <span class="token number">_</span><span class="token punctuation">)</span> <span class="token keyword">in</span>
  <span class="token comment" spellcheck="true">// data å°±æ˜¯åå›çš„æ•°æ®</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>javaScript â€“&gt; WKWebViewçš„æ“ä½œ</p>
<pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">var</span> message <span class="token operator">=</span> <span class="token punctuation">{</span>
            <span class="token string">"type"</span><span class="token punctuation">:</span> <span class="token number">0</span>
        <span class="token punctuation">}</span>
window<span class="token punctuation">.</span>webkit<span class="token punctuation">.</span>messageHandlers<span class="token punctuation">.</span>JSBridge<span class="token punctuation">.</span><span class="token function">postMessage</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>ä¹‹åå†å’±ä»¬çš„é¡¹ç›®ä¸­å®ç°<code>WKScriptMessageHandler</code>ä»£ç†æ–¹æ³•</p>
<pre class="line-numbers language-swift"><code class="language-swift"><span class="token keyword">public</span> <span class="token keyword">func</span> <span class="token function">userContentController</span><span class="token punctuation">(</span><span class="token number">_</span> userContentController<span class="token punctuation">:</span> <span class="token builtin">WKUserContentController</span><span class="token punctuation">,</span> didReceive message<span class="token punctuation">:</span> <span class="token builtin">WKScriptMessage</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

       <span class="token keyword">guard</span> <span class="token keyword">let</span> bodyData <span class="token operator">=</span> message<span class="token punctuation">.</span>body <span class="token keyword">as</span><span class="token operator">?</span> <span class="token builtin">Dictionary</span><span class="token operator">&lt;</span><span class="token builtin">String</span><span class="token punctuation">,</span><span class="token builtin">AnyObject</span><span class="token operator">></span> <span class="token keyword">else</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token punctuation">}</span>

       <span class="token comment" spellcheck="true">/// bodyDaya å°±æ˜¯å’±ä»¬çš„ä¼ å…¥çš„å¯¹è±¡ è¿™é‡Œæ ¹æ®è‡ªå·±ä¼ å…¥çš„ç±»å‹æœºå‹ options åˆ¤æ–­å³å¯</span>
   <span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>å…¶ä¸­JSBridge å¯¹è±¡å°±æ˜¯å’±ä»¬çš„è‡ªå®šä¹‰æ¡¥è¿å¯¹è±¡</p>
<p>è¿™æ ·å°±å¯ä»¥å®ç°äº¤äº’äº†</p>
<h3 id="é«˜åº¦çš„è®¡ç®—é—®é¢˜"><a href="#é«˜åº¦çš„è®¡ç®—é—®é¢˜" class="headerlink" title="é«˜åº¦çš„è®¡ç®—é—®é¢˜"></a>é«˜åº¦çš„è®¡ç®—é—®é¢˜</h3><p>ç›¸ä¿¡å¾ˆæœ‹å‹ä¹Ÿéƒ½æŸ¥é˜…äº†å¾ˆå¤šä¸œè¥¿ï¼ŒçŸ¥é“äº† è°ƒç”¨ JSçš„ é«˜åº¦è®¡ç®—æ–¹æ³• .       </p>
<p><code>document.getElementById(&#39;section&#39;).offsetHeight</code></p>
<p>æˆ‘çš„ä¸»è¦å†…å®¹éƒ½æ˜¯æ˜¾ç¤ºåœ¨ä¸€ä¸ª sectionçš„Divé‡Œçš„ï¼Œä½ ä»¬å„ä½ä¹Ÿè¯·è¿›è¡Œè‡ªå·±çš„è®¡ç®—ã€‚</p>
<p>é‚£å¥½å§ï¼Œæˆ‘ä»¬å°±æ¥åšå§~~~</p>
<p>é¦–å…ˆæˆ‘ä»¬å…ˆç›‘å¬ WebView åŠ è½½å®Œæˆé¡µé¢ä¹‹åçš„äº‹ä»¶ï¼Œé‚£ä¹ˆæˆ‘ä»¬å…ˆå®ç°å®ƒçš„Delegateå§ã€‚</p>
<pre class="line-numbers language-swift"><code class="language-swift">
<span class="token comment" spellcheck="true">/// åŠ è½½å®Œæˆ</span>
<span class="token keyword">public</span> <span class="token keyword">func</span> <span class="token function">webView</span><span class="token punctuation">(</span><span class="token number">_</span> webView<span class="token punctuation">:</span> <span class="token builtin">WKWebView</span><span class="token punctuation">,</span> didFinish navigation<span class="token punctuation">:</span> <span class="token builtin">WKNavigation</span><span class="token operator">!</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

  <span class="token comment" spellcheck="true">// æ‰§è¡Œæ–¹æ³•</span>
  <span class="token keyword">self</span><span class="token punctuation">.</span>webView<span class="token punctuation">.</span><span class="token function">evaluateJavaScript</span><span class="token punctuation">(</span><span class="token string">"document.getElementById('section').offsetHeight"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">(</span>data<span class="token punctuation">,</span> <span class="token number">_</span><span class="token punctuation">)</span> <span class="token keyword">in</span>

              <span class="token keyword">if</span> <span class="token keyword">let</span> height <span class="token operator">=</span> data <span class="token keyword">as</span><span class="token operator">?</span> <span class="token builtin">CGFloat</span><span class="token punctuation">{</span>

                  <span class="token keyword">if</span> <span class="token keyword">self</span><span class="token punctuation">.</span>webView<span class="token punctuation">.</span>frame<span class="token punctuation">.</span>size<span class="token punctuation">.</span>height <span class="token operator">!=</span> height<span class="token operator">+</span><span class="token number">35</span> <span class="token punctuation">{</span>

                      <span class="token keyword">self</span><span class="token punctuation">.</span>webView<span class="token punctuation">.</span><span class="token function">layoutIfNeeded</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                      <span class="token keyword">self</span><span class="token punctuation">.</span>webView<span class="token punctuation">.</span>frame<span class="token punctuation">.</span>size<span class="token punctuation">.</span>height <span class="token operator">=</span> height<span class="token operator">+</span><span class="token number">35</span>
                      <span class="token keyword">self</span><span class="token punctuation">.</span>tableView<span class="token punctuation">.</span>tableHeaderView <span class="token operator">=</span> <span class="token keyword">self</span><span class="token punctuation">.</span>webView
                  <span class="token punctuation">}</span>
              <span class="token punctuation">}</span>
          <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>è¿™æ ·æˆ‘ä»¬ä¼šå‘è§‰ï¼Œå¥½äº†å•Š~  é‚£ä¹ˆæ¥ä¸‹æ¥å’±ä»¬å°±é‡åˆ°äº†ï¼Œå’±ä»¬çš„ç¬¬äºŒä¸ªå</p>
<h3 id="å›¾ç‰‡LazyLoadçš„é—®é¢˜"><a href="#å›¾ç‰‡LazyLoadçš„é—®é¢˜" class="headerlink" title="å›¾ç‰‡LazyLoadçš„é—®é¢˜"></a>å›¾ç‰‡LazyLoadçš„é—®é¢˜</h3><p>å¯èƒ½åœ¨è¿™é‡Œå¾ˆå¤šç”¨æˆ·å°±ä¼šå¯Ÿè§‰åˆ°è¿™ä¸ªï¼Œå½“å’±ä»¬çš„æ–°é—»è¯¦æƒ…å¾ˆå¤šå›¾ç‰‡çš„æ—¶å€™ï¼Œå’±ä»¬å°±ä¼šå‡ºç°åŠ è½½æ—¶é—´å·¨é•¿çš„é—®é¢˜ã€‚ä¸»è¦æ˜¯å› ä¸ºHtmlç•Œé¢å‘¢ï¼Œä»–ä¸æ˜¯å’±ä»¬çš„tableView,iosçš„åŠ è½½æœºåˆ¶ï¼Œæ˜¯å¿«è¦æ˜¾ç¤ºäº†å¼€å§‹å‡†å¤‡æ¸²æŸ“Cellï¼Œè€ŒHtmlæ˜¯å…¨éƒ¨æ¸²æŸ“å®Œæˆï¼Œä¹‹åä½ çˆ±æ€ä¹ˆæ»‘æ€ä¹ˆæ»‘ã€‚æ‰€ä»¥å½“å›¾ç‰‡è¿‡å¤§çš„æ—¶å€™ã€‚å°±ä¼šå‡ºç°åŠ è½½æ—¶é—´å¾ˆé•¿çš„é—®é¢˜äº†<br>é‚£ä¹ˆè‡ªç„¶è€Œç„¶çš„æƒ³åˆ°äº†ä½¿ç”¨å’±ä»¬çš„lazyloadã€‚ä¹Ÿå°±æ˜¯ä¿—ç§°çš„ æ‡’åŠ è½½ã€‚</p>
<p>ç°åœ¨ä¸–é¢ä¸Šçš„æ‡’åŠ è½½ï¼Œéƒ½æ˜¯ä¸€ä¸ªæ ·å­çš„ï¼Œç»™ä½ æä¾›ä¸€ä¸ªè‡ªå®šä¹‰çš„é¢å±æ€§ã€‚æ¯”å¦‚<code>lazysrc</code>ï¼Œè®¾ç½®æˆå’±ä»¬éœ€è¦åŠ è½½çš„ç½‘ç»œå›¾ç‰‡ï¼Œè€Œ<code>src</code>è®¾ç½®æˆå’±ä»¬çš„æ²¡æœ‰åŠ è½½å‡ºæ¥çš„å ä½å›¾ç‰‡ã€‚ä¹‹åæ£€æµ‹é¡µé¢çš„æ»‘åŠ¨æƒ…å†µï¼Œå½“æ£€æµ‹åˆ°å¿«æˆ–è€…éœ€è¦æ˜¾ç¤º<code>&lt;img&gt;</code>æ ‡ç­¾çš„æ—¶å€™ï¼Œè¿›è¡Œå§ <code>lazysrc</code>èµ‹å€¼<code>src</code>çš„è¿™ä¹ˆä¸€ä¸ªæ“ä½œã€‚</p>
<pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>jquery-1.11.0.min.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>jquery.lazyload.js?v<span class="token punctuation">=</span>1.9.1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>åœ¨ç½‘ä¸Šéšä¾¿æ‰¾äº†ä¸€ä¸ªæµ‹è¯•å‘è§‰æ²¡ç”¨è¿˜æ˜¯æ…¢å•Šï¼Œä¹‹åæŠ“åŒ…ï¼Œå‘ç°å›¾ç‰‡è¿˜æ˜¯ä¸€èµ·åŠ è½½çš„ã€‚å³ä½¿æ²¡æœ‰æ»‘åŠ¨â€¦â€¦</p>
<p>è¿™æ˜¯æ€ä¹ˆå›äº‹å„¿å‘¢ï¼Ÿ</p>
<p>å…¶å®ä¸éš¾ç†è§£ï¼Œå’±ä»¬çš„æ‡’åŠ è½½è®¡ç®—çš„æ˜¯é€šè¿‡åç§»ä½ç½®æ¥è®¡ç®—çš„ï¼Œä»€ä¹ˆäº‹åç§»ä½ç½®å‘¢ã€‚ã€‚å…¶å®è¿™ä¸ªåœ°æ–¹ç”¨å›¾çš„æ–¹å¼æ›´å¥½ï¼Œä½†æ˜¯æˆ‘ä¸çŸ¥é“ç”¨ä»€ä¹ˆç”»â€¦â€¦</p>
<p>é‚£ä¹ˆå’±ä»¬ç»™webViewçš„è®¾ç½®çš„å°±æ˜¯å’±ä»¬çš„æ‰€æœ‰çš„htmlçš„é«˜åº¦ï¼Œä»–æ ¹æœ¬å°±ä¸éœ€è¦åç§»å°±å¯ä»¥æ˜¾ç¤ºæ‰€æœ‰çš„å†…å®¹äº†ï¼Œè¿™ä¹Ÿå°±æ˜¯æˆ‘ä»¬çš„lazyload.js æ²¡æœ‰æ•ˆæœçš„åŸå› äº†ã€‚<br>é‚£ä¹ˆæˆ‘ä»¬æ€ä¹ˆè§£å†³è¿™ä¸ªé—®é¢˜å‘¢ï¼Ÿ</p>
<p>æˆ‘æ˜¯è¿™æ ·åšçš„ï¼Œå› ä¸ºæˆ‘çš„WebViewæ˜¯tableViewçš„è¡¨è§†å›¾ï¼Œé‚£ä¹ˆæˆ‘å°±å®ç°äº† scrollViewçš„ä»£ç†æ–¹æ³•</p>
<pre class="line-numbers language-swift"><code class="language-swift"><span class="token comment" spellcheck="true">/**
  ä¸»è¦æ˜¯ä¸ºäº†é’ˆå¯¹äºå…šå›¾ç‰‡å»¶æ—¶åŠ è½½ä¹‹åçš„webvViewé«˜åº¦é—®é¢˜

  - parameter scrollView: æ»‘åŠ¨è§†å›¾
  */</span>
 <span class="token keyword">public</span> <span class="token keyword">func</span> <span class="token function">scrollViewDidScroll</span><span class="token punctuation">(</span><span class="token number">_</span> scrollView<span class="token punctuation">:</span> <span class="token builtin">UIScrollView</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

     <span class="token keyword">let</span> height <span class="token operator">=</span> <span class="token builtin">UIScreen</span><span class="token punctuation">.</span>main<span class="token punctuation">.</span>bounds<span class="token punctuation">.</span>height<span class="token operator">+</span>scrollView<span class="token punctuation">.</span>contentOffset<span class="token punctuation">.</span>y

     <span class="token keyword">self</span><span class="token punctuation">.</span>webView<span class="token punctuation">.</span><span class="token function">evaluateJavaScript</span><span class="token punctuation">(</span><span class="token string">"scrollMethod(<span class="token interpolation"><span class="token delimiter variable">\(</span>height<span class="token delimiter variable">)</span></span>)"</span><span class="token punctuation">,</span> completionHandler<span class="token punctuation">:</span> <span class="token constant">nil</span><span class="token punctuation">)</span>

     <span class="token keyword">self</span><span class="token punctuation">.</span><span class="token function">adaptionWebViewHeightMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
 <span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>é€šè¿‡è¿™ä¸ªæ–¹æ³•ä¸æ–­æ£€æµ‹é¡µé¢çš„åç§»é‡</p>
<pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">scrollMethod</span><span class="token punctuation">(</span>offesty<span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"img"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">each</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span>index<span class="token punctuation">,</span> img<span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token comment" spellcheck="true">// &lt;!-- æ›´å¤šçš„æ“ä½œ></span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>åœ¨è¿™ä¸ªæ“ä½œé‡Œè¿›è¡Œå›¾ç‰‡çš„å¾ªç¯è·Ÿæˆ‘ä»¬ä¼ å…¥çš„ä¾¿å®œé‡å¯¹æ¯”ï¼Œå¦‚æœå¿«è¦å±•ç¤ºäº†ï¼Œé‚£ä¹ˆå’±ä»¬å°±æŠŠå’±ä»¬è®¾ç½®çš„ å±æ€§æ›¿æ¢æˆå›¾ç‰‡çš„src ï¼Œè¿™ä¸ªå­å°±å®ç°äº†å›¾ç‰‡çš„æ‡’åŠ è½½äº†</p>
<h3 id="å…³äºå›¾ç‰‡ç‚¹å‡»é—®é¢˜"><a href="#å…³äºå›¾ç‰‡ç‚¹å‡»é—®é¢˜" class="headerlink" title="å…³äºå›¾ç‰‡ç‚¹å‡»é—®é¢˜"></a>å…³äºå›¾ç‰‡ç‚¹å‡»é—®é¢˜</h3><p>è¿™ä¸ªç‚¹å‡»é—®é¢˜ï¼Œç›¸ä¿¡å¤§å®¶çœ‹åˆ°è¿™é‡Œå°±åº”è¯¥å·²ç»çŸ¥é“è¯¥æ€ä¹ˆåšäº†ã€‚å¯¹äº†â€¦â€¦â€¦â€¦</p>
<p>å½“ç„¶æ˜¯ä½¿ç”¨jsæ–¹æ³•æ¡¥è¿äº†</p>
<pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"#body_section img"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
       <span class="token keyword">var</span> index <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"img"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">index</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
       window<span class="token punctuation">.</span>webkit<span class="token punctuation">.</span>messageHandlers<span class="token punctuation">.</span>JSBridge<span class="token punctuation">.</span><span class="token function">postMessage</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
           <span class="token string">"type"</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
           <span class="token string">"index"</span><span class="token punctuation">:</span> index
       <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-swift"><code class="language-swift"><span class="token keyword">public</span> <span class="token keyword">func</span> <span class="token function">userContentController</span><span class="token punctuation">(</span><span class="token number">_</span> userContentController<span class="token punctuation">:</span> <span class="token builtin">WKUserContentController</span><span class="token punctuation">,</span> didReceive message<span class="token punctuation">:</span> <span class="token builtin">WKScriptMessage</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token keyword">guard</span> <span class="token keyword">let</span> bodyData <span class="token operator">=</span> message<span class="token punctuation">.</span>body <span class="token keyword">as</span><span class="token operator">?</span> <span class="token builtin">Dictionary</span><span class="token operator">&lt;</span><span class="token builtin">String</span><span class="token punctuation">,</span><span class="token builtin">AnyObject</span><span class="token operator">></span> <span class="token keyword">else</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token punctuation">}</span>

    <span class="token keyword">guard</span> <span class="token keyword">let</span> type <span class="token operator">=</span> bodyData<span class="token punctuation">[</span><span class="token string">"type"</span><span class="token punctuation">]</span> <span class="token keyword">as</span><span class="token operator">?</span> <span class="token builtin">Int</span> <span class="token keyword">else</span><span class="token punctuation">{</span><span class="token keyword">return</span><span class="token punctuation">}</span>

           <span class="token keyword">if</span> type <span class="token operator">==</span> <span class="token number">1</span> <span class="token punctuation">{</span>

               <span class="token comment" spellcheck="true">/// å›¾ç‰‡å±•ç¤º</span>
           <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>ä½†æ˜¯è¿™å°±åˆæœ‰äº†ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯å’±ä»¬çš„webviewå’Œå’±ä»¬çš„å›¾ç‰‡å±•ç¤ºVCçš„å›¾ç‰‡åŠ è½½çš„æ–¹å¼æ˜¯ä¸ä¸€æ ·çš„ã€‚æˆ‘è¿™é‡Œå…ˆè®²è®²æˆ‘çš„ï¼Œä¹‹å‰æ‰¾åˆ°ä½¿ç”¨ webviewçš„ç¼“å­˜ï¼Ÿè¿˜æ˜¯ä»€ä¹ˆçš„ï¼Œè¿˜æ²¡æœ‰ç ”ç©¶â€¦â€¦</p>
<h3 id="å…³äºå›¾ç‰‡é‡å¤åŠ è½½çš„é—®é¢˜ã€‚"><a href="#å…³äºå›¾ç‰‡é‡å¤åŠ è½½çš„é—®é¢˜ã€‚" class="headerlink" title="å…³äºå›¾ç‰‡é‡å¤åŠ è½½çš„é—®é¢˜ã€‚"></a>å…³äºå›¾ç‰‡é‡å¤åŠ è½½çš„é—®é¢˜ã€‚</h3><p>å…¶å®è¿™é‡Œçš„é—®é¢˜ï¼Œå°±éš¾ç‚¹äº†ï¼Œæˆ‘æ˜¯æƒ³äº†å¾ˆä¹…ï¼Œè¯¥æ€ä¹ˆè§£å†³ï¼Œå› ä¸ºè¿™æ ·è¿˜æ¶‰åŠåˆ°ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯ç»™å›¾ç‰‡æ·»åŠ è¿›åº¦æ¡çš„é—®é¢˜ã€‚</p>
<p>å…ˆè¯´è¯´è§£å†³åŠæ³•å§ï¼Œå¿ƒè·¯å†ç¨‹å°±ä¸è¯´äº†ã€‚é¦–å…ˆå’±ä»¬çš„ä¸æ˜¯å¯ä»¥æ§åˆ¶å›¾ç‰‡çš„ä½•æ—¶åŠ è½½äº†å—ï¼Ÿé‚£ä¹ˆå’±ä»¬å¯ä¸å¯ä»¥æ›´å‰å®³ä¸€ç‚¹å‘¢ï¼Ÿè®©æˆ‘ä»¬çš„å›¾ç‰‡è¯¥è¦åŠ è½½çš„æ—¶å€™æŠŠè¯·æ±‚é“¾æ¥ä¼ ç»™æˆ‘ä»¬ï¼Œæˆ‘ä»¬è¿›è¡Œæˆ‘ä»¬çš„ç¼“å­˜ç­–ç•¥ã€‚<code>SD</code> <code>PIN</code> éšä¾¿äº†å°±ã€‚</p>
<p>ç­”æ¡ˆæ˜¯è‚¯å®šçš„ã€‚</p>
<pre class="line-numbers language-js"><code class="language-js"><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"img"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">each</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span>index<span class="token punctuation">,</span> img<span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token keyword">var</span> datasrc <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">"data-src"</span><span class="token punctuation">)</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">$</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">offset</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>top <span class="token operator">&lt;</span> offesty <span class="token operator">+</span> <span class="token number">200</span> <span class="token operator">&amp;&amp;</span> ajaxUrl<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

            ajaxUrl<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span>

            window<span class="token punctuation">.</span>webkit<span class="token punctuation">.</span>messageHandlers<span class="token punctuation">.</span>JSBridge<span class="token punctuation">.</span><span class="token function">postMessage</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                <span class="token string">"type"</span><span class="token punctuation">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
                <span class="token string">"index"</span><span class="token punctuation">:</span> index<span class="token punctuation">,</span>
                <span class="token string">"url"</span><span class="token punctuation">:</span> datasrc
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>å…¶ä¸­ ajaxurlå­˜å‚¨äº†å·²ç»æ·»åŠ çš„ index å¦‚æœï¼Œæ²¡æœ‰è¿™ä¸ªä¸œè¥¿çš„è¯ï¼Œæˆ‘ä»¬åªè¦ä¸€æ»‘åŠ¨ï¼Œé‚£å°±è¹­è¹­è¹­çš„ä¼ é€’ç»™æˆ‘ä»¬urlï¼Œæˆ‘ä»¬å°±æœ‰çš„åŠ è½½äº†â€¦â€¦   è¿™å¯ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ã€‚</p>
<p>é‚£ä¹ˆåœ¨æˆ‘ä»¬æ¥æ”¶åˆ°URLçš„åŠ è½½çš„è¯·æ±‚ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¼€å§‹åŠ è½½å§~~</p>
<pre class="line-numbers language-swift"><code class="language-swift">fileprivate <span class="token keyword">func</span> <span class="token function">HandlePinDownLoadResult</span><span class="token punctuation">(</span><span class="token number">_</span> finish<span class="token punctuation">:</span>@<span class="token function">escaping</span> <span class="token punctuation">(</span><span class="token builtin">String</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">Void</span><span class="token punctuation">,</span>result<span class="token punctuation">:</span><span class="token builtin">PINRemoteImageManagerResult</span><span class="token punctuation">)</span><span class="token punctuation">{</span>

    <span class="token comment" spellcheck="true">/// å«æœ‰é™æ€å›¾ç‰‡</span>
    <span class="token keyword">if</span> <span class="token keyword">let</span> img <span class="token operator">=</span> result<span class="token punctuation">.</span>image <span class="token punctuation">,</span><span class="token keyword">let</span> base64 <span class="token operator">=</span> <span class="token function">UIImageJPEGRepresentation</span><span class="token punctuation">(</span>img<span class="token punctuation">,</span> <span class="token number">0.9</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">.</span><span class="token function">base64EncodedString</span><span class="token punctuation">(</span>options<span class="token punctuation">:</span> <span class="token builtin">NSData</span><span class="token punctuation">.</span><span class="token builtin">Base64EncodingOptions</span><span class="token punctuation">.</span><span class="token keyword">init</span><span class="token punctuation">(</span>rawValue<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>

        <span class="token builtin">DispatchQueue</span><span class="token punctuation">.</span><span class="token function">global</span><span class="token punctuation">(</span>qos<span class="token punctuation">:</span> <span class="token punctuation">.</span>background<span class="token punctuation">)</span><span class="token punctuation">.</span>async <span class="token punctuation">{</span>

            <span class="token keyword">let</span> string <span class="token operator">=</span> <span class="token string">"data:image/jpeg;base64,<span class="token interpolation"><span class="token delimiter variable">\(</span>base64<span class="token delimiter variable">)</span></span>"</span><span class="token punctuation">.</span><span class="token function">replaceRegex</span><span class="token punctuation">(</span><span class="token string">"&lt;"</span><span class="token punctuation">,</span> with<span class="token punctuation">:</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">replaceRegex</span><span class="token punctuation">(</span><span class="token string">">"</span><span class="token punctuation">,</span> with<span class="token punctuation">:</span> <span class="token string">""</span><span class="token punctuation">)</span>

            <span class="token builtin">DispatchQueue</span><span class="token punctuation">.</span>main<span class="token punctuation">.</span><span class="token function">async</span><span class="token punctuation">(</span>execute<span class="token punctuation">:</span> <span class="token punctuation">{</span>

                <span class="token function">finish</span><span class="token punctuation">(</span>string<span class="token punctuation">)</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment" spellcheck="true">/// å«æœ‰åŠ¨æ€å›¾ç‰‡</span>
    <span class="token keyword">if</span> <span class="token keyword">let</span> img <span class="token operator">=</span> result<span class="token punctuation">.</span>animatedImage <span class="token punctuation">{</span>

        <span class="token builtin">DispatchQueue</span><span class="token punctuation">.</span><span class="token function">global</span><span class="token punctuation">(</span>qos<span class="token punctuation">:</span> <span class="token builtin">DispatchQoS</span><span class="token punctuation">.</span><span class="token builtin">QoSClass</span><span class="token punctuation">.</span>background<span class="token punctuation">)</span><span class="token punctuation">.</span>async <span class="token punctuation">{</span>

            <span class="token keyword">let</span> base64 <span class="token operator">=</span> img<span class="token punctuation">.</span>data<span class="token punctuation">.</span><span class="token function">base64EncodedString</span><span class="token punctuation">(</span>options<span class="token punctuation">:</span> <span class="token builtin">NSData</span><span class="token punctuation">.</span><span class="token builtin">Base64EncodingOptions</span><span class="token punctuation">.</span><span class="token keyword">init</span><span class="token punctuation">(</span>rawValue<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

            <span class="token keyword">let</span> string <span class="token operator">=</span> <span class="token string">"data:image/gif;base64,<span class="token interpolation"><span class="token delimiter variable">\(</span>base64<span class="token delimiter variable">)</span></span>"</span><span class="token punctuation">.</span><span class="token function">replaceRegex</span><span class="token punctuation">(</span><span class="token string">"&lt;"</span><span class="token punctuation">,</span> with<span class="token punctuation">:</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">replaceRegex</span><span class="token punctuation">(</span><span class="token string">">"</span><span class="token punctuation">,</span> with<span class="token punctuation">:</span> <span class="token string">""</span><span class="token punctuation">)</span>

            <span class="token builtin">DispatchQueue</span><span class="token punctuation">.</span>main<span class="token punctuation">.</span><span class="token function">async</span><span class="token punctuation">(</span>execute<span class="token punctuation">:</span> <span class="token punctuation">{</span>

                <span class="token function">finish</span><span class="token punctuation">(</span>string<span class="token punctuation">)</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>è¿™æ ·æˆ‘ä»¬å°±å®ç°äº†å›¾ç‰‡çš„æœ¬åœ°ç¼“å­˜ç­–ç•¥äº†~ä½†æ˜¯é—®é¢˜åˆæ¥äº†â€¦â€¦  é¦–å…ˆå°±æ˜¯é‡åˆ°å¤§çš„å›¾ç‰‡å°¤å…¶æ˜¯gifé‚£ä¸ªbase64è§£æçœŸæ˜¯æ…¢å•Šâ€¦â€¦ è€Œä¸”æ¯æ¬¡é‡æ–°æ‰“å¼€ webview å°±ç®—æ˜¯å·²ç»ä¸‹è½½å¥½äº†ï¼Œå…‰æ˜¯base64è§£æä¹Ÿè¦å°ä¸€ä¼šå„¿äº†â€¦â€¦</p>
<h3 id="base64çš„é—®é¢˜"><a href="#base64çš„é—®é¢˜" class="headerlink" title="base64çš„é—®é¢˜"></a>base64çš„é—®é¢˜</h3><p>é‚£è¿˜çœŸæ²¡å¥½çš„åŠæ³•ï¼Œï¼Œç¼“å­˜å§â€¦â€¦â€¦â€¦â€¦â€¦</p>
<pre class="line-numbers language-swift"><code class="language-swift">

fileprivate <span class="token keyword">func</span> <span class="token function">DownloadImageByUrl</span><span class="token punctuation">(</span><span class="token number">_</span> progress<span class="token punctuation">:</span>@<span class="token function">escaping</span> <span class="token punctuation">(</span><span class="token builtin">Int</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">Void</span><span class="token punctuation">,</span>finish<span class="token punctuation">:</span>@<span class="token function">escaping</span> <span class="token punctuation">(</span><span class="token builtin">String</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">Void</span><span class="token punctuation">)</span><span class="token punctuation">{</span>

    <span class="token comment" spellcheck="true">/// å…ˆè¯»ç¼“å­˜ æ²¡æœ‰å’±ä»¬å†è¿›è¡Œåç»­å·¥ä½œ</span>
    <span class="token keyword">if</span> <span class="token keyword">let</span> str <span class="token operator">=</span> <span class="token builtin">PINCache</span><span class="token punctuation">.</span><span class="token function">shared</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">object</span><span class="token punctuation">(</span>forKey<span class="token punctuation">:</span> <span class="token string">"hanle<span class="token interpolation"><span class="token delimiter variable">\(</span><span class="token keyword">self</span><span class="token delimiter variable">)</span></span>"</span><span class="token punctuation">)</span> <span class="token keyword">as</span><span class="token operator">?</span> <span class="token builtin">String</span> <span class="token punctuation">{</span>

        <span class="token keyword">return</span> <span class="token function">finish</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">guard</span> <span class="token keyword">let</span> url <span class="token operator">=</span> <span class="token function">URL</span><span class="token punctuation">(</span>string<span class="token punctuation">:</span> <span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token keyword">else</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token punctuation">}</span>

    <span class="token builtin">PINRemoteImageManager</span><span class="token punctuation">.</span><span class="token function">shared</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">downloadImage</span><span class="token punctuation">(</span>with<span class="token punctuation">:</span> url<span class="token punctuation">,</span> options<span class="token punctuation">:</span> <span class="token function">PINRemoteImageManagerDownloadOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token punctuation">(</span>result<span class="token punctuation">)</span> <span class="token keyword">in</span>

        <span class="token keyword">self</span><span class="token punctuation">.</span><span class="token function">HandlePinDownLoadResult</span><span class="token punctuation">(</span>finish<span class="token punctuation">,</span>result<span class="token punctuation">:</span>result<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">/**
 å¤„ç†PINRemoteImageä¸‹è½½å®Œæˆçš„ç»“æœå“¦

 - parameter finish: å¤„ç†å®ŒæˆåŒ–åçš„å›è°ƒ
 - parameter result: Result to PINRemoteImageManagerResult
 */</span>
fileprivate <span class="token keyword">func</span> <span class="token function">HandlePinDownLoadResult</span><span class="token punctuation">(</span><span class="token number">_</span> finish<span class="token punctuation">:</span>@<span class="token function">escaping</span> <span class="token punctuation">(</span><span class="token builtin">String</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">Void</span><span class="token punctuation">,</span>result<span class="token punctuation">:</span><span class="token builtin">PINRemoteImageManagerResult</span><span class="token punctuation">)</span><span class="token punctuation">{</span>

    <span class="token comment" spellcheck="true">/// å«æœ‰é™æ€å›¾ç‰‡</span>
    <span class="token keyword">if</span> <span class="token keyword">let</span> img <span class="token operator">=</span> result<span class="token punctuation">.</span>image <span class="token punctuation">,</span><span class="token keyword">let</span> base64 <span class="token operator">=</span> <span class="token function">UIImageJPEGRepresentation</span><span class="token punctuation">(</span>img<span class="token punctuation">,</span> <span class="token number">0.9</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">.</span><span class="token function">base64EncodedString</span><span class="token punctuation">(</span>options<span class="token punctuation">:</span> <span class="token builtin">NSData</span><span class="token punctuation">.</span><span class="token builtin">Base64EncodingOptions</span><span class="token punctuation">.</span><span class="token keyword">init</span><span class="token punctuation">(</span>rawValue<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>

        <span class="token builtin">DispatchQueue</span><span class="token punctuation">.</span><span class="token function">global</span><span class="token punctuation">(</span>qos<span class="token punctuation">:</span> <span class="token punctuation">.</span>background<span class="token punctuation">)</span><span class="token punctuation">.</span>async <span class="token punctuation">{</span>

            <span class="token keyword">let</span> string <span class="token operator">=</span> <span class="token string">"data:image/jpeg;base64,<span class="token interpolation"><span class="token delimiter variable">\(</span>base64<span class="token delimiter variable">)</span></span>"</span><span class="token punctuation">.</span><span class="token function">replaceRegex</span><span class="token punctuation">(</span><span class="token string">"&lt;"</span><span class="token punctuation">,</span> with<span class="token punctuation">:</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">replaceRegex</span><span class="token punctuation">(</span><span class="token string">">"</span><span class="token punctuation">,</span> with<span class="token punctuation">:</span> <span class="token string">""</span><span class="token punctuation">)</span>

            <span class="token builtin">DispatchQueue</span><span class="token punctuation">.</span>main<span class="token punctuation">.</span><span class="token function">async</span><span class="token punctuation">(</span>execute<span class="token punctuation">:</span> <span class="token punctuation">{</span>

                <span class="token function">finish</span><span class="token punctuation">(</span>string<span class="token punctuation">)</span>

                <span class="token builtin">PINCache</span><span class="token punctuation">.</span><span class="token function">shared</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setObject</span><span class="token punctuation">(</span>string <span class="token keyword">as</span> <span class="token builtin">NSCoding</span><span class="token punctuation">,</span> forKey<span class="token punctuation">:</span> <span class="token string">"hanle<span class="token interpolation"><span class="token delimiter variable">\(</span><span class="token keyword">self</span><span class="token delimiter variable">)</span></span>"</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">/// ç¼“å­˜</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment" spellcheck="true">/// å«æœ‰åŠ¨æ€å›¾ç‰‡</span>
    <span class="token keyword">if</span> <span class="token keyword">let</span> img <span class="token operator">=</span> result<span class="token punctuation">.</span>animatedImage <span class="token punctuation">{</span>

        <span class="token builtin">DispatchQueue</span><span class="token punctuation">.</span><span class="token function">global</span><span class="token punctuation">(</span>qos<span class="token punctuation">:</span> <span class="token builtin">DispatchQoS</span><span class="token punctuation">.</span><span class="token builtin">QoSClass</span><span class="token punctuation">.</span>background<span class="token punctuation">)</span><span class="token punctuation">.</span>async <span class="token punctuation">{</span>

            <span class="token keyword">let</span> base64 <span class="token operator">=</span> img<span class="token punctuation">.</span>data<span class="token punctuation">.</span><span class="token function">base64EncodedString</span><span class="token punctuation">(</span>options<span class="token punctuation">:</span> <span class="token builtin">NSData</span><span class="token punctuation">.</span><span class="token builtin">Base64EncodingOptions</span><span class="token punctuation">.</span><span class="token keyword">init</span><span class="token punctuation">(</span>rawValue<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

            <span class="token keyword">let</span> string <span class="token operator">=</span> <span class="token string">"data:image/gif;base64,<span class="token interpolation"><span class="token delimiter variable">\(</span>base64<span class="token delimiter variable">)</span></span>"</span><span class="token punctuation">.</span><span class="token function">replaceRegex</span><span class="token punctuation">(</span><span class="token string">"&lt;"</span><span class="token punctuation">,</span> with<span class="token punctuation">:</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">replaceRegex</span><span class="token punctuation">(</span><span class="token string">">"</span><span class="token punctuation">,</span> with<span class="token punctuation">:</span> <span class="token string">""</span><span class="token punctuation">)</span>

            <span class="token builtin">DispatchQueue</span><span class="token punctuation">.</span>main<span class="token punctuation">.</span><span class="token function">async</span><span class="token punctuation">(</span>execute<span class="token punctuation">:</span> <span class="token punctuation">{</span>

                <span class="token function">finish</span><span class="token punctuation">(</span>string<span class="token punctuation">)</span>

                <span class="token builtin">PINCache</span><span class="token punctuation">.</span><span class="token function">shared</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setObject</span><span class="token punctuation">(</span>string <span class="token keyword">as</span> <span class="token builtin">NSCoding</span><span class="token punctuation">,</span> forKey<span class="token punctuation">:</span> <span class="token string">"hanle<span class="token interpolation"><span class="token delimiter variable">\(</span><span class="token keyword">self</span><span class="token delimiter variable">)</span></span>"</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">/// ç¼“å­˜</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="å›¾ç‰‡åŠ è½½è¿›åº¦æ¡"><a href="#å›¾ç‰‡åŠ è½½è¿›åº¦æ¡" class="headerlink" title="å›¾ç‰‡åŠ è½½è¿›åº¦æ¡"></a>å›¾ç‰‡åŠ è½½è¿›åº¦æ¡</h3><p>è¿™ä¸ªéœ€è¦htmlé…åˆï¼Œé¦–å…ˆå’±ä»¬æ¯ä¸ªå›¾ç‰‡ä¹Ÿå°±æ˜¯<code>&lt;img&gt;</code>æ ‡ç­¾ä¸Šéƒ½ç”Ÿæˆä¸€ä¸ªè¿›åº¦æ¡ã€‚æ— è®ºä»€ä¹ˆæ ·å­çš„éƒ½è¡Œã€‚åæ­£ä½ å¾—ä¿è¯æˆ‘æŠŠè¿›åº¦ä¼ é€’å›å»äº†ï¼Œä½ æ‰¾çš„åˆ°ä½ çš„ç©ºé—´ï¼Œé‚£ä¹ˆå”¯ä¸€æ ‡è¯†æ˜¯ã€‚indexè¿˜æ˜¯å…¶ä»–çš„éšä½ äº†ã€‚</p>
<pre class="line-numbers language-swift"><code class="language-swift">fileprivate <span class="token keyword">func</span> <span class="token function">DownloadImageByUrl</span><span class="token punctuation">(</span><span class="token number">_</span> progress<span class="token punctuation">:</span>@<span class="token function">escaping</span> <span class="token punctuation">(</span><span class="token builtin">Int</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">Void</span><span class="token punctuation">,</span>finish<span class="token punctuation">:</span>@<span class="token function">escaping</span> <span class="token punctuation">(</span><span class="token builtin">String</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">Void</span><span class="token punctuation">)</span><span class="token punctuation">{</span>

    <span class="token keyword">if</span> <span class="token keyword">let</span> str <span class="token operator">=</span> <span class="token builtin">PINCache</span><span class="token punctuation">.</span><span class="token function">shared</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">object</span><span class="token punctuation">(</span>forKey<span class="token punctuation">:</span> <span class="token string">"hanle<span class="token interpolation"><span class="token delimiter variable">\(</span><span class="token keyword">self</span><span class="token delimiter variable">)</span></span>"</span><span class="token punctuation">)</span> <span class="token keyword">as</span><span class="token operator">?</span> <span class="token builtin">String</span> <span class="token punctuation">{</span>

        <span class="token keyword">return</span> <span class="token function">finish</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">guard</span> <span class="token keyword">let</span> url <span class="token operator">=</span> <span class="token function">URL</span><span class="token punctuation">(</span>string<span class="token punctuation">:</span> <span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token keyword">else</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token punctuation">}</span>

    <span class="token builtin">PINRemoteImageManager</span><span class="token punctuation">.</span><span class="token function">shared</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">downloadImage</span><span class="token punctuation">(</span>with<span class="token punctuation">:</span> url<span class="token punctuation">,</span> options<span class="token punctuation">:</span> <span class="token function">PINRemoteImageManagerDownloadOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> progressDownload<span class="token punctuation">:</span> <span class="token punctuation">{</span> <span class="token punctuation">(</span><span class="token builtin">min</span><span class="token punctuation">,</span> <span class="token builtin">max</span><span class="token punctuation">)</span> <span class="token keyword">in</span>

        <span class="token keyword">if</span> url<span class="token punctuation">.</span>absoluteString<span class="token punctuation">.</span><span class="token function">hasSuffix</span><span class="token punctuation">(</span><span class="token string">".gif"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

            <span class="token keyword">let</span> process <span class="token operator">=</span> <span class="token function">Int</span><span class="token punctuation">(</span><span class="token function">CGFloat</span><span class="token punctuation">(</span><span class="token builtin">min</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token function">CGFloat</span><span class="token punctuation">(</span><span class="token builtin">max</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">100</span><span class="token punctuation">)</span>
            <span class="token function">progress</span><span class="token punctuation">(</span><span class="token punctuation">(</span>process<span class="token operator">-</span><span class="token number">5</span> <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token operator">?</span> <span class="token number">0</span> <span class="token punctuation">:</span> process<span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>

    <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">(</span>result<span class="token punctuation">)</span> <span class="token keyword">in</span>

        <span class="token keyword">self</span><span class="token punctuation">.</span><span class="token function">HandlePinDownLoadResult</span><span class="token punctuation">(</span>finish<span class="token punctuation">,</span>result<span class="token punctuation">:</span>result<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>è¿™æ ·å’±ä»¬å°±è·å–åˆ°äº†è¿›åº¦äº†ã€‚</p>
<pre class="line-numbers language-swift"><code class="language-swift"><span class="token comment" spellcheck="true">/**
    æ ¹æ®æä¾›çš„ URL å’Œ éœ€è¦åŠ è½½å®Œæˆçš„ Index

    - parameter url:   å›¾ç‰‡URL
    - parameter index: å›¾ç‰‡æ‰€åœ¨çš„Index
    */</span>
   fileprivate <span class="token keyword">func</span> <span class="token function">HandleUrlAndIndex</span><span class="token punctuation">(</span><span class="token number">_</span> url<span class="token punctuation">:</span><span class="token builtin">String</span><span class="token punctuation">,</span>index<span class="token punctuation">:</span><span class="token builtin">Int</span><span class="token punctuation">)</span><span class="token punctuation">{</span>

       url<span class="token punctuation">.</span><span class="token function">DownloadImageByUrl</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token punctuation">(</span>pro<span class="token punctuation">)</span> <span class="token keyword">in</span>

           <span class="token builtin">DispatchQueue</span><span class="token punctuation">.</span>main<span class="token punctuation">.</span><span class="token function">async</span><span class="token punctuation">(</span>execute<span class="token punctuation">:</span> <span class="token punctuation">{</span>

               <span class="token keyword">let</span> jsStr <span class="token operator">=</span> <span class="token string">"$(\"div .customProgressBar\").eq(<span class="token interpolation"><span class="token delimiter variable">\(</span>index<span class="token delimiter variable">)</span></span>).css(\"width\",\"<span class="token interpolation"><span class="token delimiter variable">\(</span>pro<span class="token delimiter variable">)</span></span>%\")"</span>

               <span class="token keyword">self</span><span class="token punctuation">.</span>webView<span class="token punctuation">.</span><span class="token function">evaluateJavaScript</span><span class="token punctuation">(</span>jsStr<span class="token punctuation">,</span> completionHandler<span class="token punctuation">:</span> <span class="token constant">nil</span><span class="token punctuation">)</span>
           <span class="token punctuation">}</span><span class="token punctuation">)</span>

           <span class="token punctuation">}</span><span class="token punctuation">,</span> finish<span class="token punctuation">:</span> <span class="token punctuation">{</span> <span class="token punctuation">(</span>base64<span class="token punctuation">)</span> <span class="token keyword">in</span>

               <span class="token keyword">let</span> jsStr <span class="token operator">=</span> <span class="token string">"$(\"img\").eq(<span class="token interpolation"><span class="token delimiter variable">\(</span>index<span class="token delimiter variable">)</span></span>).attr(\"src\",\"<span class="token interpolation"><span class="token delimiter variable">\(</span>base64<span class="token delimiter variable">)</span></span>\")"</span>

               <span class="token keyword">self</span><span class="token punctuation">.</span>webView<span class="token punctuation">.</span><span class="token function">evaluateJavaScript</span><span class="token punctuation">(</span>jsStr<span class="token punctuation">,</span> completionHandler<span class="token punctuation">:</span> <span class="token constant">nil</span><span class="token punctuation">)</span>

               <span class="token keyword">if</span> url<span class="token punctuation">.</span><span class="token function">hasSuffix</span><span class="token punctuation">(</span><span class="token string">".gif"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

                   <span class="token keyword">let</span> display <span class="token operator">=</span> <span class="token string">"$(\"div .progress\").eq(<span class="token interpolation"><span class="token delimiter variable">\(</span>index<span class="token delimiter variable">)</span></span>).css(\"visibility\",\"hidden\")"</span>

                   <span class="token keyword">self</span><span class="token punctuation">.</span>webView<span class="token punctuation">.</span><span class="token function">evaluateJavaScript</span><span class="token punctuation">(</span>display<span class="token punctuation">,</span> completionHandler<span class="token punctuation">:</span> <span class="token constant">nil</span><span class="token punctuation">)</span>
               <span class="token punctuation">}</span>
       <span class="token punctuation">}</span><span class="token punctuation">)</span>
   <span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>æˆ‘çš„è¿›åº¦æ¡classéƒ½å«åšcustomProgressBarï¼Œä¹‹åæˆ‘æ ¹æ® index è¿›è¡Œçš„å”¯ä¸€æ€§æ ‡è¯†ã€‚<br>ä¹‹åä¼ å…¥è¿‡å»è¿›åº¦æ¡ã€‚è¿›è¡Œè¿›åº¦æ¡çš„æ˜¾ç¤ºã€‚</p>
<p>å¯¹äº†æé†’ä¸€å¥ è¿›åº¦æ¡ç‰¹åˆ«å å†…å­˜ã€‚å’±ä»¬è¿˜æ˜¯åªç»™ gif åšåšå°±ç®—äº†ï¼Œå…¶ä»–çš„æ²¡å¿…è¦å•Šâ€¦â€¦â€¦â€¦</p>
<p>è°¢è°¢</p>
]]></content>
      
        <categories>
            
            <category> IOS </category>
            
        </categories>
        
        
        <tags>
            
            <tag> swift </tag>
            
            <tag> WKWebView </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[RxSwift å­¦ä¹  æœªå®Œå¾…ç»­]]></title>
      <url>http://www.msiter.com/2016/07/06/RxSwift%20%E5%AD%A6%E4%B9%A0/</url>
      <content type="html"><![CDATA[<h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><h3 id="ä¸ºä»€ä¹ˆä½¿ç”¨-RxSwift"><a href="#ä¸ºä»€ä¹ˆä½¿ç”¨-RxSwift" class="headerlink" title="ä¸ºä»€ä¹ˆä½¿ç”¨ RxSwift"></a>ä¸ºä»€ä¹ˆä½¿ç”¨ RxSwift</h3><p>å…¶å®è¿™ä¸ªé—®é¢˜å°±æ˜¯åœ¨é—®ï¼ŒRxSwiftå®ƒå¯ä»¥åšä»€ä¹ˆå‘¢ï¼Ÿåœ¨ä»–ä»¬ç¼–å†™ç¨‹åºçš„æ—¶å€™ï¼Œæ€»æ˜¯ä¼šç‰µæ¶‰åˆ°éœ€è¦æ£€æµ‹æŸäº›å€¼çš„å˜åŒ–ã€‚æ¯”å¦‚ã€‚textFiled Textå˜åŒ–ï¼Ÿæ•°æ®è¯·æ±‚å®Œæˆå¤±è´¥çš„å˜åŒ–ï¼Ÿé”®ç›˜å¼¹èµ·éšè—çš„å˜åŒ–ï¼Œè€Œæˆ‘ä»¬éœ€è¦åšå¾ˆå¤šä¸ä¸€æ ·çš„æ“ä½œï¼Œå»æ£€æµ‹è¿™äº›ä¸œè¥¿çš„å˜åŒ–æƒ…å†µï¼Œå¯èƒ½ä¼šæ˜¯delegateï¼ŒNotifinotionï¼ŒKVOç­‰ç­‰ã€‚</p>
<p>äºæ˜¯ä¹å°±æœ‰äººæƒ³åˆ°äº†ï¼Œä¸ºä»€ä¹ˆä¸è®¾è®¡ä¸€ç§å¤„ç†æœºåˆ¶æ¥ç»Ÿä¸€å¤„ç†è¿™äº›ä¸œè¥¿å‘¢ï¼Ÿæ‰€ä»¥ <code>reactivex</code> è¿™ç§æœºåˆ¶å‡ºç°äº†ï¼Œè€Œè¿™é‡Œçš„ <code>RxSwift</code> å°±æ˜¯è¿™ä¹ˆä¸€ä¸ªæœºåˆ¶ä¸‹çš„ä¸€ä¸ªæ‰©å±•ã€‚<br>æ‰€ä»¥RxSwift ä¸ºä»€ä¹ˆç”¨å®ƒï¼Ÿä½ å¯ä»¥ç†è§£äº†å—ï¼Ÿ</p>
<p><img class = "g-pl-90"  src="http://image.msiter.com/stock-photo-184019953.jpg" alt="" title="å­¦æ ¡é‡Œè¿˜æ˜¯ç›¸å¯¹å•çº¯çš„åœ°æ–¹ï¼Œæ‰¾ä¸åˆ°å¥³æœ‹å‹ï¼ŒåŸºæœ¬è¿˜æ˜¯å› ä¸ºä½ ä¸‘ã€‚"></p>
<a id="more"></a>
<h3 id="RxSwift-æ¦‚å¿µ"><a href="#RxSwift-æ¦‚å¿µ" class="headerlink" title="RxSwift æ¦‚å¿µ"></a>RxSwift æ¦‚å¿µ</h3><p>æ¯ä¸€ä¸ª<code>Observable</code> çš„å®ä¾‹ç›¸å½“äºä¸€ä¸ªSwiftä¸­çš„Sequenceã€‚</p>
<p>ä½†æ˜¯åŒºåˆ«åœ¨äºï¼ŒSwiftä¸­çš„SequenceTypeæ˜¯åŒæ­¥çš„å¾ªç¯ï¼Œè€Œ <code>Observable</code> æ˜¯å¼‚æ­¥çš„ã€‚</p>
<ul>
<li>ä¸€ä¸ª <code>Observable (ObservableType)</code>  ç›¸å½“äºä¸€ä¸ªåºåˆ—<code>Sequence(SequenceType)</code> .</li>
<li><code>ObservableType.subscribe(_:)</code> æ–¹æ³•å…¶å®å°±ç›¸å½“äº  <code>SequenceType.generate()</code></li>
<li><code>Observable</code> å¯¹è±¡ä¼šåœ¨æœ‰ä»»ä½• <code>Event</code> æ—¶å€™ï¼Œå°†æŠŠ observer (ObserverType) ä½œä¸ºä¸€ä¸ªå‚æ•°é€šè¿‡ <code>ObservableType.subscribe(_:)</code> è‡ªåŠ¨å‘å‡ºã€‚å¹¶ä¸éœ€è¦ observer (ObserverType) è°ƒç”¨ <code>Next()</code>æ–¹æ³•</li>
</ul>
<p>å¦‚æœä¸€ä¸ª  <code>Observable</code> å‘é€äº†ä¸€ä¸ª <code>(Event.Next(Element))</code> ä¸‹ä¸€æ­¥æŒ‡ä»¤çš„æ—¶å€™ï¼Œå®ƒå°†ä¼šç»§ç»­å‘é€åç»­æ›´å¤šçš„ <code>Event</code> ï¼Œç„¶è€Œå¦‚æœå®ƒå‘å‡ºçš„æ˜¯ä¸€ä¸ª  <code>(Event.Error(ErrorType))</code> é”™è¯¯åŠ¨ä½œï¼Œæˆ–è€…æ˜¯ä¸€ä¸ª <code>(Event.Completed)</code> æ­£å¸¸ç»“æŸå®ŒæˆåŠ¨ä½œçš„è¯ã€‚å®ƒå°†é€šçŸ¥ä¸åœ¨å‘å‡ºä»»ä½•åŠ¨ä½œã€‚</p>
<p>åºåˆ—çš„è¯­æ³•å¯ä»¥å¾ˆæ˜æ˜¾çš„è¡¨è¾¾è¿™ä¸€ç‚¹:</p>
<pre class="line-numbers language-swift"><code class="language-swift"><span class="token builtin">Next</span><span class="token operator">*</span> <span class="token punctuation">(</span><span class="token builtin">Error</span> <span class="token operator">|</span> <span class="token builtin">Completed</span><span class="token punctuation">)</span><span class="token operator">?</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>å›¾è¡¨å¯ä»¥ç›´è§‚çš„è§£é‡Šè¿™ä¸€åˆ‡</p>
<pre class="line-numbers language-js"><code class="language-js"><span class="token operator">--</span><span class="token number">1</span><span class="token operator">--</span><span class="token number">2</span><span class="token operator">--</span><span class="token number">3</span><span class="token operator">--</span><span class="token number">4</span><span class="token operator">--</span><span class="token number">5</span><span class="token operator">--</span><span class="token number">6</span><span class="token operator">--</span><span class="token operator">|</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">></span> <span class="token comment" spellcheck="true">// "|" = æ­£å¸¸ç»ˆæ­¢</span>

<span class="token operator">--</span>a<span class="token operator">--</span>b<span class="token operator">--</span>c<span class="token operator">--</span>d<span class="token operator">--</span>e<span class="token operator">--</span>f<span class="token operator">--</span>X<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">></span> <span class="token comment" spellcheck="true">// "X" = é”™è¯¯ç»ˆæ­¢</span>

<span class="token operator">--</span>tap<span class="token operator">--</span>tap<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>tap<span class="token operator">--</span><span class="token operator">></span> <span class="token comment" spellcheck="true">// "|" = ç»§ç»­è¿›è¡Œ, å¦‚åŒä¸€ä¸ªæŒ‰é’®ç‚¹å‡»äº‹ä»¶çš„ä¸€ä¸ªåºåˆ—</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<blockquote>
<p>è¿™äº›å›¾è¡¨è¢«ç§°ä¸ºmarble diagramsã€‚ä½ å¯ä»¥å­¦ä¹ æ›´å¤šå…³äºä»–ä»¬åœ¨ <a href="http://rxmarbles.com/" target="_blank" rel="noopener">rxmarbles.com</a>ã€‚</p>
</blockquote>
<h3 id="Observables-å’Œ-observers-åˆå-subscribers"><a href="#Observables-å’Œ-observers-åˆå-subscribers" class="headerlink" title="Observables å’Œ observers (åˆå subscribers)"></a>Observables å’Œ observers (åˆå subscribers)</h3><p><code>Observables</code> è§‚æµ‹æ•°æ®å°†ä¸ä¼šæ‰§è¡Œé™¤éæœ‰ç”¨æˆ·ç”¨æˆ·è®¢é˜…äº†å®ƒã€‚åœ¨ä¸‹é¢çš„ç¤ºä¾‹ä¸­ï¼Œè§‚å¯Ÿåˆ°çš„å…³é—­å°†æ°¸è¿œä¸ä¼šè¢«æ‰§è¡Œï¼Œå› ä¸ºæ²¡æœ‰è®¢é˜…<code>observers</code>ï¼š</p>
<pre class="line-numbers language-swift"><code class="language-swift"><span class="token function">example</span><span class="token punctuation">(</span><span class="token string">"Observable with no subscribers"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token number">_</span> <span class="token operator">=</span> <span class="token builtin">Observable</span><span class="token operator">&lt;</span><span class="token builtin">String</span><span class="token operator">></span><span class="token punctuation">.</span>create <span class="token punctuation">{</span> observerOfString <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">Disposable</span> <span class="token keyword">in</span>
        <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"This will never be printed"</span><span class="token punctuation">)</span>
        observerOfString<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token function">Next</span><span class="token punctuation">(</span><span class="token string">"ğŸ˜¬"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        observerOfString<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token builtin">Completed</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token builtin">NopDisposable</span><span class="token punctuation">.</span>instance
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>åœ¨ä¸‹é¢çš„ç¤ºä¾‹ä¸­, åœ¨ç»“æŸä¹‹å‰ä¼šè°ƒç”¨ <code>subscribe(_:)</code>:</p>
<pre class="line-numbers language-swift"><code class="language-swift"><span class="token function">example</span><span class="token punctuation">(</span><span class="token string">"Observable with subscriber"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token number">_</span> <span class="token operator">=</span> <span class="token builtin">Observable</span><span class="token operator">&lt;</span><span class="token builtin">String</span><span class="token operator">></span><span class="token punctuation">.</span>create <span class="token punctuation">{</span> observerOfString <span class="token keyword">in</span>
            <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"Observable created"</span><span class="token punctuation">)</span>
            observerOfString<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token function">Next</span><span class="token punctuation">(</span><span class="token string">"ğŸ˜‰"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            observerOfString<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token builtin">Completed</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span> <span class="token builtin">NopDisposable</span><span class="token punctuation">.</span>instance
        <span class="token punctuation">}</span>
        <span class="token punctuation">.</span>subscribe <span class="token punctuation">{</span> event <span class="token keyword">in</span>
            <span class="token function">print</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<blockquote>
<p>ä¸ç”¨æ‹…å¿ƒè¿™äº›åˆ›å»º Observable çš„ç»†èŠ‚ï¼Œé©¬ä¸Šå°±è¦å­¦ä¹ äº†</p>
<p>åœ¨ä»¥ä¸Šçš„æ —å­ä¸­ï¼Œæˆ‘ä»¬è¿”å›çš„éƒ½æ˜¯ä¸€ä¸ª NopDisposable.instance ï¼Œè€Œåœ¨å®é™…çš„æƒ…å†µä¸­æ˜¯éœ€è¦ è¿”å›ä¸€ä¸ª DisposeBag çš„å®ä¾‹çš„ï¼Œæ¥å¦¥å–„çš„å¤„ç†è¿™äº›ä»£ç ã€‚ è‡³äºä¸ºä»€ä¹ˆï¼Ÿå—¯ã€‚ â€¦â€¦   practice makes permanent ğŸ™‚ ç†Ÿèƒ½ç”Ÿå·§ï¼Ÿ ä½ å¯ä»¥æŸ¥çœ‹æ›´å¤šä»‹ç» <a href="https://github.com/ReactiveX/RxSwift/blob/master/Documentation/GettingStarted.md#disposing" target="_blank" rel="noopener">Disposing</a> ï¼Œ <a href="https://github.com/ReactiveX/RxSwift/blob/master/Documentation/GettingStarted.md" target="_blank" rel="noopener">Getting Started guide</a>.</p>
</blockquote>
<h3 id="åˆ›å»ºå’Œè®¢é˜…ä¸€ä¸ª-Observables"><a href="#åˆ›å»ºå’Œè®¢é˜…ä¸€ä¸ª-Observables" class="headerlink" title="åˆ›å»ºå’Œè®¢é˜…ä¸€ä¸ª Observables"></a>åˆ›å»ºå’Œè®¢é˜…ä¸€ä¸ª Observables</h3><p>æœ‰ä»¥ä¸‹è¿™å‡ ç§æ–¹æ³•æ¥åˆ›å»ºå’Œè®¢é˜…ä¸€ä¸ª <code>Observables</code></p>
<h4 id="never"><a href="#never" class="headerlink" title="never"></a>never</h4><p>åˆ›å»ºä¸€ä¸ª <code>Observables</code> ï¼Œä¸å‘å‡ºä»»ä½•é¡¹ç›®ï¼Œä¸ç»ˆæ­¢ å°±æ˜¯ä»»æ€§ï¼ï¼ï¼ï¼</p>
<p><img src="http://upload-images.jianshu.io/upload_images/755009-32bc4bdfb7ba6a73.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="never"></p>
<pre class="line-numbers language-swift"><code class="language-swift"><span class="token function">example</span><span class="token punctuation">(</span><span class="token string">"never"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> disposeBag <span class="token operator">=</span> <span class="token function">DisposeBag</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">let</span> neverSequence <span class="token operator">=</span> <span class="token builtin">Observable</span><span class="token operator">&lt;</span><span class="token builtin">String</span><span class="token operator">></span><span class="token punctuation">.</span><span class="token function">never</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">let</span> neverSequenceSubscription <span class="token operator">=</span> neverSequence
        <span class="token punctuation">.</span>subscribe <span class="token punctuation">{</span> <span class="token number">_</span> <span class="token keyword">in</span>
            <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"This will never be printed"</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    neverSequenceSubscription<span class="token punctuation">.</span><span class="token function">addDisposableTo</span><span class="token punctuation">(</span>disposeBag<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="empty"><a href="#empty" class="headerlink" title="empty"></a>empty</h4><p>åˆ›å»ºä¸€ä¸ªåªå‘é€å®ŒæˆåŠ¨ä½œçš„ <code>Observables</code> å¯¹è±¡ã€‚ è€å­ä¸é—®è¿‡ç¨‹ï¼Œåªçœ‹ç»“æœï¼ï¼ï¼</p>
<p><img src="http://upload-images.jianshu.io/upload_images/755009-42da08b0fd5b9cea.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="empty"></p>
<pre class="line-numbers language-swift"><code class="language-swift"><span class="token function">example</span><span class="token punctuation">(</span><span class="token string">"empty"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> disposeBag <span class="token operator">=</span> <span class="token function">DisposeBag</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token builtin">Observable</span><span class="token operator">&lt;</span><span class="token builtin">Int</span><span class="token operator">></span><span class="token punctuation">.</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span>subscribe <span class="token punctuation">{</span> event <span class="token keyword">in</span>
            <span class="token function">print</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
        <span class="token punctuation">.</span><span class="token function">addDisposableTo</span><span class="token punctuation">(</span>disposeBag<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<blockquote>
<p>è¿™ä¸ªå®ä¾‹è¿˜ä»‹ç»äº†åˆ›å»ºå’Œè®¢é˜…ä¸€ä¸ª Observables å¯¹è±¡ï¼Œå…¶å®å°±æ˜¯æ‰§è¡Œäº† subscribe è¿™ä¸ªæ–¹æ³•ã€‚</p>
</blockquote>
<h4 id="just"><a href="#just" class="headerlink" title="just"></a>just</h4><p>åˆ›å»ºä¸€ä¸ªå‘é€åˆ¶å®šåŠ¨ä½œçš„çš„ <code>Observables</code> å¯¹è±¡ã€‚</p>
<p><img src="http://upload-images.jianshu.io/upload_images/755009-dc8ba7d0f279a460.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="just"></p>
<pre class="line-numbers language-swift"><code class="language-swift"><span class="token function">example</span><span class="token punctuation">(</span><span class="token string">"just"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> disposeBag <span class="token operator">=</span> <span class="token function">DisposeBag</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token builtin">Observable</span><span class="token punctuation">.</span><span class="token function">just</span><span class="token punctuation">(</span><span class="token string">"ğŸ”´"</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span>subscribe <span class="token punctuation">{</span> event <span class="token keyword">in</span>
            <span class="token function">print</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
        <span class="token punctuation">.</span><span class="token function">addDisposableTo</span><span class="token punctuation">(</span>disposeBag<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<blockquote>
<p>è¿™ä¸ªå®ä¾‹è¿˜ä»‹ç»äº†åˆ›å»ºå’Œè®¢é˜…ä¸€ä¸ª Observables å¯¹è±¡ï¼Œå…¶å®å°±æ˜¯æ‰§è¡Œäº† <code>subscribe</code> è¿™ä¸ªæ–¹æ³•ã€‚</p>
</blockquote>
<h4 id="of"><a href="#of" class="headerlink" title="of"></a>of</h4><p>åˆ›å»ºä¸€ä¸ªå…·æœ‰å›ºå®šæ•°é‡çš„ <code>Observables</code> å¯¹è±¡</p>
<p><img src="http://upload-images.jianshu.io/upload_images/755009-dc8ba7d0f279a460.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="just"></p>
<pre class="line-numbers language-swift"><code class="language-swift"><span class="token function">example</span><span class="token punctuation">(</span><span class="token string">"of"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> disposeBag <span class="token operator">=</span> <span class="token function">DisposeBag</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token builtin">Observable</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token string">"ğŸ¶"</span><span class="token punctuation">,</span> <span class="token string">"ğŸ±"</span><span class="token punctuation">,</span> <span class="token string">"ğŸ­"</span><span class="token punctuation">,</span> <span class="token string">"ğŸ¹"</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span>subscribeNext <span class="token punctuation">{</span> element <span class="token keyword">in</span>
            <span class="token function">print</span><span class="token punctuation">(</span>element<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
        <span class="token punctuation">.</span><span class="token function">addDisposableTo</span><span class="token punctuation">(</span>disposeBag<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<blockquote>
<p>è¿™ä¸ªä¾‹å­è¿˜ä»‹ç»äº† subscribeNext(<em>:) è¿™ç§ç®€å•çš„æ–¹æ³•<br>ä¸åƒ subscribe(</em>:),å®ƒæ˜¯å®šè¯­äº†æ‰€æœ‰çš„åŠ¨ä½œ åŒ…æ‹¬ ï¼ˆNext, Error, and Completedï¼‰<br>subscribeNext å°†ä¼šå¿½ç•¥æ‰€æœ‰çš„ (Error and Completed )åŠ¨ä½œï¼Œåªä¼šç”Ÿäº§å‡ºä¸€ä¸ª Next åŠ¨ä½œã€<br>æˆ‘ä»¬è¿™é‡ŒåŒæ ·ä¹Ÿæœ‰ å®Œæˆ å’Œ å¤±è´¥ å¯¹åº”çš„ç®€å•æ–¹æ³•ã€‚ subscribeError(<em>:) and subscribeCompleted(</em>:)ï¼Œå½“ä½ åªæƒ³æ£€æµ‹æ˜¯å¯¹åº”çš„åŠ¨ä½œçš„æ—¶å€™<br>å¦‚æœä½ æƒ³è®¢é˜…æ‰€æœ‰çš„åŠ¨ä½œçš„ä½ å¯ä»¥ä½¿ç”¨   subscribe(onNext:onError:onCompleted:onDisposed:)` å°±åƒä¸‹é¢çš„ä¾‹å­ ğŸ‘‡<br>çœ‹äº†ä»¥ä¸‹è‡ªå·±å†™çš„ã€‚ä¸çŸ¥é“æ€ä¹ˆè¯´ï¼  è‰  ï¼subscribe å°±æ˜¯æ‹¦æˆªæ‰€æœ‰çš„æ“ä½œï¼  æ¯”å¦‚ next error å’Œ compltedã€‚<br>è€Œè¿™äº›æ£€æµ‹éƒ½æœ‰å•ç‹¬çš„ç®€ä¾¿æ–¹æ³• subscribeNext  subscribeError subscribeCompleted</p>
<p>Example</p>
<pre><code>someObservable.subscribe(
    onNext: { print(&quot;Element:&quot;, $0) },
    onError: { print(&quot;Error:&quot;, $0) },
    onCompleted: { print(&quot;Completed&quot;) },
    onDisposed: { print(&quot;Disposed&quot;) }
)
</code></pre></blockquote>
<h4 id="toObservable"><a href="#toObservable" class="headerlink" title="toObservable"></a>toObservable</h4><p>å°†ä¸€ä¸ª sequence(SequenceType),è½¬æ¢æˆä¸ºä¸€ä¸ª <code>Observable</code> ,å¯ä»¥æ˜¯ä»»ä½•å®ç°äº†(SequenceType)åè®®çš„å¯¹è±¡ï¼Œæ¯”å¦‚Array, Dictionary, or Set</p>
<pre class="line-numbers language-swift"><code class="language-swift"><span class="token function">example</span><span class="token punctuation">(</span><span class="token string">"toObservable"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> disposeBag <span class="token operator">=</span> <span class="token function">DisposeBag</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token punctuation">[</span><span class="token string">"ğŸ¶"</span><span class="token punctuation">,</span> <span class="token string">"ğŸ±"</span><span class="token punctuation">,</span> <span class="token string">"ğŸ­"</span><span class="token punctuation">,</span> <span class="token string">"ğŸ¹"</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">toObservable</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span>subscribeNext <span class="token punctuation">{</span> <span class="token function">print</span><span class="token punctuation">(</span>$<span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>
        <span class="token punctuation">.</span><span class="token function">addDisposableTo</span><span class="token punctuation">(</span>disposeBag<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<blockquote>
<p>è¯¥ä¾‹å­ä½¿ç”¨äº† $0 è¿™ä¸€ç§å‚æ•°ï¼Œè€Œä¸æ˜¯æ˜¾å¼å‘½åçš„å‚æ•°</p>
</blockquote>
<h4 id="create"><a href="#create" class="headerlink" title="create"></a>create</h4><p>åˆ›å»ºä¸€ä¸ª <code>Observable</code> åºåˆ—<br><img src="http://upload-images.jianshu.io/upload_images/755009-62884a006c12cc68.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="create"></p>
<pre class="line-numbers language-swift"><code class="language-swift"><span class="token function">example</span><span class="token punctuation">(</span><span class="token string">"create"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> disposeBag <span class="token operator">=</span> <span class="token function">DisposeBag</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">let</span> myJust <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token punctuation">(</span>element<span class="token punctuation">:</span> <span class="token builtin">String</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">Observable</span><span class="token operator">&lt;</span><span class="token builtin">String</span><span class="token operator">></span> <span class="token keyword">in</span>
        <span class="token keyword">return</span> <span class="token builtin">Observable</span><span class="token punctuation">.</span>create <span class="token punctuation">{</span> observer <span class="token keyword">in</span>
            observer<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token function">Next</span><span class="token punctuation">(</span>element<span class="token punctuation">)</span><span class="token punctuation">)</span>
            observer<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token builtin">Completed</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span> <span class="token builtin">NopDisposable</span><span class="token punctuation">.</span>instance
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token function">myJust</span><span class="token punctuation">(</span><span class="token string">"ğŸ”´"</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span>subscribe <span class="token punctuation">{</span> <span class="token function">print</span><span class="token punctuation">(</span>$<span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>
        <span class="token punctuation">.</span><span class="token function">addDisposableTo</span><span class="token punctuation">(</span>disposeBag<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="range"><a href="#range" class="headerlink" title="range"></a>range</h4><p>åˆ›å»ºä¸€ä¸ª å¯ä»¥å‘å°„ä¸€ç³»åˆ—çš„è¿ç»­æ•´æ•°ï¼Œç„¶åç»ˆæ­¢ çš„ <code>Observable</code>å¯¹è±¡</p>
<p><img src="http://upload-images.jianshu.io/upload_images/755009-5fa8215035a92cb7.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="range"></p>
<pre class="line-numbers language-swift"><code class="language-swift"><span class="token function">example</span><span class="token punctuation">(</span><span class="token string">"range"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> disposeBag <span class="token operator">=</span> <span class="token function">DisposeBag</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token builtin">Observable</span><span class="token punctuation">.</span><span class="token function">range</span><span class="token punctuation">(</span>start<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token builtin">count</span><span class="token punctuation">:</span> <span class="token number">10</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span>subscribe <span class="token punctuation">{</span> <span class="token function">print</span><span class="token punctuation">(</span>$<span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>
        <span class="token punctuation">.</span><span class="token function">addDisposableTo</span><span class="token punctuation">(</span>disposeBag<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="repeatElement"><a href="#repeatElement" class="headerlink" title="repeatElement"></a>repeatElement</h4><p>åˆ›å»ºä¸€ä¸ªæ— é™åœ°å‘å°„ç»™å®šçš„å…ƒç´  <code>Observable</code>ã€‚  è±Œè±†å›ï¼Ÿï¼Ÿ</p>
<p><img src="http://upload-images.jianshu.io/upload_images/755009-00b2005946443344.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="repeatElement"></p>
<pre class="line-numbers language-swift"><code class="language-swift"><span class="token function">example</span><span class="token punctuation">(</span><span class="token string">"repeatElement"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> disposeBag <span class="token operator">=</span> <span class="token function">DisposeBag</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token builtin">Observable</span><span class="token punctuation">.</span><span class="token function">repeatElement</span><span class="token punctuation">(</span><span class="token string">"ğŸ”´"</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">take</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span>subscribeNext <span class="token punctuation">{</span> <span class="token function">print</span><span class="token punctuation">(</span>$<span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>
        <span class="token punctuation">.</span><span class="token function">addDisposableTo</span><span class="token punctuation">(</span>disposeBag<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<blockquote>
<p>è¯¥æ —å­ä¸­ä½¿ç”¨ take æ–¹æ³•æ¥é™åˆ¶å‘å°„ç»™å®šå…ƒç´ çš„æ¬¡æ•°</p>
</blockquote>
<h4 id="generate"><a href="#generate" class="headerlink" title="generate"></a>generate</h4><p>åˆ›å»ºä¸€ä¸ªåªæœ‰å½“æä¾›çš„æ‰€æœ‰çš„åˆ¤æ–­æ¡ä»¶éƒ½ä¸º true çš„æ—¶å€™ï¼Œæ‰ä¼šç»™å‡ºåŠ¨ä½œçš„  <code>Observable</code> !  è€å­ åˆšæ­£ä¸é˜¿</p>
<pre class="line-numbers language-swift"><code class="language-swift"><span class="token function">example</span><span class="token punctuation">(</span><span class="token string">"generate"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> disposeBag <span class="token operator">=</span> <span class="token function">DisposeBag</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token builtin">Observable</span><span class="token punctuation">.</span><span class="token function">generate</span><span class="token punctuation">(</span>
            initialState<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
            condition<span class="token punctuation">:</span> <span class="token punctuation">{</span> $<span class="token number">0</span> <span class="token operator">&lt;</span> <span class="token number">3</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
            iterate<span class="token punctuation">:</span> <span class="token punctuation">{</span> $<span class="token number">0</span> <span class="token operator">+</span> <span class="token number">1</span> <span class="token punctuation">}</span>
        <span class="token punctuation">)</span>
        <span class="token punctuation">.</span>subscribeNext <span class="token punctuation">{</span> <span class="token function">print</span><span class="token punctuation">(</span>$<span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>
        <span class="token punctuation">.</span><span class="token function">addDisposableTo</span><span class="token punctuation">(</span>disposeBag<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="deferred"><a href="#deferred" class="headerlink" title="deferred"></a>deferred</h4><p>åˆ›å»ºä¸€ä¸ªå…¨æ–°çš„  <code>Observable</code> ï¼Œä½ TMæ‰æ˜¯æ¬è¿å·¥ï¼Œè€å­æ˜¯å¤§è‡ªç„¶çš„åˆ›é€ è€…ï¼</p>
<p><img src="http://upload-images.jianshu.io/upload_images/755009-e83303a845a37808.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<pre class="line-numbers language-swift"><code class="language-swift"><span class="token function">example</span><span class="token punctuation">(</span><span class="token string">"deferred"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> disposeBag <span class="token operator">=</span> <span class="token function">DisposeBag</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">var</span> <span class="token builtin">count</span> <span class="token operator">=</span> <span class="token number">1</span>

    <span class="token keyword">let</span> deferredSequence <span class="token operator">=</span> <span class="token builtin">Observable</span><span class="token operator">&lt;</span><span class="token builtin">String</span><span class="token operator">></span><span class="token punctuation">.</span>deferred <span class="token punctuation">{</span>
        <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"Creating <span class="token interpolation"><span class="token delimiter variable">\(</span><span class="token builtin">count</span><span class="token delimiter variable">)</span></span>"</span><span class="token punctuation">)</span>
        <span class="token builtin">count</span> <span class="token operator">+</span><span class="token operator">=</span> <span class="token number">1</span>

        <span class="token keyword">return</span> <span class="token builtin">Observable</span><span class="token punctuation">.</span>create <span class="token punctuation">{</span> observer <span class="token keyword">in</span>
            <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"Emitting..."</span><span class="token punctuation">)</span>
            observer<span class="token punctuation">.</span><span class="token function">onNext</span><span class="token punctuation">(</span><span class="token string">"ğŸ¶"</span><span class="token punctuation">)</span>
            observer<span class="token punctuation">.</span><span class="token function">onNext</span><span class="token punctuation">(</span><span class="token string">"ğŸ±"</span><span class="token punctuation">)</span>
            observer<span class="token punctuation">.</span><span class="token function">onNext</span><span class="token punctuation">(</span><span class="token string">"ğŸµ"</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span> <span class="token builtin">NopDisposable</span><span class="token punctuation">.</span>instance
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    deferredSequence
        <span class="token punctuation">.</span>subscribeNext <span class="token punctuation">{</span> <span class="token function">print</span><span class="token punctuation">(</span>$<span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>
        <span class="token punctuation">.</span><span class="token function">addDisposableTo</span><span class="token punctuation">(</span>disposeBag<span class="token punctuation">)</span>

    deferredSequence
        <span class="token punctuation">.</span>subscribeNext <span class="token punctuation">{</span> <span class="token function">print</span><span class="token punctuation">(</span>$<span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>
        <span class="token punctuation">.</span><span class="token function">addDisposableTo</span><span class="token punctuation">(</span>disposeBag<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="error"><a href="#error" class="headerlink" title="error"></a>error</h4><p>åˆ›å»ºä¸€ä¸ªä¸åšä»»ä½•æ“ä½œï¼Œç›´æ¥ä¸¢ä¸€ä¸ªé”™è¯¯ç»™ä½ çš„ <code>Observable</code>. å¯¹æ–¹ä¸æƒ³å’Œä½  BBï¼Œå¹¶ä¸¢ç»™ä½ ä¸€ä¸ªé”™è¯¯ ğŸ˜</p>
<pre class="line-numbers language-swift"><code class="language-swift"><span class="token function">example</span><span class="token punctuation">(</span><span class="token string">"error"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> disposeBag <span class="token operator">=</span> <span class="token function">DisposeBag</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token builtin">Observable</span><span class="token operator">&lt;</span><span class="token builtin">Int</span><span class="token operator">></span><span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token builtin">Error</span><span class="token punctuation">.</span><span class="token builtin">Test</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span>subscribe <span class="token punctuation">{</span> <span class="token function">print</span><span class="token punctuation">(</span>$<span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>
        <span class="token punctuation">.</span><span class="token function">addDisposableTo</span><span class="token punctuation">(</span>disposeBag<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="doOn"><a href="#doOn" class="headerlink" title="doOn"></a>doOn</h4><p>ä¸ºæ¯ä¸€ä¸ªå‘å‡ºçš„äº‹ä»¶å’Œè¿”å›çš„æ‰§è¡Œåˆ¶å®šæ“ä½œã€‚ æ”¶è´¹ç«™ï¼Ÿ</p>
<p><img src="http://upload-images.jianshu.io/upload_images/755009-61b525586595f814.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<pre class="line-numbers language-swift"><code class="language-swift"><span class="token function">example</span><span class="token punctuation">(</span><span class="token string">"doOn"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> disposeBag <span class="token operator">=</span> <span class="token function">DisposeBag</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token builtin">Observable</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token string">"ğŸ"</span><span class="token punctuation">,</span> <span class="token string">"ğŸ"</span><span class="token punctuation">,</span> <span class="token string">"ğŸŠ"</span><span class="token punctuation">,</span> <span class="token string">"ğŸ‹"</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span>doOn <span class="token punctuation">{</span> <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"Intercepted:"</span><span class="token punctuation">,</span> $<span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>
        <span class="token punctuation">.</span>subscribeNext <span class="token punctuation">{</span> <span class="token function">print</span><span class="token punctuation">(</span>$<span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>
        <span class="token punctuation">.</span><span class="token function">addDisposableTo</span><span class="token punctuation">(</span>disposeBag<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<blockquote>
<p>è¿™é‡Œä¹Ÿæœ‰ã€‚ doOnNext(<em>:), doOnError(</em>:), and doOnCompleted(<em>:) ç®€ä¾¿æ–¹æ³•ã€‚ ä¹Ÿæœ‰ doOn(onNext(</em>:)onError(<em>:)onCompleted(</em>:)) è¿™æ ·çš„æ–¹æ³•</p>
</blockquote>
<h2 id="Working-with-Subjects"><a href="#Working-with-Subjects" class="headerlink" title="Working with Subjects"></a>Working with Subjects</h2><p>ä½¿ç”¨ Subjects è¿›è¡Œå·¥ä½œï¼Œä¸€ä¸ª Subject å¯ä»¥ç†è§£ä¸ºä¸€ä¸ªä¸­é—´äººï¼Œä»–æ—¢å¯ä»¥è§‚å¯Ÿè€…è§‚å¯Ÿï¼Œå‘è§‚å¯Ÿè€…æä¾›åŠ¨ä½œã€‚ä¹Ÿå¯ä»¥å½“ä½œè§‚å¯Ÿè€…å»è§‚å¯Ÿï¼Œæ¥æ¥å—å¯¹è±¡ã€‚ å¤§æ¦‚çš„æ„æ€ã€‚å¯æ”»å¯å—ï¼Ÿï¼Ÿï¼Ÿ</p>
<h3 id="PublishSubject"><a href="#PublishSubject" class="headerlink" title="PublishSubject"></a>PublishSubject</h3><p>å‘æ‰€æœ‰è®¢é˜…è€…å‘å¸ƒåŠ¨ä½œã€‚åœ¨ä»–ä»¬è®¢é˜…ä¹‹åã€‚è¿™ä¸ªæ—¶é—´æ˜¯æœ‰å…³ç³»çš„å“¦ã€‚ä»ä¸‹å›¾ä¹Ÿå¯ä»¥çœ‹åˆ°ï¼Œç¬¬äºŒä¸ªè®¢é˜…çš„ç”¨æˆ·ï¼Œå·²ç»é”™è¿‡äº†æ¥å—çº¢ç»¿çš„æ—¶é—´ã€‚æ‰€ä»¥ä»–åªæ¥å—åˆ°äº†ï¼Œè“è‰²å’Œé”™è¯¯åŠ¨ä½œ</p>
<p><img src="http://upload-images.jianshu.io/upload_images/755009-52e8b61b5b1553ca.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="PublishSubject"></p>
<pre class="line-numbers language-swift"><code class="language-swift"><span class="token keyword">let</span> disposeBag <span class="token operator">=</span> <span class="token function">DisposeBag</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">let</span> subject <span class="token operator">=</span> <span class="token builtin">PublishSubject</span><span class="token operator">&lt;</span><span class="token builtin">String</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
subject<span class="token punctuation">.</span>subscribe<span class="token punctuation">{</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"ç¬¬ä¸€æ¬¡è®¢é˜…"</span><span class="token punctuation">,</span>$<span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">.</span><span class="token function">addDisposableTo</span><span class="token punctuation">(</span>disposeBag<span class="token punctuation">)</span>
subject<span class="token punctuation">.</span><span class="token function">onNext</span><span class="token punctuation">(</span><span class="token string">"ğŸ¶"</span><span class="token punctuation">)</span>
subject<span class="token punctuation">.</span><span class="token function">onNext</span><span class="token punctuation">(</span><span class="token string">"ğŸ±"</span><span class="token punctuation">)</span>
subject<span class="token punctuation">.</span>subscribe<span class="token punctuation">{</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"ç¬¬äºŒæ¬¡è®¢é˜…"</span><span class="token punctuation">,</span>$<span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">.</span><span class="token function">addDisposableTo</span><span class="token punctuation">(</span>disposeBag<span class="token punctuation">)</span>
subject<span class="token punctuation">.</span><span class="token function">onNext</span><span class="token punctuation">(</span><span class="token string">"ğŸ…°ï¸"</span><span class="token punctuation">)</span>
subject<span class="token punctuation">.</span><span class="token function">onNext</span><span class="token punctuation">(</span><span class="token string">"ğŸ…±ï¸"</span><span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>åœ¨è¿™ä»½ä»£ç ä¸­ç¬¬ä¸€ä¸ªè®¢é˜…å¯ä»¥å±•ç¤º4ä¸ªï¼Ÿè€Œç¬¬äºŒæ¬¡ï¼Œå°±åªèƒ½æ¥æ”¶åˆ° å°çŒ«å’Œå°ç‹—ã€‚</p>
<blockquote>
<p>åœ¨è¿™ä»½ä¾‹å­ä¸­ï¼Œä½¿ç”¨çš„æ˜¯  onNext(<em>:) ç®€ä¾¿çš„æ–¹æ³•ï¼Œå½“ç„¶ä¹Ÿæœ‰ é”™è¯¯ å’Œ å®Œæˆçš„ç®€ä¾¿æ–¹æ³• onError(</em>:) , onCompleted() . ä½ ä¹Ÿå¯ä»¥ç›´æ¥é£Ÿç”¨ on(.Error(<em>:)) on(.Completed(</em>:)) on(.Next(<em>:))  è¿™å’Œä¹‹å‰çš„å¦‚å‡ºä¸€è¾™ (</em>:)</p>
</blockquote>
<h3 id="ReplaySubject"><a href="#ReplaySubject" class="headerlink" title="ReplaySubject"></a>ReplaySubject</h3><p>å’±ä»¬ä¹‹å‰åˆ›å»ºçš„ PublishSubject ï¼Œå¦‚æœåœ¨è®¢é˜…ä¹‹å‰çš„æ—¶é—´æ˜¯ä¸ä¼šæ¥æ”¶åˆ°çš„ï¼Œè€Œè¿™ä¸ªå‘¢ å¯ä»¥æŒ‡å®šï¼Œç¼“å­˜çš„ä¸ªæ•°ï¼Œæ¯”å¦‚ 2 ï¼Œé‚£ä¹ˆå’±ä»¬å°±å¯ä»¥æ¥å—è®¢é˜…æ—¶é—´ä¹‹å‰ä¸¤æ¬¡çš„ åŠ¨ä½œäº‹ä»¶ã€‚</p>
<p><img src="http://upload-images.jianshu.io/upload_images/755009-e5b881a5fd17a49d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="ReplaySubject"></p>
<pre class="line-numbers language-swift"><code class="language-swift"><span class="token keyword">let</span> disposeBag <span class="token operator">=</span> <span class="token function">DisposeBag</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">let</span> subject <span class="token operator">=</span> <span class="token builtin">ReplaySubject</span><span class="token operator">&lt;</span><span class="token builtin">String</span><span class="token operator">></span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>bufferSize<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">)</span>
subject<span class="token punctuation">.</span>subscribe<span class="token punctuation">{</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"ç¬¬ä¸€æ¬¡è®¢é˜…"</span><span class="token punctuation">,</span>$<span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">.</span><span class="token function">addDisposableTo</span><span class="token punctuation">(</span>disposeBag<span class="token punctuation">)</span>
subject<span class="token punctuation">.</span><span class="token function">onNext</span><span class="token punctuation">(</span><span class="token string">"ğŸ¶"</span><span class="token punctuation">)</span>
subject<span class="token punctuation">.</span><span class="token function">onNext</span><span class="token punctuation">(</span><span class="token string">"ğŸ±"</span><span class="token punctuation">)</span>
subject<span class="token punctuation">.</span>subscribe<span class="token punctuation">{</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"ç¬¬äºŒæ¬¡è®¢é˜…"</span><span class="token punctuation">,</span>$<span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">.</span><span class="token function">addDisposableTo</span><span class="token punctuation">(</span>disposeBag<span class="token punctuation">)</span>
subject<span class="token punctuation">.</span><span class="token function">onNext</span><span class="token punctuation">(</span><span class="token string">"ğŸ…°ï¸"</span><span class="token punctuation">)</span>
subject<span class="token punctuation">.</span><span class="token function">onNext</span><span class="token punctuation">(</span><span class="token string">"ğŸ…±ï¸"</span><span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>åœ¨è¿™ä»½ä»£ç ä¸­ï¼Œç¬¬äºŒæ¬¡çš„é¢è®¢é˜…çš„æ—¶å€™ å°±ä¼š æ˜¯ å°çŒ« A å’Œ Bäº†ï½</p>
<h3 id="BehaviorSubject"><a href="#BehaviorSubject" class="headerlink" title="BehaviorSubject"></a>BehaviorSubject</h3><p>å‘æ‰€æœ‰çš„è®¢é˜…è€…å¹¿æ’­æ–°çš„äº‹ä»¶ï¼Œå¹¶ä¸”ä¼ é€’ å½“å‰ çš„æœ€æ–°å€¼ï¼Œåˆå§‹å€¼ã€‚</p>
<p><img src="http://upload-images.jianshu.io/upload_images/755009-ee65a318eaf1ab57.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="BehaviorSubject"></p>
<p>æ€ä¹ˆæ„Ÿè§‰å°±æ˜¯  ReplaySubject ä¹‹å buffSize æ˜¯ 1 çš„å˜å½¢å‘¢ã€‚ã€‚ã€‚ã€‚é™¤äº†å¤šäº†ä¸€ä¸ªåˆå§‹å€¼ã€‚ã€‚ã€‚</p>
<pre class="line-numbers language-swift"><code class="language-swift"><span class="token keyword">let</span> disposeBag <span class="token operator">=</span> <span class="token function">DisposeBag</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">let</span> subject <span class="token operator">=</span>  <span class="token function">BehaviorSubject</span><span class="token punctuation">(</span>value<span class="token punctuation">:</span> <span class="token string">"ğŸ”´"</span><span class="token punctuation">)</span>
subject<span class="token punctuation">.</span>subscribe<span class="token punctuation">{</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"ç¬¬ä¸€æ¬¡è®¢é˜…"</span><span class="token punctuation">,</span>$<span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">.</span><span class="token function">addDisposableTo</span><span class="token punctuation">(</span>disposeBag<span class="token punctuation">)</span>
subject<span class="token punctuation">.</span><span class="token function">onNext</span><span class="token punctuation">(</span><span class="token string">"ğŸ¶"</span><span class="token punctuation">)</span>
subject<span class="token punctuation">.</span><span class="token function">onNext</span><span class="token punctuation">(</span><span class="token string">"ğŸ±"</span><span class="token punctuation">)</span>
subject<span class="token punctuation">.</span>subscribe<span class="token punctuation">{</span> <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"ç¬¬äºŒæ¬¡è®¢é˜…"</span><span class="token punctuation">,</span>$<span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">.</span><span class="token function">addDisposableTo</span><span class="token punctuation">(</span>disposeBag<span class="token punctuation">)</span>
subject<span class="token punctuation">.</span><span class="token function">onNext</span><span class="token punctuation">(</span><span class="token string">"ğŸ…°ï¸"</span><span class="token punctuation">)</span>
subject<span class="token punctuation">.</span><span class="token function">onNext</span><span class="token punctuation">(</span><span class="token string">"ğŸ…±ï¸"</span><span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>åœ¨ç¬¬äºŒæ¬¡è®¢é˜…å‡ºç°çš„æ—¶å€™ä¼šå¤šå‡ºç°ä¸€æ¬¡ã€‚æœ€æ–°å€¼ã€‚è€Œç¬¬ä¸€æ¬¡è®¢é˜…åˆ™ä¼šå‡ºç°ä¸€ä¸ª åˆå§‹å€¼ã€‚</p>
<blockquote>
<p>çœ‹äº†è¿™ä¸‰ä¸ªä¾‹å­æœ‰æ²¡æœ‰å¥½åƒé—æ¼äº†ä»€ä¹ˆ ï¼Œä¸€ä¸ª Completed äº‹ä»¶ã€‚ PublishSubject, ReplaySubject, å’Œ BehaviorSubject ä¸ä¼šåœ¨è‡ªåŠ¨å‘å‡º å®Œæˆäº‹ä»¶çš„ã€‚</p>
</blockquote>
<h3 id="Variable"><a href="#Variable" class="headerlink" title="Variable"></a>Variable</h3><p>BehaviorSubject å˜ç§ã€‚ã€‚ã€‚  å°±æ˜¯è¯´å‘¢ï¼ŒBehaviorSubject ä¸æ˜¯ä¸ä¼šè‡ªåŠ¨å‘é€ Completed äº‹ä»¶å—ï¼Ÿ  Variable ä¼šã€‚æ²¡äº†ã€‚</p>
<pre class="line-numbers language-swift"><code class="language-swift"><span class="token keyword">let</span> variable <span class="token operator">=</span> <span class="token function">Variable</span><span class="token punctuation">(</span><span class="token string">"ğŸ”´"</span><span class="token punctuation">)</span>
subject<span class="token punctuation">.</span>subscribe<span class="token punctuation">{</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"ç¬¬ä¸€æ¬¡è®¢é˜…"</span><span class="token punctuation">,</span>$<span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">.</span><span class="token function">addDisposableTo</span><span class="token punctuation">(</span>disposeBag<span class="token punctuation">)</span>
variable<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token string">"ğŸ¶"</span>
variable<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token string">"ğŸ±"</span>
subject<span class="token punctuation">.</span>subscribe<span class="token punctuation">{</span> <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"ç¬¬ä¸€æ¬¡è®¢é˜…"</span><span class="token punctuation">,</span>$<span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">.</span><span class="token function">addDisposableTo</span><span class="token punctuation">(</span>disposeBag<span class="token punctuation">)</span>
variable<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token string">"ğŸ…°ï¸"</span>
variable<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token string">"ğŸ…±ï¸"</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<blockquote>
<p>Variable å¯¹è±¡ è°ƒç”¨  asObservable() æ–¹æ³•å¯ä»¥è·å–ä»–å˜ç§å‰çš„  BehaviorSubject å¯¹è±¡ã€‚ Variable å¯¹è±¡ ä¸èƒ½å®ç° onNext æ–¹æ³•ï¼Œä½†æ˜¯ä½ å¯ä»¥è°ƒç”¨ä»–çš„ value å‚æ•°ï¼Œæ¥ get å’Œset å®ƒçš„å€¼ã€‚</p>
</blockquote>
]]></content>
      
        <categories>
            
            <category> IOS </category>
            
        </categories>
        
        
        <tags>
            
            <tag> ios </tag>
            
            <tag> swift </tag>
            
            <tag> RX </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[reactivex å­¦ä¹ ]]></title>
      <url>http://www.msiter.com/2016/06/21/reactivex%20%E5%AD%A6%E4%B9%A0/</url>
      <content type="html"><![CDATA[<p><img class = "g-pl-90"  src="http://image.msiter.com/stock-photo-179922657.jpg" alt="" title="åº†å¹¸ä½ æ¥è‡ªè¿œæ–¹ä¸æ¸…æ¥šæˆ‘çš„è¿‡å¾€ã€‚"></p>
<h3 id="æ•£è®°"><a href="#æ•£è®°" class="headerlink" title="æ•£è®°"></a>æ•£è®°</h3><p>å¥½ä¹…æ²¡æœ‰å­¦ä¹ åˆ°æ–°çš„ä¸œè¥¿äº†ï¼Œä¹‹å‰ä¸€ç›´æƒ³å­¦ä¹  <code>ReactiveCocoa</code>,ä½†æ˜¯çœ‹äº†ä¸€ç‚¹ä¹‹åï¼Œè§‰çš„å¾ˆæ˜¯ç¹çï¼Œè€Œä¸”æ„Ÿè§‰å¾ˆå¤šapiæ–¹æ³•ï¼Œå†åŠ ä¸Šé¡¹ç›®å¾ˆç´§è¿«æ²¡æœ‰æ—¶é—´å»å­¦ä¹ æ–°çš„ä¸œè¥¿äº†ã€‚æˆ‘å°±æš‚æ—¶æç½®äº†ï¼Œç°åœ¨é¡¹ç›®åšçš„ä¹Ÿå·®ä¸å¤šäº†ï¼Œè§‰å¾—è¿™ä¸ªå­¦ä¹ è¿›åº¦æ˜¯æ—¶å€™æä¸Šè¿›ç¨‹ã€‚</p>
<p>å†å¼€å§‹å­¦ä¹ çš„æ—¶å€™ï¼Œå‘ç°äº†<code>RxSwift</code>.åœ¨ä¹‹åå‘ç°äº† <code>reactivex</code> ã€‚è¿›å…¥äº†å®˜ç½‘å‘ç°è‡ªå·±å¯èƒ½ï¼Œæ‰¾åˆ°äº†ä¸€ä¸ª ç±»ä¼¼äº <code>Realm</code>å’Œ<code>swagger</code> çš„åºç„¶å¤§ç‰©ï¼Œ ç»å¯¹è¦å¥½å¥½å­¦ä¹ ï¼Œåœ¨åŠ ä¸Šè‡ªå·±å­¦ä¹ çš„æœ¬èº«å°±æ˜¯swiftã€‚è‡ªç„¶é€‰æ‹©äº† RXswiftã€‚</p>
<p>å¥½äº†ï¼ŒåºŸè¯ä¸å¤šè¯´äº†ï¼Œå¼€å§‹å­¦ä¹ å§ï¼Œè¯·è€å¿ƒçœ‹ä¸‹å»ã€‚å› ä¸ºæˆ‘ä¹Ÿæ˜¯ç¿»è¯‘ï¼Œæ‰€ä»¥å¦‚æœæœ‰ä»»ä½•è§‰å¾—ä¸åº”è¯¥çš„åœ°æ–¹ï¼Œå¯ä»¥æé†’æˆ‘ã€‚</p>
<a id="more"></a>
<h3 id="ReactiveX"><a href="#ReactiveX" class="headerlink" title="ReactiveX"></a>ReactiveX</h3><p>åœ¨è¿›å…¥ReactiveXçš„å®˜æ–¹ç½‘ç«™åï¼Œå°±çœ‹åˆ°äº†å®ƒå¯¹è‡ªå·±çš„è¯„ä»·</p>
<blockquote>
<p>ReactiveX is a combination of the best ideas from<br>the Observer pattern, the Iterator pattern, and functional programming</p>
</blockquote>
<p>reactivexç»„åˆæ˜¯è§‚å¯Ÿè€…æ¨¡å¼ï¼Œè¿­ä»£å™¨æ¨¡å¼å’Œå‡½æ•°å¼ç¼–ç¨‹æœ€å¥½çš„æƒ³æ³•ã€‚</p>
<p>ok ~ å¥½å§ï¼Œç®—ä½ åŠã€‚ä»€ä¹ˆæ„æ€ï¼</p>
<h3 id="Observable-è§‚å¯Ÿè€…æ¨¡å¼"><a href="#Observable-è§‚å¯Ÿè€…æ¨¡å¼" class="headerlink" title="Observable è§‚å¯Ÿè€…æ¨¡å¼"></a>Observable è§‚å¯Ÿè€…æ¨¡å¼</h3><h4 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h4><p>åœ¨reactivex è§‚å¯Ÿè€… è®¢é˜… å¯è§‚å¯Ÿå¯¹è±¡ã€‚ç„¶åï¼Œè§‚å¯Ÿè€… ä¼šå¯¹ å¯è§‚å¯Ÿå¯¹è±¡ ä»¥ä»»æ„é¡ºåºå‘å‡ºçš„ä»»ä½•é¡¹ç›®ä¸¢å›ä½œå‡ºååº”ã€‚è¿™ç§æ¨¡å¼æœ‰åˆ©äºå¹¶å‘æ“ä½œï¼Œä»–ä¸éœ€è¦åˆ›å»ºä¸€ä¸ªé˜»å¡å¯¹è±¡æ¥ç­‰å¾… å¯è§‚å¯Ÿè€… å‘å‡ºä»»ä½•æŒ‡ä»¤,è€Œæ˜¯åˆ›å»ºä¸€ä¸ªå“¨å…µçš„å½¢å¼çš„è§‚å¯Ÿå‘˜ï¼Œéšæ—¶å‡†å¤‡ä½œå‡ºé€‚å½“çš„ååº”é’ˆå¯¹äº å¯è§‚å¯Ÿå¯¹è±¡ å‘å‡ºçš„é¡¹ç›®ã€‚</p>
<p><img src="http://reactivex.io/assets/operators/legend.png" alt=""></p>
<p>See Also</p>
<ul>
<li><a href="http://reactivex.io/documentation/single.html" target="_blank" rel="noopener">Single</a> â€” ä¸€ä¸ªé’ˆå¯¹äºå¯è§‚å¯Ÿå¯¹è±¡åªå‘å‡ºä¸€æ¬¡é¡¹ç›®çš„ä¸“é—¨ç‰ˆæœ¬</li>
<li><a href="http://channel9.msdn.com/Series/Rx-Workshop/Rx-Workshop-Introduction" target="_blank" rel="noopener">Rx Workshop: Introduction</a></li>
<li><a href="http://www.introtorx.com/Content/v1.0.10621.0/02_KeyTypes.html#IObservable" target="_blank" rel="noopener">Introduction to Rx: IObservable</a></li>
<li><a href="http://docs.couchbase.com/developer/java-2.0/observables.html" target="_blank" rel="noopener">Mastering observables</a> (æ¥è‡ª Couchbase æœåŠ¡å™¨çš„æ–‡æ¡£)</li>
<li><a href="https://medium.com/@andrestaltz/2-minute-introduction-to-rx-24c8ca793877" target="_blank" rel="noopener">2 minute introduction to Rx</a>  ä½œè€…: Andre Staltz(â€œThink of an Observable as an asynchronous immutable array.â€) (æŠŠä¸€ä¸ªå¯è§‚å¯Ÿå¯¹è±¡è®¤ä½œä¸ºä¸€ä¸ªå¼‚æ­¥ä¸å¯æ”¹å˜çš„æ•°ç»„)</li>
<li><a href="https://egghead.io/lessons/javascript-introducing-the-observable" target="_blank" rel="noopener">Introducing the Observable</a> by Jafar Husain (JavaScript Video Tutorial)</li>
<li><a href="https://egghead.io/lessons/javascript-introducing-the-observable" target="_blank" rel="noopener">Observable object</a> (RxJS) by Dennis Stoyanov</li>
<li><a href="https://afterecho.uk/blog/turning-a-callback-into-an-rx-observable.html" target="_blank" rel="noopener">Turning a callback into an Rx Observable</a> by @afterecho</li>
</ul>
<h4 id="Background"><a href="#Background" class="headerlink" title="Background"></a>Background</h4><p>åœ¨è®¸å¤šç¼–ç¨‹é¡¹ç›®ä¸­ï¼Œäººä»¬å¾€å¾€æ›´å€¾å‘äºåœ¨ä¸€ä¸ªæ—¶é—´æ‰§è¡Œä¸€ä¸ªæŒ‡ä»¤æ‰§è¡Œæˆ–è€…å®Œæˆä¸€ä¸ªå¢é‡æ“ä½œã€‚ä½†æ˜¯åœ¨reactivexä¸­ï¼Œè®¸å¤šæŒ‡ä»¤å¯ä»¥å¹¶è¡Œæ‰§è¡Œã€‚å…¶ç»“æœä¼šåœ¨åæ¥ä»¥ä»»æ„é¡ºåºè¢«è§‚å¯Ÿè€…æŠ“è·ã€‚è€Œä¸æ˜¯å®šä¹‰ä¸€ä¸ªæ–¹æ³•å®Œæˆæ•°æ®çš„è½¬æ¢ç­‰æ“ä½œæ–¹æ³•ï¼Œç„¶åä»¥ä¸€ä¸ª è¢«è§‚å¯Ÿè€…çš„èº«ä»½å»è®¢é˜…äº†ä¸€ä¸ªè§‚å¯Ÿè€…ã€‚</p>
<p>è¿™ç§æ–¹æ³•çš„ä¸€ä¸ªä¼˜ç‚¹æ˜¯ï¼Œå½“ä½ æœ‰ä¸€å †ä¸ä¾èµ–äºå½¼æ­¤çš„ä»»åŠ¡æ—¶ï¼Œä½ å¯ä»¥åŒæ—¶å¯åŠ¨å®ƒä»¬ï¼Œè€Œä¸æ˜¯ç­‰å¾…æ¯ä¸€ä¸ªå®Œæˆä¹‹å‰å¼€å§‹ä¸‹ä¸€ä¸ª-è¿™æ ·ï¼Œä½ çš„æ€»æ‰§è¡Œæ—¶é—´å°±æ˜¯ä½ ä¸€å †ä»»åŠ¡æ‰§è¡Œæ—¶é—´æœ€é•¿çš„é‚£ä¸€ä¸ªï¼Œå°±åƒæ˜¯æœ¨æ¿ç»„æˆæ°´æ¡¶ï¼Œè£…çš„æ°´å¤šå°‘åœ¨äºæœ€çŸ­çš„é‚£å—æœ¨æ¿ä¸€æ ·çš„é“é‡Œã€‚</p>
<p>æœ‰è®¸å¤šæœ¯è¯­ç”¨æ¥æè¿°è¿™ç§å¼‚æ­¥ç¼–ç¨‹å’Œè®¾è®¡æ¨¡å‹ã€‚æœ¬æ–‡æ¡£å°†ä½¿ç”¨ä»¥ä¸‹æœ¯è¯­ï¼šä¸€ä¸ªè§‚å¯Ÿè€…è®¢é˜…è§‚å¯Ÿã€‚ä¸€ä¸ªå¯è§‚å¯Ÿçš„å‘å°„é¡¹ç›®æˆ–é€šè¿‡è°ƒç”¨è§‚å¯Ÿå‘˜çš„æ–¹æ³•å‘é€é€šçŸ¥ç»™å®ƒçš„è§‚å¯Ÿå‘˜ã€‚</p>
<p>åœ¨å…¶ä»–æƒ…å†µä¸‹ï¼Œæœ‰æ—¶ä¹Ÿç§°è§‚å¯Ÿå‘˜ä¸ºâ€œç”¨æˆ·â€â€œè§‚çœ‹çš„äººâ€æˆ–â€œå †â€ã€‚è¿™ç§æ¨¡å¼ä¸€èˆ¬æ˜¯é€šå¸¸è¢«ç§°ä¸ºâ€œååº”æ¨¡å¼â€</p>
<h4 id="å»ºç«‹è§‚å¯Ÿå‘˜"><a href="#å»ºç«‹è§‚å¯Ÿå‘˜" class="headerlink" title="å»ºç«‹è§‚å¯Ÿå‘˜"></a>å»ºç«‹è§‚å¯Ÿå‘˜</h4><p>åœ¨ä¸€ä¸ªæ™®é€šçš„æ–¹æ³•è°ƒç”¨æ˜¯å¼‚æ­¥çš„ï¼Œæ²¡æœ‰æ’åºï¼Œå¹¶è¡Œè°ƒç”¨å…¸å‹çš„reactivex -æµç¨‹æ˜¯è¿™æ ·çš„ï¼š</p>
<ol>
<li>è°ƒç”¨æ–¹æ³•ã€‚</li>
<li>å°†è¯¥æ–¹æ³•çš„è¿”å›å€¼å­˜å‚¨åœ¨ä¸€ä¸ªå˜é‡ä¸­</li>
<li>ä½¿ç”¨è¿™ä¸ªå˜é‡å’Œå®ƒçš„æ–°å€¼æ¥åšä¸€äº›æœ‰ç”¨çš„äº‹æƒ…ã€‚</li>
</ol>
<p>æˆ–è€…ï¼Œåƒè¿™æ ·çš„ï¼š</p>
<pre><code>// æ‰“ç”µè¯ï¼ŒæŠŠå®ƒçš„è¿”å›å€¼ èµ‹å€¼ç»™` returnval `
returnval =æ–¹æ³•ï¼ˆå‚æ•°ï¼‰ï¼›
// returnval å»åšç‚¹æœ‰ç”¨çš„äº‹å„¿
</code></pre><p>åœ¨å¼‚æ­¥æ¨¡å‹ä¸­ï¼Œæµç¨‹ä¼šåƒè¿™æ ·ï¼š</p>
<ol>
<li>å®šä¹‰ä¸€ä¸ªæ–¹æ³•ï¼Œåšä¸€äº›æœ‰ç”¨çš„ä»å¼‚æ­¥è°ƒç”¨è¿”å›å€¼ï¼›è¯¥æ–¹æ³•æ˜¯è§‚å¯Ÿè€…çš„ä¸€éƒ¨åˆ†ã€‚ä¹Ÿå°±æ˜¯ A è°ƒç”¨æ–¹æ³•åšå‡ºä¸€äº›è°ƒæ•´å åæ‚” A</li>
<li>å®šä¹‰å¼‚æ­¥è°ƒç”¨æ–¹æ³•æœ¬èº«ä½œä¸ºä¸€ä¸ªå¯è§‚å¯Ÿçš„å¯¹è±¡</li>
<li>é™„åŠ çš„è§‚æµ‹å™¨ï¼Œé€šè¿‡è®¢é˜…å®ƒè§‚å¯Ÿï¼ˆè¿™ä¹Ÿå¯¼è‡´å¯è§‚å¯Ÿåˆ°çš„å¼€å§‹è¡ŒåŠ¨ï¼‰</li>
<li>ç»§ç»­ä½ çš„ä¸šåŠ¡ï¼›æ¯å½“è°ƒç”¨è¿”å›æ—¶ï¼Œè§‚å¯Ÿè€…çš„æ–¹æ³•å°†å¼€å§‹æ“ä½œå®ƒçš„è¿”å›å€¼æˆ–å€¼-æ‰€è§‚å¯Ÿåˆ°çš„é¡¹ç›®ã€‚</li>
</ol>
<p>çœ‹èµ·æ¥åƒè¿™æ ·ï¼š</p>
<pre><code>// å®šä¹‰ï¼Œä½†ä¸è°ƒç”¨ï¼Œç”¨æˆ· onNext  å¤„ç†
// åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œè§‚å¯Ÿè€…æ˜¯éå¸¸ç®€å•çš„ï¼Œåªæœ‰ä¸€ä¸ª`onNext`å¤„ç†
def myOnNext = { it -&gt; do something useful with it };
// å®šä¹‰ï¼Œä½†ä¸è°ƒç”¨ï¼Œå¯è§‚å¯Ÿåˆ°çš„
def myObservable = someObservable(itsParameters);
// è®¢é˜…ç”¨æˆ·å¯è§ï¼Œå¹¶è°ƒç”¨è§‚å¯Ÿ
myObservable.subscribe(myOnNext);
// ç»§ç»­æˆ‘çš„ä¸šåŠ¡
</code></pre><h5 id="onNext-onCompleted-and-onError"><a href="#onNext-onCompleted-and-onError" class="headerlink" title="onNext, onCompleted, and onError"></a>onNext, onCompleted, and onError</h5><p>æ‚¨çš„è§‚å¯Ÿè€…å®ç°ä»¥ä¸‹æ–¹æ³•çš„ä¸€äº›è®¢é˜…æ–¹æ³•å­é›†å¯ä»¥å°†ä¸€ä¸ªè§‚å¯Ÿè€…è¿æ¥åˆ°ä¸€ä¸ªå¯è§‚å¯Ÿåˆ°çš„ï¼š</p>
<h6 id="onNext"><a href="#onNext" class="headerlink" title="onNext"></a>onNext</h6><p>æ— è®ºä»»ä½•æ—¶å€™ï¼Œä¸€ä¸ªå¯è§‚å¯Ÿå¯¹è±¡è°ƒç”¨è¿™ä¸ªæ–¹æ³•å‘å‡ºä¸€ä¸ªé¡¹ç›®ï¼Œè¿™ä¸ªæ–¹æ³•ä¼šæŠŠ è¢«è§‚å¯Ÿè€…å‘å‡ºçš„è¿™ä¸ªé¡¹ç›®ä½œä¸ºä¸€ä¸ªå‚æ•°ç»§ç»­ä¼ é€’ä¸‹å»</p>
<h6 id="onError"><a href="#onError" class="headerlink" title="onError"></a>onError</h6><p>ä¸€ä¸ªè¢«è§‚å¯Ÿè€…é‡åˆ°éé¢„æœŸçš„æ•°æ®å’Œä¸€äº›é”™è¯¯ï¼Œå°±ä¼šè°ƒç”¨è¿™ä¸ªæ–¹æ³•ï¼Œæ¥ä¸‹æ¥å®ƒä¸ä¼šè°ƒç”¨ <code>onCompleted</code> æˆ–è€… <code>onNext</code> æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•å°†é”™è¯¯çš„æŒ‡ç¤ºä½œä¸ºå‚æ•°</p>
<h6 id="onCompleted"><a href="#onCompleted" class="headerlink" title="onCompleted"></a>onCompleted</h6><p>æ²¡æœ‰å‘ç”Ÿé”™è¯¯çš„æƒ…å†µä¸‹ï¼Œå®Œæˆæ“ä½œåï¼Œè°ƒç”¨çš„æ–¹æ³•ã€‚</p>
<p>é€šè¿‡å¯¹è§‚å¯Ÿåˆ°çš„æ¡æ¬¾ï¼Œå®ƒå¯ä»¥è°ƒç”¨<code>OnNext</code>é›¶æ¬¡æˆ–æ›´å¤šæ¬¡ï¼Œç„¶åå¯ä»¥æ ¹æ®è°ƒç”¨ç»“æœè°ƒç”¨ æœ€åä¸€æ¬¡ onCompletedæˆ–OnErrorã€‚æŒ‰ç…§æƒ¯ä¾‹ï¼Œåœ¨è¿™ä¸ªæ–‡ä»¶ä¸­ï¼Œè°ƒç”¨<code>OnNext</code>é€šå¸¸è¢«ç§°ä¸ºâ€œæ’æ”¾â€çš„é¡¹ç›®ï¼Œè€Œå«<code>onCompleted</code>æˆ–<code>onError</code>è¢«ç§°ä¸ºâ€œé€šçŸ¥â€ã€‚</p>
<p>å‚è§ï¼š</p>
<ul>
<li><a href="http://www.introtorx.com/Content/v1.0.10621.0/02_KeyTypes.html#IObserver" target="_blank" rel="noopener">Introduction to Rx: IObserver</a></li>
</ul>
<h5 id="æ³¨é”€-Unsubscribing"><a href="#æ³¨é”€-Unsubscribing" class="headerlink" title="æ³¨é”€ Unsubscribing"></a>æ³¨é”€ Unsubscribing</h5><p>åœ¨ä¸€äº›reactivexå®ç°ï¼Œæœ‰ä¸€ä¸ªä¸“é—¨çš„è§‚å¯Ÿè€…æ¥å£ï¼Œç­¾çº¦è€…ï¼Œå®ç°ä¸€ä¸ª<code>Unsubscribing</code>çš„æ–¹æ³•ã€‚ä½ å¯ä»¥è°ƒç”¨è¿™ä¸ªæ–¹æ³•æ¥è¡¨æ˜ï¼Œç”¨æˆ·ä¸å†å¯¹ç›®å‰ä»»ä½•è®¢é˜…æ„Ÿå…´è¶£ã€‚è¿™äº›è§‚æµ‹å¯ä»¥ï¼ˆå¦‚æœä»–ä»¬æ²¡æœ‰å…¶ä»–æ„Ÿå…´è¶£çš„è§‚å¯Ÿå‘˜ï¼‰é€‰æ‹©åœæ­¢äº§ç”Ÿæ–°çš„ç‰©å“å‘å‡ºã€‚</p>
<p>è¿™ä¸€ç»“æœå°†çº§è”é€€è®¢é€šè¿‡è¿è¥å•†ï¼Œé€‚ç”¨äºè§‚å¯Ÿï¼Œè§‚å¯Ÿè€…è®¢é˜…çš„é“¾ï¼Œè¿™å°†å¯¼è‡´åœ¨äº§ä¸šé“¾çš„å„ä¸ªç¯èŠ‚åœæ­¢å‘å°„é¡¹ç›®ã€‚è¿™ä¸ä¿è¯ç«‹å³å‘ç”Ÿï¼Œä½†æ˜¯ï¼Œå®ƒæ˜¯å¯èƒ½çš„ä¸€ä¸ªè§‚å¯Ÿåˆ°çš„äº§ç”Ÿå’Œå°è¯•å‘å°„ä¸€æ®µæ—¶é—´ï¼Œå³ä½¿æ²¡æœ‰è§‚å¯Ÿè€…ä»ç„¶è§‚å¯Ÿè¿™äº›æ’æ”¾é‡ã€‚</p>
<h5 id="å…³äºå‘½åçº¦å®šçš„ä¸€äº›æ³¨é‡Š"><a href="#å…³äºå‘½åçº¦å®šçš„ä¸€äº›æ³¨é‡Š" class="headerlink" title="å…³äºå‘½åçº¦å®šçš„ä¸€äº›æ³¨é‡Š"></a>å…³äºå‘½åçº¦å®šçš„ä¸€äº›æ³¨é‡Š</h5><p>reactivexæ¯ä¸ªè¯­è¨€çš„å…·ä½“å®ç°æœ‰è‡ªå·±çš„å‘½åä¹ æƒ¯ã€‚æœ‰æ²¡æœ‰è§„èŒƒçš„å‘½åæ ‡å‡†ï¼Œè™½ç„¶æœ‰è®¸å¤šå…±æ€§ä¹‹é—´çš„å®ç°</p>
<p>æ­¤å¤–ï¼Œè¿™äº›åç§°ä¸­çš„ä¸€äº›åœ¨å…¶ä»–ä¸Šä¸‹æ–‡ä¸­æœ‰ä¸åŒçš„å«ä¹‰ï¼Œæˆ–åœ¨ä¸€ä¸ªç‰¹å®šçš„å®ç°è¯­è¨€çš„æˆè¯­ä¸­æ˜¾å¾—æœ‰äº›å°´å°¬ã€‚</p>
<p>ä¾‹å¦‚æœ‰äº‹ä»¶çš„å‘½åæ¨¡å¼ï¼ˆä¾‹å¦‚OnNextï¼ŒOnCompletedï¼ŒOnErrorï¼‰ã€‚åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œè¿™æ ·çš„åç§°å°†è¡¨ç¤ºæ–¹æ³•ï¼Œé€šè¿‡è¯¥äº‹ä»¶å¤„ç†ç¨‹åºçš„æ³¨å†Œã€‚ç„¶è€Œï¼Œä»–ä»¬çš„åå­—reactivexï¼Œäº‹ä»¶å¤„ç†å™¨ã€‚</p>
<h4 id="â€œçƒ­â€å’Œâ€œå†·â€çš„-è¢«è§‚æµ‹è€…"><a href="#â€œçƒ­â€å’Œâ€œå†·â€çš„-è¢«è§‚æµ‹è€…" class="headerlink" title="â€œçƒ­â€å’Œâ€œå†·â€çš„ è¢«è§‚æµ‹è€…"></a>â€œçƒ­â€å’Œâ€œå†·â€çš„ è¢«è§‚æµ‹è€…</h4><p>ä»€ä¹ˆæ—¶å€™è¢«è§‚å¯Ÿè€…ä¼šå‘å‡ºä¿¡æ¯ï¼Ÿè¿™å–å†³äºè¢«è§‚å¯Ÿè€…ã€‚â€œçƒ­â€çš„è§‚å¯Ÿå¯èƒ½å½“ä»–åˆšè¢«åˆ›å»ºæ²¡å¤šä¹…å°±å‘å‡ºä¿¡æ¯ï¼Œæ‰€ä»¥åæ¥è®¢é˜…çš„è§‚å¯Ÿè€…è§‚å¯Ÿåˆ°çš„ä¿¡æ¯å°±æ˜¯ä¸­é—´çš„æŸäº›åœ°æ–¹ã€‚â€œå†·â€çš„è§‚å¯Ÿï¼Œç›´åˆ°ä¸€ä¸ªè®¢é˜…è€…è§‚å¯Ÿä»–çš„å˜åŒ–ï¼Œä»–æ‰å¼€å§‹å‘ç”Ÿä¿¡æ¯ã€‚æ‰€ä»¥è§‚å¯Ÿè€…å°±çœ‹åˆ°ä»–çš„æ•´ä¸ªä¿¡æ¯è¿‡ç¨‹</p>
<p>åœ¨reactivexä¸€äº›å®æ–½æ–¹æ¡ˆä¸­ï¼Œä¹Ÿæœ‰ä¸€äº›ç§°ä¸ºâ€œè¿æ¥â€çš„è§‚å¯Ÿã€‚é™¤éä¸€ä¸ªè§‚å¯Ÿè€…è®¢é˜…äº†è¿™ä¸ªè¿æ¥å¯¹è±¡å¹¶ä¸”è°ƒç”¨å®ƒçš„ <code>Connect</code> æ–¹æ³•ï¼Œå¦åˆ™è¢«è§‚å¯Ÿè€…ä¸ä¼šå‘å‡ºä¿¡æ¯</p>
<h4 id="é€šè¿‡å¯è§‚å¯Ÿç®—å­çš„åˆæˆ"><a href="#é€šè¿‡å¯è§‚å¯Ÿç®—å­çš„åˆæˆ" class="headerlink" title="é€šè¿‡å¯è§‚å¯Ÿç®—å­çš„åˆæˆ"></a>é€šè¿‡å¯è§‚å¯Ÿç®—å­çš„åˆæˆ</h4><p>è§‚å¯Ÿè€…å’Œè¢«è§‚å¯Ÿè€…ä»…ä»…åªæ˜¯ <code>ReactiveX</code>çš„å¼€å§‹ã€‚ç”±ä»–ä»¬è‡ªå·±ï¼Œä»–ä»¬åªä¸è¿‡æ˜¯ä¸€ä¸ªè½»å¾®çš„æ‰©å±•çš„æ ‡å‡†è§‚å¯Ÿè€…æ¨¡å¼ï¼Œæ›´é€‚åˆå¤„ç†ä¸€ç³»åˆ—çš„äº‹ä»¶ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªå•ä¸€çš„å›è°ƒã€‚</p>
<p>çœŸæ­£çš„åŠ›é‡æ¥è‡ªäº<code>reactive extensions</code>ï¼ˆå³<code>reactivex</code>ï¼‰-è¿è¥å•†å¯ä»¥å˜æ¢ï¼Œç»“åˆï¼Œæ“çºµï¼Œå¹¶ä¸å‘å°„çš„è§‚æµ‹å€¼åºåˆ—çš„å·¥ä½œé¡¹ç›®ã€‚</p>
<p>è¿™äº›æ¥æ”¶è¿è¥å•†å…è®¸ä½ ä¸€èµ·æ„æˆå¼‚æ­¥åºåˆ—åœ¨å£°æ˜çš„æ–¹å¼ä¸æ‰€æœ‰çš„å›è°ƒå‡½æ•°çš„æ•ˆç‡æ•ˆç›Šä½†æ²¡æœ‰åµŒå¥—çš„å›è°ƒå¤„ç†ç¨‹åºé€šå¸¸ä¸å¼‚æ­¥ç³»ç»Ÿç›¸å…³çš„é—®é¢˜ã€‚</p>
<p>This documentation groups information about the various operators and examples of their usage into the following pages:</p>
<p><a href="http://reactivex.io/documentation/operators.html#creating" target="_blank" rel="noopener">Creating Observables</a><br><code>Create</code>, <code>Defer</code>, <code>Empty/Never/Throw</code>, <code>From</code>, <code>Interval</code>, <code>Just</code>, <code>Range</code>, <code>Repeat</code>, <code>Start</code>, and <code>Timer</code><br><a href="http://reactivex.io/documentation/operators.html#transforming" target="_blank" rel="noopener">Transforming Observable Items</a><br><code>Buffer</code>, <code>FlatMap</code>, <code>GroupBy</code>, <code>Map</code>, <code>Scan</code>, and <code>Window</code><br><a href="http://reactivex.io/documentation/operators.html#filtering" target="_blank" rel="noopener">Filtering Observables</a><br><code>Debounce</code>, <code>Distinct</code>, <code>ElementAt</code>, <code>Filter</code>, <code>First</code>, <code>IgnoreElements</code>, <code>Last</code>, <code>Sample</code>, <code>Skip</code>, <code>SkipLast</code>, <code>Take</code>, and <code>TakeLast</code><br><a href="http://reactivex.io/documentation/operators.html#combining" target="_blank" rel="noopener">Combining Observables</a><br><code>And/Then/When</code>, <code>CombineLatest</code>, <code>Join</code>, <code>Merge</code>, <code>StartWith</code>, <code>Switch</code>, and <code>Zip</code><br><a href="http://reactivex.io/documentation/operators.html#error" target="_blank" rel="noopener">Error Handling Operators</a><br><code>Catch</code> and <code>Retry</code><br><a href="http://reactivex.io/documentation/operators.html#utility" target="_blank" rel="noopener">Utility Operators</a><br><code>Delay</code>, <code>Do</code>, <code>Materialize/Dematerialize</code>, <code>ObserveOn</code>, <code>Serialize</code>, <code>Subscribe</code>, <code>SubscribeOn</code>, <code>TimeInterval</code>, <code>Timeout</code>, <code>Timestamp</code>, and <code>Using</code><br><a href="http://reactivex.io/documentation/operators.html#conditional" target="_blank" rel="noopener">Conditional and Boolean Operators</a><br><code>All</code>, <code>Amb</code>, <code>Contains</code>, <code>DefaultIfEmpty</code>, <code>SequenceEqual</code>, <code>SkipUntil</code>, <code>SkipWhile</code>, <code>TakeUntil</code>, and <code>TakeWhile</code><br><a href="http://reactivex.io/documentation/operators.html#mathematical" target="_blank" rel="noopener">Mathematical and Aggregate Operators</a><br><code>Average</code>, <code>Concat</code>, <code>Count</code>, <code>Max</code>, <code>Min</code>, <code>Reduce</code>, and <code>Sum</code><br><a href="http://reactivex.io/documentation/operators.html#conversion" target="_blank" rel="noopener">Converting Observables</a><br><code>To</code><br><a href="http://reactivex.io/documentation/operators.html#connectable" target="_blank" rel="noopener">Connectable Observable Operators</a><br><code>Connect</code>, <code>Publish</code>, <code>RefCount</code>, and <code>Replay</code><br><a href="http://reactivex.io/documentation/operators/backpressure.html" target="_blank" rel="noopener">Backpressure Operators</a><br>æ‰§è¡Œç‰¹å®šçš„æµé‡æ§åˆ¶ç­–ç•¥çš„å„ç§è¿è¥å•†</p>
<h5 id="è¿é”è¿è¥å•†"><a href="#è¿é”è¿è¥å•†" class="headerlink" title="è¿é”è¿è¥å•†"></a>è¿é”è¿è¥å•†</h5><p>å¤§å¤šæ•°æ“ä½œç¬¦åœ¨å¯è§‚å¯Ÿåˆ°çš„å’Œè¿”å›ä¸€ä¸ªå¯è§‚å¯Ÿåˆ°çš„ã€‚è¿™å…è®¸ä½ åº”ç”¨è¿™äº›æ“ä½œç¬¦ä¸€ä¸ªæ¥ä¸€ä¸ªï¼Œåœ¨ä¸€ä¸ªé“¾ä¸­ã€‚é“¾ä¸­çš„æ¯ä¸ªæ“ä½œç¬¦éƒ½ä¿®æ”¹äº†å¯è§‚å¯Ÿåˆ°çš„ç»“æœï¼Œä»ä»¥å‰çš„æ“ä½œçš„æ“ä½œã€‚<br>è¿˜æœ‰å…¶ä»–æ¨¡å¼ï¼Œå¦‚ç”Ÿæˆå™¨æ¨¡å¼ï¼Œå…¶ä¸­ä¸€ä¸ªç‰¹å®šç±»çš„å„ç§æ–¹æ³•é€šè¿‡ä¿®æ”¹è¯¥å¯¹è±¡çš„æ“ä½œæ¥ä¿®æ”¹è¯¥ç±»çš„ä¸€ä¸ªç±»ä¸Šçš„ä¸€ä¸ªé¡¹ç›®ã€‚è¿™äº›æ¨¡å¼ä¹Ÿå…è®¸ä½ ä»¥ç±»ä¼¼çš„æ–¹å¼é“¾çš„æ–¹æ³•ã€‚ä½†åœ¨ç”Ÿæˆå™¨æ¨¡å¼ä¸­ï¼Œåœ¨é“¾ä¸­å‡ºç°çš„æ–¹æ³•çš„é¡ºåºé€šå¸¸ä¸é‡è¦ï¼Œä¸å¯è§‚å¯Ÿåˆ°çš„è¿è¥å•†çš„è®¢å•äº‹å®œã€‚<br>è§‚å¯Ÿåˆ°çš„æ“ä½œç¬¦çš„é“¾ä¸ç‹¬ç«‹äºåŸå§‹è§‚å¯Ÿåˆ°çš„èµ·æºé“¾ï¼Œä½†ä»–ä»¬åè¿‡æ¥æ“ä½œï¼Œæ¯ä¸€ä¸ªæ“ä½œä¸Šçš„è§‚å¯Ÿæ‰€äº§ç”Ÿçš„è¿è¥å•†ç«‹å³åœ¨å¤–é“¾ã€‚</p>
]]></content>
      
        <categories>
            
            <category> å¼€å‘å¸®åŠ© </category>
            
        </categories>
        
        
        <tags>
            
            <tag> reactiv </tag>
            
            <tag> rxswift </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Realm-cocoa å­¦ä¹ ]]></title>
      <url>http://www.msiter.com/2016/03/03/realm-cocoa%20%E5%AD%A6%E4%B9%A0/</url>
      <content type="html"><![CDATA[<p><img class = "g-pl-90"  src="http://image.msiter.com/stock-photo-181146547.jpg" alt="" title="å¦‚æœæ²¡æœ‰è§è¿‡å…‰æ˜ï¼Œæˆ‘æœ¬å¯ä»¥å¿å—é»‘æš—ã€‚"></p>
<p>PS:ä»¥ä¸‹å†…å®¹å‡ä¸ºé¡¹ç›®ä¸ºSwiftçš„åŸºç¡€ï¼Œå¦‚æœéœ€è¦Objectï¼cè¯·æŸ¥é˜…Realmçš„<a href="https://realm.io/docs/objc/latest" target="_blank" rel="noopener">Objectï¼cæ–‡æ¡£</a>ã€‚</p>
<p>å‰äº›æ—¥å­åœ¨çœ‹ç¬¬ä¸€å±Šã€Šä¸­å›½Swiftå¼€å‘è€…å¤§ä¼šã€‹çš„æ—¶å€™ï¼Œå¬åˆ°äº†realmè¿™ä¸ªæ•°æ®åº“ï¼Œè¯´åˆ°äº†è¿è¡Œé€Ÿåº¦æ–¹é¢ï¼Œç›¸è¾ƒäºCoreDataå¯ä»¥æœ‰å¾ˆå¤§çš„æå‡ã€‚å†åŠ ä¸Šä¹‹å‰åœ¨åšé¡¹ç›®çš„æ—¶å€™ï¼Œè§‰çš„coredataçš„å¾ˆå¤šé…ç½®è®©æˆ‘è§‰çš„ä¸çˆ½ï¼Œå¾ˆæ˜¯ç¹çã€‚æ‰€ä»¥å°±æƒ³çœ‹ä¸€çœ‹realmåˆ°åº•å¦‚ä½•ï¼Œå­¦ä¹ äº†ä¸€å¤©è§‰çš„å¾ˆå¥½ï¼Œå›ºå†³å®šè®°å½•ä¸€ä¸‹ã€‚å› ä¸ºä¹Ÿä¸çŸ¥é“æ€ä¹ˆè®²è§£ï¼Œæ‰€ä»¥æˆ‘ä¼šå°è¯•ç¿»è¯‘realmå®˜ç½‘çš„æ–‡æ¡£ï¼Œå†åŠ ä¸Šæˆ‘çš„ç†è§£è¿›è¡Œè§£é‡Šã€‚</p>
<blockquote>
<p>Realm is a mobile database<br>hundreds of millions of people rely on</p>
</blockquote>
<a id="more"></a>
<h2 id="æ•£è®°"><a href="#æ•£è®°" class="headerlink" title="æ•£è®°"></a>æ•£è®°</h2><p>è¿™æ˜¯<a href="https://realm.io/" target="_blank" rel="noopener">Realm</a>å®˜ç½‘çš„å¯¹äºè‡ªå·±çš„è§£é‡Šã€‚</p>
<p>realmå¯ä»¥å¿«é€Ÿæœ‰æ•ˆçš„ç¼–å†™åº”ç”¨ç¨‹åºçš„æœ¬åœ°æŒä¹…åŒ–ï¼Œå®ƒçš„ä»£ç å¤§æ¦‚å°±æ˜¯ä¸‹é¢è¿™ä¸ªæ ·å­ï¼š</p>
<pre class="line-numbers language-swift"><code class="language-swift"><span class="token comment" spellcheck="true">// å…ˆåˆ›å»ºä¸€ä¸ªä½ æƒ³è¦æŒä¹…åŒ–çš„å¯¹è±¡çš„æ¨¡å‹ï¼ŒObject æ˜¯ Reaml è‡ªå·±å®šä¹‰çš„å¯¹è±¡</span>
<span class="token keyword">class</span> <span class="token class-name">Dog</span><span class="token punctuation">:</span> <span class="token builtin">Object</span> <span class="token punctuation">{</span>
  <span class="token keyword">dynamic</span> <span class="token keyword">var</span> name <span class="token operator">=</span> <span class="token string">""</span>
  <span class="token keyword">dynamic</span> <span class="token keyword">var</span> age <span class="token operator">=</span> <span class="token number">0</span>
<span class="token punctuation">}</span>
<span class="token keyword">class</span> <span class="token class-name">Person</span><span class="token punctuation">:</span> <span class="token builtin">Object</span> <span class="token punctuation">{</span>
  <span class="token keyword">dynamic</span> <span class="token keyword">var</span> name <span class="token operator">=</span> <span class="token string">""</span>
  <span class="token keyword">dynamic</span> <span class="token keyword">var</span> picture<span class="token punctuation">:</span> <span class="token builtin">NSData</span><span class="token operator">?</span> <span class="token operator">=</span> <span class="token constant">nil</span> <span class="token comment" spellcheck="true">// è¿™æ˜¯ä¸€ä¸ªå¯é€‰ç±»å‹</span>
  <span class="token keyword">let</span> dogs <span class="token operator">=</span> <span class="token builtin">List</span><span class="token operator">&lt;</span><span class="token builtin">Dog</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">// è¿™æ˜¯å®ä¾‹åŒ–ä¸€ä¸ªRealmå¯¹è±¡çš„æ—¶å€™ï¼Œå°±åƒå’±ä»¬å¹³æ—¶åˆ›å»ºClasså¯¹è±¡ä¸€æ ·çš„</span>
<span class="token keyword">let</span> myDog <span class="token operator">=</span> <span class="token function">Dog</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
myDog<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">"Rex"</span>
myDog<span class="token punctuation">.</span>age <span class="token operator">=</span> <span class="token number">1</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"name of dog: <span class="token interpolation"><span class="token delimiter variable">\(</span>myDog<span class="token punctuation">.</span>name<span class="token delimiter variable">)</span></span>"</span><span class="token punctuation">)</span>

<span class="token comment" spellcheck="true">// å¾—åˆ°ä¸€ä¸ªRealmå¯¹è±¡</span>
<span class="token keyword">let</span> realm <span class="token operator">=</span> <span class="token keyword">try</span><span class="token operator">!</span> <span class="token function">Realm</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment" spellcheck="true">// æŸ¥è¯¢è¿™ä¸ªç‹—å°äºä¸¤å²çš„ï¼Œå…¶å®å’±ä»¬çœ‹ç€ä»£ç å°±å¯ä»¥ç†è§£äº†ï¼Œå®ƒä½¿ç”¨äº†é“¾å¼ä»£ç ç»“æ„ï¼Œå¾ˆå®¹æ˜“çœ‹æ‡‚</span>
<span class="token keyword">let</span> puppies <span class="token operator">=</span> realm<span class="token punctuation">.</span><span class="token function">objects</span><span class="token punctuation">(</span><span class="token builtin">Dog</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token string">"age &lt; 2"</span><span class="token punctuation">)</span>
puppies<span class="token punctuation">.</span><span class="token builtin">count</span> <span class="token comment" spellcheck="true">// => 0 æ¯”å¦‚ç°åœ¨çš„åˆ°çš„æ•°ç›®æ˜¯0ï¼Œå› ä¸ºç°åœ¨å’±ä»¬è¿˜æ²¡æœ‰æ·»åŠ ä»»ä½•æ•°æ®</span>

<span class="token comment" spellcheck="true">// æŠŠå’±ä»¬çš„ä¸Šé¢åˆ›å»ºçš„ç‹—çš„å¯¹è±¡ï¼Œæ·»åŠ åˆ°æ•°æ®åº“ä¸­</span>
<span class="token keyword">try</span><span class="token operator">!</span> realm<span class="token punctuation">.</span>write <span class="token punctuation">{</span>
  realm<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>myDog<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">// å†æ¬¡æŸ¥çœ‹æ•°é‡çš„æ—¶å€™ï¼Œä¸éœ€è¦å†è¿›è¡Œä¸€æ¬¡æŸ¥è¯¢ï¼ŒRealmä¼šè‡ªåŠ¨çš„ä¸ºä½ å®Œæˆæ›´æ–°</span>
puppies<span class="token punctuation">.</span><span class="token builtin">count</span> <span class="token comment" spellcheck="true">// => 1</span>

<span class="token comment" spellcheck="true">// ä½ ä¹Ÿå¯ä»¥æ›´æ–°ä½ çš„æ•°æ®å†…å®¹åœ¨ä»»ä½•çº¿ç¨‹</span>
<span class="token function">dispatch_async</span><span class="token punctuation">(</span><span class="token function">dispatch_queue_create</span><span class="token punctuation">(</span><span class="token string">"background"</span><span class="token punctuation">,</span> <span class="token constant">nil</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> realm <span class="token operator">=</span> <span class="token keyword">try</span><span class="token operator">!</span> <span class="token function">Realm</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">let</span> theDog <span class="token operator">=</span> realm<span class="token punctuation">.</span><span class="token function">objects</span><span class="token punctuation">(</span><span class="token builtin">Dog</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token string">"age == 1"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">first</span>
  <span class="token keyword">try</span><span class="token operator">!</span> realm<span class="token punctuation">.</span>write <span class="token punctuation">{</span>
    theDog<span class="token operator">!</span><span class="token punctuation">.</span>age <span class="token operator">=</span> <span class="token number">3</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="æ•™ç¨‹"><a href="#æ•™ç¨‹" class="headerlink" title="æ•™ç¨‹"></a>æ•™ç¨‹</h2><h3 id="é¡¹ç›®ä¸­å¦‚ä½•æ·»åŠ -Realm-æ¡†æ¶"><a href="#é¡¹ç›®ä¸­å¦‚ä½•æ·»åŠ -Realm-æ¡†æ¶" class="headerlink" title="é¡¹ç›®ä¸­å¦‚ä½•æ·»åŠ  Realm æ¡†æ¶"></a><strong>é¡¹ç›®ä¸­å¦‚ä½•æ·»åŠ  Realm æ¡†æ¶</strong></h3><p>ä¸»è¦æœ‰ä¸‹é¢çš„ä¸‰ç§é›†æˆæ–¹å¼</p>
<h4 id="ä½¿ç”¨Dynamic-Frameworkï¼š"><a href="#ä½¿ç”¨Dynamic-Frameworkï¼š" class="headerlink" title="ä½¿ç”¨Dynamic Frameworkï¼š"></a>ä½¿ç”¨Dynamic Frameworkï¼š</h4><ul>
<li>ä¸‹è½½Realmå®‰è£…åŒ…<a href="https://static.realm.io/downloads/swift/realm-swift-0.98.3.zip" target="_blank" rel="noopener">æœ€æ–°ç‰ˆæœ¬</a></li>
<li>æ ¹æ®ä½ çš„éœ€è¦ï¼Œå°†ä½ ä¸‹è½½æ–‡ä»¶è§£å‹åï¼Œ ä»/ios/swift-2.1.1ï¼ˆIOSè®¾å¤‡ï¼‰ æˆ–è€…  tvos/ï¼ˆAppleç”µè§†è®¾å¤‡ï¼‰ å†æˆ–è€… osx/swift-2.1.1/ï¼ˆmacç”µè„‘è®¾å¤‡ï¼‰ è¿™ä¸‰ä¸ªç›®å½•ä¸­ï¼Œé€‰æ‹©è‡ªå·±éœ€è¦çš„æ–‡ä»¶ï¼Œå°†å…¶æ‹–å…¥é¡¹ç›®ä¸­ï¼Œå¹¶ä¸”è¦é€‰ä¸­â€œå¦‚æœéœ€è¦è¯·å‹¾é€‰â€é€‰é¡¹</li>
<li>åœ¨ä½ çš„é¡¹ç›®ä¸­ Build Settings ï¼Œä¸ºFramework Search Paths è®¾ç½®ealmSwift.framework è·¯å¾„</li>
<li>å¦‚æœä½¿ç”¨Realm åœ¨ IOSï¼ŒwatchOSæˆ–è€…TvOSï¼Œåœ¨Build Phase åˆ›å»ºä¸€ä¸ªæ–°çš„ â€œRun Script Phaseâ€ï¼Œä¸‹é¢å†™ä¸Š<code>bash &quot;${BUILT_PRODUCTS_DIR}/${FRAMEWORKS_FOLDER_PATH}/Realm.framework/strip-frameworks.sh&quot;</code>è¿™ä¸€æ­¥æ˜¯éœ€è¦è§£å†³åº”ç”¨ç¨‹åºå•†åº—æäº¤bugæ—¶å­˜æ¡£é€šç”¨äºŒè¿›åˆ¶æ–‡ä»¶ã€‚<h4 id="ä½¿ç”¨CocoaPods"><a href="#ä½¿ç”¨CocoaPods" class="headerlink" title="ä½¿ç”¨CocoaPods"></a>ä½¿ç”¨CocoaPods</h4></li>
<li>å®‰è£…<code>CocoaPods</code>0.39.0 ç‰ˆæœ¬æˆ–è€…æ›´æ–°çš„ç‰ˆæœ¬.</li>
<li>åœ¨ä½ çš„Podfileæ–‡ä»¶ä¸­æ·»åŠ <code>use_frameworks!</code> å’Œ <code>pod &#39;RealmSwift&#39;</code></li>
<li>åœ¨ç»ˆç«¯ä¸­è¿è¡Œ <code>pod install</code></li>
<li>æ‰“å¼€ <code>ï¼Š.xcworkspace</code> é¡¹ç›®<h4 id="ä½¿ç”¨Carthage"><a href="#ä½¿ç”¨Carthage" class="headerlink" title="ä½¿ç”¨Carthage"></a>ä½¿ç”¨Carthage</h4></li>
<li>å®‰è£… <code>Carthage</code> 0.9.2 æˆ–è€…æ›´æ–°çš„ç‰ˆæœ¬</li>
<li>åœ¨ä½ çš„Cartfileæ–‡ä»¶ä¸­æ·»åŠ <code>&quot;realm/realm-cocoa&quot;</code></li>
<li>è¿è¡Œ <code>carthage update</code>.</li>
<li>ä» Carthage/Build/ æ‹–æ‹½RealmSwift.framework å’Œ Realm.framework åˆ° General ä¸‹é¢çš„â€œEmbedded Binariesâ€</li>
<li>iOS/watchOS/tvOS: åœ¨ä½ çš„é¡¹ç›®targetsçš„ â€œBuild Phasesâ€è®¾ç½®é¡¹ä¸­ï¼Œç‚¹å‡»â€œï¼‹â€å¥½æŒ‰é’®ï¼Œæ·»åŠ ä¸€ä¸ªæ–°çš„â€œNew Run Script Phaseâ€ï¼Œå†…å®¹å¦‚ä¸‹<code>/usr/local/bin/carthage copy-frameworks</code>å’Œè·¯å¾„æ·»åŠ åˆ°æ¡†æ¶ä¸‹æ‚¨æƒ³è¦ä½¿ç”¨â€œè¾“å…¥æ–‡ä»¶â€,å¦‚<code>$(SRCROOT)/Carthage/Build/iOS/Realm.framework</code>,<br><code>$(SRCROOT)/Carthage/Build/iOS/RealmSwift.framework</code>è¿™ä¸ªè„šæœ¬æ˜¯åœ¨<a href="http://www.openradar.me/radar?id=6409498411401216" target="_blank" rel="noopener">åº”ç”¨ç¨‹åºå•†åº—æäº¤é”™è¯¯</a>å¼•å‘äº†æ™®éçš„äºŒè¿›åˆ¶æ–‡ä»¶ã€‚ç¡®ä¿è¿™ä¸€é˜¶æ®µå,â€œåµŒå…¥æ¡†æ¶â€é˜¶æ®µã€‚</li>
</ul>
<h3 id="åˆ›å»ºæ•°æ®æ¨¡å‹"><a href="#åˆ›å»ºæ•°æ®æ¨¡å‹" class="headerlink" title="åˆ›å»ºæ•°æ®æ¨¡å‹"></a>åˆ›å»ºæ•°æ®æ¨¡å‹</h3><p><a name="æ–¹ä¾¿å¿«æ·çš„åˆ›å»ºRealmæ¨¡å‹"></a><br><br></p>
<h4 id="æ–¹ä¾¿å¿«æ·çš„åˆ›å»ºRealmæ¨¡å‹"><a href="#æ–¹ä¾¿å¿«æ·çš„åˆ›å»ºRealmæ¨¡å‹" class="headerlink" title="æ–¹ä¾¿å¿«æ·çš„åˆ›å»ºRealmæ¨¡å‹"></a>æ–¹ä¾¿å¿«æ·çš„åˆ›å»ºRealmæ¨¡å‹</h4><p>é¦–å…ˆéœ€è¦å®‰è£…<code>Alcatraz</code>,åœ¨ç»ˆç«¯é‡Œé¢æ‰§è¡Œä»¥ä¸‹å‘½ä»¤.å¦‚æœæ‰§è¡Œå¤±è´¥ï¼Œè¯·ç¿»å¢™ååœ¨å°è¯•</p>
<pre class="line-numbers language-shell"><code class="language-shell">curl -fsSL https://raw.githubusercontent.com/supermarin/Alcatraz/deploy/Scripts/install.sh | sh
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>å®‰è£…å®Œæˆä¹‹åï¼Œé‡å¯xcodeå°±å¯ä»¥åœ¨èœå•windowé€‰é¡¹ä¸‹é¢çœ‹åˆ°ä¸€ä¸ªPackage Manager é€‰é¡¹ï¼Œç‚¹å‡» å®‰è£…package ï¼Œæœç´¢ Xcode Plugin ï¼Œä¹‹åï¼Œå†é‡å¯ã€‚åˆ›å»ºåˆ›å»ºæ–‡ä»¶ï¼Œå°±å¯ä»¥æ–‡ä»¶ç±»å‹ä¸­æœ‰ä¸€ä¸ªRealmé€‰é¡¹ï¼Œç‚¹å‡»åˆ›å»ºã€‚ä¹‹åç”Ÿæˆæ–‡ä»¶ï¼  ä½ ä¼šå‘ç°ï¼ï¼SHITï¼ï¼ï¼ï¼ï¼æˆ‘ä¸å¦‚è‡ªå·±å†™äº†ï¼ï¼ï¼ï¼ï¼ï¼ï¼</p>
<p><a name="åˆ›å»ºRealm æ•°æ®æ¨¡å‹"></a><br><br></p>
<h4 id="åˆ›å»ºRealm-æ•°æ®æ¨¡å‹"><a href="#åˆ›å»ºRealm-æ•°æ®æ¨¡å‹" class="headerlink" title="åˆ›å»ºRealm æ•°æ®æ¨¡å‹"></a>åˆ›å»ºRealm æ•°æ®æ¨¡å‹</h4><p>å…¶å®åˆ›å»ºRealmæ•°æ®æ¨¡å‹çš„æ–¹æ³•è¶…çº§ç®€å•ï¼Œå°±å’Œå’±ä»¬å¹³æ—¶åˆ›å»ºClassæ˜¯ä¸€æ ·ä¸€æ ·çš„ã€‚</p>
<pre class="line-numbers language-swift"><code class="language-swift"><span class="token keyword">import</span> <span class="token builtin">RealmSwift</span>

<span class="token comment" spellcheck="true">// ç‹—çš„æ•°æ®æ¨¡å‹</span>
<span class="token keyword">class</span> <span class="token class-name">Dog</span><span class="token punctuation">:</span> <span class="token builtin">Object</span> <span class="token punctuation">{</span>
    <span class="token keyword">dynamic</span> <span class="token keyword">var</span> name <span class="token operator">=</span> <span class="token string">""</span>
    <span class="token keyword">dynamic</span> <span class="token keyword">var</span> owner<span class="token punctuation">:</span> <span class="token builtin">Person</span><span class="token operator">?</span> <span class="token comment" spellcheck="true">// ç‹—çš„ä¸»äººæ˜¯å¯ä»¥ä¸ºç©ºçš„</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>ä½†æ˜¯ï¼Œåœ¨ä»¬å¿…é¡»çŸ¥é“ä»–éƒ½å…è®¸å’±ä»¬åˆ›å»ºä»€ä¹ˆç±»å‹çš„æ•°æ®ã€‚</p>
<p>è¿™æ ·å­å’±ä»¬åˆ›å»ºæ•°æ®æ¨¡å‹çš„æ—¶å€™å°±æ²¡æœ‰é—®é¢˜äº†å§ã€‚å½“ç„¶Realmæ˜¯æ”¯æŒç»‘å®šå…³ç³»çš„ã€‚ä¸€å¯¹ä¸€ï¼Œä¸€å¯¹å¤šä¹‹ç±»çš„ï¼Œéƒ½å¯ä»¥çš„ã€‚</p>
<p><a name="æ•°æ®çš„æ“ä½œ"></a><br><br></p>
<h3 id="æ•°æ®çš„æ“ä½œ"><a href="#æ•°æ®çš„æ“ä½œ" class="headerlink" title="æ•°æ®çš„æ“ä½œ"></a>æ•°æ®çš„æ“ä½œ</h3><p><a name="å‘Realmæ’å…¥æ•°æ®"></a><br><br></p>
<h4 id="å‘Realmæ’å…¥æ•°æ®"><a href="#å‘Realmæ’å…¥æ•°æ®" class="headerlink" title="å‘Realmæ’å…¥æ•°æ®"></a>å‘Realmæ’å…¥æ•°æ®</h4><p>ç»ˆäºè¿æ¥äº†ï¼Œå’±ä»¬çš„å¢åˆ æ”¹æŸ¥äº†ã€‚</p>
<p>å½“ä½ å®šä¹‰ä¸€ä¸ªæ¨¡å‹ä½ å¯ä»¥å®ä¾‹åŒ–å¯¹è±¡å­ç±»å’Œæ–°å®ä¾‹æ·»åŠ åˆ°åŸŸã€‚è€ƒè™‘ä¸€ä¸‹è¿™ä¸ªç®€å•çš„æ¨¡å‹:</p>
<pre class="line-numbers language-swift"><code class="language-swift"><span class="token keyword">class</span> <span class="token class-name">Dog</span><span class="token punctuation">:</span> <span class="token builtin">Object</span> <span class="token punctuation">{</span>
    <span class="token keyword">dynamic</span> <span class="token keyword">var</span> name <span class="token operator">=</span> <span class="token string">""</span>
    <span class="token keyword">dynamic</span> <span class="token keyword">var</span> age <span class="token operator">=</span> <span class="token number">0</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>æˆ‘ä»¬å¯ä»¥ä»¥ä¸‹å‡ ä¸ªæ–¹å¼åˆ›å»ºå¯¹è±¡:</p>
<pre class="line-numbers language-swift"><code class="language-swift"><span class="token comment" spellcheck="true">// (1) å…ˆåˆ›å»ºç‹—çš„å¯¹è±¡ï¼Œç„¶ååœ¨ç»™äºˆå…¶èµ‹å€¼</span>
<span class="token keyword">var</span> myDog <span class="token operator">=</span> <span class="token function">Dog</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
myDog<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">"Rex"</span>
myDog<span class="token punctuation">.</span>age <span class="token operator">=</span> <span class="token number">10</span>

<span class="token comment" spellcheck="true">// (2) ä½¿ç”¨å­—å…¸åˆ›å»º</span>
<span class="token keyword">let</span> myOtherDog <span class="token operator">=</span> <span class="token function">Dog</span><span class="token punctuation">(</span>value<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">"name"</span> <span class="token punctuation">:</span> <span class="token string">"Pluto"</span><span class="token punctuation">,</span> <span class="token string">"age"</span><span class="token punctuation">:</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment" spellcheck="true">// (3) ä½¿ç”¨ä¸€ä¸ªArrayåˆ›å»ºyã€‚</span>
<span class="token keyword">let</span> myThirdDog <span class="token operator">=</span> <span class="token function">Dog</span><span class="token punctuation">(</span>value<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">"Fido"</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>1.æœ€æ˜¾è€Œæ˜“è§çš„å°±æ˜¯ ç›´æ¥åˆ›å»ºå¯¹è±¡ï¼Œå¹¶ä¸”èµ‹å€¼<br>2.ä¹Ÿå¯ä»¥ä½¿ç”¨å­—å…¸å®ä¾‹åŒ–å¯¹è±¡ï¼Œä½†æ˜¯ï¼è¦ä½¿ç”¨æ•°æ®æ¨¡å‹ä¸­å¯¹åº”çš„ï¼çš„é”®å’Œå€¼ã€‚<br>3.æœ€å,å¯ä»¥ä½¿ç”¨æ•°ç»„å®ä¾‹åŒ–å¯¹è±¡ã€‚ä½†æ˜¯è¦æ³¨æ„ï¼æ•°ç»„ä¸­çš„å€¼ï¼Œå¿…é¡»å’Œæ•°æ®æ¨¡å‹ä¸­çš„å±æ€§çš„é¡ºåºä¿æŒä¸€è‡´</p>
<p>åˆ›å»ºå®Œæˆå¯¹è±¡ä¹‹åå°±æ˜¯æŠŠå®ƒæ”¾å…¥æ•°æ®åº“é‡Œé¢äº†ï¼Œä½ å¯ä»¥åƒä¸‹é¢çš„æ–¹æ³•ä¸€æ ·æ”¾è¿›æ•°æ®åº“</p>
<pre class="line-numbers language-swift"><code class="language-swift"><span class="token comment" spellcheck="true">// åˆ›å»ºä¸€ä¸ªç”¨æˆ·å¯¹è±¡ï¼Œå¹¶ä¸”èµ‹å€¼</span>
<span class="token keyword">let</span> author <span class="token operator">=</span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
author<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">"David Foster Wallace"</span>

<span class="token comment" spellcheck="true">// å¾—åˆ°é»˜è®¤çš„Realmå¯¹è±¡</span>
<span class="token keyword">let</span> realm <span class="token operator">=</span> <span class="token keyword">try</span><span class="token operator">!</span> <span class="token function">Realm</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment" spellcheck="true">// ä½ åªéœ€è¦è¿™ä¹ˆåšä¸€æ¬¡</span>

<span class="token comment" spellcheck="true">// æ·»åŠ è¿™ä¸ªå¯¹è±¡åˆ°Realm</span>
<span class="token keyword">try</span><span class="token operator">!</span> realm<span class="token punctuation">.</span>write <span class="token punctuation">{</span>
  realm<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>author<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>è¿™æ ·å°±åœ¨æ•°æ®åº“ä¸­ï¼Œæ·»åŠ äº†ä¸€ä¸ªå¯¹è±¡äº†ã€‚</p>
<p><a name="Realmä¿®æ”¹æ•°æ®"></a><br><br></p>
<h4 id="Realmä¿®æ”¹æ•°æ®"><a href="#Realmä¿®æ”¹æ•°æ®" class="headerlink" title="Realmä¿®æ”¹æ•°æ®"></a>Realmä¿®æ”¹æ•°æ®</h4><p>Realm æä¾›å¾ˆå¤šæ–¹å¼å»ä¿®æ”¹æ•°æ®ï¼Œè¯·é€‰æ‹©é€‚åˆè‡ªå·±çš„æ–¹å¼è¿›è¡Œä¿®æ”¹</p>
<p><a name="Typed Updates"></a><br><br></p>
<h5 id="Typed-Updates"><a href="#Typed-Updates" class="headerlink" title="Typed Updates"></a>Typed Updates</h5><p>ä½ å¯ä»¥ä¿®æ”¹ä»»ä½•å¯¹è±¡çš„å±æ€§ï¼Œåœ¨writeè¿›ç¨‹ä¸­</p>
<pre class="line-numbers language-swift"><code class="language-swift"><span class="token comment" spellcheck="true">// Update an object with a transaction</span>
<span class="token keyword">try</span><span class="token operator">!</span> realm<span class="token punctuation">.</span>write <span class="token punctuation">{</span>
  author<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">"Thomas Pynchon"</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p><a name="æ ¹æ®æ•°æ®çš„ä¸»é”®è¿›è¡Œä¿®æ”¹"></a><br><br></p>
<h5 id="æ ¹æ®æ•°æ®çš„ä¸»é”®è¿›è¡Œä¿®æ”¹"><a href="#æ ¹æ®æ•°æ®çš„ä¸»é”®è¿›è¡Œä¿®æ”¹" class="headerlink" title="æ ¹æ®æ•°æ®çš„ä¸»é”®è¿›è¡Œä¿®æ”¹"></a>æ ¹æ®æ•°æ®çš„ä¸»é”®è¿›è¡Œä¿®æ”¹</h5><p>é‡å†™æ•°æ®æ¨¡å‹çš„<code>Object.primaryKey()</code>æ–¹æ³•å¯ä»¥è®¾ç½®æ¨¡å‹çš„ä¸»é”®ï¼Œå£°æ˜ä¸€ä¸ªä¸»é”®ï¼Œå…è®¸å¯¹è±¡å¯ä»¥é€šè¿‡ä¸»é”®è¿›è¡Œæœ‰æ•ˆçš„æŸ¥è¯¢å’Œä¿®æ”¹ï¼Œå¹¶å¼ºåˆ¶æ¯ä¸ªå€¼çš„å”¯ä¸€æ€§ã€‚ä¸€æ—¦ä¸€ä¸ªå¯¹è±¡æ·»åŠ åˆ°Realmï¼Œä¸»é”®å°±ä¸èƒ½æ›´æ”¹</p>
<pre class="line-numbers language-swift"><code class="language-swift"><span class="token keyword">class</span> <span class="token class-name">Book</span><span class="token punctuation">:</span> <span class="token builtin">Object</span> <span class="token punctuation">{</span>
  <span class="token keyword">dynamic</span> <span class="token keyword">var</span> id <span class="token operator">=</span> <span class="token number">0</span>
  <span class="token keyword">dynamic</span> <span class="token keyword">var</span> price <span class="token operator">=</span> <span class="token number">0</span>
  <span class="token keyword">dynamic</span> <span class="token keyword">var</span> title <span class="token operator">=</span> <span class="token string">""</span>

  <span class="token keyword">override</span> <span class="token keyword">static</span> <span class="token keyword">func</span> <span class="token function">primaryKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">String</span><span class="token operator">?</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token string">"id"</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>å› ä¸ºè¿™ä¸ªæ•°æ®æ¨¡å‹å«æœ‰ä¸»é”®ï¼Œæ‰€ä»¥å†å‘Realmæ·»åŠ ä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œå¦‚æœå·²ç»å­˜åœ¨åŒæ ·ä¸»é”®çš„å¯¹è±¡æ—¶ï¼ŒRealmä¼šè‡ªåŠ¨æ›´æ–°å‰ä¸€ä¸ªæ•°æ®çš„å…¶å®ƒä¸ä¸€æ ·çš„å±æ€§ã€‚è€Œå¦‚æœä¸å­˜åœ¨è¿™ä¸ªä¸»é”®çš„å¯¹è±¡ï¼ŒRealmä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„å¯¹è±¡</p>
<pre class="line-numbers language-swift"><code class="language-swift"><span class="token comment" spellcheck="true">// å‡è®¾Realmä¸­å­˜åœ¨ä¸€ä¸ªä¸»é”®ä¸º1çš„å¯¹è±¡çš„æ—¶å€™</span>
<span class="token keyword">let</span> cheeseBook <span class="token operator">=</span> <span class="token function">Book</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
cheeseBook<span class="token punctuation">.</span>title <span class="token operator">=</span> <span class="token string">"Cheese recipes"</span>
cheeseBook<span class="token punctuation">.</span>price <span class="token operator">=</span> <span class="token number">9000</span>
cheeseBook<span class="token punctuation">.</span>id <span class="token operator">=</span> <span class="token number">1</span>

<span class="token comment" spellcheck="true">// id==1ï¼Œä¿®æ”¹è¿™ä¸ªä¹¦çš„å±æ€§</span>
<span class="token keyword">try</span><span class="token operator">!</span> realm<span class="token punctuation">.</span>write <span class="token punctuation">{</span>
  realm<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>cheeseBook<span class="token punctuation">,</span> update<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>ä½ ä¹Ÿå¯ä»¥é€šè¿‡ä¸€ä¸ªå­—å…¸çš„æ–¹å¼ï¼ŒæŒ‡å®šä¸»é”®å’Œä½ è¦ä¿®æ”¹çš„å±æ€§ï¼Œæ¥è¿›è¡Œä¿®æ”¹ç”¨æˆ·</p>
<pre class="line-numbers language-swift"><code class="language-swift"><span class="token comment" spellcheck="true">// å‡è®¾æ•°æ®åº“ä¸­å·²ç»å­˜åœ¨ä¸€ä¸ªä¸»é”®ä¸º1çš„Bookæ—¶</span>
<span class="token keyword">try</span><span class="token operator">!</span> realm<span class="token punctuation">.</span>write <span class="token punctuation">{</span>
  realm<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token builtin">Book</span><span class="token punctuation">.</span><span class="token keyword">self</span><span class="token punctuation">,</span> value<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">"id"</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">"price"</span><span class="token punctuation">:</span> <span class="token number">9000.0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> update<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
  <span class="token comment" spellcheck="true">// the book's `title` property will remain unchanged.</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><a name="ä¿®æ”¹å¤§æ‰¹é‡æ•°æ®"></a><br><br></p>
<h5 id="ä¿®æ”¹å¤§æ‰¹é‡æ•°æ®"><a href="#ä¿®æ”¹å¤§æ‰¹é‡æ•°æ®" class="headerlink" title="ä¿®æ”¹å¤§æ‰¹é‡æ•°æ®"></a>ä¿®æ”¹å¤§æ‰¹é‡æ•°æ®</h5><p>å¯ä»¥è·å–ä¸€ç¾¤æ•°æ®åï¼ŒæŒ‡å®šè¿™äº›æ•°æ®å…¶ä¸­çš„æŸäº›æ•°æ®ï¼Œæˆ–è€…å…¨éƒ¨æ•°æ®ã€‚ çš„æŸä¸€æ­‡å±æ€§å€¼ã€‚</p>
<pre class="line-numbers language-swift"><code class="language-swift"><span class="token keyword">let</span> persons <span class="token operator">=</span> realm<span class="token punctuation">.</span><span class="token function">objects</span><span class="token punctuation">(</span><span class="token builtin">Person</span><span class="token punctuation">)</span>
<span class="token keyword">try</span><span class="token operator">!</span> realm<span class="token punctuation">.</span>write <span class="token punctuation">{</span>
 <span class="token comment" spellcheck="true">// è®¾ç½®ç¬¬ä¸€ä¸ªäººçš„ isFirstå¯¹è±¡ä¸ºTrue</span>
 persons<span class="token punctuation">.</span><span class="token builtin">first</span><span class="token operator">?</span><span class="token punctuation">.</span><span class="token function">setValue</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">,</span> forKeyPath<span class="token punctuation">:</span> <span class="token string">"isFirst"</span><span class="token punctuation">)</span>
  <span class="token comment" spellcheck="true">// æŠŠæ¯ä¸ªäººçš„æ‰€å±…ä½çš„è¡Œæ˜Ÿï¼Œè®¾ç½®ä¸ºåœ°çƒ</span>
  persons<span class="token punctuation">.</span><span class="token function">setValue</span><span class="token punctuation">(</span><span class="token string">"Earth"</span><span class="token punctuation">,</span> forKeyPath<span class="token punctuation">:</span> <span class="token string">"planet"</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><a name="Realmåˆ é™¤æ•°æ®"></a><br><br></p>
<h4 id="Realmåˆ é™¤æ•°æ®"><a href="#Realmåˆ é™¤æ•°æ®" class="headerlink" title="Realmåˆ é™¤æ•°æ®"></a>Realmåˆ é™¤æ•°æ®</h4><p>å½“ç”¨æˆ·æƒ³åˆ é™¤æŸä¸€ä¸ªå¯¹è±¡çš„æ—¶å€™ï¼ŒæŸ¥è¯¢å‡ºæ¥ï¼Œä¹‹åï½</p>
<pre class="line-numbers language-swift"><code class="language-swift"><span class="token comment" spellcheck="true">// let cheeseBook = ... Book stored in Realm</span>

<span class="token comment" spellcheck="true">//åˆ é™¤ä¸€ä¸ªå¯¹è±¡ï¼Œåœ¨Wirteäº¤æ˜“ä¸­ã€‚</span>
<span class="token keyword">try</span><span class="token operator">!</span> realm<span class="token punctuation">.</span>write <span class="token punctuation">{</span>
  realm<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span>cheeseBook<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>ä½ ä¹Ÿå¯ä»¥åˆ é™¤Realmä¸­çš„å…¨éƒ¨æ•°æ®ï¼Œè¿™å¾ˆå¿«é€Ÿ</p>
<pre class="line-numbers language-swift"><code class="language-swift"><span class="token comment" spellcheck="true">// åˆ é™¤Realmä¸­æ‰€æœ‰çš„å¯¹è±¡</span>
<span class="token keyword">try</span><span class="token operator">!</span> realm<span class="token punctuation">.</span>write <span class="token punctuation">{</span>
  realm<span class="token punctuation">.</span><span class="token function">deleteAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p><a name="RealmæŸ¥è¯¢æ•°æ®"></a><br><br></p>
<h4 id="RealmæŸ¥è¯¢æ•°æ®"><a href="#RealmæŸ¥è¯¢æ•°æ®" class="headerlink" title="RealmæŸ¥è¯¢æ•°æ®"></a>RealmæŸ¥è¯¢æ•°æ®</h4><p>Realmç§°ä¸ºè¿™ä¹ˆå—æ¬¢è¿çš„æ•°æ®åº“çš„åŸå› æ¥äº†ï¼å’±ä»¬çœ‹å¥¹ä»¬å®˜æ–¹çš„è§£é‡Šã€‚</p>
<blockquote>
<p>Queries return a Results instance, which contains a collection of Objects. Results have an interface very similar to Array and objects contained in a Results can be accessed using indexed subscripting. Unlike Arrays, Results only hold Objects of a single subclass type.</p>
</blockquote>
<p>æŸ¥è¯¢è¿”å›ä¸€ä¸ªç»“æœå®ä¾‹ï¼Œå®ƒåŒ…å«ä¸€ä¸ªå¯¹è±¡é›†åˆã€‚ç»“æœç±»ä¼¼äºArrayä¸€æ ·çš„ä¸œè¥¿ï¼Œå¯ä»¥ä½¿ç”¨ä¸‹æ ‡æ¥è¿›è¡Œæ¯ä¸€ä¸ªæ•°æ®çš„è®¿é—®ã€‚å’ŒArraysä¸ä¸€æ ·çš„åœ°æ–¹åœ¨äº,æŸ¥è¯¢ç»“æœåªæŒæœ‰ä¸€ç§ç±»å‹çš„å¯¹è±¡ã€‚</p>
<blockquote>
<p>All queries (including queries and property access) are lazy in Realm. Data is only read when the properties are accessed.</p>
</blockquote>
<p>åœ¨Realmä¸­ï¼Œæ‰€æœ‰çš„æŸ¥è¯¢ï¼ˆè¿™é‡Œé¢åŒ…æ‹¬äº†æŸ¥è¯¢å’Œå±æ€§çš„è®¿é—®ï¼‰éƒ½æ˜¯æ‡’åŠ è½½çš„ã€‚æ•°æ®ä»…ä»…åœ¨æ•°æ®è®¿é—®çš„æ—¶å€™å†è¿›è¡Œå”¯ä¸€çš„ä¸€æ¬¡è¯»å–</p>
<p>é‚£ä¹ˆå°±è®©æˆ‘ä»¬æ¥è¯•è¯•å§ã€‚</p>
<pre class="line-numbers language-swift"><code class="language-swift"><span class="token keyword">let</span> dogs <span class="token operator">=</span> realm<span class="token punctuation">.</span><span class="token function">objects</span><span class="token punctuation">(</span><span class="token builtin">Dog</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">// è¿™æ ·å­å°±æŸ¥è¯¢äº†Realmæ•°æ®åº“ä¸­æ‰€æœ‰çš„ç‹—</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><a name="æ¡ä»¶ç­›é€‰"></a><br><br></p>
<h4 id="æ¡ä»¶ç­›é€‰"><a href="#æ¡ä»¶ç­›é€‰" class="headerlink" title="æ¡ä»¶ç­›é€‰"></a>æ¡ä»¶ç­›é€‰</h4><p>å¦‚æœä½ ç†Ÿæ‚‰<code>nspredicate</code>ï¼Œé‚£ä¹ˆä½ å·²ç»åˆ°äº†æŒ‡å¯¼å¦‚ä½•æŸ¥è¯¢çš„å¢ƒç•Œã€‚å¯¹è±¡ã€Realmsï¼Œåˆ—è¡¨ï¼Œå’Œç»“æœéƒ½æä¾›äº†æ–¹æ³•ï¼ŒæŸ¥è¯¢ä¸€ä¸ªç»“æœArrays å¯ä»¥ä¼ é€’ä¸€ä¸ª<code>nspredicate</code>å®ä¾‹ï¼Œè°“è¯å­—ç¬¦ä¸²ï¼Œæˆ–è°“æ ¼å¼å­—ç¬¦ä¸²ã€‚<br>ä¾‹å¦‚ï¼Œæ£€ç´¢æ‰€æœ‰ç‹—çš„é¢œè‰²æ£•è¤è‰²å’Œåå­—é¦–â€œBâ€ä»é»˜è®¤çš„å¢ƒç•Œï¼š</p>
<pre class="line-numbers language-swift"><code class="language-swift"><span class="token comment" spellcheck="true">// æŸ¥è¯¢ä½¿ç”¨è°“è¯å­—ç¬¦ä¸²</span>
<span class="token keyword">var</span> tanDogs <span class="token operator">=</span> realm<span class="token punctuation">.</span><span class="token function">objects</span><span class="token punctuation">(</span><span class="token builtin">Dog</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token string">"color = 'tan' AND name BEGINSWITH 'B'"</span><span class="token punctuation">)</span>

<span class="token comment" spellcheck="true">// æŸ¥è¯¢ä½¿ç”¨ NSPredicate å®ä¾‹</span>
<span class="token keyword">let</span> predicate <span class="token operator">=</span> <span class="token function">NSPredicate</span><span class="token punctuation">(</span>format<span class="token punctuation">:</span> <span class="token string">"color = %@ AND name BEGINSWITH %@"</span><span class="token punctuation">,</span> <span class="token string">"tan"</span><span class="token punctuation">,</span> <span class="token string">"B"</span><span class="token punctuation">)</span>
tanDogs <span class="token operator">=</span> realm<span class="token punctuation">.</span><span class="token function">objects</span><span class="token punctuation">(</span><span class="token builtin">Dog</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>predicate<span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>çœ‹åˆ°è‹¹æœçš„<a href="https://developer.apple.com/library/ios/documentation/Cocoa/Conceptual/Predicates/AdditionalChapters/Introduction.html" target="_blank" rel="noopener">è°“è¯ç¼–ç¨‹æŒ‡å—</a>å»ºç«‹è°“è¯çš„æ›´å¤šä¿¡æ¯å’Œä½¿ç”¨<a href="https://realm.io/news/nspredicate-cheatsheet/" target="_blank" rel="noopener">æˆ‘ä»¬çš„nspredicateåˆ—è¡¨</a>ã€‚é¢†åŸŸæ”¯æŒè®¸å¤šå…±åŒçš„è°“è¯ï¼š</p>
<ul>
<li>æ¯”è¾ƒæ“ä½œæ•°å¯ä»¥æ˜¯å±æ€§åç§°æˆ–å¸¸é‡ã€‚è‡³å°‘ä¸€ä¸ªæ“ä½œæ•°å¿…é¡»æ˜¯ä¸€ä¸ªå±æ€§åã€‚</li>
<li>æ¯”è¾ƒè¿ç®—ç¬¦= =ï¼Œ&lt;ï¼Œ&gt; =ï¼Œ&gt;ï¼Œï¼=ï¼Œæ”¯æŒ<code>Int</code>, <code>Int8</code>, <code>Int16</code>, <code>Int32</code>, <code>Int64</code>, <code>Float</code>, <code>Double</code> å’Œ <code>NSDate</code> å±æ€§ç±»å‹ã€‚å¦‚: <code>age == 45</code></li>
<li>èº«ä»½æ¯”è¾ƒ == ï¼Œ!= ï¼Œ<code>Results&lt;Employee&gt;().filter(&quot;company == %@&quot;, company)</code></li>
<li>æ¯”è¾ƒè¿ç®—ç¬¦ = å’Œ != éœ€è¦<code>Bool</code>å±æ€§çš„æ”¯æŒã€‚</li>
<li>å­—ç¬¦ä¸²å’ŒNSDataæ€§è´¨ï¼Œæˆ‘ä»¬æˆ‘ä»¬æ”¯æŒ <code>==</code>, <code>!=</code>,<code>BEGINSWITH</code>,<code>CONTAINS</code>, and<code>ENDSWITH</code> ï¼Œå¦‚åç§°ä¸­ <code>CONTAINS â€˜Jaâ€™</code></li>
<li>ä¸åŒºåˆ†å¤§å°å†™çš„æ¯”è¾ƒå­—ç¬¦ä¸²ï¼Œå¦‚:<code>CONTAINS[c] â€˜Jaâ€™</code>ã€‚è¯·æ³¨æ„åªæœ‰å­—ç¬¦<code>A-Z</code>å’Œ<code>a-z</code>ä¼šè¢«å¿½ç•¥ã€‚</li>
<li>Realmæ”¯æŒä»¥ä¸‹å¤åˆæ“ä½œï¼š: <code>AND</code>, <code>OR</code>, and <code>NOT</code>. ä¾‹å¦‚ï¼š<code>name BEGINSWITH â€˜Jâ€™ AND age &gt;= 32</code></li>
<li>åŒ…å«æ“ä½œç¬¦å· INï¼Œ  å¦‚ åå­— <code>name IN {â€˜Lisaâ€™, â€˜Spikeâ€™, â€˜Hachiâ€™}</code></li>
<li>æˆ‘ä»¬å¯ä»¥æ¯”è¾ƒå±æ€§æ˜¯å¦ä¸ºç©ºï¼Œå¦‚ï¼š<code>Results&lt;Company&gt;().filter(&quot;ceo == nil&quot;)</code>.æ³¨æ„ï¼Œå¢ƒç•ŒæŠŠNilä½œä¸ºä¸€ä¸ªç‰¹æ®Šçš„å€¼è€Œä¸æ˜¯ä¸€ä¸ªå±æ€§çš„ç¼ºå¤±ï¼Œæ‰€ä»¥ä¸åƒSQLé›¶ç­‰äºæœ¬èº«ã€‚</li>
<li>ä»»ä½•çš„æ¯”è¾ƒï¼Œå¦‚æœ‰ <code>student.ageï¼œ21</code></li>
<li>èšåˆè¡¨è¾¾å¼<code>@count</code>, <code>@min</code>, <code>@max</code>, <code>@sum</code> å’Œ <code>@avg</code>Realméƒ½æ”¯æŒã€‚ä¾‹å¦‚ï¼š<code>realm.objects(Company).filter(&quot;employees.@count &gt; 5&quot;)</code>ã€‚æ‰¾åˆ°æ‰€æœ‰å‘˜å·¥åœ¨äº”ä¸ªä»¥ä¸Šçš„å…¬å¸</li>
<li>å­æŸ¥è¯¢çš„é™åˆ¶å’Œæ”¯æŒï¼š<ul>
<li><code>@count</code>åœ¨å­æŸ¥è¯¢è¡¨è¾¾å¼æ˜¯å”¯ä¸€çš„ã€‚</li>
<li><code>SUBQUERY(â€¦).@count</code>å¿…é¡»å’Œä¸€ä¸ªå¸¸é‡è¿›è¡Œæ¯”è¾ƒ</li>
<li>ç›¸å…³å­æŸ¥è¯¢ç°åœ¨è¿˜ä¸æ”¯æŒ</li>
</ul>
</li>
</ul>
<p><a name="æ’åº"></a><br><br></p>
<h5 id="æ’åº"><a href="#æ’åº" class="headerlink" title="æ’åº"></a>æ’åº</h5><p>ç»“æœå…è®¸æ‚¨åœ¨ä¸€ä¸ªæˆ–å¤šä¸ªå±æ€§çš„åŸºç¡€ä¸ŠæŒ‡å®šä¸€ä¸ªæ’åºæ ‡å‡†å’Œé¡ºåºã€‚ä¾‹å¦‚ï¼Œä¸‹é¢çš„ä¾‹å­ä¸­ç‹—æŒ‰ç…§åå­—æ¥è¿›è¡Œæ’åºè¿”å›ï¼š</p>
<pre class="line-numbers language-swift"><code class="language-swift"><span class="token keyword">let</span> sortedDogs <span class="token operator">=</span> realm<span class="token punctuation">.</span><span class="token function">objects</span><span class="token punctuation">(</span><span class="token builtin">Dog</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token string">"color = 'tan' AND name BEGINSWITH 'B'"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sorted</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><a name="é“¾å¼æŸ¥è¯¢"></a><br><br></p>
<h5 id="é“¾å¼æŸ¥è¯¢"><a href="#é“¾å¼æŸ¥è¯¢" class="headerlink" title="é“¾å¼æŸ¥è¯¢"></a>é“¾å¼æŸ¥è¯¢</h5><p>Realm å’Œå…¶å®ƒçš„æŸ¥åŒºåˆ«åœ¨äºï¼Œä»–æ¯ä¸€ä¸ªæŸ¥è¯¢ç»“æœéƒ½æ‹¥æœ‰ç»§ç»­æŸ¥è¯¢çš„èƒ½åŠ›ï¼Œè¿™æ ·ç”¨æˆ·å°±å¯ä»¥å¯¹è‡ªå·±æŸ¥è¯¢çš„ç»“æœè¿›è¡Œè¿›ä¸€æ­¥çš„è¯¢é—®ã€‚ä¾‹å¦‚ï¼šæˆ‘ä»¬å…ˆæŸ¥æ‰¾äº†ä¸€ç¾¤æ£•è‰²çš„ç‹—ï¼Œä¹‹ååˆæƒ³æŸ¥è¯¢å¤„å…¶ä¸­åå­—ä»¥â€œBâ€å¼€å¤´çš„ç‹—ã€‚</p>
<pre class="line-numbers language-swift"><code class="language-swift"><span class="token keyword">let</span> tanDogs <span class="token operator">=</span> realm<span class="token punctuation">.</span><span class="token function">objects</span><span class="token punctuation">(</span><span class="token builtin">Dog</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token string">"color = 'tan'"</span><span class="token punctuation">)</span>
<span class="token keyword">let</span> tanDogsWithBNames <span class="token operator">=</span> tanDogs<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token string">"name BEGINSWITH 'B'"</span><span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p><a name="Realmç‰ˆæœ¬è¿ç§»"></a><br><br></p>
<h3 id="Realmç‰ˆæœ¬è¿ç§»"><a href="#Realmç‰ˆæœ¬è¿ç§»" class="headerlink" title="Realmç‰ˆæœ¬è¿ç§»"></a>Realmç‰ˆæœ¬è¿ç§»</h3><p>å…¶å®ä¸€èˆ¬çš„ç‰ˆæœ¬è¿ç§»æœ‰ä¸¤ç§æƒ…å†µï¼Œç¬¬ä¸€ç§ã€‚åˆ é™¤äº†æŸäº›å­—æ®µ</p>
<pre class="line-numbers language-swift"><code class="language-swift"><span class="token keyword">class</span> <span class="token class-name">Person</span><span class="token punctuation">:</span> <span class="token builtin">Object</span> <span class="token punctuation">{</span>
    <span class="token keyword">dynamic</span> <span class="token keyword">var</span> firstName <span class="token operator">=</span> <span class="token string">""</span>
    <span class="token keyword">dynamic</span> <span class="token keyword">var</span> lastName <span class="token operator">=</span> <span class="token string">""</span>
    <span class="token keyword">dynamic</span> <span class="token keyword">var</span> age <span class="token operator">=</span> <span class="token number">0</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>To:</p>
<pre class="line-numbers language-swift"><code class="language-swift"><span class="token keyword">class</span> <span class="token class-name">Person</span><span class="token punctuation">:</span> <span class="token builtin">Object</span> <span class="token punctuation">{</span>
    <span class="token keyword">dynamic</span> <span class="token keyword">var</span> fullName <span class="token operator">=</span> <span class="token string">""</span>
    <span class="token keyword">dynamic</span> <span class="token keyword">var</span> age <span class="token operator">=</span> <span class="token number">0</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>æ¥ä¸‹æ¥ï¼Œä½ å°†è¿›è¡Œ</p>
<pre class="line-numbers language-swift"><code class="language-swift"><span class="token comment" spellcheck="true">// åœ¨ä½ çš„(application:didFinishLaunchingWithOptions:)</span>

<span class="token keyword">let</span> config <span class="token operator">=</span> <span class="token builtin">Realm</span><span class="token punctuation">.</span><span class="token function">Configuration</span><span class="token punctuation">(</span>
  <span class="token comment" spellcheck="true">// è®¾ç½®ä¸€ä¸ªæ–°çš„ç‰ˆæœ¬ï¼Œå¦‚æœä½ ä»æ¥æ²¡æœ‰è®¾ç½®è¿‡ç‰ˆæœ¬ï¼Œé‚£ä¹ˆé»˜è®¤ç‰ˆæœ¬å°±æ˜¯0</span>
  schemaVersion<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>

  <span class="token comment" spellcheck="true">/// è®¾ç½®ä¸€ä¸ªæ‰¾åˆ°ä¸ä¸€æ ·ç‰ˆæœ¬çš„å›è°ƒæ–¹æ³•</span>
  migrationBlock<span class="token punctuation">:</span> <span class="token punctuation">{</span> migration<span class="token punctuation">,</span> oldSchemaVersion <span class="token keyword">in</span>
    <span class="token comment" spellcheck="true">// å› ä¸ºæˆ‘ä»¬æ²¡æœ‰è®¾ç½®è¿‡ç‰ˆæœ¬ï¼Œæ‰€ä»¥ oldSchemaVersion &lt; 1</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>oldSchemaVersion <span class="token operator">&lt;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment" spellcheck="true">// ä»€ä¹ˆéƒ½ä¸ç”¨åš</span>
      <span class="token comment" spellcheck="true">// Realm å°†è‡ªåŠ¨æ£€æµ‹æ–°çš„å±æ€§å’Œåˆ é™¤çš„å±æ€§</span>
      <span class="token comment" spellcheck="true">// å¹¶ä¼šè‡ªåŠ¨æ›´æ–°ç£ç›˜æ¨¡å¼</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment" spellcheck="true">// å‘Šè¯‰Realm ä½¿ç”¨è¿™ä¸ªæ–°çš„é…ç½®ä½œä¸ºé»˜è®¤é…ç½®</span>
<span class="token builtin">Realm</span><span class="token punctuation">.</span><span class="token builtin">Configuration</span><span class="token punctuation">.</span>defaultConfiguration <span class="token operator">=</span> config

<span class="token comment" spellcheck="true">// æ¥ä¸‹æ¥å°±è®©æˆ‘ä»¬è·å¾—é»˜è®¤çš„å¯¹è±¡å§</span>
<span class="token keyword">let</span> realm <span class="token operator">=</span> <span class="token keyword">try</span><span class="token operator">!</span> <span class="token function">Realm</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>è€Œå¦‚æœä½ æ·»åŠ äº†ä¸€äº›å­—æ®µï¼Œæ¯”å¦‚å’±ä»¬ä¸æƒ³è¦FirstNameå’ŒLastNameäº†ï¼Œæˆ‘ä»¬å¸Œæœ›ä»–å˜æˆä¸€ä¸ªå­—æ®µï¼<code>fullName</code>ï¼</p>
<pre class="line-numbers language-swift"><code class="language-swift"><span class="token comment" spellcheck="true">// åœ¨ä½ çš„(application:didFinishLaunchingWithOptions:)</span>

<span class="token builtin">Realm</span><span class="token punctuation">.</span><span class="token builtin">Configuration</span><span class="token punctuation">.</span>defaultConfiguration <span class="token operator">=</span> <span class="token builtin">Realm</span><span class="token punctuation">.</span><span class="token function">Configuration</span><span class="token punctuation">(</span>
  schemaVersion<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
  migrationBlock<span class="token punctuation">:</span> <span class="token punctuation">{</span> migration<span class="token punctuation">,</span> oldSchemaVersion <span class="token keyword">in</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>oldSchemaVersion <span class="token operator">&lt;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment" spellcheck="true">// æšä¸¾æ‰€æœ‰çš„å±æ€§</span>
      migration<span class="token punctuation">.</span><span class="token function">enumerate</span><span class="token punctuation">(</span><span class="token builtin">Person</span><span class="token punctuation">.</span><span class="token function">className</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> oldObject<span class="token punctuation">,</span> newObject <span class="token keyword">in</span>

        <span class="token comment" spellcheck="true">// ä»æ—§çš„å¯¹è±¡ä¸­è·å–ä¹‹å‰å­˜å‚¨çš„ä¸œè¥¿</span>
        <span class="token keyword">let</span> firstName <span class="token operator">=</span> oldObject<span class="token operator">!</span><span class="token punctuation">[</span><span class="token string">"firstName"</span><span class="token punctuation">]</span> <span class="token keyword">as</span><span class="token operator">!</span> <span class="token builtin">String</span>
        <span class="token keyword">let</span> lastName <span class="token operator">=</span> oldObject<span class="token operator">!</span><span class="token punctuation">[</span><span class="token string">"lastName"</span><span class="token punctuation">]</span> <span class="token keyword">as</span><span class="token operator">!</span> <span class="token builtin">String</span>
        <span class="token comment" spellcheck="true">// è®¾ç½®åˆ°æ–°çš„å¯¹è±¡ä¸­çš„å±æ€§ä¸Šå»</span>
        newObject<span class="token operator">!</span><span class="token punctuation">[</span><span class="token string">"fullName"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"<span class="token interpolation"><span class="token delimiter variable">\(</span>firstName<span class="token delimiter variable">)</span></span> <span class="token interpolation"><span class="token delimiter variable">\(</span>lastName<span class="token delimiter variable">)</span></span>"</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>è¿˜æœ‰ä¸€ç§æƒ…å†µï¼šä»ç‰ˆæœ¬0 ç›´æ¥ å‡åˆ° ç‰ˆæœ¬2</p>
<pre class="line-numbers language-swift"><code class="language-swift"><span class="token builtin">Realm</span><span class="token punctuation">.</span><span class="token builtin">Configuration</span><span class="token punctuation">.</span>defaultConfiguration <span class="token operator">=</span> <span class="token builtin">Realm</span><span class="token punctuation">.</span><span class="token function">Configuration</span><span class="token punctuation">(</span>
  schemaVersion<span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
  migrationBlock<span class="token punctuation">:</span> <span class="token punctuation">{</span> migration<span class="token punctuation">,</span> oldSchemaVersion <span class="token keyword">in</span>
    <span class="token comment" spellcheck="true">// The enumerateObjects:block: method iterates</span>
    <span class="token comment" spellcheck="true">// over every 'Person' object stored in the Realm file</span>
    migration<span class="token punctuation">.</span><span class="token function">enumerate</span><span class="token punctuation">(</span><span class="token builtin">Person</span><span class="token punctuation">.</span><span class="token function">className</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> oldObject<span class="token punctuation">,</span> newObject <span class="token keyword">in</span>
      <span class="token comment" spellcheck="true">// Add the `fullName` property only to Realms with a schema version of 0</span>
      <span class="token keyword">if</span> oldSchemaVersion <span class="token operator">&lt;</span> <span class="token number">1</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> firstName <span class="token operator">=</span> oldObject<span class="token operator">!</span><span class="token punctuation">[</span><span class="token string">"firstName"</span><span class="token punctuation">]</span> <span class="token keyword">as</span><span class="token operator">!</span> <span class="token builtin">String</span>
        <span class="token keyword">let</span> lastName <span class="token operator">=</span> oldObject<span class="token operator">!</span><span class="token punctuation">[</span><span class="token string">"lastName"</span><span class="token punctuation">]</span> <span class="token keyword">as</span><span class="token operator">!</span> <span class="token builtin">String</span>
        newObject<span class="token operator">!</span><span class="token punctuation">[</span><span class="token string">"fullName"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"<span class="token interpolation"><span class="token delimiter variable">\(</span>firstName<span class="token delimiter variable">)</span></span> <span class="token interpolation"><span class="token delimiter variable">\(</span>lastName<span class="token delimiter variable">)</span></span>"</span>
      <span class="token punctuation">}</span>

      <span class="token comment" spellcheck="true">// Add the `email` property to Realms with a schema version of 0 or 1</span>
      <span class="token keyword">if</span> oldSchemaVersion <span class="token operator">&lt;</span> <span class="token number">2</span> <span class="token punctuation">{</span>
          newObject<span class="token operator">!</span><span class="token punctuation">[</span><span class="token string">"email"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">""</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment" spellcheck="true">// Realm will automatically perform the migration and opening the Realm will succeed</span>
<span class="token keyword">let</span> realm <span class="token operator">=</span> <span class="token keyword">try</span><span class="token operator">!</span> <span class="token function">Realm</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><a name="Realmæ•°æ®å˜åŒ–é€šçŸ¥"></a><br><br></p>
<h3 id="Realmæ•°æ®å˜åŒ–é€šçŸ¥"><a href="#Realmæ•°æ®å˜åŒ–é€šçŸ¥" class="headerlink" title="Realmæ•°æ®å˜åŒ–é€šçŸ¥"></a>Realmæ•°æ®å˜åŒ–é€šçŸ¥</h3><p>ç»“æœæˆ–åˆ—è¡¨æ˜¯é€šè¿‡è°ƒç”¨<code>addnotificationblock</code>æ–¹æ³•åœ¨å…¶æ•°å€¼å‘ç”Ÿå˜åŒ–çš„æ—¶å€™ç»™äºˆé€šçŸ¥è¿™æ˜¯å¯èƒ½çš„ã€‚<br>æ¯ä¸€æ¬¡å†™äº‹åŠ¡æäº¤æ—¶ï¼Œåœ¨å…¶ä»–çº¿ç¨‹ä¸Šçš„å…¶ä»–çº¿ç¨‹å‘é€é€šçŸ¥åˆ°å…¶ä»–å®ä¾‹ï¼š</p>
<pre class="line-numbers language-swift"><code class="language-swift"><span class="token comment" spellcheck="true">// æ³¨å†Œé€šçŸ¥</span>
<span class="token keyword">let</span> token <span class="token operator">=</span> realm<span class="token punctuation">.</span>addNotificationBlock <span class="token punctuation">{</span> notification<span class="token punctuation">,</span> realm <span class="token keyword">in</span>
    viewController<span class="token punctuation">.</span><span class="token function">updateUI</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">// ç¨å</span>
token<span class="token punctuation">.</span><span class="token function">stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>å½“ç„¶ä½ ä¹Ÿå¯ä»¥æ³¨å†ŒæŸä¸€èŒƒå›´çš„æ•°å€¼å‘ç”Ÿå˜åŒ–çš„æ—¶å€™ï¼Œè¿›è¡Œç»™äºˆé€šçŸ¥</p>
<pre class="line-numbers language-swift"><code class="language-swift"><span class="token comment" spellcheck="true">// å¤§äº5å²çš„äººå¹´çºªå‘ç”Ÿå˜åŒ–çš„æ—¶å€™è¿›è¡Œç»Ÿæ²»</span>
<span class="token keyword">let</span> token <span class="token operator">=</span> realm<span class="token punctuation">.</span><span class="token function">objects</span><span class="token punctuation">(</span><span class="token builtin">Person</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token string">"age > 5"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>addNotificationBlock <span class="token punctuation">{</span> results<span class="token punctuation">,</span> error <span class="token keyword">in</span>
    <span class="token comment" spellcheck="true">// results å°±å·²ç»æ˜¯ `realm.objects(Person).filter("age > 5")`çš„ç»“æœé›†äº†</span>
    viewController<span class="token punctuation">.</span><span class="token function">updateUI</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment" spellcheck="true">// ç¨å</span>
token<span class="token punctuation">.</span><span class="token function">stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>å…¶å®ƒæ›´è¯¦ç»†çš„æ–‡æ¡£è¯·è®¿é—® <a href="https://realm.io/docs/swift/latest/" target="_blank" rel="noopener">Realmï¼Swiftæ–‡æ¡£</a></p>
]]></content>
      
        <categories>
            
            <category> IOS </category>
            
        </categories>
        
        
        <tags>
            
            <tag> DB </tag>
            
            <tag> realm </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[IOS Tips å°é›†åˆ]]></title>
      <url>http://www.msiter.com/2015/08/10/IOS%20Tips%20%E5%B0%8F%E9%9B%86%E5%90%88/</url>
      <content type="html"><![CDATA[<p><img class = "g-pl-90"  src="http://image.msiter.com/stock-photo-155024749.jpg" alt="" title="å¬è¯´äººåœ¨æ­»å‰çš„ä¸€ç§’é’Ÿï¼Œä»–çš„ä¸€ç”Ÿä¼šé—ªè¿‡çœ¼å‰ã€‚"></p>
<p>IOSæŠ€å·§ï¼Œåœ¨å·¥ä½œå­¦ä¹ ä¸­é‡åˆ°çš„ä¸€äº›æœ‰ç‚¹æ„æ€çš„å°æŠ€å·§ï¼Œè®°å½•åœ¨åœ¨è¿™é‡Œ</p>
<a id="more"></a>
<h2 id="ä»£ç è®°å½•"><a href="#ä»£ç è®°å½•" class="headerlink" title="ä»£ç è®°å½•"></a>ä»£ç è®°å½•</h2><h3 id="è·å–çŠ¶æ€æ "><a href="#è·å–çŠ¶æ€æ " class="headerlink" title="è·å–çŠ¶æ€æ "></a>è·å–çŠ¶æ€æ </h3><pre class="line-numbers language-swift"><code class="language-swift"> <span class="token comment" spellcheck="true">///è·å–çŠ¶æ€æ </span>
    <span class="token keyword">private</span> <span class="token keyword">func</span> <span class="token function">JZStatusBar</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">UIView</span><span class="token operator">?</span><span class="token punctuation">{</span>
        <span class="token keyword">var</span> object <span class="token operator">=</span> <span class="token builtin">UIApplication</span><span class="token punctuation">.</span><span class="token function">sharedApplication</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>statusBar<span class="token punctuation">:</span><span class="token builtin">UIView</span><span class="token operator">?</span>
        <span class="token keyword">if</span> object<span class="token punctuation">.</span><span class="token function">respondsToSelector</span><span class="token punctuation">(</span><span class="token function">NSSelectorFromString</span><span class="token punctuation">(</span><span class="token string">"statusBar"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            statusBar <span class="token operator">=</span> object<span class="token punctuation">.</span><span class="token function">valueForKey</span><span class="token punctuation">(</span><span class="token string">"statusBar"</span><span class="token punctuation">)</span> <span class="token keyword">as</span><span class="token operator">?</span> <span class="token builtin">UIView</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> statusBar
    <span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="åŠ¨æ€æ˜¾ç¤ºè§†å›¾"><a href="#åŠ¨æ€æ˜¾ç¤ºè§†å›¾" class="headerlink" title="åŠ¨æ€æ˜¾ç¤ºè§†å›¾"></a>åŠ¨æ€æ˜¾ç¤ºè§†å›¾</h3><pre class="line-numbers language-swift"><code class="language-swift"><span class="token comment" spellcheck="true">///æŒ‰é’®æ‰©å±•ç±»</span>
<span class="token atrule">@IBDesignable</span>
<span class="token keyword">class</span> <span class="token class-name">borderImageView</span><span class="token punctuation">:</span><span class="token builtin">UIButton</span><span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">/// è®¾ç½®è¾¹æ¡†å®½åº¦</span>
    <span class="token atrule">@IBInspectable</span> <span class="token keyword">var</span> borderWidth<span class="token punctuation">:</span><span class="token builtin">CGFloat</span> <span class="token operator">=</span> <span class="token number">0</span> <span class="token punctuation">{</span>
        <span class="token keyword">didSet</span><span class="token punctuation">{</span>
            <span class="token keyword">self</span><span class="token punctuation">.</span>layer<span class="token punctuation">.</span>borderWidth <span class="token operator">=</span> borderWidth
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token comment" spellcheck="true">/// è®¾ç½®è¾¹æ¡†é¢œè‰²</span>
    <span class="token atrule">@IBInspectable</span> <span class="token keyword">var</span> borderColor<span class="token punctuation">:</span><span class="token builtin">UIColor</span> <span class="token operator">=</span> <span class="token builtin">UIColor</span><span class="token punctuation">.</span><span class="token function">blackColor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">didSet</span><span class="token punctuation">{</span>
            <span class="token keyword">self</span><span class="token punctuation">.</span>layer<span class="token punctuation">.</span>borderColor <span class="token operator">=</span> borderColor<span class="token punctuation">.</span><span class="token builtin">CGColor</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token comment" spellcheck="true">/// è®¾ç½®åœ†å½¢å¼§åº¦</span>
    <span class="token atrule">@IBInspectable</span> <span class="token keyword">var</span> cornerRadius<span class="token punctuation">:</span><span class="token builtin">CGFloat</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">{</span>
        <span class="token keyword">didSet</span><span class="token punctuation">{</span>
            <span class="token keyword">self</span><span class="token punctuation">.</span>layer<span class="token punctuation">.</span>cornerRadius <span class="token operator">=</span> cornerRadius
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="æ£€æµ‹é”®ç›˜å¼¹èµ·éšè—"><a href="#æ£€æµ‹é”®ç›˜å¼¹èµ·éšè—" class="headerlink" title="æ£€æµ‹é”®ç›˜å¼¹èµ·éšè—"></a>æ£€æµ‹é”®ç›˜å¼¹èµ·éšè—</h3><pre class="line-numbers language-swift"><code class="language-swift"><span class="token keyword">func</span> <span class="token function">resignNotification</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token builtin">NSNotificationCenter</span><span class="token punctuation">.</span><span class="token function">defaultCenter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addObserver</span><span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">,</span> selector<span class="token punctuation">:</span> <span class="token string">"keyboardShow:"</span><span class="token punctuation">,</span> name<span class="token punctuation">:</span> <span class="token builtin">UIKeyboardWillShowNotification</span><span class="token punctuation">,</span> object<span class="token punctuation">:</span> <span class="token constant">nil</span><span class="token punctuation">)</span>
        <span class="token builtin">NSNotificationCenter</span><span class="token punctuation">.</span><span class="token function">defaultCenter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addObserver</span><span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">,</span> selector<span class="token punctuation">:</span> <span class="token string">"keyboardHide:"</span><span class="token punctuation">,</span> name<span class="token punctuation">:</span> <span class="token builtin">UIKeyboardWillHideNotification</span><span class="token punctuation">,</span> object<span class="token punctuation">:</span> <span class="token constant">nil</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token comment" spellcheck="true">//é€šçŸ¥ä¸­å¿ƒé€šçŸ¥é”®ç›˜è¦å‡ºç°äº†ï¼  ğŸ˜³   å…¨å‘˜æˆ’å¤‡ï¼</span>
    <span class="token keyword">func</span> <span class="token function">keyboardShow</span><span class="token punctuation">(</span>note<span class="token punctuation">:</span><span class="token builtin">NSNotification</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token keyword">let</span> info <span class="token operator">=</span> note<span class="token punctuation">.</span>userInfo <span class="token punctuation">{</span>
            <span class="token keyword">let</span>  keyboardFrame<span class="token punctuation">:</span><span class="token builtin">CGRect</span> <span class="token operator">=</span> <span class="token punctuation">(</span>info<span class="token punctuation">[</span><span class="token builtin">UIKeyboardFrameEndUserInfoKey</span><span class="token punctuation">]</span> <span class="token keyword">as</span><span class="token operator">!</span> <span class="token builtin">NSValue</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">CGRectValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token keyword">let</span> deltay<span class="token punctuation">:</span><span class="token builtin">CGFloat</span> <span class="token operator">=</span> keyboardFrame<span class="token punctuation">.</span>size<span class="token punctuation">.</span>height <span class="token keyword">as</span> <span class="token builtin">CGFloat</span>
            <span class="token keyword">self</span><span class="token punctuation">.</span><span class="token builtin">InputBackViewBottomSpaceConstraint</span><span class="token punctuation">.</span>constant <span class="token operator">=</span> deltay
            <span class="token keyword">self</span><span class="token punctuation">.</span>view<span class="token punctuation">.</span><span class="token function">layoutIfNeeded</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token comment" spellcheck="true">//é€šçŸ¥ä¸­å¿ƒé€šçŸ¥é”®ç›˜è¦æ¶ˆå¤±äº†  ğŸ˜„  è§£æ•£~  åº†åŠŸå®´~~</span>
    <span class="token keyword">func</span> <span class="token function">keyboardHide</span><span class="token punctuation">(</span>note<span class="token punctuation">:</span><span class="token builtin">NSNotification</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">self</span><span class="token punctuation">.</span><span class="token builtin">InputBackViewBottomSpaceConstraint</span><span class="token punctuation">.</span>constant <span class="token operator">=</span> <span class="token number">0</span>
        <span class="token keyword">self</span><span class="token punctuation">.</span>view<span class="token punctuation">.</span><span class="token function">layoutIfNeeded</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="å•ä¾‹æ¨¡å¼"><a href="#å•ä¾‹æ¨¡å¼" class="headerlink" title="å•ä¾‹æ¨¡å¼"></a>å•ä¾‹æ¨¡å¼</h3><pre class="line-numbers language-swift"><code class="language-swift">    <span class="token comment" spellcheck="true">/// è·å–å•ä¾‹æ¨¡å¼ä¸‹çš„UIStoryBoardå¯¹è±¡</span>
    <span class="token keyword">class</span> <span class="token class-name">var</span> shareWelComeStoryBoard<span class="token punctuation">:</span><span class="token builtin">UIStoryboard</span><span class="token operator">!</span><span class="token punctuation">{</span>
        <span class="token keyword">get</span><span class="token punctuation">{</span>
            <span class="token keyword">struct</span> backTaskLeton<span class="token punctuation">{</span>
                <span class="token keyword">static</span> <span class="token keyword">var</span> predicate<span class="token punctuation">:</span>dispatch_once_t <span class="token operator">=</span> <span class="token number">0</span>
                <span class="token keyword">static</span> <span class="token keyword">var</span> bgTask<span class="token punctuation">:</span><span class="token builtin">UIStoryboard</span><span class="token operator">?</span> <span class="token operator">=</span> <span class="token constant">nil</span>
            <span class="token punctuation">}</span>
            <span class="token function">dispatch_once</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>backTaskLeton<span class="token punctuation">.</span>predicate<span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">Void</span> <span class="token keyword">in</span>
                backTaskLeton<span class="token punctuation">.</span>bgTask <span class="token operator">=</span> <span class="token function">UIStoryboard</span><span class="token punctuation">(</span>name<span class="token punctuation">:</span> <span class="token string">"WelCome"</span><span class="token punctuation">,</span> bundle<span class="token punctuation">:</span> <span class="token builtin">NSBundle</span><span class="token punctuation">.</span><span class="token function">mainBundle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span> backTaskLeton<span class="token punctuation">.</span>bgTask
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="è·å–å½“å‰æ˜¾ç¤ºçš„UIViewController"><a href="#è·å–å½“å‰æ˜¾ç¤ºçš„UIViewController" class="headerlink" title="è·å–å½“å‰æ˜¾ç¤ºçš„UIViewController"></a>è·å–å½“å‰æ˜¾ç¤ºçš„UIViewController</h3><pre class="line-numbers language-swift"><code class="language-swift"><span class="token keyword">extension</span> <span class="token builtin">UIViewController</span><span class="token punctuation">{</span>
    <span class="token keyword">class</span> <span class="token class-name">func</span> <span class="token function">getCurrentViewController</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">UIViewController</span><span class="token operator">?</span><span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token keyword">let</span> rootViewController <span class="token operator">=</span> <span class="token builtin">UIApplication</span><span class="token punctuation">.</span><span class="token function">sharedApplication</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>keyWindow<span class="token operator">?</span><span class="token punctuation">.</span>rootViewController<span class="token punctuation">{</span>
            <span class="token keyword">var</span> topViewController <span class="token operator">=</span> rootViewController
            <span class="token keyword">while</span> <span class="token keyword">let</span> present <span class="token operator">=</span> topViewController<span class="token punctuation">.</span>presentedViewController<span class="token punctuation">{</span>
                topViewController <span class="token operator">=</span> present
            <span class="token punctuation">}</span>
            <span class="token keyword">return</span> topViewController
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token constant">nil</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment" spellcheck="true">/// è°ƒç”¨æ–¹æ³•å¦‚ä¸‹</span>
<span class="token keyword">if</span> <span class="token keyword">let</span> currentViewController <span class="token operator">=</span> <span class="token builtin">UIViewController</span><span class="token punctuation">.</span><span class="token function">getCurrentViewController</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
<span class="token comment" spellcheck="true">//// ç•¥</span>
        <span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="åˆ¤æ–­æ˜¯å¦åœ¨å‰å°"><a href="#åˆ¤æ–­æ˜¯å¦åœ¨å‰å°" class="headerlink" title="åˆ¤æ–­æ˜¯å¦åœ¨å‰å°"></a>åˆ¤æ–­æ˜¯å¦åœ¨å‰å°</h3><pre class="line-numbers language-swift"><code class="language-swift">        <span class="token comment" spellcheck="true">/// å¤„äºå‰å°</span>
        <span class="token keyword">if</span> application<span class="token punctuation">.</span>applicationState <span class="token operator">==</span> <span class="token builtin">UIApplicationState</span><span class="token punctuation">.</span><span class="token builtin">Active</span><span class="token punctuation">{</span>
            <span class="token comment" spellcheck="true">///  å¤„äºåå°</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span> application<span class="token punctuation">.</span>applicationState <span class="token operator">==</span> <span class="token builtin">UIApplicationState</span><span class="token punctuation">.</span><span class="token builtin">Inactive</span><span class="token punctuation">{</span>
        <span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="ä¸€ä¸‹å­dismiss-ä¸¤ä¸ªViewController"><a href="#ä¸€ä¸‹å­dismiss-ä¸¤ä¸ªViewController" class="headerlink" title="ä¸€ä¸‹å­dismiss ä¸¤ä¸ªViewController"></a>ä¸€ä¸‹å­dismiss ä¸¤ä¸ªViewController</h3><pre class="line-numbers language-swift"><code class="language-swift"><span class="token keyword">self</span><span class="token punctuation">.</span>presentingViewController<span class="token operator">!</span><span class="token punctuation">.</span>presentingViewController<span class="token operator">?</span><span class="token punctuation">.</span><span class="token function">dismissViewControllerAnimated</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">,</span> completion<span class="token punctuation">:</span> <span class="token punctuation">{</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">Void</span> <span class="token keyword">in</span>
                            <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<h2 id="ç¬¬ä¸‰æ–¹å¯¼å…¥åº“"><a href="#ç¬¬ä¸‰æ–¹å¯¼å…¥åº“" class="headerlink" title="ç¬¬ä¸‰æ–¹å¯¼å…¥åº“"></a>ç¬¬ä¸‰æ–¹å¯¼å…¥åº“</h2><h3 id="ä¸‹æ‹‰åˆ·æ–°"><a href="#ä¸‹æ‹‰åˆ·æ–°" class="headerlink" title="ä¸‹æ‹‰åˆ·æ–°"></a>ä¸‹æ‹‰åˆ·æ–°</h3><p><a href="https://github.com/dasdom/BreakOutToRefresh" target="_blank" rel="noopener">BreakOutToRefresh</a> ä¸€ä¸ªä¸‹æ‹‰åˆ·æ–°æ‰“ç –å—çš„swiftåº“<br><a href="https://github.com/gsdios/SDRefreshView" target="_blank" rel="noopener">SDRefreshView</a> ç®€å•æ˜“ç”¨çš„ä¸Šæ‹‰å’Œä¸‹æ‹‰åˆ·æ–°<br><a href="https://github.com/MakeZL/ZLSwiftRefresh" target="_blank" rel="noopener">ZLSwiftRefresh</a> - ä¸‹æ‹‰åˆ·æ–°/ä¸Šæ‹‰åŠ è½½æ›´å¤šï¼Œæ”¯æŒè‡ªå®šä¹‰åŠ¨ç”»ï¼Œé›†æˆç®€å•<br><a href="https://github.com/andreamazz/GearRefreshControl" target="_blank" rel="noopener">GearRefreshControl</a> - ä¸€ä¸ªéå¸¸ç²¾ç»†çš„ä¸‹æ‹‰åˆ·æ–° åšçš„å¾ˆç»†å¿ƒ<br><a href="https://github.com/jcavar/refresher" target="_blank" rel="noopener">refresher</a> - ç®€æ´æ¸…çˆ½çš„ä¸‹æ‹‰åˆ·æ–°<br><a href="https://github.com/entotsu/PullToBounce" target="_blank" rel="noopener">PullToBounce</a> - å¼¹æ€§åŠ¨ç”» éå¸¸ç‚«é…·çš„ä¸‹æ‹‰åˆ·æ–°<br><a href="https://github.com/Shuangzuan/RCTRefreshControl" target="_blank" rel="noopener">RCTRefreshControl</a> qqçš„æ©¡çš®ç³–ä¸‹æ‹‰åˆ·æ–°<br><a href="https://github.com/Yalantis/PullToRefresh" target="_blank" rel="noopener">PullToRefresh</a> åˆ·æ–°åŠ¨ç”»å¯å®šåˆ¶çš„ä¸‹æ‹‰æ•°æ®è¯·æ±‚æ›´æ–°ç»„ä»¶<br><a href="https://github.com/MakeZL/MLSwiftBasic" target="_blank" rel="noopener">MLSwiftBasic</a> é›†åˆè‡ªå®šä¹‰å¯¼èˆªæ ã€ä¸‹æ‹‰åˆ·æ–°/ä¸Šæ‹‰åŠ è½½æ›´å¤šã€è§†è§‰æ•ˆæœã€å¥½ç”¨åˆ†ç±»ç­‰ç­‰ä¸€ç³»åˆ—ï¼Œå´è€¦åˆæ€§å¾ˆä½çš„Swiftåº“!</p>
<h3 id="å›¾ç‰‡é€‰æ‹©ã€æµè§ˆ-è¿™éƒ¨åˆ†swiftåº“çœŸå°‘å‘€-æ¬¢è¿çŸ¥é“çš„è¡¥å……"><a href="#å›¾ç‰‡é€‰æ‹©ã€æµè§ˆ-è¿™éƒ¨åˆ†swiftåº“çœŸå°‘å‘€-æ¬¢è¿çŸ¥é“çš„è¡¥å……" class="headerlink" title="å›¾ç‰‡é€‰æ‹©ã€æµè§ˆ (è¿™éƒ¨åˆ†swiftåº“çœŸå°‘å‘€ æ¬¢è¿çŸ¥é“çš„è¡¥å……)"></a>å›¾ç‰‡é€‰æ‹©ã€æµè§ˆ (è¿™éƒ¨åˆ†swiftåº“çœŸå°‘å‘€ æ¬¢è¿çŸ¥é“çš„è¡¥å……)</h3><p><a href="https://github.com/nsdictionary/PhotoBrowser" target="_blank" rel="noopener">PhotoBrowser-swift</a> å›¾ç‰‡æµè§ˆ<br><a href="https://github.com/mengxiangyue/PhotoPicker" target="_blank" rel="noopener">PhotoPicker</a> swiftå›¾ç‰‡é€‰æ‹©<br><a href="https://github.com/mikaoj/BSImagePicker" target="_blank" rel="noopener">BSImagePicker</a> è¿™ä¸ªå›¾ç‰‡é€‰æ‹© ä¸é”™ï¼Œocå’Œswiftéƒ½æœ‰ çœŸè´´å¿ƒå‘€<br><a href="https://github.com/KittenYang/KYElegantPhotoGallery" target="_blank" rel="noopener">KYElegantPhotoGallery</a> - ä¸€ä¸ªä¼˜é›…çš„å›¾ç‰‡æµè§ˆåº“(å¯æƒœOCå†™çš„å‘€ã€‚ã€‚ã€‚ã€‚)<br><a href="https://github.com/thebookofleaves/CocoaPicker" target="_blank" rel="noopener">CocoaPicker</a> - ä»¿ QQ å›¾ç‰‡é€‰æ‹©å™¨ï¼ˆéswiftï¼‰ã€‚</p>
<h3 id="ç½‘ç»œéƒ¨åˆ†"><a href="#ç½‘ç»œéƒ¨åˆ†" class="headerlink" title="ç½‘ç»œéƒ¨åˆ†"></a>ç½‘ç»œéƒ¨åˆ†</h3><p><a href="https://github.com/Alamofire/Alamofire" target="_blank" rel="noopener">Alamofire</a> è‘—åçš„ AFNetworking ç»œåŸºç¡€åº“ Swift è¯­è¨€ç‰ˆ<br><a href="https://github.com/Alamofire/AlamofireImage" target="_blank" rel="noopener">AlamofireImage</a> åŸºäº Alamofire çš„ç½‘ç»œå›¾ç‰‡ç»„ä»¶åº“<br><a href="https://github.com/ashleymills/Reachability.swift" target="_blank" rel="noopener">Reachability.swift</a> Reachability Swift ç‰ˆæœ¬<br><a href="https://github.com/honghaoz/Ji" target="_blank" rel="noopener">Ji</a> Swift ç‰ˆ HTML/XML è§£æå™¨<br><a href="https://github.com/JohnEstropia/CoreStore" target="_blank" rel="noopener">CoreStore</a> æä¾›é«˜å¯è¯»æ€§ï¼Œä¸€è‡´æ€§åŠå®‰å…¨æ€§çš„ Core Data ç®¡ç†ç±»åº“<br><a href="https://github.com/SwiftyJSON/SwiftyJSON" target="_blank" rel="noopener">SwiftyJSON</a> GitHub ä¸Šæœ€ä¸ºå¼€å‘è€…è®¤å¯çš„ JSON è§£æç±»</p>
<h3 id="å›¾ç‰‡"><a href="#å›¾ç‰‡" class="headerlink" title="å›¾ç‰‡"></a>å›¾ç‰‡</h3><p><a href="https://github.com/onevcat/Kingfisher" target="_blank" rel="noopener">Kingfisher</a> onevcat å¤§ç¥å¼€å‘çš„å¤„ç†ç½‘ç»œå›¾ç‰‡åŠç¼“å­˜çš„åº“<br><a href="https://github.com/kaishin/ImageScout" target="_blank" rel="noopener">ImageScout</a> æœ€å°ç½‘ç»œä»£ä»·è·å¾—å›¾ç‰‡å¤§å°åŠç±»å‹<br><a href="https://github.com/kean/Nuke" target="_blank" rel="noopener">Nuke</a> å®Œæ•´ã€å¼ºå¤§ã€å®ç”¨çš„å›¾ç‰‡ç®¡ç†ç±»åº“<br><a href="https://github.com/Haneke/HanekeSwift" target="_blank" rel="noopener">HanekeSwift</a> è½»é‡å¸¦ç¼“å­˜é«˜æ€§èƒ½å›¾ç‰‡åŠ è½½ç»„ä»¶<br><a href="https://github.com/jathu/UIImageColors" target="_blank" rel="noopener">UIImageColors</a> è·å–å›¾ç‰‡å¼ çš„ä¸»è‰²è°ƒå’Œå…¶ç›¸å¯¹åº”çš„å¯¹æ¯”è‰²ï¼ŒèƒŒæ™¯è‰²ä¹‹ç±»çš„æ¡†æ¶ï¼Œå¯ä»¥å»çœ‹ä¸€ä¸‹ï¼Œæ„Ÿè§‰ç”¨åˆ°çš„åœ°æ–¹è¿˜æ˜¯ä¼šå¾ˆå¤šçš„</p>
<h3 id="ç•Œé¢æ•ˆæœ-åŠ¨ç”»ç­‰"><a href="#ç•Œé¢æ•ˆæœ-åŠ¨ç”»ç­‰" class="headerlink" title="ç•Œé¢æ•ˆæœ,åŠ¨ç”»ç­‰"></a>ç•Œé¢æ•ˆæœ,åŠ¨ç”»ç­‰</h3><p><a href="https://github.com/sxyx2008/awesome-ios-animation" target="_blank" rel="noopener">awesome-ios-animation</a> æ”¶é›†äº†iOSå¹³å°ä¸‹æ¯”è¾ƒä¸»æµç‚«é…·çš„å‡ æ¬¾åŠ¨ç”»æ¡†æ¶ï¼ˆè¿™ä¸Šé¢æœ‰å¾ˆå¤šï¼Œå­™ç„¶ä¸æ˜¯å…¨éƒ¨ç”¨swiftå†™çš„ã€‚ä½†æ˜¯è¿˜æ˜¯å¯ä»¥é‰´èµä¸‹ï¼‰<br><a href="https://github.com/yoavlt/LiquidFloatingActionButton" target="_blank" rel="noopener">LiquidFloatingActionButton</a> å¯å®šåˆ¶æ°´æ»´å‹æµ®åŠ¨åŠ¨æ€æŒ‰é’®ç»„ä»¶åŠæ¼”ç¤º<br><a href="https://github.com/kevinzhow/PNChart-Swift" target="_blank" rel="noopener">PNChart-Swift</a> å¸¦åŠ¨ç”»æ•ˆæœçš„å›¾è¡¨æ§ä»¶åº“<br><a href="https://github.com/robb/hamburger-button" target="_blank" rel="noopener">HamburgerButton - Menu/Close</a> æ— è®ºè®¾è®¡è¿˜æ˜¯ä»£ç ï¼Œéƒ½è¿›è¡Œäº†ç²¾é›•ç»†ç¢<br><a href="https://github.com/entotsu/TKAnimatedCheckButton" target="_blank" rel="noopener">HamburgerButton - Check</a> Hamburger é£æ ¼æŒ‰é’®åŠ¨ç”»å›¾æ ‡ï¼ˆå•é€‰ï¼‰ç»„ä»¶<br><a href="https://github.com/entotsu/TKSubmitTransition" target="_blank" rel="noopener">entotsu/TKSubmitTransition</a> ç™»å½•åŠ è½½ã€è¿”å›æŒ‰é’®è½¬åœºåŠ¨ç”»ç»„ä»¶<br><a href="https://github.com/codestergit/SweetAlert-iOS" target="_blank" rel="noopener">SweetAlert-iOS</a> å¸¦åŠ¨ç”»æ•ˆæœå¼¹çª—å°è£…ç±»<br><a href="https://github.com/exchangegroup/Dodo" target="_blank" rel="noopener">Dodo</a> ä¸€æ¬¾è½»é‡åœ°å¯å®šåˆ¶ä¿¡æ¯æ å°ç»„ä»¶<br><a href="https://github.com/Ramotion/animated-tab-bar" target="_blank" rel="noopener">AnimatedTabBar</a> çµåŠ¨çš„åŠ¨ç”»tabbar<br><a href="https://github.com/kentya6/KYCircularProgress" target="_blank" rel="noopener">KYCircularProgress</a> ç®€å•ã€å®ç”¨è·¯å¾„å¯å®šè¿›ç¨‹æ¡<br><a href="https://github.com/gmertk/ParkedTextField" target="_blank" rel="noopener">ParkedTextField</a> å¸¦å›ºå®šæ–‡æœ¬çš„è¾“å…¥ç»„ä»¶<br><a href="https://github.com/optonaut/ActiveLabel.swift" target="_blank" rel="noopener">optonaut/ActiveLabel.swift</a> æ‰©å±•å®ç° UILabel è§¦æ§äº‹ä»¶é’ˆå¯¹ â€œ#, @, é“¾æ¥â€ å“åº”<br><a href="https://github.com/gmertk/GMStepper" target="_blank" rel="noopener">GMStepper</a> å¸¦åŠ¨ç”»æ•ˆæœã€æ”¯æŒæ‰‹åŠ¿æ»‘åŠ¨æ“ä½œçš„æ­¥è¿›æ ‡ç­¾<br><a href="https://github.com/khawars/KSTokenView" target="_blank" rel="noopener">KSTokenView</a> å¸¦æœç´¢ã€å¿«æ·è¾“å…¥ã€åˆ†æ®µæ˜¾ç¤ºå…³é”®è¯è¾“å…¥ç»„ä»¶<br><a href="https://github.com/yannickl/QRCodeReader.swift" target="_blank" rel="noopener">QRCodeReader</a> QR äºŒç»´ç é˜…è¯»ç»„ä»¶åŠç¤ºä¾‹<br><a href="https://github.com/teodorpatras/EasyTipView" target="_blank" rel="noopener">EasyTipView</a> å¼¹å‡ºæç¤ºæ¡†ç±»åŠæ¼”ç¤ºç¤ºä¾‹<br><a href="https://github.com/corin8823/Popover" target="_blank" rel="noopener">Popover</a> æ³¡æ³¡é£æ ¼å¼¹å‡ºè§†å›¾å°è£…ç±»åº“<br><a href="https://github.com/schwa/TimingFunctionEditor" target="_blank" rel="noopener">TimingFunctionEditor</a> - TimingFunctionEditorç”¨swiftç¼–å†™ï¼Œ è´å¡å°”æ›²çº¿ç¼–è¾‘å™¨ï¼Œç¼–è¾‘åå¯ä»¥é¢„è§ˆæˆ–æ‹·è´ä»£ç ç‰‡æ®µç›´æ¥ä½¿ç”¨ã€‚P.S. è¯¥é¡¹ç›®é‡‡ç”¨æ›´ç®€å•çš„ä¾èµ–ç®¡ç†å™¨<a href="https://github.com/Carthage/Carthage" target="_blank" rel="noopener">Carthage</a> ï¼Œè€Œéå¸¸ç”¨çš„ CocoaPodsã€‚<a href="http://www.cocoachina.com/ios/20141204/10528.html" target="_blank" rel="noopener">Carthageä»‹ç»ä¸­æ–‡</a>ã€‚<br><a href="https://github.com/aaronabentheuer/AAFaceDetection" target="_blank" rel="noopener">AAFaceDetection</a> - AAFaceDetectionâ€“swiftï¼Œç®€å•ã€å®ç”¨çš„é¢éƒ¨è¯†åˆ«å°è£…åº“ã€‚è™½ç„¶è¯¥æŠ€æœ¯ä» iOS 5 å‘å±•ï¼Œä¸è¿‡çœŸæ­£æœ‰è¶£çš„åº”ç”¨è¿˜ä¸å¤šã€‚ã€‚<br><a href="https://github.com/contentful-labs/Concorde" target="_blank" rel="noopener">Concorde</a> - swift, Concorde, ä¸€ä¸ªå¯ç”¨äºä¸‹è½½å’Œè§£ç æ¸è¿›å¼ JPEG çš„åº“, å¯ç”¨æ¥æ”¹å–„åº”ç”¨çš„ç”¨æˆ·ä½“éªŒã€‚<br><a href="https://github.com/tristanhimmelman/ZoomTransition" target="_blank" rel="noopener">ZoomTransition</a> - swift, é€šè¿‡æ‰‹åŠ¿æ“æ§å›¾ç‰‡çš„æ”¾å¤§ã€ç¼©å°ã€æ—‹è½¬ç­‰è‡ªç”±å˜åŒ–æ•ˆæœçš„ç»„ä»¶åŠç¤ºä¾‹ã€‚<br><a href="https://github.com/melvitax/AFImageHelper" target="_blank" rel="noopener">AFImageHelper</a> - swift,ä¸€å¥—é’ˆå¯¹ UIImage å’Œ UIImageView çš„å®ç”¨æ‰©å±•åº“ï¼ŒåŠŸèƒ½åŒ…å«å¡«è‰²å’Œæ¸å˜ã€è£å‰ªã€ç¼©æ”¾ä»¥åŠå…·æœ‰ç¼“å­˜æœºåˆ¶çš„åœ¨çº¿å›¾ç‰‡è·å–<br><a href="PinterestSwift">PinterestSwift</a> - swift,Pinterest é£æ ¼å›¾ç‰‡ç¼©æ”¾ã€åˆ‡æ¢ç¤ºä¾‹ã€‚<br><a href="https://github.com/ninjaprox/NVActivityIndicatorView" target="_blank" rel="noopener">NVActivityIndicatorView</a> ç­‰å¾…æŒ‡ç¤ºå™¨ çœŸå¿ƒå¤šã€‚<br><a href="https://github.com/xxycode/UIViewXXYBoom" target="_blank" rel="noopener">UIViewXXYBoom</a> æ¨¡æ‹ŸMIUIå¸è½½è½¯ç”²çš„æ—¶å€™åŠ¨ç”»<br><a href="https://github.com/tispr/tispr-card-stack" target="_blank" rel="noopener">TisprCardStack</a> ä¸€æ¬¾UICollectionåˆ‡æ¢åŠ¨ç”»<br><a href="https://github.com/lexrus/LTMorphingLabel" target="_blank" rel="noopener">LTMorphingLabel</a> è¶…çº§ç‚«é…·çš„Labelåˆ‡æ¢æ–‡å­—çš„åŠ¨ç”»æ¡†æ¶<br><a href="https://github.com/xmartlabs/XLPagerTabStrip" target="_blank" rel="noopener">XLPagerTabStrip</a> å¤šé¡µUIViewControllæ¡†æ¶</p>
<h3 id="çº¦æŸAutolayout"><a href="#çº¦æŸAutolayout" class="headerlink" title="çº¦æŸAutolayout"></a>çº¦æŸAutolayout</h3><p><a href="https://github.com/SnapKit/SnapKit" target="_blank" rel="noopener">SnapKit</a> æˆ‘å°±ç”¨è¿™ä¸€ä¸ª</p>
<h3 id="æ•°æ®åº“æ–¹é¢"><a href="#æ•°æ®åº“æ–¹é¢" class="headerlink" title="æ•°æ®åº“æ–¹é¢"></a>æ•°æ®åº“æ–¹é¢</h3><p> <a href="https://github.com/realm/realm-cocoa" target="_blank" rel="noopener">realm-cocoa</a> ç»æµ‹è¯•ï¼Œè¡¨ç¤ºæ¯”è‹¹æœè‡ªå¸¦çš„CoreData é€Ÿåº¦æ›´åŠ çš„å¿«ï¼Œæ–‡æ¡£è¯¦ç»†ã€‚ç‰ˆæœ¬è¿ç§»æ–¹ä¾¿ã€‚<br> <a href="https://github.com/JohnEstropia/CoreStore" target="_blank" rel="noopener">CoreStore</a> ä¸€æ¬¾CoreDataçš„ç¬¬ä¸‰æ–¹å¸®åŠ©åº“ï¼Œä½¿ç”¨CoreDataæ›´æ–¹é¢ï¼ŒåŒ…æ‹¬ç‰ˆæœ¬è¿ç§»ã€‚</p>
<h3 id="ç›¸æœº"><a href="#ç›¸æœº" class="headerlink" title="ç›¸æœº"></a>ç›¸æœº</h3><p><a href="https://github.com/ykyouhei/KYShutterButton" target="_blank" rel="noopener">KYShutterButton</a> æ¨¡æ‹Ÿç³»ç»Ÿç›¸æœºæŒ‰é’®â€¦â€¦â€¦â€¦<br><a href="https://github.com/TimOliver/TOCropViewController" target="_blank" rel="noopener">TOCropViewController</a> æ¨¡æ‹Ÿç³»ç»Ÿç›¸å†Œå‰ªåˆ‡å›¾ç‰‡æ—¶çš„ç•Œé¢<br><a href="https://github.com/mariohahn/MHVideoPhotoGallery" target="_blank" rel="noopener">MHVideoPhotoGallery</a> ä¸€æ¬¾å¯ä»¥è®©ä½ å­¦ä¹ åˆ°å¾ˆå¤šçŸ¥è¯†çš„demo</p>
<h3 id="å…¶ä»–æ–¹é¢"><a href="#å…¶ä»–æ–¹é¢" class="headerlink" title="å…¶ä»–æ–¹é¢"></a>å…¶ä»–æ–¹é¢</h3><p><a href="https://github.com/pNre/ExSwift" target="_blank" rel="noopener">ExSwift</a> ä¸€æ¬¾Extensioné›†åˆçš„æ¡†æ¶ï¼Œçœç€é€ è½®å­äº†<br><a href="https://github.com/jessesquires/JSQMessagesViewController" target="_blank" rel="noopener">JSQMessagesViewController</a> èŠå¤©é¡µé¢çš„æ­å»ºï¼Œä¸ç”¨æ„äº†ï½ ä½†æ˜¯éœ€è¦è‡ªå·±å»å®ç°ä¸€äº›ï¼Œä¾‹å¦‚æ’­æ”¾è§†é¢‘ä¹‹ç±»çš„ä¸œè¥¿ï¼Œå®ƒæœ¬èº«åªå®ç°äº†æ–‡å­—å’Œå›¾ç‰‡<br><a href="https://github.com/zhenlintie/STClock" target="_blank" rel="noopener">STClock</a> å®Œå…¨æ¨¡ä»¿é”¤å­æ—¶é’Ÿï¼Œå¯ä»¥å½“ä½œä¸€ä¸ªå­¦ä¹ çš„æ¡ˆä¾‹</p>
]]></content>
      
        <categories>
            
            <category> IOS </category>
            
        </categories>
        
        
        <tags>
            
            <tag> ios </tag>
            
            <tag> swift </tag>
            
            <tag> æŠ€å·§ </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Swagger åˆçº§å­¦ä¹ ]]></title>
      <url>http://www.msiter.com/2015/07/13/swagger%20%E5%AD%A6%E4%B9%A0/</url>
      <content type="html"><![CDATA[<p><img class = "g-pl-90"  src="http://image.msiter.com/stock-photo-76133855.jpg" alt="" title="çªç„¶æƒ³åˆ°ä½ ï¼Œç¬‘äº†ç¬‘è‡ªå·±ã€‚"></p>
<p>æœ€å¼€å§‹åªæ˜¯æƒ³æ‰¾ä¸€ä¸ªåˆ¶ä½œapiçš„å·¥å…·è€Œå·²ï¼Œç„¶åå†æŸä¸€ä¸ªå¸–å­ä¸­å‘ç°äº†è¿™ä¸ªå®¶ä¼™ã€‚ä»–ä¸åªæ˜¯å¯ä»¥è®©ä½ å¯ä»¥å±•ç¤ºæœåŠ¡å™¨çš„APIæ¥å£ã€‚ä½ ç”šè‡³å¯ä»¥è®©å®¢æˆ·ç«¯å—ç›Šï¼Œç”Ÿæˆå®¢æˆ·ç«¯ä»£ç ï¼Œè®©å®¢æˆ·ç«¯å¼€å‘è€…ç›´æ¥è°ƒç”¨ç”Ÿæˆä»£ç ï¼Œä½¿ç”¨ç”Ÿæˆçš„ä»£ç ï¼Œè®¿é—®ä½ çš„æ¥å£å¹¶ä¸”å®Œæˆæ•°æ®çš„è·å–ã€‚So Coll</p>
<blockquote>
<p>Swagge is a simple yet powerful representation of your RESTful API</p>
</blockquote>
<a id="more"></a>
<p><code>swagger</code>çš„æ„æ€æ˜¯ ç‹‚å¦„è‡ªå¤§ã€‚ä½†æ˜¯ç­‰æˆ‘ä»‹ç»å®Œæ¯•ä¹‹åä½ ä¼šçš„è§‰çš„ä»–çš„ç‹‚å¦„ç»å¯¹æ˜¯æœ‰é“ç†çš„ï¼Œæ²¡æœ‰æµ®å¤¸ã€‚å…·ä½“æ¥è¯´ä»–æ˜¯ä»€ä¹ˆå‘¢ï¼Œæ­£å¦‚ä»–è‡ªå·±çš„ä»‹ç»ï¼Œæ˜¯ä¸€ä¸ªç®€å•è€Œåˆå¼ºå¤§çš„apiå‘å¸ƒå·¥å…·ï¼Œå¼ºå¤§æ˜¯æ¯‹åº¸ç½®ç–‘çš„ï¼Œæˆ‘ç°åœ¨çŸ¥é“ä¹Ÿåªæ˜¯ä»–çš„å‡ ä¸ªç»„ä»¶ä¸­çš„å‡ ä¸ªè€Œå·²ï¼Œè¿˜æœ‰æ›´å¤šçš„ä½œç”¨çš„ï¼Œå½“ç„¶å°±æ˜¯è¿™å‡ ä¸ªä½œç”¨æˆ‘å°±å·²ç»è·ç›ŠåŒªæµ…äº†ã€‚åºŸè¯ä¸å¤šè¯´ã€‚</p>
<p>æœ¬æ–‡å°†ä»è¿™å‡ ä¸ªæ­¥éª¤å±•å¼€è®²è¿°ï¼š</p>
<ul>
<li>ä½œä¸ºæœåŠ¡å™¨ï¼Œæˆ‘ä»¬åº”è¯¥å¦‚ä½•å‘åç«¯å±•ç¤ºAPIä»‹ç»é¡µé¢å‘¢<ol>
<li>åœ¨å“ªé‡Œç¼–å†™å‘¢ï¼Ÿ</li>
<li>æ€ä¹ˆç¼–å†™ï¼Ÿ</li>
<li>å¦‚ä½•å±•ç¤ºï¼Ÿ ä»…é™<code>NodJs</code></li>
</ol>
</li>
<li>ä½œä¸ºå®¢æˆ·ç«¯ï¼Œæˆ‘ä»¬å¦‚ä½•è·å–æ•°æ®æ ¹æ®<code>Swagger</code>çš„æ–¹å¼<ol>
<li>å¦‚ä½•è·å–?</li>
<li>æ€ä¹ˆä½¿ç”¨? ä»…é™<code>swift</code></li>
</ol>
</li>
</ul>
<h3 id="åœ¨å“ªé‡Œç¼–å†™å‘¢ï¼Ÿ"><a href="#åœ¨å“ªé‡Œç¼–å†™å‘¢ï¼Ÿ" class="headerlink" title="åœ¨å“ªé‡Œç¼–å†™å‘¢ï¼Ÿ"></a>åœ¨å“ªé‡Œç¼–å†™å‘¢ï¼Ÿ</h3><p>ä¸¤ç§æ˜¯ï¼Œä¸€ç§æ˜¯ç½‘ç»œç¼–è¾‘å™¨ï¼Œç¬¬äºŒç§æœ¬åœ°ç¼–è¾‘å™¨ã€‚å¦‚æœä½ å“ªé‡Œçš„ç½‘ç»œæ²¡æœ‰å¾ˆå·®çš„è¯ï¼Œæ¯”è¾ƒæ¨èä½¿ç”¨ç¬¬ä¸€ç§æ–¹å¼ã€‚æ¯•ç«Ÿ<code>ç®€å•æ‰æ˜¯ç‹é“</code></p>
<ol>
<li>ç‚¹å‡»<a href="http://editor.swagger.io/#/" target="_blank" rel="noopener">è¿™é‡Œ</a>è¿›å…¥</li>
<li><p>é¦–å…ˆéœ€è¦ä½ æ‹¥æœ‰ nodejs ç¯å¢ƒï¼Œç„¶åæ‰§è¡Œä»¥ä¸‹è¯­å¥</p>
<pre class="line-numbers language-shell"><code class="language-shell">git clone https://github.com/swagger-api/swagger-editor.git
cd swagger-editor
npm start
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>å…¶å®è¿™ä¸¤ç§æ–¹å¼å®Œæˆä¹‹åéƒ½ä¼šçœ‹åˆ°ç¼–è¾‘é¡µé¢ã€‚å½“ç„¶ç¬¬ä¸€ç§ä¼šç®€å•çš„å¾ˆå¤šã€‚<br>æ‰“å¼€é¡µé¢ä¹‹åä½ è¦çœ‹çœ‹ä¸Šé¢çš„å¯¼èˆªæ å“¦</p>
</li>
<li><p><code>file</code>è‡ªç„¶å°±æ˜¯æ–‡ä»¶çš„ä¸€äº›æ“ä½œäº†ï¼Œæ¯”å¦‚æ–°å»ºå•Šï¼Œæ‰“å¼€è‡ªå·±çš„ï¼Œæˆ–è€…æ‰“å¼€é­”æ¿å•Šï¼Œä¹‹ç±»çš„ã€‚ã€</p>
</li>
<li><code>Preferences</code> åŸºæœ¬çš„ä¸€äº›é…ç½®ï¼Œè­¬å¦‚è¯´ï¼š å­—ä½“å¤§å°å•Šä¹‹ç±»çš„é¥¿ï¼Œå½“ç„¶ä¹Ÿä¼šæœ‰å…¶ä»–çš„è®¾ç½®ï¼Œä½†æ˜¯å¦‚æœä½ ä¸æ˜¯å¼ºè¿«ç—‡æˆ–è€…æœ‰è‡ªå·±çš„ç‹¬ç‰¹çš„å‡†åˆ™çš„äººï¼Œé‚£ä¹ˆè¿™ä¸ªä¸œè¥¿ä½ å¯ä»¥æ— è§†</li>
<li><code>Generate Server</code> çœ‹ä»–çš„æ„æ€ä¹Ÿå¾ˆæ˜ç™½äº†ï¼Œç”ŸæˆæœåŠ¡å™¨ä»£ç è‡³äºä½ ç”Ÿæˆä»€ä¹ˆè¯­è¨€çš„æœåŠ¡å™¨å°±çœ‹ä½ è‡ªå·±äº†ã€‚</li>
<li><code>Generate Client</code> ç”Ÿæˆå®¢æˆ·ç«¯ä»£ç ã€‚å¾ˆæ˜æ˜¾å•¦~  å“‡å“ˆå“ˆå“ˆ</li>
<li><code>help</code> - can l help you? ç•Œé¢<h3 id="æ€ä¹ˆç¼–å†™å‘¢"><a href="#æ€ä¹ˆç¼–å†™å‘¢" class="headerlink" title="æ€ä¹ˆç¼–å†™å‘¢"></a>æ€ä¹ˆç¼–å†™å‘¢</h3>è¿™ä¸ªå°±è¦è¯´èµ·æ¥è¯å°±å¤šäº†ï¼Œä½†æ˜¯æˆ‘å°±æŒ‘ä¸€äº›é‡è¦çš„å§ã€‚æ¯•ç«Ÿæˆ‘æ‡’â€¦<br>è¿™é‡Œçš„ç¼–è¾‘éœ€è¦ä¸€ç§æ¨¡æ¿è¯­è¨€çš„åŸºç¡€ã€‚<br>````yaml<h6 id="ä½¿ç”¨è¯·æ‰“å¼€-ã€http-editor-swagger-io-ã€‘-æˆ–è€…"><a href="#ä½¿ç”¨è¯·æ‰“å¼€-ã€http-editor-swagger-io-ã€‘-æˆ–è€…" class="headerlink" title="ä½¿ç”¨è¯·æ‰“å¼€ ã€http://editor.swagger.io/#/ã€‘ æˆ–è€…"></a>ä½¿ç”¨è¯·æ‰“å¼€ ã€<a href="http://editor.swagger.io/#/ã€‘" target="_blank" rel="noopener">http://editor.swagger.io/#/ã€‘</a> æˆ–è€…</h6></li>
</ol>
<p>################################################################################</p>
<h1 id="swagger"><a href="#swagger" class="headerlink" title="swagger"></a>swagger</h1><p>################################################################################</p>
<p>#è¿™ä¸ªæ˜¯å¿…é¡»çš„<br>swagger: â€˜2.0â€™</p>
<p>################################################################################</p>
<h1 id="info"><a href="#info" class="headerlink" title="info"></a>info</h1><p>################################################################################</p>
<p>#æ–‡æ¡£ä¿¡æ¯<br>info:<br>  title: é‡è§ Api<br>  description: é‡è§ web Service Api æ¥å£ã€‚è¯¥æ¥å£æ–‡æ¡£ç”¨äºå¼€å‘è€…æ›´å¥½çš„æ ¹æ®æ•°æ®ï¼Œç”¨äºé‡è§ç”¨æˆ·çš„è®°å½•å’Œé‡è§ç”¨æˆ·åŠ¨æ€çš„æ•´åˆã€‚<br>  version: â€œ1.0.0â€<br>  termsOfService: Copyright [2015] [ä¸€åŒ¡å¤©ä¸‹]<br>  license:#å¯æœ‰å¯æ— <br>    name: Apache 2.0<br>    url: <a href="http://www.apache.org/licenses/LICENSE-2.0.html" target="_blank" rel="noopener">http://www.apache.org/licenses/LICENSE-2.0.html</a><br>  contact:<br>    name: è†æ–‡å¾<br>    url: msiter.com<br>    email: msiter@qq.com</p>
<h1 id="APIåœ°å€"><a href="#APIåœ°å€" class="headerlink" title="APIåœ°å€"></a>APIåœ°å€</h1><p>host: api.msiter.com</p>
<h1 id="è¯·æ±‚æ–¹å¼"><a href="#è¯·æ±‚æ–¹å¼" class="headerlink" title="è¯·æ±‚æ–¹å¼"></a>è¯·æ±‚æ–¹å¼</h1><p>schemes:</p>
<ul>
<li>http<h1 id="è¿™ä¸ªå­—æ®µä¼šæ·»åŠ åˆ°æ‰€æœ‰çš„APIå‰é¢ï¼Œå½“åšç‰ˆæœ¬æ§åˆ¶å­—æ®µè¿˜æ˜¯ä¸é”™çš„"><a href="#è¿™ä¸ªå­—æ®µä¼šæ·»åŠ åˆ°æ‰€æœ‰çš„APIå‰é¢ï¼Œå½“åšç‰ˆæœ¬æ§åˆ¶å­—æ®µè¿˜æ˜¯ä¸é”™çš„" class="headerlink" title="è¿™ä¸ªå­—æ®µä¼šæ·»åŠ åˆ°æ‰€æœ‰çš„APIå‰é¢ï¼Œå½“åšç‰ˆæœ¬æ§åˆ¶å­—æ®µè¿˜æ˜¯ä¸é”™çš„"></a>è¿™ä¸ªå­—æ®µä¼šæ·»åŠ åˆ°æ‰€æœ‰çš„APIå‰é¢ï¼Œå½“åšç‰ˆæœ¬æ§åˆ¶å­—æ®µè¿˜æ˜¯ä¸é”™çš„</h1>#basePath: /v1</li>
</ul>
<p>#MIMEç±»å‹çš„apiå¯ä»¥äº§ç”Ÿçš„åˆ—è¡¨ã€‚è¿™æ˜¯å¯ä»¥è¦†ç›–å…¨çƒæ‰€æœ‰API,ä½†åœ¨ç‰¹å®šçš„APIè°ƒç”¨ã€‚å€¼å¿…é¡»æ˜¯æ‰€è¿° <a href="http://http://swagger.io/specification/#mimeTypes" target="_blank" rel="noopener">http://http://swagger.io/specification/#mimeTypes</a><br>consumes:</p>
<ul>
<li>application/json</li>
</ul>
<p>#MIMEç±»å‹çš„apiå¯ä»¥äº§ç”Ÿçš„åˆ—è¡¨ã€‚è¿™æ˜¯å¯ä»¥è¦†ç›–å…¨çƒæ‰€æœ‰API,ä½†åœ¨ç‰¹å®šçš„APIè°ƒç”¨ã€‚å€¼å¿…é¡»æ˜¯æ‰€è¿° <a href="http://http://swagger.io/specification/#mimeTypes" target="_blank" rel="noopener">http://http://swagger.io/specification/#mimeTypes</a><br>produces:</p>
<ul>
<li>application/json<br>################################################################################<h1 id="Tags"><a href="#Tags" class="headerlink" title="Tags"></a>Tags</h1>################################################################################<br>#æ ‡ç­¾ï¼Œå¦‚æœä½ ä¸å†™çš„è¯ï¼Œä»–ä¼šè‡ªåŠ¨å¸®ä½ ç”Ÿæˆçš„ã€‚å¦‚æœä½ è‡ªå·±å†™çš„è¯â€¦è¯·æ³¨æ„åˆ°å’±ä»¬çš„æ°‘æ—ã€‚å¤§ä¸­å›½è¯­è¨€æ¯•ç«Ÿæœ‰äº›ä¸è¢«ä¸–ç•Œæ¥å—ï¼Œæ‰€ä»¥éš¾å…ä¸å¥½çœ‹ã€‚è¿˜æ˜¯å¸Œæœ›ä½¿ç”¨è‹±æ–‡å§ã€‚<br>tags:</li>
<li>name: ç”¨æˆ·<br>description: |<br>  æœ‰å…³äºç”¨æˆ·çš„æ¥å£API:<ul>
<li>å…³äº<code>æ³¨å†Œ</code></li>
<li>å…³äº<code>è·å–</code></li>
</ul>
</li>
<li>name: åŠ¨æ€<br>description: |<br>  æœ‰å…³äºåŠ¨æ€çš„æ¥å£API:<ul>
<li>å…³äº<code>åˆ›å»º</code></li>
<li>å…³äº<code>è·å–</code></li>
</ul>
</li>
<li><p>name: è¾…åŠ©æ ‡ç­¾<br>description: |</p>
<blockquote>
<p>å•çº¯çš„ä¸ºäº†å¥½çœ‹<br>################################################################################</p>
<h1 id="paths"><a href="#paths" class="headerlink" title="paths"></a>paths</h1><p>################################################################################<br>#æ¥ä¸‹é‡Œå°±æ˜¯APIä¸»é¢˜äº†<br>paths:<br>/users/registered:<br>post:<br>  summary: æ³¨å†Œç”¨æˆ·<br>  description: æ ¹æ®ç”¨æˆ·ä¼ å…¥çš„æ–°æµªå¾®åšå‚æ•°,è¿”å›æ•°æ®åº“é‡Œçš„ç”¨æˆ·ä¿¡æ¯.<br>  parameters:</p>
<ul>
<li>name: source<br>required: true<br>in: query<br>type: string<br>format: string<br>description: æ–°æµªå¾®åš App Id</li>
<li>name: access_token<br>required: true<br>in: query<br>type: string<br>format: string<br>description: æ–°æµªå¾®åš è®¤è¯å£ä»¤</li>
<li>name: uid<br>required: true<br>in: query<br>type: string<br>format: string<br>description: æ–°æµªå¾®åš ç”¨æˆ·ID.<br>tags:<ul>
<li>ç”¨æˆ·<br>responses:<br>200:<br>description: è¯·æ±‚å®Œæˆï¼Œè·å–ç”¨æˆ·æˆåŠŸ<br>schema:<br> $ref: â€˜#/definitions/Userâ€™<br>400:<br>description: è¯·æ±‚å¤±è´¥<br>schema:<br> $ref: â€˜#/definitions/Errorâ€™</li>
</ul>
</li>
</ul>
</blockquote>
<p>/users/obtainbyid:<br>get:<br>  summary: æ ¹æ®ç”¨æˆ·idè·å–ç”¨æˆ·ä¿¡æ¯<br>  description: æ ¹æ®ç”¨æˆ·ä¼ å…¥çš„ç”¨æˆ·idè·å–ç”¨æˆ·çš„ä¿¡æ¯.<br>  parameters:</p>
<ul>
<li>name: masterid<br>required: true<br>in: query<br>type: string<br>format: string<br>description: ä¸»äººid</li>
<li>name: otherid<br>required: false<br>in: query<br>type: string<br>format: string<br>description: è¦æŸ¥è¯¢çš„ç”¨æˆ·id,å¦‚æœä¸ä¼ é€’åˆ™æŸ¥è¯¢ä¸»äººid<br>tags:<ul>
<li>ç”¨æˆ·<br>responses:<br>200:<br>description: è¯·æ±‚å®Œæˆï¼Œè·å–ç”¨æˆ·æˆåŠŸ<br>schema:<br> $ref: â€˜#/definitions/Userâ€™<br>400:<br>description: è¯·æ±‚å¤±è´¥<br>schema:<br> $ref: â€˜#/definitions/Errorâ€™<br>/users/obtainallmeetuser:<br>get:<br>summary: get User By Id<br>description: æ ¹æ®ç”¨æˆ·idè·å–ç”¨æˆ·æ‰€æœ‰çš„é‡è§çš„äººä¿¡æ¯.è¿™ä¸ªæ¥å£å…¶å®å°±æ˜¯è·å–ç”¨æˆ·çš„å¥½å‹ã€‚<br>parameters:</li>
</ul>
</li>
<li>name: userid<br>required: true<br>in: query<br>type: string<br>format: string<br>description: ç”¨æˆ·id<br>tags:<ul>
<li>ç”¨æˆ·<br>responses:<br>200:<br>description: è¯·æ±‚å®Œæˆï¼Œè·å–ç”¨æˆ·æˆåŠŸ<br>schema:<br> type: array<br> items:<br>   $ref: â€˜#/definitions/Userâ€™<br>400:<br>description: è¯·æ±‚å¤±è´¥<br>schema:<br> $ref: â€˜#/definitions/Errorâ€™<br>################################################################################<h1 id="Definitions"><a href="#Definitions" class="headerlink" title="Definitions"></a>Definitions</h1>################################################################################<br>#APIæ‰€éœ€è¦çš„æ¨¡å—ã€‚<br>definitions:<br>User:<br>description: ç”¨æˆ·å¯¹è±¡<br>type: object<br>properties:<br>_id:<br>type: string<br>description: ç”¨æˆ·id.<br>sinaId:<br>type: string<br>description: æ–°æµªå¾®åšå”¯ä¸€æ ‡ç¤º.<br>name:<br>type: string<br>description: ç”¨æˆ·åç§°.<br>gender:<br>type: string<br>description: ç”¨æˆ·æ€§åˆ« mï¼šç”·ã€fï¼šå¥³ã€nï¼šæœªçŸ¥.<br>commGround:<br>type: string<br>description: ç”¨æˆ·å¸¸å‡ºæ²¡åœ°.<br>signature:<br>type: string<br>description: ç”¨æˆ·çš„ä¸ªæ€§ç­¾å.<br>headPhotoKey:<br>type: string<br>description: ä¸ƒç‰›çš„æ–‡ä»¶è®¿é—®æ ‡ç¤º.<br>createDateTime:<br>type: string<br>format: date-time<br>description: ç”¨æˆ·æ³¨å†Œæ—¶é—´.<br>userLabels:<br>type: array<br>items:<br>$ref: â€˜#/definitions/UserLabelâ€™<br>userBacks:<br>type: array<br>items:<br>$ref: â€˜#/definitions/UserBackâ€™<br>UserBack:<br>description: ç”¨æˆ·èƒŒæ™¯å¯¹è±¡<br>type: object<br>properties:<br>index:<br>type: number<br>description: ç”¨æˆ·èƒŒæ™¯çš„æ’åºè¡¨ç¤º.<br>identifier:<br>type: string<br>description: ç”¨æˆ·èƒŒæ™¯çš„å”¯ä¸€æ ‡ç¤º.<br>imageKey:<br>type: string<br>description: ä¸ƒç‰›çš„æ–‡ä»¶è®¿é—®æ ‡ç¤º.<br>UserLabel:<br>description: ç”¨æˆ·ä¸ªæ€§ç­¾åå¯¹è±¡<br>type: object<br>properties:<br>content:<br>type: string<br>description: ç”¨æˆ·èƒŒæ™¯çš„æ’åºè¡¨ç¤º.<br>identifier:<br>type: string<br>description: ç”¨æˆ·èƒŒæ™¯çš„å”¯ä¸€æ ‡ç¤º.<br>createDateTime:<br>type: string<br>format: date-time<br>description: ä¸ƒç‰›çš„æ–‡ä»¶è®¿é—®æ ‡ç¤º.<br>Error:<br>description: é”™è¯¯ä¿¡æ¯<br>properties:<br>error:<br>type: string<br>description: é”™è¯¯ä¿¡æ¯.</li>
</ul>
</li>
</ul>
</li>
</ul>
<pre><code>
è¿™ä¸ªæˆ‘çœŸçš„ä¸çŸ¥é“æ€ä¹ˆè¯´äº†ï¼Œä»£ç å¤åˆ¶ä¸€ä¸‹ï¼Œå¤åˆ¶åˆ°ç¼–è¾‘å™¨å†…ã€‚çœ‹çœ‹æ•ˆæœå¯¹ç…§ç€æ¥ï¼Œæˆ‘ç›¸ä¿¡å¾ˆå¿«å°±ä¼šå­¦ä¼šçš„ã€‚å½“ç„¶äººå®¶ä¹Ÿæ˜¯æä¾›äº†ä¸€äº›ç¤ºä¾‹ä»£ç äº†çš„ï¼Œä½ ä¹Ÿå¯ä»¥ä¸çœ‹æˆ‘çš„è¿™ä¸ªçš„ã€‚


### æ€ä¹ˆå±•ç¤º
é‚£å°±`so Easy`å•¦ï¼Œå»å¯¼èˆªä¸‹è½½ä½ ç´¢å¯¹åº”çš„æœåŠ¡å™¨è¯­è¨€å°±OKï¼Œæ‰¾ä¸åˆ°ï¼Ÿ  é‚£ä¹ˆæˆ‘æ¨èä½ ä½¿ç”¨`NODEJS`ã€‚

æ¯”å¦‚æˆ‘å°±æ˜¯ä¸‹è½½çš„nodejsä»£ç ï¼Œè§£å‹å
</code></pre><p>cd nodejs-server<br>npm install<br>node index.js</p>
<pre class="line-numbers language-`"><code class="language-`">
ç„¶å[ç‚¹å‡»](http://localhost:8080/docs)ä¸å‡ºç°ä»€ä¹ˆé‡å¤§æ„å¤–ï¼Œä½ ç°åœ¨å·²ç»å¤„äºapié¡µé¢äº†ã€‚

### å¦‚ä½•è·å–?

ç‚¹å‡»å¯¼èˆªå†…ï¼Œå¹¶ä¸‹è½½ä½ æ‰€å¯¹åº”çš„è¯­è¨€

### æ€ä¹ˆä½¿ç”¨? - `swift`

æˆ‘åªçŸ¥é“swiftçš„oc çš„ç±»ä¼¼ï¼Œå…¶ä»–çš„è¯­è¨€å°å¼Ÿä¸æ›¾æ¶‰çŒã€‚æŠ±æ­‰ã€‚

ä¸‹è½½å®Œæˆåï¼Œè§£å‹åè¿›å…¥åï¼š

1. å¦‚æœä½ ä½¿ç”¨çš„`cocopod`,åªéœ€è¦æŠŠ æ–‡ä»¶å¤¹å†…çš„`SwaggerClient`æ–‡ä»¶å¤¹ä¸€è‚¡è„‘çš„æ‹½è¿›ä½ çš„é¡¹ç›®å°±OKï¼Œå½“ç„¶ä½ éœ€è¦æŸ¥çœ‹ä¸€ä¸‹ `Carfile`æ–‡ä»¶çœ‹çœ‹éœ€è¦å¼•å…¥é‚£äº›ç¬¬ä¸‰æ–¹ï¼Œpod installå°±å¯ä»¥äº†ã€‚
2. `Carthage`æ˜¯ä¸€ä¸ªç¬¬ä¸‰æ–¹åŠ è½½ç»„ä»¶ã€‚æˆ‘ä¹‹å‰å› ä¸ºä¸çŸ¥é“ï¼Œç›´æ¥ä½¿ç”¨`cocopod`ä¹Ÿå¯ä»¥,æ‰€ä»¥å°è¯•äº†ä¸€ç•ªï¼Œæ•…è®°ä¸‹ï¼š
  - å®‰è£… `Carthage` - ä½¿ç”¨ `brew install Carthage`
  2. å®‰è£…å®Œæˆåï¼Œè¿›å…¥æ–‡ä»¶ç›®å½•ï¼Œ`Carthage update`
  3. æ‰“å¼€é¡¹ç›®ï¼Œåœ¨é¡¹ç›®çš„æŸä¸ªTarget -> Build Phases -> Link Library with Librariesï¼Œå°†Carthage/Buildç›®å½•ä¸­å¸Œæœ›å¯¼å…¥çš„Frameworkåº“æ‹–æ‹½è¿›å»ã€‚
  4. æ·»åŠ è„šæœ¬ï¼Œæ·»åŠ Input Files
     - æ·»åŠ è„šæœ¬
         ```/usr/local/bin/carthage copy-frameworks
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre><code>  - æ·»åŠ Input Files
 ```$(SRCROOT)/Carthage/Build/iOS/ä½ æ‰€éœ€è¦çš„.framework```
</code></pre>]]></content>
      
        <categories>
            
            <category> å¼€å‘å¸®åŠ© </category>
            
        </categories>
        
        
        <tags>
            
            <tag> swagger </tag>
            
            <tag> api </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Mongoose å­¦ä¹ ]]></title>
      <url>http://www.msiter.com/2015/07/11/Mongoose%20%E5%AD%A6%E4%B9%A0/</url>
      <content type="html"><![CDATA[<p><img class = "g-pl-90"  src="http://image.msiter.com/stock-photo-161742993.jpg" alt="" title="é†‰åä¸çŸ¥å¤©åœ¨æ°´ï¼Œæ»¡èˆ¹æ¸…æ¢¦å‹æ˜Ÿæ²³ã€‚"></p>
<blockquote>
<p>Mongoose is a MongoDB object modeling tool designed to work in an asynchronous environment.</p>
</blockquote>
<p>å…³äºmongodbçš„ä¼˜åŠ¿ä¹‹ç±»çš„è¯ï¼Œæˆ‘ä¹Ÿå°±ä¸è¯´ä»€ä¹ˆï¼Œå› ä¸ºä½ æ—¢ç„¶ä½¿ç”¨è¿™ä¸ªæ•°æ®åº“çš„è¯ï¼Œæˆ‘ç›¸ä¿¡ä½ å·²ç»å¯¹ä»–çš„åŸºæœ¬ä¿¡æ¯å¾ˆäº†è§£äº†ã€‚<br>å¦å¤–æœ¬ç¯‡æ–‡ç« æ²¡æœ‰åŸºæœ¬çš„æ“ä½œã€‚ä¸»è¦æ˜¯é’ˆå¯¹ï¼Œå­è¡¨å’Œå…³è”è¡¨çš„æ“ä½œã€‚å› ä¸ºæˆ‘è§‰çš„åŸºæœ¬çš„æ“ä½œï¼Œä¸æ˜¯å¾ˆéº»çƒ¦ï¼Œè€Œéåœ°éƒ½æ˜¯æ–‡æ¡£ï¼Œæˆ‘æ„Ÿè§‰æ²¡ä»€ä¹ˆå¿…è¦å†å¨å” ä¸€éäº†</p>
<a id="more"></a>
<h2 id="MongoDB-ç®€ä»‹"><a href="#MongoDB-ç®€ä»‹" class="headerlink" title="MongoDB ç®€ä»‹"></a>MongoDB ç®€ä»‹</h2><p>MongoDB æ˜¯ä¸€ä¸ªåŸºäºåˆ†å¸ƒå¼æ–‡ä»¶å­˜å‚¨çš„æ•°æ®åº“ã€‚ç”± C++ è¯­è¨€ç¼–å†™ã€‚æ—¨åœ¨ä¸º WEB åº”ç”¨æä¾›å¯æ‰©å±•çš„é«˜æ€§èƒ½æ•°æ®å­˜å‚¨è§£å†³æ–¹æ¡ˆã€‚<br>MongoDB æ˜¯ä¸€ä¸ªä»‹äºå…³ç³»æ•°æ®åº“å’Œéå…³ç³»æ•°æ®åº“ä¹‹é—´çš„äº§å“ï¼Œæ˜¯éå…³ç³»æ•°æ®åº“å½“ä¸­åŠŸèƒ½æœ€ä¸°å¯Œï¼Œæœ€åƒå…³ç³»æ•°æ®åº“çš„ã€‚</p>
<h2 id="æ•°æ®åº“æ“ä½œ"><a href="#æ•°æ®åº“æ“ä½œ" class="headerlink" title="æ•°æ®åº“æ“ä½œ"></a>æ•°æ®åº“æ“ä½œ</h2><h3 id="è¿æ¥æ•°æ®åº“ï¼Œåˆ›å»ºä¸€ä¸ªè¡¨ã€‚"><a href="#è¿æ¥æ•°æ®åº“ï¼Œåˆ›å»ºä¸€ä¸ªè¡¨ã€‚" class="headerlink" title="è¿æ¥æ•°æ®åº“ï¼Œåˆ›å»ºä¸€ä¸ªè¡¨ã€‚"></a>è¿æ¥æ•°æ®åº“ï¼Œåˆ›å»ºä¸€ä¸ªè¡¨ã€‚</h3><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token comment" spellcheck="true">///è·å–Mongooseç»„ä»¶</span>
<span class="token keyword">var</span> mongoose <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'mongoose'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">///é“¾æ¥è‡³æ•°æ®åº“ï¼ŒMeetåˆ™ä¸ºæ•°æ®åº“åç§°</span>
mongoose<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span><span class="token string">'mongodb://localhost/Meet'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>æ—¢ç„¶å·²ç»è¿æ¥ä¸Šçš„è¯ï¼Œé‚£ä¹ˆæ¥ä¸‹æ¥å°±è¯¥æ˜¯å¦‚ä½•åˆ›å»ºè¡¨äº†ã€‚</p>
<pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">var</span> mongoose <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'mongoose'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> UserSchema <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">mongoose<span class="token punctuation">.</span>Schema</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    sinaId<span class="token punctuation">:</span> String<span class="token punctuation">,</span>
    name<span class="token punctuation">:</span> String<span class="token punctuation">,</span>
    gender<span class="token punctuation">:</span> String<span class="token punctuation">,</span><span class="token comment" spellcheck="true">//æ€§åˆ«ï¼Œmï¼šç”·ã€fï¼šå¥³ã€nï¼šæœªçŸ¥</span>
    commGround<span class="token punctuation">:</span> String<span class="token punctuation">,</span>
    signature<span class="token punctuation">:</span> String<span class="token punctuation">,</span>
    headPhotoKey<span class="token punctuation">:</span> String<span class="token punctuation">,</span>
    userBacks<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
        identifier<span class="token punctuation">:</span> String<span class="token punctuation">,</span>
        index<span class="token punctuation">:</span> Number<span class="token punctuation">,</span>
        imageKey<span class="token punctuation">:</span> String
    <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    userLabels<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
        content<span class="token punctuation">:</span> String<span class="token punctuation">,</span>
        identifier<span class="token punctuation">:</span> String<span class="token punctuation">,</span>
        createDateTime<span class="token punctuation">:</span> <span class="token punctuation">{</span>type<span class="token punctuation">:</span> Date<span class="token punctuation">,</span> <span class="token keyword">default</span><span class="token punctuation">:</span> Date<span class="token punctuation">.</span>now<span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    createDateTime<span class="token punctuation">:</span> <span class="token punctuation">{</span>type<span class="token punctuation">:</span> Date<span class="token punctuation">,</span> <span class="token keyword">default</span><span class="token punctuation">:</span> Date<span class="token punctuation">.</span>now<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>collection<span class="token punctuation">:</span> <span class="token string">"User"</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">///Userå°±æ˜¯è¡¨åäº†</span>

<span class="token comment" spellcheck="true">/**
ä¸­é—´å†™å…¶ä»–çš„ä¸€äº›æ–¹æ³•
*/</span>
<span class="token keyword">var</span> User <span class="token operator">=</span> mongoose<span class="token punctuation">.</span><span class="token function">model</span><span class="token punctuation">(</span><span class="token string">'User'</span><span class="token punctuation">,</span> UserSchema<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>è‡³æ­¤ ä¸€ä¸ªè¡¨å·²ç»åˆ›å»ºå®Œæˆäº†ï¼Œå¯èƒ½ä½ ä¼šè¯§å¼‚ä¸ºä»€ä¹ˆä½ å¯åŠ¨äº†æœåŠ¡å™¨å¹¶ä¸”ä¹Ÿè¿æ¥åˆ°äº†æ•°æ®åº“å´æ²¡æœ‰åˆ›å»ºè¡¨ï¼Œä¸è¦ç€æ€¥ï¼Œä½ æ²¡æœ‰æ•°æ®çš„æ—¶å€™ï¼Œæ•°æ®åº“æ˜¯ä¸ä¼šæ˜¾ç¤ºçš„ã€‚</p>
<h2 id="å­è¡¨å¦‚ä½•æ“ä½œ"><a href="#å­è¡¨å¦‚ä½•æ“ä½œ" class="headerlink" title="å­è¡¨å¦‚ä½•æ“ä½œ"></a>å­è¡¨å¦‚ä½•æ“ä½œ</h2><p>å¤§å®¶çœ‹æˆ‘æ¥ä¸‹æ¥çš„ä¸€å¼ è¡¨</p>
<pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">var</span> UserSchema <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">mongoose<span class="token punctuation">.</span>Schema</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    sinaId<span class="token punctuation">:</span> String<span class="token punctuation">,</span><span class="token comment" spellcheck="true">//æ–°æµªå¾®åšID</span>
    name<span class="token punctuation">:</span> String<span class="token punctuation">,</span><span class="token comment" spellcheck="true">//ç”¨æˆ·åç§°</span>
    gender<span class="token punctuation">:</span> String<span class="token punctuation">,</span><span class="token comment" spellcheck="true">//æ€§åˆ«ï¼Œmï¼šç”·ã€fï¼šå¥³ã€nï¼šæœªçŸ¥</span>
    commGround<span class="token punctuation">:</span> String<span class="token punctuation">,</span><span class="token comment" spellcheck="true">//å”±å‡ºæ²¡åœ°</span>
    signature<span class="token punctuation">:</span> String<span class="token punctuation">,</span><span class="token comment" spellcheck="true">//ä¸ªæ€§ç­¾å</span>
    headPhotoKey<span class="token punctuation">:</span> String<span class="token punctuation">,</span><span class="token comment" spellcheck="true">//å¤´åƒåœ°å€</span>
    userLabels<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span><span class="token comment" spellcheck="true">//ç”¨æˆ·ä¸ªäººæ ‡ç­¾é›†åˆ</span>
        content<span class="token punctuation">:</span> String<span class="token punctuation">,</span><span class="token comment" spellcheck="true">//å†…å®¹</span>
        identifier<span class="token punctuation">:</span> String<span class="token punctuation">,</span><span class="token comment" spellcheck="true">//å”¯ä¸€æ ‡ç¤º</span>
        createDateTime<span class="token punctuation">:</span> <span class="token punctuation">{</span>type<span class="token punctuation">:</span> Date<span class="token punctuation">,</span> <span class="token keyword">default</span><span class="token punctuation">:</span> Date<span class="token punctuation">.</span>now<span class="token punctuation">}</span><span class="token comment" spellcheck="true">//åˆ›å»ºæ—¶é—´</span>
    <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    createDateTime<span class="token punctuation">:</span> <span class="token punctuation">{</span>type<span class="token punctuation">:</span> Date<span class="token punctuation">,</span> <span class="token keyword">default</span><span class="token punctuation">:</span> Date<span class="token punctuation">.</span>now<span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token comment" spellcheck="true">//ç”¨æˆ·æ³¨å†Œæ—¶é—´</span>
    isDelete<span class="token punctuation">:</span> <span class="token punctuation">{</span>type<span class="token punctuation">:</span> Boolean<span class="token punctuation">,</span> <span class="token keyword">default</span><span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">//æ˜¯å¦åˆ é™¤</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>collection<span class="token punctuation">:</span> <span class="token string">"MeetUser"</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>è¿™æ˜¯ä¸€ä¸ªåŸºæœ¬çš„ç”¨æˆ·æ•°æ®ç±»å‹ã€‚æ¥ä¸‹æ¥è®©æˆ‘ä»¬æ¥çœ‹çœ‹å¦‚ä½•æ“ä½œè¿™ä¸ªç±»å‹é‚£ä¸ªå§ã€‚</p>
<h3 id="å­è¡¨æ–°å¢æ•°æ®"><a href="#å­è¡¨æ–°å¢æ•°æ®" class="headerlink" title="å­è¡¨æ–°å¢æ•°æ®"></a>å­è¡¨æ–°å¢æ•°æ®</h3><pre class="line-numbers language-javascript"><code class="language-javascript">

<span class="token comment" spellcheck="true">//åˆ›å»ºç”¨æˆ·æ ‡ç­¾æ–¹æ³•</span>
UserSchema<span class="token punctuation">.</span>statics<span class="token punctuation">.</span>createUserLabel <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>userid<span class="token punctuation">,</span> identifier<span class="token punctuation">,</span> content<span class="token punctuation">,</span> createtime<span class="token punctuation">,</span> callBack<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">//é¦–å…ˆæŸ¥çœ‹æ•°æ®åº“ä¸­è¯¥ç”¨æˆ·æ˜¯å¦å­˜åœ¨è¿™ä¸ªä¸ªäººæ ‡ç­¾ï¼Œæ–¹æ³•ä¼šåœ¨ä¸‹é¢åˆ—å‡º</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">findUserLabel</span><span class="token punctuation">(</span>userid<span class="token punctuation">,</span> identifier<span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>err<span class="token punctuation">,</span> result<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>result<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>callBack<span class="token punctuation">)</span><span class="token keyword">return</span> <span class="token function">callBack</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> result<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment" spellcheck="true">//å¦‚æœå¹¶æ²¡æœ‰è¯¥å¯¹è±¡ï¼Œé‚£ä¹ˆä¹…åˆ›å»ºä¸€ä¸ªæ–°å¾·å¯¹è±¡</span>
        <span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token punctuation">{</span>
            identifier<span class="token punctuation">:</span> identifier<span class="token punctuation">,</span>
            content<span class="token punctuation">:</span> content<span class="token punctuation">,</span>
            createDateTime<span class="token punctuation">:</span> createtime
        <span class="token punctuation">}</span>
        <span class="token comment" spellcheck="true">//è¿™é‡Œå°±æ˜¯é‡ç‚¹ï¼Œä½¿ç”¨findOneAndUpdateæ‰¾åˆ°é«˜ç”¨æˆ·ï¼Œä¹‹åä½¿ç”¨ $push æ–°å¢ä¸€ä¸ªç”¨æˆ·ä¸ªäººæ ‡ç­¾ï¼Œå¹¶ä¸”æ‰§è¡Œ</span>
        User<span class="token punctuation">.</span><span class="token function">findOneAndUpdate</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">"_id"</span><span class="token punctuation">:</span> mongoose<span class="token punctuation">.</span>Types<span class="token punctuation">.</span><span class="token function">ObjectId</span><span class="token punctuation">(</span>userid<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token string">'$push'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token string">"userLabels"</span><span class="token punctuation">:</span> b<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span>err<span class="token punctuation">,</span> result<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment" spellcheck="true">///æ¥å£éœ€è¦æ‰€ä»¥è¦åœ¨å¢åŠ å®Œæˆä¹‹åï¼Œè·å–è¿™ä¸ªç”¨æˆ·å¹¶ä¸”è¿”å›</span>
            User<span class="token punctuation">.</span><span class="token function">findOne</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">"_id"</span><span class="token punctuation">:</span> mongoose<span class="token punctuation">.</span>Types<span class="token punctuation">.</span><span class="token function">ObjectId</span><span class="token punctuation">(</span>userid<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>err<span class="token punctuation">,</span> result<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token function">callBack</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> result<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="å­è¡¨æŸ¥æ‰¾æ•°æ®"><a href="#å­è¡¨æŸ¥æ‰¾æ•°æ®" class="headerlink" title="å­è¡¨æŸ¥æ‰¾æ•°æ®"></a>å­è¡¨æŸ¥æ‰¾æ•°æ®</h3><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token comment" spellcheck="true">///è¯¥æ–¹æ³•å°±æ˜¯ä¸Šé¢æ–¹æ³•ä¸­è°ƒç”¨çš„æŸ¥æ‰¾æ–¹æ³•</span>
UserSchema<span class="token punctuation">.</span>statics<span class="token punctuation">.</span>findUserLabel <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>userid<span class="token punctuation">,</span> identifier<span class="token punctuation">,</span> callBack<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">findOne</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token string">"_id"</span><span class="token punctuation">:</span> mongoose<span class="token punctuation">.</span>Types<span class="token punctuation">.</span><span class="token function">ObjectId</span><span class="token punctuation">(</span>userid<span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token string">"userLabels.identifier"</span><span class="token punctuation">:</span> identifier
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>err<span class="token punctuation">,</span> result<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>callBack<span class="token punctuation">)</span><span class="token keyword">return</span> <span class="token function">callBack</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> result<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="å­è¡¨åˆ é™¤æ•°æ®"><a href="#å­è¡¨åˆ é™¤æ•°æ®" class="headerlink" title="å­è¡¨åˆ é™¤æ•°æ®"></a>å­è¡¨åˆ é™¤æ•°æ®</h3><p>ç”±äºä¸šåŠ¡ä¸Šçš„éœ€è¦ï¼Œæ‰€ä»¥æ¥ä¸‹æ¥æ–¹æ³•æ˜¯æ¸…ç©ºè¯¥ç”¨æˆ·æ‰€æœ‰çš„ä¸ªäººæ ‡ç­¾</p>
<pre class="line-numbers language-javascript"><code class="language-javascript">UserSchema<span class="token punctuation">.</span>statics<span class="token punctuation">.</span>cleanUserLabels <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>userid<span class="token punctuation">,</span> callBack<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">///å…ˆæ‰¾åˆ°è¯¥ç”¨æˆ·</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">findOne</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">"_id"</span><span class="token punctuation">:</span> mongoose<span class="token punctuation">.</span>Types<span class="token punctuation">.</span><span class="token function">ObjectId</span><span class="token punctuation">(</span>userid<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>err<span class="token punctuation">,</span> result<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment" spellcheck="true">///å¾ªç¯éå†ç”¨æˆ·çš„ä¸ªäººæ ‡ç­¾ï¼Œasync ä¼šåœ¨å¦ä¸€ç¯‡åšå®¢ä¸­è¯¦ç»†è®²è§£</span>
        <span class="token keyword">async</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span>userLabels<span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>item<span class="token punctuation">,</span> callback<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment" spellcheck="true">// ä¹‹åä½¿ç”¨ $pull åˆ é™¤ç”¨æˆ·çš„ä¸ªäººæ ‡ç­¾</span>
            User<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">"_id"</span><span class="token punctuation">:</span> mongoose<span class="token punctuation">.</span>Types<span class="token punctuation">.</span><span class="token function">ObjectId</span><span class="token punctuation">(</span>userid<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token string">'$pull'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token string">"userLabels"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token string">"identifier"</span><span class="token punctuation">:</span> item<span class="token punctuation">.</span>identifier<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>err<span class="token punctuation">,</span> numberUpdated<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token function">callback</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>err<span class="token punctuation">,</span> results<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>callBack<span class="token punctuation">)</span><span class="token keyword">return</span> <span class="token function">callBack</span><span class="token punctuation">(</span>results<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="å­è¡¨ä¿®æ”¹æ•°æ®"><a href="#å­è¡¨ä¿®æ”¹æ•°æ®" class="headerlink" title="å­è¡¨ä¿®æ”¹æ•°æ®"></a>å­è¡¨ä¿®æ”¹æ•°æ®</h3><pre class="line-numbers language-javascript"><code class="language-javascript">UserSchema<span class="token punctuation">.</span>statics<span class="token punctuation">.</span>modifysUserLabel <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>userid<span class="token punctuation">,</span> identifier<span class="token punctuation">,</span>content<span class="token punctuation">,</span> callBack<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token string">"_id"</span><span class="token punctuation">:</span> mongoose<span class="token punctuation">.</span>Types<span class="token punctuation">.</span><span class="token function">ObjectId</span><span class="token punctuation">(</span>userid<span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token string">"userLabels.identifier"</span><span class="token punctuation">:</span> identifier
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token string">'$set'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token string">"userLabels.$.content"</span><span class="token punctuation">:</span> content<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>err<span class="token punctuation">,</span> numberUpdated<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        User<span class="token punctuation">.</span><span class="token function">findById</span><span class="token punctuation">(</span>userid<span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>err<span class="token punctuation">,</span> data<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>callBack<span class="token punctuation">)</span><span class="token function">callBack</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>ä»¥ä¸Šå°±æ˜¯å­ç±»çš„å¢åˆ æ”¹æŸ¥ã€‚å¸Œæœ›å¯¹ä½ æœ‰äº›è®¸å¸®åŠ©ã€‚åŸºæœ¬çš„å¢åˆ æ”¹æŸ¥ï¼Œæˆ‘è¿™é‡Œå°±ä¸å¤šå¤šè§£é‡Šäº†ã€‚</p>
<p>##å…³è”è¡¨å¦‚ä½•æ“ä½œ</p>
<p>åœ¨mongodbä¸­å¹¶æ²¡æœ‰å…³è”è¡¨è¿™ä¹ˆä¸€è¯´ï¼Œè¿™ä¹Ÿæ˜¯å› ä¸ºmongodbæœ¬èº«å°±æ˜¯éå…³ç³»å‹æ•°æ®åº“ï¼Œä½†æ˜¯mongooseä¸­çš„<code>populate</code>æ–¹æ³•åœ¨ä¸€å®šç¨‹åº¦ä¸Šè§£å†³äº†å…³è”é—®é¢˜</p>
<p>é¦–å…ˆæ¥æŸ¥çœ‹ä¸€äº›æ•°æ®åº“çš„è®¾è®¡å§ã€‚</p>
<h3 id="å…³è”è¡¨è®¾è®¡"><a href="#å…³è”è¡¨è®¾è®¡" class="headerlink" title="å…³è”è¡¨è®¾è®¡"></a>å…³è”è¡¨è®¾è®¡</h3><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token comment" spellcheck="true">//ç”¨æˆ·è¡¨</span>
<span class="token keyword">var</span> UserSchema <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">mongoose<span class="token punctuation">.</span>Schema</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    name<span class="token punctuation">:</span> String
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>collection<span class="token punctuation">:</span> <span class="token string">"MeetUser"</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">//åŠ å…¥æ•°æ®åº“</span>
<span class="token keyword">var</span> User <span class="token operator">=</span> mongoose<span class="token punctuation">.</span><span class="token function">model</span><span class="token punctuation">(</span><span class="token string">'User'</span><span class="token punctuation">,</span> UserSchema<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">//åˆ†ç»„è¡¨</span>
<span class="token keyword">var</span> GroupSchema <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">mongoose<span class="token punctuation">.</span>Schema</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    name<span class="token punctuation">:</span>String<span class="token punctuation">,</span>
    <span class="token comment" spellcheck="true">//æ­¤æ—¶çš„refå­—æ®µè¦å’ŒåŠ å…¥æ•°æ®åº“ä¸­çš„modelæ–¹æ³•å†…çš„å­—æ®µå»åˆï¼Œå¹¶ä¸”è®°ä½ä¸€å®šè¦å†™å­—ç¬¦ä¸²</span>
    users<span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token punctuation">{</span>type<span class="token punctuation">:</span>mongoose<span class="token punctuation">.</span>Schema<span class="token punctuation">.</span>ObjectId<span class="token punctuation">,</span>ref<span class="token punctuation">:</span><span class="token string">'User'</span><span class="token punctuation">}</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span>collection<span class="token punctuation">:</span><span class="token string">"MeetGroup"</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> Group <span class="token operator">=</span> mongoose<span class="token punctuation">.</span><span class="token function">model</span><span class="token punctuation">(</span><span class="token string">'Group'</span><span class="token punctuation">,</span>GroupSchema<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="å…³è”è¡¨æŸ¥è¯¢æ–¹æ³•"><a href="#å…³è”è¡¨æŸ¥è¯¢æ–¹æ³•" class="headerlink" title="å…³è”è¡¨æŸ¥è¯¢æ–¹æ³•"></a>å…³è”è¡¨æŸ¥è¯¢æ–¹æ³•</h3><pre class="line-numbers language-javascript"><code class="language-javascript">
GroupSchema<span class="token punctuation">.</span>statics<span class="token punctuation">.</span>loadGroup <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>callBack<span class="token punctuation">)</span><span class="token punctuation">{</span>
  Group<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">populate</span><span class="token punctuation">(</span><span class="token string">'users'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span>callBack<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>ä»¥ä¸Šæ˜¯æ¯”è¾ƒåŸºç¡€çš„æŸ¥è¯¢ï¼Œä½†æ˜¯æˆ‘ä»¬å¼€å‘çš„æ—¶å€™é‡åˆ°çš„å¾€å¾€æ²¡æœ‰é‚£ä¹ˆç®€å•ï¼Œå¦‚æœæˆ‘æƒ³å¯¹å­—è¡¨è¿›è¡Œæ’åºæˆ–è€…ç­›é€‰å†æˆ–è€…æˆ‘åªæƒ³è¦å­è¡¨é‡Œçš„å…¶ä¸­ä¸€äº›å­—æ®µè¯¥æ€ä¹ˆåŠå‘¢</p>
<h3 id="å…³è”è¡¨å‡†ç¡®æŸ¥è¯¢"><a href="#å…³è”è¡¨å‡†ç¡®æŸ¥è¯¢" class="headerlink" title="å…³è”è¡¨å‡†ç¡®æŸ¥è¯¢"></a>å…³è”è¡¨å‡†ç¡®æŸ¥è¯¢</h3><pre class="line-numbers language-javascript"><code class="language-javascript">GroupSchema<span class="token punctuation">.</span>statics<span class="token punctuation">.</span>loadGroup <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>callBack<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">var</span> populateQuery <span class="token operator">=</span> <span class="token punctuation">{</span>path<span class="token punctuation">:</span><span class="token string">'users'</span><span class="token punctuation">,</span>select<span class="token punctuation">:</span><span class="token string">'name'</span><span class="token punctuation">,</span>match<span class="token punctuation">:</span><span class="token punctuation">{</span>
        <span class="token string">'name'</span><span class="token punctuation">:</span><span class="token string">'Msiter'</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>options<span class="token punctuation">:</span><span class="token punctuation">{</span>
        limit<span class="token punctuation">:</span><span class="token number">20</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>sort<span class="token punctuation">:</span><span class="token punctuation">{</span><span class="token string">'_id'</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

    Group<span class="token punctuation">.</span><span class="token function">findOne</span><span class="token punctuation">(</span><span class="token punctuation">{</span>name<span class="token punctuation">:</span><span class="token string">"Test"</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token string">'name users'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">populate</span><span class="token punctuation">(</span>populateQuery<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span>callBack<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>å…¶ä¸­ Pathå­—æ®µæ˜¯æŒ‡è¦æŸ¥è¯¢çš„ å“ªä¸€ä¸ª å…³è”è¡¨ï¼Œselect åˆ™æ˜¯éœ€è¦å­—è¡¨çš„é‚£äº›å­—æ®µ ï¼Œå¦‚æœéœ€è¦å¤šä¸ª ä¸­é—´ä¸€ä¸ª ç©ºæ ¼åˆ†éš”å³å¯ï¼Œ<code>_id</code>å­—æ®µæ˜¯é»˜è®¤è¢«éœ€è¦çš„ã€‚matchå°±æ˜¯å¯¹å…³è”è¡¨çš„è¿™äº›ç­›é€‰çš„ï¼Œoptionså°±å¯ä»¥ä½¿ç”¨åˆ†é¡µå‚æ•°  Skipå’Œlimitäº† å½“ç„¶ä¹Ÿæœ‰ä¸€äº›å¸¸è§çš„æŸ¥è¯¢å‚æ•°è­¬å¦‚Sortç­‰ï¼›</p>
<h3 id="å…³è”è¡¨çš„å¢åŠ å‘¢ï¼Ÿ"><a href="#å…³è”è¡¨çš„å¢åŠ å‘¢ï¼Ÿ" class="headerlink" title="å…³è”è¡¨çš„å¢åŠ å‘¢ï¼Ÿ"></a>å…³è”è¡¨çš„å¢åŠ å‘¢ï¼Ÿ</h3><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token comment" spellcheck="true">///è¿™é‡Œçš„Useridæ—¶mongoose.Schema.ObjectIdï¼Œå³ä½ è¦å…³è”çš„å¯¹è±¡çš„Id</span>
GroupSchema<span class="token punctuation">.</span>statics<span class="token punctuation">.</span>createGroup <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>groupname<span class="token punctuation">,</span>userId<span class="token punctuation">,</span>callBack<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">var</span> group <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Group</span><span class="token punctuation">(</span><span class="token punctuation">{</span>name<span class="token punctuation">:</span>groupname<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    group<span class="token punctuation">.</span>users<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>userId<span class="token punctuation">)</span><span class="token punctuation">;</span>
    group<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>callBack<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="å…³è”è¡¨çš„åˆ é™¤"><a href="#å…³è”è¡¨çš„åˆ é™¤" class="headerlink" title="å…³è”è¡¨çš„åˆ é™¤"></a>å…³è”è¡¨çš„åˆ é™¤</h3><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token comment" spellcheck="true">///è¿™é‡Œçš„Useridæ—¶mongoose.Schema.ObjectIdï¼Œå³ä½ è¦å…³è”çš„å¯¹è±¡çš„Id</span>
GroupSchema<span class="token punctuation">.</span>statics<span class="token punctuation">.</span>createGroup <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>groupname<span class="token punctuation">,</span>userId<span class="token punctuation">,</span>callBack<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">var</span> group <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Group</span><span class="token punctuation">(</span><span class="token punctuation">{</span>name<span class="token punctuation">:</span>groupname<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    group<span class="token punctuation">.</span>users<span class="token punctuation">.</span><span class="token function">pull</span><span class="token punctuation">(</span>userId<span class="token punctuation">)</span><span class="token punctuation">;</span>
    group<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>callBack<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
]]></content>
      
        <categories>
            
            <category> æœåŠ¡å™¨ </category>
            
        </categories>
        
        
        <tags>
            
            <tag> mongodb </tag>
            
            <tag> mongoose </tag>
            
            <tag> nodejs </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Nodejs Async å­¦ä¹ ]]></title>
      <url>http://www.msiter.com/2015/07/06/Nodejs%20Async%20%E5%AD%A6%E4%B9%A0/</url>
      <content type="html"><![CDATA[<p><img class = "g-pl-90"  src="http://image.msiter.com/stock-photo-151005535.jpg" alt="" title="è®©ä½ éš¾è¿‡çš„äº‹æƒ…ï¼Œæœ‰ä¸€å¤©ï¼Œä½ ä¸€å®šä¼šç¬‘ç€è¯´å‡ºæ¥ã€‚"></p>
<blockquote>
<p>æœ¬æ–‡æ•´ç†äº<a href="https://github.com/bsspirit" target="_blank" rel="noopener"><code>bsspirit</code></a>çš„<a href="http://blog.fens.me/nodejs-async/" target="_blank" rel="noopener">åšæ–‡</a>å’Œ<a href="https://github.com/bsspirit/async_demo" target="_blank" rel="noopener">ä»£ç ç¤ºä¾‹</a></p>
</blockquote>
<p><code>Async</code>æ˜¯ä¸€ä¸ªæµç¨‹æ§åˆ¶å·¥å…·åŒ…ï¼Œæä¾›äº†ç›´æ¥è€Œå¼ºå¤§çš„å¼‚æ­¥åŠŸèƒ½ã€‚åŸºäº<code>Javascript</code>ä¸º<code>Node.js</code>è®¾è®¡ï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥ç›´æ¥åœ¨æµè§ˆå™¨ä¸­ä½¿ç”¨ã€‚<br><code>Async</code>æä¾›äº†å¤§çº¦20ä¸ªå‡½æ•°ï¼ŒåŒ…æ‹¬å¸¸ç”¨çš„<code>map</code>,<code>reduce</code>, <code>filter</code>, <code>forEach</code> ç­‰ï¼Œå¼‚æ­¥æµç¨‹æ§åˆ¶æ¨¡å¼åŒ…æ‹¬ï¼Œä¸²è¡Œ(<code>series</code>)ï¼Œå¹¶è¡Œ(<code>parallel</code>)ï¼Œç€‘å¸ƒ(<code>waterfall</code>)ç­‰ã€‚</p>
<a id="more"></a>
<h2 id="é¡¹ç›®ç®€ä»‹"><a href="#é¡¹ç›®ç®€ä»‹" class="headerlink" title="é¡¹ç›®ç®€ä»‹"></a>é¡¹ç›®ç®€ä»‹</h2><p><a href="https://github.com/caolan/async" target="_blank" rel="noopener">Async</a>  </p>
<p><em>For Async v1.5.x documentation, go <a href="https://github.com/caolan/async/blob/v1.5.2/README.md" target="_blank" rel="noopener">HERE</a></em></p>
<p>Async is a utility module which provides straight-forward, powerful functions<br>for working with asynchronous JavaScript. Although originally designed for<br>use with <a href="https://nodejs.org/" target="_blank" rel="noopener">Node.js</a> and installable via <code>npm install --save async</code>,<br>it can also be used directly in the browser.</p>
<p>Async is also installable via:</p>
<ul>
<li><a href="http://bower.io/" target="_blank" rel="noopener">bower</a>: <code>bower install async</code></li>
<li><a href="https://github.com/componentjs/component" target="_blank" rel="noopener">component</a>: <code>component install caolan/async</code></li>
<li><a href="http://jamjs.org/" target="_blank" rel="noopener">jam</a>: <code>jam install async</code></li>
</ul>
<p>Async provides around 70 functions that include the usual â€˜functionalâ€™<br>suspects (<code>map</code>, <code>reduce</code>, <code>filter</code>, <code>each</code>â€¦) as well as some common patterns<br>for asynchronous control flow (<code>parallel</code>, <code>series</code>, <code>waterfall</code>â€¦). All these<br>functions assume you follow the Node.js convention of providing a single<br>callback as the last argument of your asynchronous function â€“ a callback which expects an Error as its first argument â€“ and calling the callback once.</p>
<h2 id="åŠŸèƒ½ç®€ä»‹"><a href="#åŠŸèƒ½ç®€ä»‹" class="headerlink" title="åŠŸèƒ½ç®€ä»‹"></a>åŠŸèƒ½ç®€ä»‹</h2><p><br></p>
<h3 id="é›†åˆ-Collections"><a href="#é›†åˆ-Collections" class="headerlink" title="é›†åˆ:Collections"></a>é›†åˆ:<code>Collections</code></h3><ul>
<li><a href="#each"><code>each</code></a>: å¦‚æœæƒ³å¯¹åŒä¸€ä¸ªé›†åˆä¸­çš„æ‰€æœ‰å…ƒç´ éƒ½æ‰§è¡ŒåŒä¸€ä¸ªå¼‚æ­¥æ“ä½œã€‚</li>
<li><a href="#map"><code>map</code></a>: å¯¹é›†åˆä¸­çš„æ¯ä¸€ä¸ªå…ƒç´ ï¼Œæ‰§è¡ŒæŸä¸ªå¼‚æ­¥æ“ä½œï¼Œå¾—åˆ°ç»“æœã€‚æ‰€æœ‰çš„ç»“æœå°†æ±‡æ€»åˆ°æœ€ç»ˆçš„callbacké‡Œã€‚ä¸eachçš„åŒºåˆ«æ˜¯ï¼Œeachåªå…³å¿ƒæ“ä½œä¸ç®¡æœ€åçš„å€¼ï¼Œè€Œmapå…³å¿ƒçš„æœ€åäº§ç”Ÿçš„å€¼ã€‚</li>
<li><a href="#filter"><code>filter</code></a>: ä½¿ç”¨å¼‚æ­¥æ“ä½œå¯¹é›†åˆä¸­çš„å…ƒç´ è¿›è¡Œç­›é€‰, éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œiteratorçš„callbackåªæœ‰ä¸€ä¸ªå‚æ•°ï¼Œåªèƒ½æ¥æ”¶trueæˆ–falseã€‚</li>
<li><a href="#filter"><code>reject</code></a>: rejectè·Ÿfilteræ­£å¥½ç›¸åï¼Œå½“æµ‹è¯•ä¸ºtrueæ—¶åˆ™æŠ›å¼ƒ</li>
<li><a href="#reduce"><code>reduce</code></a>: å¯ä»¥è®©æˆ‘ä»¬ç»™å®šä¸€ä¸ªåˆå§‹å€¼ï¼Œç”¨å®ƒä¸é›†åˆä¸­çš„æ¯ä¸€ä¸ªå…ƒç´ åšè¿ç®—ï¼Œæœ€åå¾—åˆ°ä¸€ä¸ªå€¼ã€‚reduceä»å·¦å‘å³æ¥éå†å…ƒç´ ï¼Œå¦‚æœæƒ³ä»å³å‘å·¦ï¼Œå¯ä½¿ç”¨reduceRightã€‚</li>
<li><a href="#detect"><code>detect</code></a>: ç”¨äºå–å¾—é›†åˆä¸­æ»¡è¶³æ¡ä»¶çš„ç¬¬ä¸€ä¸ªå…ƒç´ ã€‚</li>
<li><a href="#sortBy"><code>sortBy</code></a>: å¯¹é›†åˆå†…çš„å…ƒç´ è¿›è¡Œæ’åºï¼Œä¾æ®æ¯ä¸ªå…ƒç´ è¿›è¡ŒæŸå¼‚æ­¥æ“ä½œåäº§ç”Ÿçš„å€¼ï¼Œä»å°åˆ°å¤§æ’åºã€‚</li>
<li><a href="#some"><code>some</code></a>: å½“é›†åˆä¸­æ˜¯å¦æœ‰è‡³å°‘ä¸€ä¸ªå…ƒç´ æ»¡è¶³æ¡ä»¶æ—¶ï¼Œæœ€ç»ˆcallbackå¾—åˆ°çš„å€¼ä¸ºtrueï¼Œå¦åˆ™ä¸ºfalse.</li>
<li><a href="#every"><code>every</code></a>: å¦‚æœé›†åˆé‡Œæ¯ä¸€ä¸ªå…ƒç´ éƒ½æ»¡è¶³æ¡ä»¶ï¼Œåˆ™ä¼ ç»™æœ€ç»ˆå›è°ƒçš„resultä¸ºtrueï¼Œå¦åˆ™ä¸ºfalse</li>
<li><a href="#concat"><code>concat</code></a>: å°†å¤šä¸ªå¼‚æ­¥æ“ä½œçš„ç»“æœåˆå¹¶ä¸ºä¸€ä¸ªæ•°ç»„ã€‚</li>
</ul>
<h3 id="æµç¨‹æ§åˆ¶-Control-Flow"><a href="#æµç¨‹æ§åˆ¶-Control-Flow" class="headerlink" title="æµç¨‹æ§åˆ¶: Control Flow"></a>æµç¨‹æ§åˆ¶: <code>Control Flow</code></h3><ul>
<li><a href="#concat"><code>concat</code></a>: ä¸²è¡Œæ‰§è¡Œï¼Œä¸€ä¸ªå‡½æ•°æ•°ç»„ä¸­çš„æ¯ä¸ªå‡½æ•°ï¼Œæ¯ä¸€ä¸ªå‡½æ•°æ‰§è¡Œå®Œæˆä¹‹åæ‰èƒ½æ‰§è¡Œä¸‹ä¸€ä¸ªå‡½æ•°ã€‚</li>
<li><a href="#parallel"><code>parallel</code></a>: å¹¶è¡Œæ‰§è¡Œå¤šä¸ªå‡½æ•°ï¼Œæ¯ä¸ªå‡½æ•°éƒ½æ˜¯ç«‹å³æ‰§è¡Œï¼Œä¸éœ€è¦ç­‰å¾…å…¶å®ƒå‡½æ•°å…ˆæ‰§è¡Œã€‚ä¼ ç»™æœ€ç»ˆcallbackçš„æ•°ç»„ä¸­çš„æ•°æ®æŒ‰ç…§tasksä¸­å£°æ˜çš„é¡ºåºï¼Œè€Œä¸æ˜¯æ‰§è¡Œå®Œæˆçš„é¡ºåºã€‚</li>
<li><a href="#whilst"><code>whilst</code></a>: ç›¸å½“äºwhileï¼Œä½†å…¶ä¸­çš„å¼‚æ­¥è°ƒç”¨å°†åœ¨å®Œæˆåæ‰ä¼šè¿›è¡Œä¸‹ä¸€æ¬¡å¾ªç¯ã€‚</li>
<li><a href="#whilst"><code>doWhilst</code></a>: ç›¸å½“äºdoâ€¦while, doWhilstäº¤æ¢äº†fn,testçš„å‚æ•°ä½ç½®ï¼Œå…ˆæ‰§è¡Œä¸€æ¬¡å¾ªç¯ï¼Œå†åšteståˆ¤æ–­ã€‚</li>
<li><a href="#whilst"><code>until</code></a>: untilä¸whilstæ­£å¥½ç›¸åï¼Œå½“testä¸ºfalseæ—¶å¾ªç¯ï¼Œä¸trueæ—¶è·³å‡ºã€‚å…¶å®ƒç‰¹æ€§ä¸€è‡´ã€‚</li>
<li><a href="#whilst"><code>doUntil</code></a>: doUntilä¸doWhilstæ­£å¥½ç›¸åï¼Œå½“testä¸ºfalseæ—¶å¾ªç¯ï¼Œä¸trueæ—¶è·³å‡ºã€‚å…¶å®ƒç‰¹æ€§ä¸€è‡´ã€‚</li>
<li><a href="#whilst"><code>forever</code></a>: æ— è®ºæ¡ä»¶å¾ªç¯æ‰§è¡Œï¼Œå¦‚æœä¸å‡ºé”™ï¼Œcallbackæ°¸è¿œä¸è¢«æ‰§è¡Œã€‚</li>
<li><a href="#waterfall"><code>waterfall</code></a>: æŒ‰é¡ºåºä¾æ¬¡æ‰§è¡Œä¸€ç»„å‡½æ•°ã€‚æ¯ä¸ªå‡½æ•°äº§ç”Ÿçš„å€¼ï¼Œéƒ½å°†ä¼ ç»™ä¸‹ä¸€ä¸ªã€‚</li>
<li><a href="#compose"><code>compose</code></a>: åˆ›å»ºä¸€ä¸ªåŒ…æ‹¬ä¸€ç»„å¼‚æ­¥å‡½æ•°çš„å‡½æ•°é›†åˆï¼Œæ¯ä¸ªå‡½æ•°ä¼šæ¶ˆè´¹ä¸Šä¸€æ¬¡å‡½æ•°çš„è¿”å›å€¼ã€‚æŠŠf(),g(),h()å¼‚æ­¥å‡½æ•°ï¼Œç»„åˆæˆf(g(h()))çš„å½¢å¼ï¼Œé€šè¿‡callbackå¾—åˆ°è¿”å›å€¼ã€‚</li>
<li><a href="#applyEach"><code>applyEach</code></a>: å®ç°ç»™ä¸€æ•°ç»„ä¸­æ¯ä¸ªå‡½æ•°ä¼ ç›¸åŒå‚æ•°ï¼Œé€šè¿‡callbackè¿”å›ã€‚å¦‚æœåªä¼ ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œå°†è¿”å›ä¸€ä¸ªå‡½æ•°å¯¹è±¡ï¼Œæˆ‘å¯ä»¥ä¼ å‚è°ƒç”¨ã€‚</li>
<li><a href="#queue"><code>queue</code></a>: æ˜¯ä¸€ä¸ªä¸²è¡Œçš„æ¶ˆæ¯é˜Ÿåˆ—ï¼Œé€šè¿‡é™åˆ¶äº†workeræ•°é‡ï¼Œä¸å†ä¸€æ¬¡æ€§å…¨éƒ¨æ‰§è¡Œã€‚å½“workeræ•°é‡ä¸å¤Ÿç”¨æ—¶ï¼Œæ–°åŠ å…¥çš„ä»»åŠ¡å°†ä¼šæ’é˜Ÿç­‰å€™ï¼Œç›´åˆ°æœ‰æ–°çš„workerå¯ç”¨ã€‚</li>
<li><a href="#cargo"><code>cargo</code></a>: ä¸€ä¸ªä¸²è¡Œçš„æ¶ˆæ¯é˜Ÿåˆ—ï¼Œç±»ä¼¼äºqueueï¼Œé€šè¿‡é™åˆ¶äº†workeræ•°é‡ï¼Œä¸å†ä¸€æ¬¡æ€§å…¨éƒ¨æ‰§è¡Œã€‚ä¸åŒä¹‹å¤„åœ¨äºï¼Œcargoæ¯æ¬¡ä¼šåŠ è½½æ»¡é¢çš„ä»»åŠ¡åšä¸ºä»»åŠ¡å•å…ƒï¼Œåªæœ‰ä»»åŠ¡å•å…ƒä¸­å…¨éƒ¨æ‰§è¡Œå®Œæˆåï¼Œæ‰ä¼šåŠ è½½æ–°çš„ä»»åŠ¡å•å…ƒã€‚</li>
<li><a href="#auto"><code>auto</code></a>: ç”¨æ¥å¤„ç†æœ‰ä¾èµ–å…³ç³»çš„å¤šä¸ªä»»åŠ¡çš„æ‰§è¡Œã€‚</li>
<li><a href="#iterator"><code>iterator</code></a>: å°†ä¸€ç»„å‡½æ•°åŒ…è£…æˆä¸ºä¸€ä¸ªiteratorï¼Œåˆæ¬¡è°ƒç”¨æ­¤iteratoræ—¶ï¼Œä¼šæ‰§è¡Œå®šä¹‰ä¸­çš„ç¬¬ä¸€ä¸ªå‡½æ•°å¹¶è¿”å›ç¬¬äºŒä¸ªå‡½æ•°ä»¥ä¾›è°ƒç”¨ã€‚</li>
<li><a href="#apply"><code>apply</code></a>: å¯ä»¥è®©æˆ‘ä»¬ç»™ä¸€ä¸ªå‡½æ•°é¢„ç»‘å®šå¤šä¸ªå‚æ•°å¹¶ç”Ÿæˆä¸€ä¸ªå¯ç›´æ¥è°ƒç”¨çš„æ–°å‡½æ•°ï¼Œç®€åŒ–ä»£ç ã€‚</li>
<li><a href="#nextTick"><code>nextTick</code></a>: ä¸nodejsçš„nextTickä¸€æ ·ï¼Œå†æœ€åè°ƒç”¨å‡½æ•°ã€‚</li>
<li><a href="#times"><code>times</code></a>: å¼‚æ­¥è¿è¡Œ,timeså¯ä»¥æŒ‡å®šè°ƒç”¨å‡ æ¬¡ï¼Œå¹¶æŠŠç»“æœåˆå¹¶åˆ°æ•°ç»„ä¸­è¿”å›</li>
<li><a href="#times"><code>timesSeries</code></a>: ä¸timeç±»ä¼¼ï¼Œå”¯ä¸€ä¸åŒçš„æ˜¯åŒæ­¥æ‰§è¡Œ</li>
</ul>
<h3 id="å·¥å…·ç±»-Utils"><a href="#å·¥å…·ç±»-Utils" class="headerlink" title="å·¥å…·ç±»: Utils"></a>å·¥å…·ç±»: <code>Utils</code></h3><ul>
<li><a href="#util.js"><code>memoize</code></a>: è®©æŸä¸€ä¸ªå‡½æ•°åœ¨å†…å­˜ä¸­ç¼“å­˜å®ƒçš„è®¡ç®—ç»“æœã€‚å¯¹äºç›¸åŒçš„å‚æ•°ï¼Œåªè®¡ç®—ä¸€æ¬¡ï¼Œä¸‹æ¬¡å°±ç›´æ¥æ‹¿åˆ°ä¹‹å‰ç®—å¥½çš„ç»“æœã€‚</li>
<li><a href="#util.js"><code>unmemoize</code></a>: è®©å·²ç»è¢«ç¼“å­˜çš„å‡½æ•°ï¼Œè¿”å›ä¸ç¼“å­˜çš„å‡½æ•°å¼•ç”¨ã€‚</li>
<li><a href="#util.js"><code>log</code></a>: æ‰§è¡ŒæŸå¼‚æ­¥å‡½æ•°ï¼Œå¹¶è®°å½•å®ƒçš„è¿”å›å€¼ï¼Œæ—¥å¿—è¾“å‡ºã€‚</li>
<li><a href="#util.js"><code>dir</code></a>: ä¸logç±»ä¼¼ï¼Œä¸åŒä¹‹å¤„åœ¨äºï¼Œä¼šè°ƒç”¨æµè§ˆå™¨çš„console.dir()å‡½æ•°ï¼Œæ˜¾ç¤ºä¸ºDOMè§†å›¾ã€‚</li>
<li><a href="#util.js"><code>noConflict</code></a>: å¦‚æœä¹‹å‰å·²ç»åœ¨å…¨å±€åŸŸä¸­å®šä¹‰äº†asyncå˜é‡ï¼Œå½“å¯¼å…¥æœ¬async.jsæ—¶ï¼Œä¼šå…ˆæŠŠä¹‹å‰çš„asyncå˜é‡ä¿å­˜èµ·æ¥ï¼Œç„¶åè¦†ç›–å®ƒã€‚ä»…ä»…ç”¨äºæµè§ˆå™¨ç«¯ï¼Œåœ¨nodejsä¸­æ²¡ç”¨ï¼Œè¿™é‡Œæ— æ³•æ¼”ç¤ºã€‚</li>
</ul>
<h2 id="ä»£ç æ¼”ç¤º"><a href="#ä»£ç æ¼”ç¤º" class="headerlink" title="ä»£ç æ¼”ç¤º"></a>ä»£ç æ¼”ç¤º</h2><p><a name="apply"></a><br><br></p>
<h3 id="applyä»£ç æ¼”ç¤º"><a href="#applyä»£ç æ¼”ç¤º" class="headerlink" title="applyä»£ç æ¼”ç¤º"></a><code>apply</code>ä»£ç æ¼”ç¤º</h3><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">var</span> <span class="token keyword">async</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'async'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> t <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./t'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> log <span class="token operator">=</span> t<span class="token punctuation">.</span>log<span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">/**
 * applyæ˜¯ä¸€ä¸ªéå¸¸å¥½ç”¨çš„å‡½æ•°ï¼Œå¯ä»¥è®©æˆ‘ä»¬ç»™ä¸€ä¸ªå‡½æ•°é¢„ç»‘å®šå¤šä¸ªå‚æ•°å¹¶ç”Ÿæˆä¸€ä¸ªå¯ç›´æ¥è°ƒç”¨çš„æ–°å‡½æ•°ï¼Œç®€åŒ–ä»£ç ã€‚
 *
 * function(callback) { t.inc(3, callback); }
 * ç­‰ä»·äºï¼š
 * async.apply(t.inc, 3);
 */</span>
<span class="token comment" spellcheck="true">// apply(function, arguments..)</span>

<span class="token comment" spellcheck="true">/**
 * é€šè¿‡åå­—ç»‘å®šå‡½æ•°t.inc, t.fireï¼Œä½œä¸ºæ–°å‡½æ•°ç»™parallelè°ƒç”¨
 */</span>
<span class="token comment" spellcheck="true">//1.1</span>
<span class="token keyword">async</span><span class="token punctuation">.</span><span class="token function">parallel</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
    <span class="token keyword">async</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>t<span class="token punctuation">.</span>inc<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword">async</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>t<span class="token punctuation">.</span>fire<span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span>
<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>err<span class="token punctuation">,</span> results<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.1 err: '</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.1 results: '</span><span class="token punctuation">,</span> results<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">//58.605> 1.1 err: null</span>
<span class="token comment" spellcheck="true">//58.613> 1.1 results: [ 4, 100 ]</span>

<span class="token comment" spellcheck="true">/**
 * æ„é€ ä¸€ä¸ªåŠ æ³•å‡½æ•°ï¼Œé€šè¿‡applyç®€åŒ–ä»£ç 
 */</span>
<span class="token comment" spellcheck="true">//1.2</span>
<span class="token keyword">function</span> <span class="token function">inc</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">,</span>callback<span class="token punctuation">,</span>timeout<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">var</span> timeout <span class="token operator">=</span> timeout <span class="token operator">||</span> <span class="token number">200</span><span class="token punctuation">;</span>
    t<span class="token punctuation">.</span><span class="token function">wait</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">callback</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> a<span class="token operator">+</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> timeout<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> fn <span class="token operator">=</span> <span class="token keyword">async</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>inc<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">fn</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.2 inc: '</span> <span class="token operator">+</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">//58.616> 1.2 inc: 3</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><a name="applyEach"></a><br><br></p>
<h3 id="applyEachä»£ç æ¼”ç¤º"><a href="#applyEachä»£ç æ¼”ç¤º" class="headerlink" title="applyEachä»£ç æ¼”ç¤º"></a><code>applyEach</code>ä»£ç æ¼”ç¤º</h3><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">var</span> <span class="token keyword">async</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'async'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> t <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./t'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> log <span class="token operator">=</span> t<span class="token punctuation">.</span>log<span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">/**
* applyEachï¼Œå¯ä»¥å®ç°ç»™ä¸€æ•°ç»„ä¸­æ¯ä¸ªå‡½æ•°ä¼ ç›¸åŒå‚æ•°ï¼Œé€šè¿‡callbackè¿”å›ã€‚
* å¦‚æœåªä¼ ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œå°†è¿”å›ä¸€ä¸ªå‡½æ•°å¯¹è±¡ï¼Œæˆ‘å¯ä»¥ä¼ å‚è°ƒç”¨ã€‚
*/</span>
<span class="token comment" spellcheck="true">// applyEach(fns, args..., callback)</span>

<span class="token comment" spellcheck="true">/**
 * å¼‚æ­¥æ‰§è¡Œï¼Œç»™æ•°ç»„ä¸­çš„å‡½æ•°ï¼Œä»–ä»¬æœ‰ç›¸åŒçš„å‚æ•°ã€‚
 */</span>
<span class="token comment" spellcheck="true">//1.1</span>
<span class="token keyword">async</span><span class="token punctuation">.</span><span class="token function">applyEach</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
    <span class="token keyword">function</span> <span class="token punctuation">(</span>name<span class="token punctuation">,</span>cb<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"1.1 handler: "</span> <span class="token operator">+</span> name <span class="token operator">+</span> <span class="token string">" A"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">cb</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>name<span class="token punctuation">,</span>cb<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"1.1 handler: "</span> <span class="token operator">+</span> name <span class="token operator">+</span> <span class="token string">" B"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">cb</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">150</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'Hello'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.1 err: '</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">//06.739> 1.1 handler: Hello B</span>
<span class="token comment" spellcheck="true">//07.079> 1.1 handler: Hello A</span>
<span class="token comment" spellcheck="true">//07.080> 1.1 err: null</span>

<span class="token comment" spellcheck="true">/**
 *  å¼‚æ­¥æ‰§è¡Œï¼Œå½“åªè®¾ç½®ç¬¬ä¸€å‚æ•°åï¼Œå¾—åˆ°å‡½æ•°å¯¹è±¡ï¼Œå†ä¼ å‚è°ƒç”¨è¿™ä¸ªå‡½æ•°ã€‚
 */</span>
<span class="token comment" spellcheck="true">//1.2</span>
<span class="token keyword">var</span> fn <span class="token operator">=</span> <span class="token keyword">async</span><span class="token punctuation">.</span><span class="token function">applyEach</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
    <span class="token keyword">function</span> <span class="token punctuation">(</span>name<span class="token punctuation">,</span>cb<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"1.2 handler: "</span> <span class="token operator">+</span> name <span class="token operator">+</span> <span class="token string">" A"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>name<span class="token punctuation">,</span>cb<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"1.2 handler: "</span> <span class="token operator">+</span> name <span class="token operator">+</span> <span class="token string">" B"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">150</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">fn</span><span class="token punctuation">(</span><span class="token string">"simgle"</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'err: '</span><span class="token punctuation">,</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">//29.351> 1.2 handler: simgle B</span>
<span class="token comment" spellcheck="true">//29.688> 1.2 handler: simgle A</span>

<span class="token comment" spellcheck="true">/**
 *   applyEachSeriesä¸applyEachå”¯ä¸€ä¸åŒçš„æ˜¯ï¼Œæ•°ç»„çš„å‡½æ•°åŒæ­¥æ‰§è¡Œã€‚
 */</span>
<span class="token comment" spellcheck="true">//applyEachSeries(arr, args..., callback)</span>
<span class="token comment" spellcheck="true">//1.3</span>
<span class="token keyword">async</span><span class="token punctuation">.</span><span class="token function">applyEachSeries</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
    <span class="token keyword">function</span> <span class="token punctuation">(</span>name<span class="token punctuation">,</span>cb<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"1.3 handler: "</span> <span class="token operator">+</span> name <span class="token operator">+</span> <span class="token string">" A"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">cb</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>name<span class="token punctuation">,</span>cb<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"1.3 handler: "</span> <span class="token operator">+</span> name <span class="token operator">+</span> <span class="token string">" B"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">cb</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">150</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">"aaa"</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.3 err: '</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">//10.669> 1.3 handler: aaa A</span>
<span class="token comment" spellcheck="true">//10.831> 1.3 handler: aaa B</span>
<span class="token comment" spellcheck="true">//10.834> 1.3 err: null</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><a name="auto"></a><br><br></p>
<h3 id="autoä»£ç æ¼”ç¤º"><a href="#autoä»£ç æ¼”ç¤º" class="headerlink" title="autoä»£ç æ¼”ç¤º"></a><code>auto</code>ä»£ç æ¼”ç¤º</h3><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">var</span> <span class="token keyword">async</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'async'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> t <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./t'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> log <span class="token operator">=</span> t<span class="token punctuation">.</span>log<span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">/**
 * autoç”¨æ¥å¤„ç†æœ‰ä¾èµ–å…³ç³»çš„å¤šä¸ªä»»åŠ¡çš„æ‰§è¡Œã€‚
 *
 * æ¯”å¦‚æŸäº›ä»»åŠ¡ä¹‹é—´å½¼æ­¤ç‹¬ç«‹ï¼Œå¯ä»¥å¹¶è¡Œæ‰§è¡Œï¼›ä½†æŸäº›ä»»åŠ¡ä¾èµ–äºå…¶å®ƒæŸäº›ä»»åŠ¡ï¼Œåªèƒ½ç­‰é‚£äº›ä»»åŠ¡å®Œæˆåæ‰èƒ½æ‰§è¡Œã€‚
 * è™½ç„¶æˆ‘ä»¬å¯ä»¥ä½¿ç”¨parallelå’Œseriesç»“åˆèµ·æ¥å®ç°è¯¥åŠŸèƒ½ï¼Œä½†å¦‚æœä»»åŠ¡ä¹‹é—´å…³ç³»å¤æ‚ï¼Œåˆ™ä»£ç ä¼šç›¸å½“å¤æ‚ï¼Œä»¥åå¦‚æœæƒ³æ·»åŠ ä¸€ä¸ªæ–°ä»»åŠ¡ï¼Œä¹Ÿä¼šå¾ˆéº»çƒ¦ã€‚
 * è¿™æ—¶ä½¿ç”¨autoï¼Œåˆ™ä¼šäº‹åŠåŠŸå€ã€‚
 *
 * å¦‚æœæœ‰ä»»åŠ¡ä¸­é€”å‡ºé”™ï¼Œåˆ™ä¼šæŠŠè¯¥é”™è¯¯ä¼ ç»™æœ€ç»ˆcallbackï¼Œæ‰€æœ‰ä»»åŠ¡ï¼ˆåŒ…æ‹¬å·²ç»æ‰§è¡Œå®Œçš„ï¼‰äº§ç”Ÿçš„æ•°æ®å°†è¢«å¿½ç•¥ã€‚
 * å¦‚æœä¸å…³å¿ƒé”™è¯¯å’Œæœ€ç»ˆæ•°æ®ï¼Œå¯ä»¥ä¸ç”¨å†™æœ€åé‚£ä¸ªcallbackã€‚
 */</span>
<span class="token comment" spellcheck="true">// async.auto(tasks, [callback])</span>

<span class="token comment" spellcheck="true">/**
 * æˆ‘è¦å†™ä¸€ä¸ªç¨‹åºï¼Œå®ƒè¦å®Œæˆä»¥ä¸‹å‡ ä»¶äº‹ï¼š
 * 1. ä»æŸå¤„å–å¾—æ•°æ®
 * 2. åœ¨ç¡¬ç›˜ä¸Šå»ºç«‹ä¸€ä¸ªæ–°çš„ç›®å½•
 * 3. å°†æ•°æ®å†™å…¥åˆ°ç›®å½•ä¸‹æŸæ–‡ä»¶
 * 4. å‘é€é‚®ä»¶ï¼Œå°†æ–‡ä»¶ä»¥é™„ä»¶å½¢å¼å‘é€ç»™å…¶å®ƒäººã€‚
 *
 * åˆ†æè¯¥ä»»åŠ¡ï¼Œå¯ä»¥çŸ¥é“1ä¸2å¯ä»¥å¹¶è¡Œæ‰§è¡Œï¼Œ3éœ€è¦ç­‰1å’Œ2å®Œæˆï¼Œ4è¦ç­‰3å®Œæˆã€‚
 * å¯ä»¥æŒ‰ä»¥ä¸‹æ–¹å¼æ¥ä½¿ç”¨autoå‡½æ•°ã€‚
 */</span>
<span class="token comment" spellcheck="true">// 1.1</span>
<span class="token keyword">async</span><span class="token punctuation">.</span><span class="token function">auto</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    getData<span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>callback<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.1: got data'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
             <span class="token function">callback</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token string">'mydata'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">300</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    makeFolder<span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>callback<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.1: made folder'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">callback</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token string">'myfolder'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    writeFile<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'getData'</span><span class="token punctuation">,</span> <span class="token string">'makeFolder'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>callback<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.1: wrote file'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">callback</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token string">'myfile'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">300</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    emailFiles<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'writeFile'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>callback<span class="token punctuation">,</span> results<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.1: emailed file: '</span><span class="token punctuation">,</span> results<span class="token punctuation">.</span>writeFile<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">callback</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> results<span class="token punctuation">.</span>writeFile<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> results<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.1: err: '</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.1: results: '</span><span class="token punctuation">,</span> results<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">//1.1: made folder</span>
<span class="token comment" spellcheck="true">//1.1: got data</span>
<span class="token comment" spellcheck="true">//1.1: wrote file</span>
<span class="token comment" spellcheck="true">//20.120> 1.1: emailed file: myfile</span>
<span class="token comment" spellcheck="true">//20.125> 1.1: err: null</span>
<span class="token comment" spellcheck="true">//20.127> 1.1: results: { makeFolder: 'myfolder',</span>
<span class="token comment" spellcheck="true">//    getData: 'mydata',</span>
<span class="token comment" spellcheck="true">//    writeFile: 'myfile',</span>
<span class="token comment" spellcheck="true">//    emailFiles: 'myfile' }</span>



<span class="token comment" spellcheck="true">/**
* å¦‚æœä¸­é€”å‡ºé”™ï¼Œåˆ™ä¼šæŠŠé”™è¯¯äº¤ç»™æœ€ç»ˆcallbackï¼Œæ‰§è¡Œå®Œä»»åŠ¡çš„ä¼ ç»™æœ€ç»ˆcallbackã€‚æœªæ‰§è¡Œå®Œæˆçš„å‡½æ•°å€¼è¢«å¿½ç•¥
*/</span>
<span class="token comment" spellcheck="true">// 1.2</span>
<span class="token keyword">async</span><span class="token punctuation">.</span><span class="token function">auto</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    getData<span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>callback<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.2: got data'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">callback</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token string">'mydata'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">300</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    makeFolder<span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>callback<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.2: made folder'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">callback</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token string">'myfolder'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    writeFile<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'getData'</span><span class="token punctuation">,</span> <span class="token string">'makeFolder'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>callback<span class="token punctuation">,</span> results<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.2: wrote file'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">callback</span><span class="token punctuation">(</span><span class="token string">'myerr'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">300</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    emailFiles<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'writeFile'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>callback<span class="token punctuation">,</span> results<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.2: emailed file: '</span> <span class="token operator">+</span> results<span class="token punctuation">.</span>writeFile<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">callback</span><span class="token punctuation">(</span><span class="token string">'err sending email'</span><span class="token punctuation">,</span> results<span class="token punctuation">.</span>writeFile<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> results<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.2 err: '</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.2 results: '</span><span class="token punctuation">,</span> results<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">//1.2: made folder</span>
<span class="token comment" spellcheck="true">//1.2: got data</span>
<span class="token comment" spellcheck="true">//1.2: wrote file</span>
<span class="token comment" spellcheck="true">//51.399> 1.2 err: myerr</span>
<span class="token comment" spellcheck="true">//51.401> 1.2 results: { makeFolder: 'myfolder',</span>
<span class="token comment" spellcheck="true">//    getData: 'mydata',</span>
<span class="token comment" spellcheck="true">//    writeFile: undefined }</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><a name="cargo"></a><br><br></p>
<h3 id="cargoä»£ç æ¼”ç¤º"><a href="#cargoä»£ç æ¼”ç¤º" class="headerlink" title="cargoä»£ç æ¼”ç¤º"></a><code>cargo</code>ä»£ç æ¼”ç¤º</h3><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">var</span> <span class="token keyword">async</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'async'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> t <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./t'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> log <span class="token operator">=</span> t<span class="token punctuation">.</span>log<span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">/**
 * cargoä¹Ÿæ˜¯ä¸€ä¸ªä¸²è¡Œçš„æ¶ˆæ¯é˜Ÿåˆ—ï¼Œç±»ä¼¼äºqueueï¼Œé€šè¿‡é™åˆ¶äº†workeræ•°é‡ï¼Œä¸å†ä¸€æ¬¡æ€§å…¨éƒ¨æ‰§è¡Œã€‚
 * å½“workeræ•°é‡ä¸å¤Ÿç”¨æ—¶ï¼Œæ–°åŠ å…¥çš„ä»»åŠ¡å°†ä¼šæ’é˜Ÿç­‰å€™ï¼Œç›´åˆ°æœ‰æ–°çš„workerå¯ç”¨ã€‚
 *
 * cargoçš„ä¸åŒä¹‹å¤„åœ¨äºï¼Œcargoæ¯æ¬¡ä¼šåŠ è½½æ»¡é¢çš„ä»»åŠ¡åšä¸ºä»»åŠ¡å•å…ƒï¼Œåªæœ‰ä»»åŠ¡å•å…ƒä¸­å…¨éƒ¨æ‰§è¡Œå®Œæˆåï¼Œæ‰ä¼šåŠ è½½æ–°çš„ä»»åŠ¡å•å…ƒã€‚
 */</span>
<span class="token comment" spellcheck="true">// cargo(worker, [payload])</span>

<span class="token comment" spellcheck="true">/**
 * åˆ›å»ºcargoå®ä¾‹
 */</span>
<span class="token keyword">var</span> cargo <span class="token operator">=</span> <span class="token keyword">async</span><span class="token punctuation">.</span><span class="token function">cargo</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span>tasks<span class="token punctuation">,</span> callback<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>tasks<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'start '</span> <span class="token operator">+</span> tasks<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token function">callback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token comment" spellcheck="true">/**
 * ç›‘å¬ï¼šå¦‚æœæŸæ¬¡pushæ“ä½œåï¼Œä»»åŠ¡æ•°å°†è¾¾åˆ°æˆ–è¶…è¿‡workeræ•°é‡æ—¶ï¼Œå°†è°ƒç”¨è¯¥å‡½æ•°
 */</span>
cargo<span class="token punctuation">.</span>saturated <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'all workers to be used'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">/**
 * ç›‘å¬ï¼šå½“æœ€åä¸€ä¸ªä»»åŠ¡äº¤ç»™workeræ—¶ï¼Œå°†è°ƒç”¨è¯¥å‡½æ•°
 */</span>
cargo<span class="token punctuation">.</span>empty <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'no more tasks wating'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">/**
 * ç›‘å¬ï¼šå½“æ‰€æœ‰ä»»åŠ¡éƒ½æ‰§è¡Œå®Œä»¥åï¼Œå°†è°ƒç”¨è¯¥å‡½æ•°
 */</span>
cargo<span class="token punctuation">.</span>drain <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'all tasks have been processed'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">/**
 * å¢åŠ æ–°ä»»åŠ¡
 */</span>
cargo<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span>name<span class="token punctuation">:</span> <span class="token string">'A'</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    t<span class="token punctuation">.</span><span class="token function">wait</span><span class="token punctuation">(</span><span class="token number">300</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'finished processing A'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
cargo<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span>name<span class="token punctuation">:</span> <span class="token string">'B'</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    t<span class="token punctuation">.</span><span class="token function">wait</span><span class="token punctuation">(</span><span class="token number">600</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'finished processing B'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
cargo<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span>name<span class="token punctuation">:</span> <span class="token string">'C'</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    t<span class="token punctuation">.</span><span class="token function">wait</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'finished processing C'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
cargo<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span>name<span class="token punctuation">:</span> <span class="token string">'D'</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    t<span class="token punctuation">.</span><span class="token function">wait</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'finished processing D'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
cargo<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span>name<span class="token punctuation">:</span> <span class="token string">'E'</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    t<span class="token punctuation">.</span><span class="token function">wait</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'finished processing E'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">//40.016> all workers to be used</span>
<span class="token comment" spellcheck="true">//40.020> no more tasks wating</span>
<span class="token comment" spellcheck="true">//40.020> start A</span>
<span class="token comment" spellcheck="true">//40.020> start B</span>
<span class="token comment" spellcheck="true">//40.322> finished processing A</span>
<span class="token comment" spellcheck="true">//40.923> finished processing B</span>
<span class="token comment" spellcheck="true">//40.923> no more tasks wating</span>
<span class="token comment" spellcheck="true">//40.924> start C</span>
<span class="token comment" spellcheck="true">//40.924> start D</span>
<span class="token comment" spellcheck="true">//41.425> finished processing C</span>
<span class="token comment" spellcheck="true">//41.526> finished processing D</span>
<span class="token comment" spellcheck="true">//41.526> no more tasks wating</span>
<span class="token comment" spellcheck="true">//41.527> start E</span>
<span class="token comment" spellcheck="true">//41.728> finished processing E</span>
<span class="token comment" spellcheck="true">//41.728> all tasks have been processed</span>
<span class="token comment" spellcheck="true">//41.729> all tasks have been processed</span>
<span class="token comment" spellcheck="true">//41.729> all tasks have been processed</span>
<span class="token comment" spellcheck="true">//41.729> all tasks have been processed</span>
<span class="token comment" spellcheck="true">//41.730> all tasks have been processed</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><a name="compose"></a><br><br></p>
<h3 id="composeä»£ç æ¼”ç¤º"><a href="#composeä»£ç æ¼”ç¤º" class="headerlink" title="composeä»£ç æ¼”ç¤º"></a><code>compose</code>ä»£ç æ¼”ç¤º</h3><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">var</span> <span class="token keyword">async</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'async'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> t <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./t'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> log <span class="token operator">=</span> t<span class="token punctuation">.</span>log<span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">/**
 * åˆ›å»ºä¸€ä¸ªåŒ…æ‹¬ä¸€ç»„å¼‚æ­¥å‡½æ•°çš„å‡½æ•°é›†åˆï¼Œæ¯ä¸ªå‡½æ•°ä¼šæ¶ˆè´¹ä¸Šä¸€æ¬¡å‡½æ•°çš„è¿”å›å€¼ã€‚
 * æŠŠf(),g(),h()å¼‚æ­¥å‡½æ•°ï¼Œç»„åˆæˆf(g(h()))çš„å½¢å¼ï¼Œé€šè¿‡callbackå¾—åˆ°è¿”å›å€¼ã€‚
 */</span>
<span class="token comment" spellcheck="true">// compose(fn1, fn2...)</span>

<span class="token comment" spellcheck="true">/**
 * é€šè¿‡composeç»„åˆï¼Œf(g(h()))çš„å½¢å¼ï¼Œä»å†…å±‚åˆ°å¤–å±‚çš„æ‰§è¡Œçš„é¡ºåºã€‚
 */</span>
<span class="token comment" spellcheck="true">//1.1</span>
<span class="token keyword">function</span> <span class="token function">f</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span>callback<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.1.f enter: '</span><span class="token punctuation">,</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">callback</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> n <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">g</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> callback<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.1.g enter: '</span><span class="token punctuation">,</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">callback</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> n <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">h</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> callback<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.1.h enter: '</span><span class="token punctuation">,</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">callback</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> n <span class="token operator">-</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> fgh <span class="token operator">=</span> <span class="token keyword">async</span><span class="token punctuation">.</span><span class="token function">compose</span><span class="token punctuation">(</span>f<span class="token punctuation">,</span>g<span class="token punctuation">,</span>h<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">fgh</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span>result<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.1 err: '</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.1 result: '</span><span class="token punctuation">,</span> result<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">//05.307> 1.1.h enter: 4</span>
<span class="token comment" spellcheck="true">//05.329> 1.1.g enter: -6</span>
<span class="token comment" spellcheck="true">//05.341> 1.1.f enter: -12</span>
<span class="token comment" spellcheck="true">//05.361> 1.1 err: null</span>
<span class="token comment" spellcheck="true">//05.362> 1.1 result: -11</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><a name="concat"></a><br><br></p>
<h3 id="concatä»£ç æ¼”ç¤º"><a href="#concatä»£ç æ¼”ç¤º" class="headerlink" title="concatä»£ç æ¼”ç¤º"></a><code>concat</code>ä»£ç æ¼”ç¤º</h3><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">var</span> <span class="token keyword">async</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'async'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> t <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./t'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> log <span class="token operator">=</span> t<span class="token punctuation">.</span>log<span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">/**
 * å°†å¤šä¸ªå¼‚æ­¥æ“ä½œçš„ç»“æœåˆå¹¶ä¸ºä¸€ä¸ªæ•°ç»„ã€‚
 */</span>
<span class="token comment" spellcheck="true">// concat(arr, iterator(item,callback(err,result)), callback(err,result))</span>

<span class="token keyword">var</span> data <span class="token operator">=</span> <span class="token punctuation">{</span>
    aaa<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">,</span><span class="token number">22</span><span class="token punctuation">,</span><span class="token number">33</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    bbb<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">44</span><span class="token punctuation">,</span><span class="token number">55</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    ccc<span class="token punctuation">:</span> <span class="token number">66</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> keys <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>name<span class="token punctuation">:</span> <span class="token string">'aaa'</span><span class="token punctuation">,</span> delay<span class="token punctuation">:</span> <span class="token number">300</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>name<span class="token punctuation">:</span> <span class="token string">'bbb'</span><span class="token punctuation">,</span> delay<span class="token punctuation">:</span> <span class="token number">100</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>name<span class="token punctuation">:</span> <span class="token string">'ccc'</span><span class="token punctuation">,</span> delay<span class="token punctuation">:</span> <span class="token number">200</span><span class="token punctuation">}</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">/**
 * ä»¥å¹¶è¡Œæ–¹å¼å¯¹é›†åˆä¸­å„å…ƒç´ è¿›è¡Œå¼‚æ­¥æ“ä½œï¼Œç„¶åæŠŠå¾—åˆ°çš„ç»“æœåˆå¹¶ä¸ºä¸€ä¸ªæ•°ç»„ï¼Œä¼ ç»™æœ€åçš„callbackã€‚
 */</span>
<span class="token comment" spellcheck="true">// 1.1</span>
<span class="token keyword">async</span><span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>keys<span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span>callback<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">callback</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> data<span class="token punctuation">[</span>key<span class="token punctuation">.</span>name<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> key<span class="token punctuation">.</span>delay<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> values<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.1 err: '</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.1 values: '</span><span class="token punctuation">,</span> values<span class="token punctuation">)</span><span class="token punctuation">;</span>    
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">// 13.539> 1.1 err:</span>
<span class="token comment" spellcheck="true">// 13.539> 1.1 values: [ 44, 55, 66, 11, 22, 33 ]</span>

<span class="token comment" spellcheck="true">/**
 * å¦‚æœä¸­é€”å‡ºé”™ï¼Œåˆ™æŠŠé”™è¯¯ä»¥åŠå·²ç»å®Œæˆçš„æ“ä½œçš„ç»“æœäº¤ç»™æœ€åcallbackã€‚æœªæ‰§è¡Œå®Œçš„åˆ™å¿½ç•¥ã€‚
 */</span>
<span class="token comment" spellcheck="true">// 1.2</span>
<span class="token keyword">async</span><span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>keys<span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span>callback<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>key<span class="token punctuation">.</span>name<span class="token operator">===</span><span class="token string">'ccc'</span><span class="token punctuation">)</span> <span class="token function">callback</span><span class="token punctuation">(</span><span class="token string">'myerr'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">else</span> <span class="token function">callback</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> data<span class="token punctuation">[</span>key<span class="token punctuation">.</span>name<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> key<span class="token punctuation">.</span>delay<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> values<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.2 err: '</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.2 values: '</span><span class="token punctuation">,</span> values<span class="token punctuation">)</span><span class="token punctuation">;</span>    
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">// 13.439> 1.2 err: myerr</span>
<span class="token comment" spellcheck="true">// 13.439> 1.2 values: [ 44, 55 ]</span>

<span class="token comment" spellcheck="true">/**
 * æŒ‰æ•°ç»„ä¸­çš„å…ƒç´ é¡ºåºæ¥æ‰§è¡Œå¼‚æ­¥æ“ä½œï¼Œä¸€ä¸ªå®Œæˆåæ‰å¯¹ä¸‹ä¸€ä¸ªè¿›è¡Œæ“ä½œã€‚æ‰€æœ‰ç»“æœä¼šæ±‡é›†æˆä¸€ä¸ªæ•°ç»„äº¤ç»™æœ€åçš„callbackã€‚
 */</span>
<span class="token comment" spellcheck="true">// concatSeries(arr, iterator, callback)</span>

<span class="token comment" spellcheck="true">// 1.3</span>
<span class="token keyword">async</span><span class="token punctuation">.</span><span class="token function">concatSeries</span><span class="token punctuation">(</span>keys<span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span>callback<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">callback</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> data<span class="token punctuation">[</span>key<span class="token punctuation">.</span>name<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> key<span class="token punctuation">.</span>delay<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> values<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.3 err: '</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.3 values: '</span><span class="token punctuation">,</span> values<span class="token punctuation">)</span><span class="token punctuation">;</span>    
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">// 13.859> 1.3 err:</span>
<span class="token comment" spellcheck="true">// 13.859> 1.3 values: [ 11, 22, 33, 44, 55, 66 ]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><a name="detect"></a><br><br></p>
<h3 id="detectä»£ç æ¼”ç¤º"><a href="#detectä»£ç æ¼”ç¤º" class="headerlink" title="detectä»£ç æ¼”ç¤º"></a><code>detect</code>ä»£ç æ¼”ç¤º</h3><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">var</span> <span class="token keyword">async</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'async'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> t <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./t'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> log <span class="token operator">=</span> t<span class="token punctuation">.</span>log<span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">/**
 * ç”¨äºå–å¾—é›†åˆä¸­æ»¡è¶³æ¡ä»¶çš„ç¬¬ä¸€ä¸ªå…ƒç´ ã€‚
 * å®ƒåˆ†ä¸ºå¹¶è¡Œä¸é¡ºåºæ‰§è¡Œä¸¤ç§æ–¹å¼ï¼Œåˆ†åˆ«å¯¹åº”å‡½æ•°detectå’ŒdetectSeriesã€‚
 */</span>
<span class="token comment" spellcheck="true">// detect(array, iterator(item,callback(test)), callback(result)</span>

<span class="token keyword">var</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>value<span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">,</span>delay<span class="token punctuation">:</span><span class="token number">500</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>value<span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">,</span>delay<span class="token punctuation">:</span><span class="token number">200</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>value<span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">,</span>delay<span class="token punctuation">:</span><span class="token number">300</span><span class="token punctuation">}</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">/**
 *  å¹¶è¡Œæ‰§è¡Œï¼Œé€šè¿‡t.incåšä¸€ä¸ªç´¯åŠ å™¨ï¼Œå¾—åˆ°ç¬¬ä¸€ä¸ªæ»¡è¶³æ¡ä»¶çš„ç»“æœå¯¹è±¡
 */</span>
<span class="token keyword">async</span><span class="token punctuation">.</span><span class="token function">detect</span><span class="token punctuation">(</span>arr<span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>item<span class="token punctuation">,</span>callback<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.1 enter: '</span><span class="token punctuation">,</span> item<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
    t<span class="token punctuation">.</span><span class="token function">inc</span><span class="token punctuation">(</span>item<span class="token punctuation">.</span>value<span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span>n<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.1 handle: '</span><span class="token punctuation">,</span> item<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">callback</span><span class="token punctuation">(</span>n<span class="token operator">%</span><span class="token number">2</span><span class="token operator">===</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> item<span class="token punctuation">.</span>delay<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.1 result: '</span><span class="token punctuation">,</span> result<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">// 09.928> 1.1 enter: 1</span>
<span class="token comment" spellcheck="true">// 09.928> 1.1 enter: 2</span>
<span class="token comment" spellcheck="true">// 09.928> 1.1 enter: 3</span>
<span class="token comment" spellcheck="true">// 10.138> 1.1 handle: 2</span>
<span class="token comment" spellcheck="true">// 10.228> 1.1 handle: 3</span>
<span class="token comment" spellcheck="true">// 10.228> 1.1 result: { value: 3, delay: 300 }</span>
<span class="token comment" spellcheck="true">// 10.438> 1.1 handle: 1</span>
<span class="token comment" spellcheck="true">// 10.438> 1.1 handle: 1</span>

<span class="token comment" spellcheck="true">/**
 *  ä¸²è¡Œæ‰§è¡Œï¼Œé€šè¿‡t.incåšä¸€ä¸ªç´¯åŠ å™¨ï¼Œå¾—åˆ°ç¬¬ä¸€ä¸ªæ»¡è¶³æ¡ä»¶çš„ç»“æœå¯¹è±¡
 */</span>
<span class="token keyword">async</span><span class="token punctuation">.</span><span class="token function">detectSeries</span><span class="token punctuation">(</span>arr<span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>item<span class="token punctuation">,</span>callback<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.2 enter: '</span><span class="token punctuation">,</span> item<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
    t<span class="token punctuation">.</span><span class="token function">inc</span><span class="token punctuation">(</span>item<span class="token punctuation">.</span>value<span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span>n<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.1 handle: '</span><span class="token punctuation">,</span> item<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">callback</span><span class="token punctuation">(</span>n<span class="token operator">%</span><span class="token number">2</span><span class="token operator">===</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> item<span class="token punctuation">.</span>delay<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.2 result: '</span><span class="token punctuation">,</span> result<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">// 09.928> 1.2 enter: 1</span>
<span class="token comment" spellcheck="true">// 10.438> 1.2 result: { value: 1, delay: 500 }</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><a name="each"></a><br><br></p>
<h3 id="eachä»£ç æ¼”ç¤º"><a href="#eachä»£ç æ¼”ç¤º" class="headerlink" title="eachä»£ç æ¼”ç¤º"></a><code>each</code>ä»£ç æ¼”ç¤º</h3><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">var</span> <span class="token keyword">async</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'async'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> t <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./t'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> log <span class="token operator">=</span> t<span class="token punctuation">.</span>log<span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">/**
 * å¦‚æœæƒ³å¯¹åŒä¸€ä¸ªé›†åˆä¸­çš„æ‰€æœ‰å…ƒç´ éƒ½æ‰§è¡ŒåŒä¸€ä¸ªå¼‚æ­¥æ“ä½œï¼Œå¯ä»¥åˆ©ç”¨eachå‡½æ•°ã€‚
 *
 * asyncæä¾›äº†ä¸‰ç§æ–¹å¼ï¼š
 * 1. é›†åˆä¸­æ‰€æœ‰å…ƒç´ å¹¶è¡Œæ‰§è¡Œ
 * 2. ä¸€ä¸ªä¸€ä¸ªé¡ºåºæ‰§è¡Œ
 * 3. åˆ†æ‰¹æ‰§è¡Œï¼ŒåŒä¸€æ‰¹å†…å¹¶è¡Œï¼Œæ‰¹ä¸æ‰¹ä¹‹é—´æŒ‰é¡ºåº
 *
 * å¦‚æœä¸­é€”å‡ºé”™ï¼Œåˆ™é”™è¯¯å°†ä¸Šä¼ ç»™æœ€ç»ˆçš„callbackå¤„ç†ã€‚å…¶å®ƒå·²ç»å¯åŠ¨çš„ä»»åŠ¡ç»§ç»­æ‰§è¡Œï¼Œæœªå¯åŠ¨çš„å¿½ç•¥ã€‚
 */</span>
<span class="token comment" spellcheck="true">// each(arr, iterator(item, callback), callback(err))</span>


<span class="token keyword">var</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>name<span class="token punctuation">:</span><span class="token string">'Jack'</span><span class="token punctuation">,</span> delay<span class="token punctuation">:</span> <span class="token number">200</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
           <span class="token punctuation">{</span>name<span class="token punctuation">:</span><span class="token string">'Mike'</span><span class="token punctuation">,</span> delay<span class="token punctuation">:</span> <span class="token number">100</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
           <span class="token punctuation">{</span>name<span class="token punctuation">:</span><span class="token string">'Freewind'</span><span class="token punctuation">,</span> delay<span class="token punctuation">:</span> <span class="token number">300</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">/**
 * æ‰€æœ‰æ“ä½œå¹¶å‘æ‰§è¡Œï¼Œä¸”å…¨éƒ¨æœªå‡ºé”™ï¼Œæœ€ç»ˆå¾—åˆ°çš„errä¸ºundefinedã€‚æ³¨æ„æœ€ç»ˆcallbackåªæœ‰ä¸€ä¸ªå‚æ•°errã€‚
 */</span>
<span class="token comment" spellcheck="true">// 1.1</span>
<span class="token keyword">async</span><span class="token punctuation">.</span><span class="token function">each</span><span class="token punctuation">(</span>arr<span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>item<span class="token punctuation">,</span> callback<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.1 enter: '</span> <span class="token operator">+</span> item<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.1 handle: '</span> <span class="token operator">+</span> item<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">callback</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> item<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> item<span class="token punctuation">.</span>delay<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.1 err: '</span> <span class="token operator">+</span> err<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">// è¾“å‡ºå¦‚ä¸‹ï¼š</span>
<span class="token comment" spellcheck="true">// 42.244> 1.1 enter: Jack</span>
<span class="token comment" spellcheck="true">// 42.245> 1.1 enter: Mike</span>
<span class="token comment" spellcheck="true">// 42.245> 1.1 enter: Freewind</span>
<span class="token comment" spellcheck="true">// 42.350> 1.1 handle: Mike</span>
<span class="token comment" spellcheck="true">// 42.445> 1.1 handle: Jack</span>
<span class="token comment" spellcheck="true">// 42.554> 1.1 handle: Freewind</span>
<span class="token comment" spellcheck="true">// 42.554> 1.1 err: undefined</span>


<span class="token comment" spellcheck="true">/**
 * å¦‚æœä¸­é€”å‡ºé”™ï¼Œåˆ™å‡ºé”™åé©¬ä¸Šè°ƒç”¨æœ€ç»ˆçš„callbackã€‚å…¶å®ƒæœªæ‰§è¡Œå®Œçš„ä»»åŠ¡ç»§ç»­æ‰§è¡Œã€‚
 */</span>
<span class="token keyword">async</span><span class="token punctuation">.</span><span class="token function">each</span><span class="token punctuation">(</span>arr<span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span>item<span class="token punctuation">,</span> callback<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.2 enter: '</span> <span class="token operator">+</span>item<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.2 handle: '</span> <span class="token operator">+</span> item<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>item<span class="token punctuation">.</span>name<span class="token operator">===</span><span class="token string">'Jack'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">callback</span><span class="token punctuation">(</span><span class="token string">'myerr'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> item<span class="token punctuation">.</span>delay<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.2 err: '</span> <span class="token operator">+</span> err<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">// è¾“å‡ºå¦‚ä¸‹ï¼š</span>
<span class="token comment" spellcheck="true">// 42.246> 1.2 enter: Jack</span>
<span class="token comment" spellcheck="true">// 42.246> 1.2 enter: Mike</span>
<span class="token comment" spellcheck="true">// 42.246> 1.2 enter: Freewind</span>
<span class="token comment" spellcheck="true">// 42.350> 1.2 handle: Mike</span>
<span class="token comment" spellcheck="true">// 42.445> 1.2 handle: Jack</span>
<span class="token comment" spellcheck="true">// 42.446> 1.2 err: myerr</span>
<span class="token comment" spellcheck="true">// 42.555> 1.2 handle: Freewind</span>

<span class="token comment" spellcheck="true">/**
 * ä¸eachç›¸ä¼¼ï¼Œä½†ä¸æ˜¯å¹¶è¡Œæ‰§è¡Œã€‚è€Œæ˜¯ä¸€ä¸ªä¸ªæŒ‰é¡ºåºæ‰§è¡Œã€‚
 */</span>
<span class="token keyword">async</span><span class="token punctuation">.</span><span class="token function">eachSeries</span><span class="token punctuation">(</span>arr<span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>item<span class="token punctuation">,</span> callback<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.3 enter: '</span> <span class="token operator">+</span> item<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.3 handle: '</span> <span class="token operator">+</span> item<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">callback</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> item<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> item<span class="token punctuation">.</span>delay<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.3 err: '</span> <span class="token operator">+</span> err<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">// 42.247> 1.3 enter: Jack</span>
<span class="token comment" spellcheck="true">// 42.459> 1.3 handle: Jack</span>
<span class="token comment" spellcheck="true">// 42.459> 1.3 enter: Mike</span>
<span class="token comment" spellcheck="true">// 42.569> 1.3 handle: Mike</span>
<span class="token comment" spellcheck="true">// 42.569> 1.3 enter: Freewind</span>
<span class="token comment" spellcheck="true">// 42.883> 1.3 handle: Freewind</span>
<span class="token comment" spellcheck="true">// 42.883> 1.3 err: undefined</span>

<span class="token comment" spellcheck="true">/**
 * å¦‚æœä¸­é€”å‡ºé”™ï¼Œåˆ™é©¬ä¸ŠæŠŠé”™è¯¯ä¼ ç»™æœ€ç»ˆçš„callbackï¼Œè¿˜æœªæ‰§è¡Œçš„ä¸å†æ‰§è¡Œã€‚
 */</span>
<span class="token keyword">async</span><span class="token punctuation">.</span><span class="token function">eachSeries</span><span class="token punctuation">(</span>arr<span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span>item<span class="token punctuation">,</span> callback<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.4 enter: '</span> <span class="token operator">+</span>item<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.4 handle: '</span> <span class="token operator">+</span> item<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>item<span class="token punctuation">.</span>name<span class="token operator">===</span><span class="token string">'Jack'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">callback</span><span class="token punctuation">(</span><span class="token string">'myerr'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> item<span class="token punctuation">.</span>delay<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.4 err: '</span> <span class="token operator">+</span> err<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">// 42.247> 1.4 enter: Jack</span>
<span class="token comment" spellcheck="true">// 42.460> 1.4 handle: Jack</span>
<span class="token comment" spellcheck="true">// 42.460> 1.4 err: myerr</span>

<span class="token comment" spellcheck="true">/**
 * åˆ†æ‰¹æ‰§è¡Œï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯æ¯ä¸€æ‰¹çš„ä¸ªæ•°ã€‚æ¯ä¸€æ‰¹å†…å¹¶è¡Œæ‰§è¡Œï¼Œä½†æ‰¹ä¸æ‰¹ä¹‹é—´æŒ‰é¡ºåºæ‰§è¡Œã€‚
 */</span>
<span class="token keyword">async</span><span class="token punctuation">.</span><span class="token function">eachLimit</span><span class="token punctuation">(</span>arr<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>item<span class="token punctuation">,</span> callback<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.5 enter: '</span> <span class="token operator">+</span> item<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.5 handle: '</span> <span class="token operator">+</span> item<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">callback</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> item<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> item<span class="token punctuation">.</span>delay<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.5 err: '</span> <span class="token operator">+</span> err<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">// 42.247> 1.5 enter: Jack</span>
<span class="token comment" spellcheck="true">// 42.248> 1.5 enter: Mike</span>
<span class="token comment" spellcheck="true">// 42.351> 1.5 handle: Mike</span>
<span class="token comment" spellcheck="true">// 42.352> 1.5 enter: Freewind</span>
<span class="token comment" spellcheck="true">// 42.461> 1.5 handle: Jack</span>
<span class="token comment" spellcheck="true">// 42.664> 1.5 handle: Freewind</span>
<span class="token comment" spellcheck="true">// 42.664> 1.5 err: undefined</span>

<span class="token comment" spellcheck="true">/**
 * å¦‚æœä¸­é€”å‡ºé”™ï¼Œé”™è¯¯å°†é©¬ä¸Šä¼ ç»™æœ€ç»ˆçš„callbackã€‚åŒä¸€æ‰¹ä¸­çš„æœªæ‰§è¡Œå®Œçš„ä»»åŠ¡è¿˜å°†ç»§ç»­æ‰§è¡Œï¼Œä½†ä¸‹ä¸€æ‰¹åŠä»¥åçš„ä¸å†æ‰§è¡Œã€‚
 */</span>
<span class="token keyword">async</span><span class="token punctuation">.</span><span class="token function">eachLimit</span><span class="token punctuation">(</span>arr<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span>item<span class="token punctuation">,</span> callback<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.6 enter: '</span> <span class="token operator">+</span>item<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.6 handle: '</span> <span class="token operator">+</span> item<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>item<span class="token punctuation">.</span>name<span class="token operator">===</span><span class="token string">'Jack'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">callback</span><span class="token punctuation">(</span><span class="token string">'myerr'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> item<span class="token punctuation">.</span>delay<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.6 err: '</span> <span class="token operator">+</span> err<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">// 42.248> 1.6 enter: Jack</span>
<span class="token comment" spellcheck="true">// 42.248> 1.6 enter: Mike</span>
<span class="token comment" spellcheck="true">// 42.352> 1.6 handle: Mike</span>
<span class="token comment" spellcheck="true">// 42.462> 1.6 handle: Jack</span>
<span class="token comment" spellcheck="true">// 42.462> 1.6 err: myerr</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><a name="every"></a><br><br></p>
<h3 id="everyä»£ç æ¼”ç¤º"><a href="#everyä»£ç æ¼”ç¤º" class="headerlink" title="everyä»£ç æ¼”ç¤º"></a><code>every</code>ä»£ç æ¼”ç¤º</h3><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">var</span> <span class="token keyword">async</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'async'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> t <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./t'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> log <span class="token operator">=</span> t<span class="token punctuation">.</span>log<span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">/**
 * å¦‚æœé›†åˆé‡Œæ¯ä¸€ä¸ªå…ƒç´ éƒ½æ»¡è¶³æ¡ä»¶ï¼Œåˆ™ä¼ ç»™æœ€ç»ˆå›è°ƒçš„resultä¸ºtrueï¼Œå¦åˆ™ä¸ºfalse
 */</span>
<span class="token comment" spellcheck="true">// every(arr, iterator(item,callback), callback(result))</span>
<span class="token comment" spellcheck="true">//alias: all</span>

<span class="token keyword">var</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">/**
 * ä¸²è¡Œæ‰§è¡Œï¼Œé›†åˆä¸­æ‰€æœ‰çš„å…ƒç´ éƒ½&lt;=10ï¼Œæ‰€ä»¥ä¸ºtrue
 */</span>
<span class="token keyword">async</span><span class="token punctuation">.</span><span class="token function">every</span><span class="token punctuation">(</span>arr<span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>item<span class="token punctuation">,</span>callback<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.1 enter: '</span><span class="token punctuation">,</span>item<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.1 handle: '</span><span class="token punctuation">,</span>item<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">callback</span><span class="token punctuation">(</span>item<span class="token operator">&lt;=</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.1 result: '</span><span class="token punctuation">,</span> result<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">// 32.113> 1.1 enter: 1</span>
<span class="token comment" spellcheck="true">// 32.123> 1.1 enter: 2</span>
<span class="token comment" spellcheck="true">// 32.123> 1.1 enter: 3</span>
<span class="token comment" spellcheck="true">// 32.123> 1.1 enter: 6</span>
<span class="token comment" spellcheck="true">// 32.233> 1.1 handle: 1</span>
<span class="token comment" spellcheck="true">// 32.233> 1.1 handle: 2</span>
<span class="token comment" spellcheck="true">// 32.233> 1.1 handle: 3</span>
<span class="token comment" spellcheck="true">// 32.233> 1.1 handle: 6</span>
<span class="token comment" spellcheck="true">// 32.233> 1.1 result: true</span>

<span class="token comment" spellcheck="true">/**
 * ä¸²è¡Œæ‰§è¡Œï¼Œé›†åˆä¸­è‡³å°‘æœ‰ä¸€ä¸ªå…ƒç´ ä¸å¤§äº2ï¼Œæ‰€ä»¥ä¸ºfalse
 */</span>
<span class="token keyword">async</span><span class="token punctuation">.</span><span class="token function">every</span><span class="token punctuation">(</span>arr<span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>item<span class="token punctuation">,</span>callback<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.2 enter: '</span><span class="token punctuation">,</span>item<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.2 handle: '</span><span class="token punctuation">,</span>item<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">callback</span><span class="token punctuation">(</span>item<span class="token operator">></span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.2 result: '</span><span class="token punctuation">,</span> result<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">// 32.123> 1.2 enter: 1</span>
<span class="token comment" spellcheck="true">// 32.123> 1.2 enter: 2</span>
<span class="token comment" spellcheck="true">// 32.123> 1.2 enter: 3</span>
<span class="token comment" spellcheck="true">// 32.123> 1.2 enter: 6</span>
<span class="token comment" spellcheck="true">// 32.233> 1.2 handle: 1</span>
<span class="token comment" spellcheck="true">// 32.233> 1.2 result: false</span>
<span class="token comment" spellcheck="true">// 32.233> 1.2 handle: 2</span>
<span class="token comment" spellcheck="true">// 32.233> 1.2 handle: 3</span>
<span class="token comment" spellcheck="true">// 32.233> 1.2 handle: 6</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><a name="filter"></a><br><br><br><code>filter</code> å’Œ <code>reject</code>ä»£ç æ¼”ç¤º</p>
<pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">var</span> <span class="token keyword">async</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'async'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> t <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./t'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> log <span class="token operator">=</span> t<span class="token punctuation">.</span>log<span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">/**
 * ä½¿ç”¨å¼‚æ­¥æ“ä½œå¯¹é›†åˆä¸­çš„å…ƒç´ è¿›è¡Œç­›é€‰ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œiteratorçš„callbackåªæœ‰ä¸€ä¸ªå‚æ•°ï¼Œåªèƒ½æ¥æ”¶trueæˆ–falseã€‚
 *
 * å¯¹äºå‡ºé”™ï¼Œè¯¥å‡½æ•°æ²¡æœ‰åšå‡ºä»»ä½•å¤„ç†ï¼Œç›´æ¥ç”±nodejsæŠ›å‡ºã€‚æ‰€ä»¥éœ€è¦æ³¨æ„å¯¹Errorçš„å¤„ç†ã€‚
 *
 * asyncæä¾›äº†ä¸¤ç§æ–¹å¼ï¼š
 * 1. å¹¶è¡Œæ‰§è¡Œï¼šfilter
 * 2. é¡ºåºæ‰§è¡Œï¼šfilterSereis
 */</span>
<span class="token comment" spellcheck="true">// filter(arr, iterator(item, callback(test)), callback(results))</span>

<span class="token keyword">var</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">/**
 * å¹¶è¡Œæ‰§è¡Œï¼Œå¯¹arrè¿›è¡Œç­›é€‰ã€‚
 */</span>
<span class="token keyword">async</span><span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>arr<span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>item<span class="token punctuation">,</span> callback<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.1 enter: '</span> <span class="token operator">+</span> item<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.1 test: '</span> <span class="token operator">+</span> item<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">callback</span><span class="token punctuation">(</span>item<span class="token operator">>=</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>results<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.1 results: '</span><span class="token punctuation">,</span> results<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">//16.739> 1.1 enter: 1</span>
<span class="token comment" spellcheck="true">//16.749> 1.1 enter: 2</span>
<span class="token comment" spellcheck="true">//16.749> 1.1 enter: 3</span>
<span class="token comment" spellcheck="true">//16.749> 1.1 enter: 4</span>
<span class="token comment" spellcheck="true">//16.749> 1.1 enter: 5</span>
<span class="token comment" spellcheck="true">//16.749> 1.3 enter: 1</span>
<span class="token comment" spellcheck="true">//16.949> 1.1 test: 1</span>
<span class="token comment" spellcheck="true">//16.949> 1.1 test: 2</span>
<span class="token comment" spellcheck="true">//16.949> 1.1 test: 3</span>
<span class="token comment" spellcheck="true">//16.949> 1.1 test: 4</span>
<span class="token comment" spellcheck="true">//16.949> 1.1 test: 5</span>
<span class="token comment" spellcheck="true">//16.949> 1.1 results: [ 3, 4, 5 ]</span>


<span class="token comment" spellcheck="true">/**
* å¦‚æœå‡ºé”™ï¼Œå°†ä¼šç”±nodejsæŠ›å‡ºï¼Œå¯¼è‡´å‡ºé”™ã€‚ä¸ºä¿è¯å…¶å®ƒä»£ç æ­£å¸¸è¿è¡Œï¼Œæ³¨é‡Šæ‰è¯¥æµ‹è¯•ã€‚
*
* try..catchï¼šæŠ“ä¸åˆ°è¿™ä¸ªé”™è¯¯
*/</span>
<span class="token comment" spellcheck="true">/*
async.filter(arr, function(item, callback) {
    log('1.2 enter: ' + item);
    setTimeout(function() {
        log('1.2 handle: ' + item);
        if(item===2) {
            throw new Error('myerr');
        }
        callback(item>=3);
    }, 100);
}, function(results) {
    log('1.2 results: ', results);
});
*/</span>

<span class="token comment" spellcheck="true">/**
* ä¸²è¡Œæ‰§è¡Œï¼Œå¯¹arrè¿›è¡Œç­›é€‰ã€‚
*/</span>
<span class="token comment" spellcheck="true">// 1.3</span>
<span class="token keyword">async</span><span class="token punctuation">.</span><span class="token function">filterSeries</span><span class="token punctuation">(</span>arr<span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>item<span class="token punctuation">,</span> callback<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.3 enter: '</span> <span class="token operator">+</span> item<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.3 handle: '</span> <span class="token operator">+</span> item<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">callback</span><span class="token punctuation">(</span>item<span class="token operator">>=</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>results<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.3 results: '</span><span class="token punctuation">,</span> results<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">// 16.749> 1.3 enter: 1</span>
<span class="token comment" spellcheck="true">// 16.949> 1.3 handle: 1</span>
<span class="token comment" spellcheck="true">// 16.949> 1.3 enter: 2</span>
<span class="token comment" spellcheck="true">// 17.149> 1.3 handle: 2</span>
<span class="token comment" spellcheck="true">// 17.149> 1.3 enter: 3</span>
<span class="token comment" spellcheck="true">// 17.369> 1.3 handle: 3</span>
<span class="token comment" spellcheck="true">// 17.369> 1.3 enter: 4</span>
<span class="token comment" spellcheck="true">// 17.589> 1.3 handle: 4</span>
<span class="token comment" spellcheck="true">// 17.589> 1.3 enter: 5</span>
<span class="token comment" spellcheck="true">// 17.789> 1.3 handle: 5</span>
<span class="token comment" spellcheck="true">// 17.789> 1.3 results: [ 3, 4, 5 ]</span>
<span class="token comment" spellcheck="true">/*
* rejectè·Ÿfilteræ­£å¥½ç›¸åï¼Œå½“æµ‹è¯•ä¸ºtrueæ—¶ï¼ŒæŠ›å¼ƒä¹‹
*/</span>
<span class="token comment" spellcheck="true">// reject(arr, iterator(item, callback(test)), callback(results)</span>
<span class="token keyword">async</span><span class="token punctuation">.</span><span class="token function">reject</span><span class="token punctuation">(</span>arr<span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>item<span class="token punctuation">,</span> callback<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.4 enter: '</span> <span class="token operator">+</span> item<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.4 test: '</span> <span class="token operator">+</span> item<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">callback</span><span class="token punctuation">(</span>item<span class="token operator">>=</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>results<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.4 results: '</span><span class="token punctuation">,</span> results<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">// 31.359> 1.4 enter: 1</span>
<span class="token comment" spellcheck="true">// 31.359> 1.4 enter: 2</span>
<span class="token comment" spellcheck="true">// 31.359> 1.4 enter: 3</span>
<span class="token comment" spellcheck="true">// 31.359> 1.4 enter: 4</span>
<span class="token comment" spellcheck="true">// 31.359> 1.4 enter: 5</span>
<span class="token comment" spellcheck="true">// 31.559> 1.4 test: 1</span>
<span class="token comment" spellcheck="true">// 31.559> 1.4 test: 2</span>
<span class="token comment" spellcheck="true">// 31.559> 1.4 test: 3</span>
<span class="token comment" spellcheck="true">// 31.559> 1.4 test: 4</span>
<span class="token comment" spellcheck="true">// 31.559> 1.4 test: 5</span>
<span class="token comment" spellcheck="true">// 31.569> 1.4 results: [ 1, 2 ]</span>


<span class="token comment" spellcheck="true">/**
 * ä¸²è¡Œæ‰§è¡Œï¼Œå¯¹arrè¿›è¡Œç­›é€‰ã€‚
 */</span>
<span class="token comment" spellcheck="true">// 1.3</span>
<span class="token keyword">async</span><span class="token punctuation">.</span><span class="token function">rejectSeries</span><span class="token punctuation">(</span>arr<span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>item<span class="token punctuation">,</span> callback<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.5 enter: '</span> <span class="token operator">+</span> item<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.5 handle: '</span> <span class="token operator">+</span> item<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">callback</span><span class="token punctuation">(</span>item<span class="token operator">>=</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>results<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.5 results: '</span><span class="token punctuation">,</span> results<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">//43.592> 1.5 enter: 1</span>
<span class="token comment" spellcheck="true">//43.799> 1.5 handle: 1</span>
<span class="token comment" spellcheck="true">//43.800> 1.5 enter: 2</span>
<span class="token comment" spellcheck="true">//44.004> 1.5 handle: 2</span>
<span class="token comment" spellcheck="true">//44.007> 1.5 enter: 3</span>
<span class="token comment" spellcheck="true">//44.210> 1.5 handle: 3</span>
<span class="token comment" spellcheck="true">//44.211> 1.5 enter: 4</span>
<span class="token comment" spellcheck="true">//44.412> 1.5 handle: 4</span>
<span class="token comment" spellcheck="true">//44.413> 1.5 enter: 5</span>
<span class="token comment" spellcheck="true">//44.614> 1.5 handle: 5</span>
<span class="token comment" spellcheck="true">//44.616> 1.5 results: [ 1, 2 ]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><a name="iterator"></a><br><br></p>
<h3 id="iteratorä»£ç æ¼”ç¤º"><a href="#iteratorä»£ç æ¼”ç¤º" class="headerlink" title="iteratorä»£ç æ¼”ç¤º"></a><code>iterator</code>ä»£ç æ¼”ç¤º</h3><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">var</span> <span class="token keyword">async</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'async'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> t <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./t'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> log <span class="token operator">=</span> t<span class="token punctuation">.</span>log<span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">/**
 * å°†ä¸€ç»„å‡½æ•°åŒ…è£…æˆä¸ºä¸€ä¸ªiteratorï¼Œåˆæ¬¡è°ƒç”¨æ­¤iteratoræ—¶ï¼Œä¼šæ‰§è¡Œå®šä¹‰ä¸­çš„ç¬¬ä¸€ä¸ªå‡½æ•°å¹¶è¿”å›ç¬¬äºŒä¸ªå‡½æ•°ä»¥ä¾›è°ƒç”¨ã€‚
 * ä¹Ÿå¯é€šè¿‡æ‰‹åŠ¨è°ƒç”¨ next() å¾—åˆ°ä»¥ä¸‹ä¸€ä¸ªå‡½æ•°ä¸ºèµ·ç‚¹çš„æ–°çš„iteratorã€‚
 * è¯¥å‡½æ•°é€šå¸¸ç”±asyncåœ¨å†…éƒ¨ä½¿ç”¨ï¼Œä½†å¦‚æœéœ€è¦æ—¶ï¼Œä¹Ÿå¯åœ¨æˆ‘ä»¬çš„ä»£ç ä¸­ä½¿ç”¨å®ƒã€‚
 */</span>
<span class="token comment" spellcheck="true">// async.iterator(tasks)</span>

<span class="token keyword">var</span> iter <span class="token operator">=</span> <span class="token keyword">async</span><span class="token punctuation">.</span><span class="token function">iterator</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
    <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'I am 111'</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'I am 222'</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'I am 333'</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">/**
* ç›´æ¥è°ƒç”¨()ï¼Œä¼šæ‰§è¡Œå½“å‰å‡½æ•°ï¼Œå¹¶è¿”å›ä¸€ä¸ªç”±ä¸‹ä¸ªå‡½æ•°ä¸ºèµ·ç‚¹çš„æ–°çš„iterator
*/</span>
<span class="token comment" spellcheck="true">//1.1</span>
<span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.1 iter()'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> it1 <span class="token operator">=</span> <span class="token function">iter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">it1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">it1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">//28.368> 1.1 iter()</span>
<span class="token comment" spellcheck="true">//28.371> I am 111</span>
<span class="token comment" spellcheck="true">//28.372> I am 222</span>
<span class="token comment" spellcheck="true">//28.372> I am 222</span>

<span class="token comment" spellcheck="true">/**
* é€šè¿‡iter()æ¥è°ƒç”¨ä¸‹ä¸€ä¸ªå‡½æ•°
*/</span>
<span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.2 iter()'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> it2 <span class="token operator">=</span> <span class="token function">iter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> it3 <span class="token operator">=</span> <span class="token function">it2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> it4 <span class="token operator">=</span> <span class="token function">it3</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">//it4(); // è¿™å¥ä»£ç æ‰§è¡Œä¼šæŠ¥é”™</span>
<span class="token function">log</span><span class="token punctuation">(</span>it4<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// => 'null'</span>
<span class="token comment" spellcheck="true">//32.449> 1.2 iter()</span>
<span class="token comment" spellcheck="true">//32.452> I am 111</span>
<span class="token comment" spellcheck="true">//32.452> I am 222</span>
<span class="token comment" spellcheck="true">//32.453> I am 333</span>
<span class="token comment" spellcheck="true">//32.454> null</span>

<span class="token comment" spellcheck="true">/**
 * è°ƒç”¨next()ï¼Œä¸ä¼šæ‰§è¡Œå½“å‰å‡½æ•°ï¼Œç›´æ¥è¿”å›ç”±ä¸‹ä¸ªå‡½æ•°ä¸ºèµ·ç‚¹çš„æ–°iterator
 * å¯¹äºåŒä¸€ä¸ªiteratorï¼Œå¤šæ¬¡è°ƒç”¨next()ï¼Œä¸ä¼šå½±å“è‡ªå·±
 */</span>
<span class="token comment" spellcheck="true">//1.3</span>
<span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.3 iter()'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> it5 <span class="token operator">=</span> iter<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">it5</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> it6 <span class="token operator">=</span> iter<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">it6</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">iter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">//39.895> 1.3 iter()</span>
<span class="token comment" spellcheck="true">//39.898> I am 222</span>
<span class="token comment" spellcheck="true">//39.899> I am 333</span>
<span class="token comment" spellcheck="true">//39.899> I am 111</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><a name="map"></a><br><br></p>
<h3 id="mapä»£ç æ¼”ç¤º"><a href="#mapä»£ç æ¼”ç¤º" class="headerlink" title="mapä»£ç æ¼”ç¤º"></a><code>map</code>ä»£ç æ¼”ç¤º</h3><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">var</span> <span class="token keyword">async</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'async'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> t <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./t'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> log <span class="token operator">=</span> t<span class="token punctuation">.</span>log<span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">/**
 * å¯¹é›†åˆä¸­çš„æ¯ä¸€ä¸ªå…ƒç´ ï¼Œæ‰§è¡ŒæŸä¸ªå¼‚æ­¥æ“ä½œï¼Œå¾—åˆ°ç»“æœã€‚æ‰€æœ‰çš„ç»“æœå°†æ±‡æ€»åˆ°æœ€ç»ˆçš„callbacké‡Œã€‚ä¸eachçš„åŒºåˆ«æ˜¯ï¼Œeachåªå…³å¿ƒæ“ä½œä¸ç®¡æœ€åçš„å€¼ï¼Œè€Œmapå…³å¿ƒçš„æœ€åäº§ç”Ÿçš„å€¼ã€‚
 *
 * æä¾›äº†ä¸¤ç§æ–¹å¼ï¼š
 * 1. å¹¶è¡Œæ‰§è¡Œã€‚åŒæ—¶å¯¹é›†åˆä¸­æ‰€æœ‰å…ƒç´ è¿›è¡Œæ“ä½œï¼Œç»“æœæ±‡æ€»åˆ°æœ€ç»ˆcallbacké‡Œã€‚å¦‚æœå‡ºé”™ï¼Œåˆ™ç«‹åˆ»è¿”å›é”™è¯¯ä»¥åŠå·²ç»æ‰§è¡Œå®Œçš„ä»»åŠ¡çš„ç»“æœï¼Œæœªæ‰§è¡Œå®Œçš„å ä¸ªç©ºä½
 * 2. é¡ºåºæ‰§è¡Œã€‚å¯¹é›†åˆä¸­çš„å…ƒç´ ä¸€ä¸ªä¸€ä¸ªæ‰§è¡Œæ“ä½œï¼Œç»“æœæ±‡æ€»åˆ°æœ€ç»ˆcallbacké‡Œã€‚å¦‚æœå‡ºé”™ï¼Œåˆ™ç«‹åˆ»è¿”å›é”™è¯¯ä»¥åŠå·²ç»æ‰§è¡Œå®Œçš„ç»“æœï¼Œæœªæ‰§è¡Œçš„è¢«å¿½ç•¥ã€‚
 */</span>
<span class="token comment" spellcheck="true">// map(arr, iterator(item, callback), callback(err, results))</span>

<span class="token keyword">var</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>name<span class="token punctuation">:</span><span class="token string">'Jack'</span><span class="token punctuation">,</span> delay<span class="token punctuation">:</span><span class="token number">200</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>name<span class="token punctuation">:</span><span class="token string">'Mike'</span><span class="token punctuation">,</span> delay<span class="token punctuation">:</span> <span class="token number">100</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>name<span class="token punctuation">:</span><span class="token string">'Freewind'</span><span class="token punctuation">,</span> delay<span class="token punctuation">:</span><span class="token number">300</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>name<span class="token punctuation">:</span><span class="token string">'Test'</span><span class="token punctuation">,</span> delay<span class="token punctuation">:</span> <span class="token number">50</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">/**
 * æ‰€æœ‰æ“ä½œå‡æ­£ç¡®æ‰§è¡Œï¼Œæœªå‡ºé”™ã€‚æ‰€æœ‰ç»“æœæŒ‰å…ƒç´ é¡ºåºæ±‡æ€»ç»™æœ€ç»ˆçš„callbackã€‚
 */</span>
<span class="token comment" spellcheck="true">// 1.1</span>
<span class="token keyword">async</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>arr<span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>item<span class="token punctuation">,</span> callback<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.1 enter: '</span> <span class="token operator">+</span> item<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.1 handle: '</span> <span class="token operator">+</span> item<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">callback</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> item<span class="token punctuation">.</span>name <span class="token operator">+</span> <span class="token string">'!!!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> item<span class="token punctuation">.</span>delay<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span>results<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.1 err: '</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.1 results: '</span><span class="token punctuation">,</span> results<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">// 54.569> 1.1 enter: Jack</span>
<span class="token comment" spellcheck="true">// 54.569> 1.1 enter: Mike</span>
<span class="token comment" spellcheck="true">// 54.569> 1.1 enter: Freewind</span>
<span class="token comment" spellcheck="true">// 54.569> 1.1 enter: Test</span>
<span class="token comment" spellcheck="true">// 54.629> 1.1 handle: Test</span>
<span class="token comment" spellcheck="true">// 54.679> 1.1 handle: Mike</span>
<span class="token comment" spellcheck="true">// 54.789> 1.1 handle: Jack</span>
<span class="token comment" spellcheck="true">// 54.879> 1.1 handle: Freewind</span>
<span class="token comment" spellcheck="true">// 54.879> 1.1 err:</span>
<span class="token comment" spellcheck="true">// 54.879> 1.1 results: [ 'Jack!!!', 'Mike!!!', 'Freewind!!!', 'Test!!!' ]</span>

<span class="token comment" spellcheck="true">/**
*  å¦‚æœä¸­é€”å‡ºé”™ï¼Œç«‹åˆ»å°†é”™è¯¯ã€ä»¥åŠå·²ç»æ‰§è¡Œå®Œæˆçš„ç»“æœæ±‡æ€»ç»™æœ€ç»ˆcallbackã€‚æœªæ‰§è¡Œå®Œçš„å°†ä¼šåœ¨ç»“æœæ•°ç»„ä¸­ç”¨å ä¸ªç©ºä½ã€‚
*/</span>
<span class="token keyword">async</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>arr<span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>item<span class="token punctuation">,</span> callback<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.2 enter: '</span> <span class="token operator">+</span> item<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.2 handle: '</span> <span class="token operator">+</span> item<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>item<span class="token punctuation">.</span>name<span class="token operator">===</span><span class="token string">'Jack'</span><span class="token punctuation">)</span> <span class="token function">callback</span><span class="token punctuation">(</span><span class="token string">'myerr'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">else</span> <span class="token function">callback</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> item<span class="token punctuation">.</span>name<span class="token operator">+</span><span class="token string">'!!!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> item<span class="token punctuation">.</span>delay<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> results<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.2 err: '</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.2 results: '</span><span class="token punctuation">,</span> results<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">// 54.569> 1.2 enter: Jack</span>
<span class="token comment" spellcheck="true">// 54.569> 1.2 enter: Mike</span>
<span class="token comment" spellcheck="true">// 54.569> 1.2 enter: Freewind</span>
<span class="token comment" spellcheck="true">// 54.569> 1.2 enter: Test</span>
<span class="token comment" spellcheck="true">// 54.629> 1.2 handle: Test</span>
<span class="token comment" spellcheck="true">// 54.679> 1.2 handle: Mike</span>
<span class="token comment" spellcheck="true">// 54.789> 1.2 handle: Jack</span>
<span class="token comment" spellcheck="true">// 54.789> 1.2 err: myerr</span>
<span class="token comment" spellcheck="true">// 54.789> 1.2 results: [ undefined, 'Mike!!!', , 'Test!!!' ]</span>
<span class="token comment" spellcheck="true">// 54.879> 1.2 handle: Freewind</span>

<span class="token comment" spellcheck="true">/**
* é¡ºåºæ‰§è¡Œï¼Œä¸€ä¸ªå®Œäº†æ‰æ‰§è¡Œä¸‹ä¸€ä¸ªã€‚
*/</span>
<span class="token keyword">async</span><span class="token punctuation">.</span><span class="token function">mapSeries</span><span class="token punctuation">(</span>arr<span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>item<span class="token punctuation">,</span> callback<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.3 enter: '</span> <span class="token operator">+</span> item<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.3 handle: '</span> <span class="token operator">+</span> item<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">callback</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> item<span class="token punctuation">.</span>name<span class="token operator">+</span><span class="token string">'!!!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> item<span class="token punctuation">.</span>delay<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span>results<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.3 err: '</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.3 results: '</span><span class="token punctuation">,</span> results<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">// 54.569> 1.3 enter: Jack</span>
<span class="token comment" spellcheck="true">// 54.789> 1.3 handle: Jack</span>
<span class="token comment" spellcheck="true">// 54.789> 1.3 enter: Mike</span>
<span class="token comment" spellcheck="true">// 54.899> 1.3 handle: Mike</span>
<span class="token comment" spellcheck="true">// 54.899> 1.3 enter: Freewind</span>
<span class="token comment" spellcheck="true">// 55.209> 1.3 handle: Freewind</span>
<span class="token comment" spellcheck="true">// 55.209> 1.3 enter: Test</span>
<span class="token comment" spellcheck="true">// 55.269> 1.3 handle: Test</span>
<span class="token comment" spellcheck="true">// 55.269> 1.3 err:</span>
<span class="token comment" spellcheck="true">// 55.269> 1.3 results: [ 'Jack!!!', 'Mike!!!', 'Freewind!!!', 'Test!!!' ]</span>

<span class="token comment" spellcheck="true">/**
* é¡ºåºæ‰§è¡Œè¿‡ç¨‹ä¸­å‡ºé”™ï¼ŒåªæŠŠé”™è¯¯ä»¥åŠæ‰§è¡Œå®Œçš„ä¼ ç»™æœ€ç»ˆcallbackï¼Œæœªæ‰§è¡Œçš„å¿½ç•¥ã€‚
*/</span>
<span class="token keyword">async</span><span class="token punctuation">.</span><span class="token function">mapSeries</span><span class="token punctuation">(</span>arr<span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>item<span class="token punctuation">,</span> callback<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.4 enter: '</span> <span class="token operator">+</span> item<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.4 handle: '</span> <span class="token operator">+</span> item<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>item<span class="token punctuation">.</span>name<span class="token operator">===</span><span class="token string">'Mike'</span><span class="token punctuation">)</span> <span class="token function">callback</span><span class="token punctuation">(</span><span class="token string">'myerr'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">else</span> <span class="token function">callback</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> item<span class="token punctuation">.</span>name<span class="token operator">+</span><span class="token string">'!!!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> item<span class="token punctuation">.</span>delay<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> results<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.4 err: '</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.4 results: '</span><span class="token punctuation">,</span> results<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">// 47.616> 1.4 enter: Jack</span>
<span class="token comment" spellcheck="true">// 47.821> 1.4 handle: Jack</span>
<span class="token comment" spellcheck="true">// 47.821> 1.4 enter: Mike</span>
<span class="token comment" spellcheck="true">// 47.931> 1.4 handle: Mike</span>
<span class="token comment" spellcheck="true">// 47.931> 1.4 err: myerr</span>
<span class="token comment" spellcheck="true">// 47.932> 1.4 results: [ 'Jack!!!', undefined ]</span>

<span class="token comment" spellcheck="true">/**
 * å¹¶è¡Œæ‰§è¡Œï¼ŒåŒæ—¶æœ€å¤š2ä¸ªå‡½æ•°å¹¶è¡Œï¼Œä¼ ç»™æœ€ç»ˆcallbackã€‚
 */</span>
<span class="token comment" spellcheck="true">//1.5</span>
<span class="token keyword">async</span><span class="token punctuation">.</span><span class="token function">mapLimit</span><span class="token punctuation">(</span>arr<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>item<span class="token punctuation">,</span> callback<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.5 enter: '</span> <span class="token operator">+</span> item<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.5 handle: '</span> <span class="token operator">+</span> item<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>item<span class="token punctuation">.</span>name<span class="token operator">===</span><span class="token string">'Jack'</span><span class="token punctuation">)</span> <span class="token function">callback</span><span class="token punctuation">(</span><span class="token string">'myerr'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">else</span> <span class="token function">callback</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> item<span class="token punctuation">.</span>name<span class="token operator">+</span><span class="token string">'!!!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> item<span class="token punctuation">.</span>delay<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> results<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.5 err: '</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.5 results: '</span><span class="token punctuation">,</span> results<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">//57.797> 1.5 enter: Jack</span>
<span class="token comment" spellcheck="true">//57.800> 1.5 enter: Mike</span>
<span class="token comment" spellcheck="true">//57.900> 1.5 handle: Mike</span>
<span class="token comment" spellcheck="true">//57.900> 1.5 enter: Freewind</span>
<span class="token comment" spellcheck="true">//58.008> 1.5 handle: Jack</span>
<span class="token comment" spellcheck="true">//58.009> 1.5 err: myerr</span>
<span class="token comment" spellcheck="true">//58.009> 1.5 results: [ undefined, 'Mike!!!' ]</span>
<span class="token comment" spellcheck="true">//58.208> 1.5 handle: Freewind</span>
<span class="token comment" spellcheck="true">//58.208> 1.5 enter: Test</span>
<span class="token comment" spellcheck="true">//58.273> 1.5 handle: Test</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><a name="nextTick"></a><br><br></p>
<h3 id="nextTickä»£ç æ¼”ç¤º"><a href="#nextTickä»£ç æ¼”ç¤º" class="headerlink" title="nextTickä»£ç æ¼”ç¤º"></a><code>nextTick</code>ä»£ç æ¼”ç¤º</h3><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">var</span> <span class="token keyword">async</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'async'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> t <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./t'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> log <span class="token operator">=</span> t<span class="token punctuation">.</span>log<span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">/**
 * nextTickçš„ä½œç”¨ä¸nodejsçš„nextTickä¸€æ ·ï¼Œå†æœ€åè°ƒç”¨å‡½æ•°ã€‚
 * ä½†åœ¨æµè§ˆå™¨ç«¯ï¼Œåªèƒ½ä½¿ç”¨setTimeout(callback,0)ï¼Œä½†è¿™ä¸ªæ–¹æ³•æœ‰æ—¶å€™ä¼šè®©å…¶å®ƒé«˜ä¼˜å…ˆçº§çš„ä»»åŠ¡æ’åˆ°å‰é¢å»ã€‚
 * æ‰€ä»¥æä¾›äº†è¿™ä¸ªnextTickï¼Œè®©åŒæ ·çš„ä»£ç åœ¨æœåŠ¡å™¨ç«¯å’Œæµè§ˆå™¨ç«¯è¡¨ç°ä¸€è‡´ã€‚
 */</span>
<span class="token comment" spellcheck="true">// nextTick(callback)</span>

<span class="token keyword">var</span> calls <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">async</span><span class="token punctuation">.</span><span class="token function">nextTick</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    calls<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">'two'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">async</span><span class="token punctuation">.</span><span class="token function">nextTick</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.1'</span><span class="token punctuation">,</span>calls<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
calls<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">'one'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.2'</span><span class="token punctuation">,</span>calls<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">async</span><span class="token punctuation">.</span><span class="token function">nextTick</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.3'</span><span class="token punctuation">,</span>calls<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">//09.838> 1.2[ 'one' ]</span>
<span class="token comment" spellcheck="true">//09.842> 1.1[ 'one', 'two' ]</span>
<span class="token comment" spellcheck="true">//09.843> 1.3[ 'one', 'two' ]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><a name="parallel"></a><br><br></p>
<h3 id="parallelä»£ç æ¼”ç¤º"><a href="#parallelä»£ç æ¼”ç¤º" class="headerlink" title="parallelä»£ç æ¼”ç¤º"></a><code>parallel</code>ä»£ç æ¼”ç¤º</h3><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">var</span> <span class="token keyword">async</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'async'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> t <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./t'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> log <span class="token operator">=</span> t<span class="token punctuation">.</span>log<span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">/**
 * å¹¶è¡Œæ‰§è¡Œå¤šä¸ªå‡½æ•°ï¼Œæ¯ä¸ªå‡½æ•°éƒ½æ˜¯ç«‹å³æ‰§è¡Œï¼Œä¸éœ€è¦ç­‰å¾…å…¶å®ƒå‡½æ•°å…ˆæ‰§è¡Œã€‚ä¼ ç»™æœ€ç»ˆcallbackçš„æ•°ç»„ä¸­çš„æ•°æ®æŒ‰ç…§tasksä¸­å£°æ˜çš„é¡ºåºï¼Œè€Œä¸æ˜¯æ‰§è¡Œå®Œæˆçš„é¡ºåºã€‚
 *
 * å¦‚æœæŸä¸ªå‡½æ•°å‡ºé”™ï¼Œåˆ™ç«‹åˆ»å°†errå’Œå·²ç»æ‰§è¡Œå®Œçš„å‡½æ•°çš„ç»“æœå€¼ä¼ ç»™parallelæœ€ç»ˆçš„callbackã€‚å…¶å®ƒæœªæ‰§è¡Œå®Œçš„å‡½æ•°çš„å€¼ä¸ä¼šä¼ åˆ°æœ€ç»ˆæ•°æ®ï¼Œä½†è¦å ä¸ªä½ç½®ã€‚
 * åŒæ—¶æ”¯æŒjsonå½¢å¼çš„tasksï¼Œå…¶æœ€ç»ˆcallbackçš„ç»“æœä¹Ÿä¸ºjsonå½¢å¼ã€‚
 */</span>
<span class="token comment" spellcheck="true">// parallel(tasks, [callback])</span>

<span class="token comment" spellcheck="true">/**
 * å¹¶è¡Œæ‰§è¡Œå¤šä¸ªå‡½æ•°ï¼Œæ¯ä¸ªå‡½æ•°çš„å€¼å°†æŒ‰å‡½æ•°å£°æ˜çš„å…ˆåé¡ºåºæ±‡æˆä¸€ä¸ªæ•°ç»„ï¼Œä¼ ç»™æœ€ç»ˆcallbackã€‚
 */</span>
<span class="token comment" spellcheck="true">// 1.1</span>
<span class="token keyword">async</span><span class="token punctuation">.</span><span class="token function">parallel</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
    <span class="token keyword">function</span><span class="token punctuation">(</span>cb<span class="token punctuation">)</span> <span class="token punctuation">{</span> t<span class="token punctuation">.</span><span class="token function">fire</span><span class="token punctuation">(</span><span class="token string">'a400'</span><span class="token punctuation">,</span> cb<span class="token punctuation">,</span> <span class="token number">400</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token keyword">function</span><span class="token punctuation">(</span>cb<span class="token punctuation">)</span> <span class="token punctuation">{</span> t<span class="token punctuation">.</span><span class="token function">fire</span><span class="token punctuation">(</span><span class="token string">'a200'</span><span class="token punctuation">,</span> cb<span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token keyword">function</span><span class="token punctuation">(</span>cb<span class="token punctuation">)</span> <span class="token punctuation">{</span> t<span class="token punctuation">.</span><span class="token function">fire</span><span class="token punctuation">(</span><span class="token string">'a300'</span><span class="token punctuation">,</span> cb<span class="token punctuation">,</span> <span class="token number">300</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>
<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>err<span class="token punctuation">,</span> results<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.1 err: '</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.1 results: '</span><span class="token punctuation">,</span> results<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">//36.929> 1.1 err: null</span>
<span class="token comment" spellcheck="true">//36.930> 1.1 results: [ 'a400', 'a200', 'a300' ]</span>

<span class="token comment" spellcheck="true">/**
* å¦‚æœä¸­é€”æœ‰ä¸ªå‡½æ•°å‡ºé”™ï¼Œåˆ™å°†è¯¥errå’Œå·²ç»å®Œæˆçš„å‡½æ•°å€¼æ±‡æˆä¸€ä¸ªæ•°ç»„ï¼Œä¼ ç»™æœ€ç»ˆçš„callbackã€‚è¿˜æ²¡æœ‰æ‰§è¡Œå®Œçš„å‡½æ•°çš„å€¼å°†è¢«å¿½ç•¥ï¼Œä½†è¦åœ¨æœ€ç»ˆæ•°ç»„ä¸­å ä¸ªä½ç½®
*/</span>
<span class="token comment" spellcheck="true">// 1.2</span>
<span class="token keyword">async</span><span class="token punctuation">.</span><span class="token function">parallel</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
    <span class="token keyword">function</span><span class="token punctuation">(</span>cb<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.2.1: '</span><span class="token punctuation">,</span> <span class="token string">'start'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> t<span class="token punctuation">.</span><span class="token function">fire</span><span class="token punctuation">(</span><span class="token string">'a400'</span><span class="token punctuation">,</span> cb<span class="token punctuation">,</span> <span class="token number">400</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token comment" spellcheck="true">// è¯¥å‡½æ•°çš„å€¼ä¸ä¼šä¼ ç»™æœ€ç»ˆcallbackï¼Œä½†è¦å ä¸ªä½ç½®</span>
    <span class="token keyword">function</span><span class="token punctuation">(</span>cb<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.2.2: '</span><span class="token punctuation">,</span> <span class="token string">'start'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> t<span class="token punctuation">.</span><span class="token function">err</span><span class="token punctuation">(</span><span class="token string">'e200'</span><span class="token punctuation">,</span> cb<span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token keyword">function</span><span class="token punctuation">(</span>cb<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.2.3: '</span><span class="token punctuation">,</span> <span class="token string">'start'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> t<span class="token punctuation">.</span><span class="token function">fire</span><span class="token punctuation">(</span><span class="token string">'a100'</span><span class="token punctuation">,</span> cb<span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>
<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> results<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.2 err: '</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.2 results: '</span><span class="token punctuation">,</span> results<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">//36.537> 1.2.1: start</span>
<span class="token comment" spellcheck="true">//36.540> 1.2.2: start</span>
<span class="token comment" spellcheck="true">//36.541> 1.2.3: start</span>
<span class="token comment" spellcheck="true">//36.741> 1.2 err: e200</span>
<span class="token comment" spellcheck="true">//36.744> 1.2 results: [ , undefined, 'a100' ]</span>

<span class="token comment" spellcheck="true">/**
* ä»¥jsonå½¢å¼ä¼ å…¥tasksï¼Œæœ€ç»ˆresultsä¹Ÿä¸ºjson
*/</span>
<span class="token comment" spellcheck="true">// 1.3</span>
<span class="token keyword">async</span><span class="token punctuation">.</span><span class="token function">parallel</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    a<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span>cb<span class="token punctuation">)</span> <span class="token punctuation">{</span> t<span class="token punctuation">.</span><span class="token function">fire</span><span class="token punctuation">(</span><span class="token string">'a400'</span><span class="token punctuation">,</span> cb<span class="token punctuation">,</span> <span class="token number">400</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    b<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span>cb<span class="token punctuation">)</span> <span class="token punctuation">{</span> t<span class="token punctuation">.</span><span class="token function">fire</span><span class="token punctuation">(</span><span class="token string">'c300'</span><span class="token punctuation">,</span> cb<span class="token punctuation">,</span> <span class="token number">300</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> results<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.3 err: '</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.3 results: '</span><span class="token punctuation">,</span> results<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">//36.943> 1.3 err: null</span>
<span class="token comment" spellcheck="true">//36.944> 1.3 results: { b: 'c300', a: 'a400' }</span>

<span class="token comment" spellcheck="true">/**
* å¦‚æœä¸­é€”å‡ºé”™ï¼Œä¼šå°†errä¸å·²ç»å®Œæˆçš„å‡½æ•°å€¼ï¼ˆæ±‡æˆä¸€ä¸ªjsonï¼‰ä¼ ç»™æœ€ç»ˆcallbackã€‚æœªæ‰§è¡Œå®Œæˆçš„å‡½æ•°å€¼è¢«å¿½ç•¥ï¼Œä¸ä¼šå‡ºç°åœ¨æœ€ç»ˆjsonä¸­ã€‚
*/</span>
<span class="token comment" spellcheck="true">// 1.4</span>
<span class="token keyword">async</span><span class="token punctuation">.</span><span class="token function">parallel</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    a<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span>cb<span class="token punctuation">)</span> <span class="token punctuation">{</span> t<span class="token punctuation">.</span><span class="token function">fire</span><span class="token punctuation">(</span><span class="token string">'a400'</span><span class="token punctuation">,</span> cb<span class="token punctuation">,</span> <span class="token number">400</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token comment" spellcheck="true">// è¯¥å‡½æ•°çš„å€¼ä¸ä¼šä¼ ç»™æœ€ç»ˆçš„callback</span>
    b<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span>cb<span class="token punctuation">)</span> <span class="token punctuation">{</span> t<span class="token punctuation">.</span><span class="token function">err</span><span class="token punctuation">(</span><span class="token string">'e300'</span><span class="token punctuation">,</span> cb<span class="token punctuation">,</span> <span class="token number">300</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    c<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span>cb<span class="token punctuation">)</span> <span class="token punctuation">{</span> t<span class="token punctuation">.</span><span class="token function">fire</span><span class="token punctuation">(</span><span class="token string">'c200'</span><span class="token punctuation">,</span> cb<span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> results<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.4 err: '</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.4 results: '</span><span class="token punctuation">,</span> results<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">//36.853> 1.4 err: e300</span>
<span class="token comment" spellcheck="true">//36.854> 1.4 results: { c: 'c200', b: undefined }</span>

<span class="token comment" spellcheck="true">/**
 * å¹¶è¡Œæ‰§è¡Œï¼ŒåŒæ—¶æœ€å¤š2ä¸ªå‡½æ•°å¹¶è¡Œï¼Œä¼ ç»™æœ€ç»ˆcallbackã€‚
 */</span>
<span class="token comment" spellcheck="true">//1.5</span>
<span class="token keyword">async</span><span class="token punctuation">.</span><span class="token function">parallelLimit</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    a<span class="token punctuation">:</span><span class="token keyword">function</span><span class="token punctuation">(</span>cb<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'a start'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> t<span class="token punctuation">.</span><span class="token function">fire</span><span class="token punctuation">(</span><span class="token string">'a400'</span><span class="token punctuation">,</span> cb<span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    b<span class="token punctuation">:</span><span class="token keyword">function</span><span class="token punctuation">(</span>cb<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'b start'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> t<span class="token punctuation">.</span><span class="token function">fire</span><span class="token punctuation">(</span><span class="token string">'b200'</span><span class="token punctuation">,</span> cb<span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    c<span class="token punctuation">:</span><span class="token keyword">function</span><span class="token punctuation">(</span>cb<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'c start'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> t<span class="token punctuation">.</span><span class="token function">fire</span><span class="token punctuation">(</span><span class="token string">'c100'</span><span class="token punctuation">,</span> cb<span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    d<span class="token punctuation">:</span><span class="token keyword">function</span><span class="token punctuation">(</span>cb<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'d start'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> t<span class="token punctuation">.</span><span class="token function">fire</span><span class="token punctuation">(</span><span class="token string">'d600'</span><span class="token punctuation">,</span> cb<span class="token punctuation">,</span> <span class="token number">600</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    e<span class="token punctuation">:</span><span class="token keyword">function</span><span class="token punctuation">(</span>cb<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'e start'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> t<span class="token punctuation">.</span><span class="token function">fire</span><span class="token punctuation">(</span><span class="token string">'e300'</span><span class="token punctuation">,</span> cb<span class="token punctuation">,</span> <span class="token number">300</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> results<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.5 err: '</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.5 results: '</span><span class="token punctuation">,</span> results<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">//26.993> a start</span>
<span class="token comment" spellcheck="true">//26.996> b start</span>
<span class="token comment" spellcheck="true">//27.200> c start</span>
<span class="token comment" spellcheck="true">//27.202> d start</span>
<span class="token comment" spellcheck="true">//27.313> e start</span>
<span class="token comment" spellcheck="true">//27.809> 1.5 err:</span>
<span class="token comment" spellcheck="true">//27.810> 1.5 results: { a: 'a400', b: 'b200', c: 'c100', e: 'e300', d: 'd600' }</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><a name="queue"></a><br><br></p>
<h3 id="queueä»£ç æ¼”ç¤º"><a href="#queueä»£ç æ¼”ç¤º" class="headerlink" title="queueä»£ç æ¼”ç¤º"></a><code>queue</code>ä»£ç æ¼”ç¤º</h3><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">var</span> <span class="token keyword">async</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'async'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> t <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./t'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> log <span class="token operator">=</span> t<span class="token punctuation">.</span>log<span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">/**
 * queueæ˜¯ä¸€ä¸ªä¸²è¡Œçš„æ¶ˆæ¯é˜Ÿåˆ—ï¼Œé€šè¿‡é™åˆ¶äº†workeræ•°é‡ï¼Œä¸å†ä¸€æ¬¡æ€§å…¨éƒ¨æ‰§è¡Œã€‚
 * å½“workeræ•°é‡ä¸å¤Ÿç”¨æ—¶ï¼Œæ–°åŠ å…¥çš„ä»»åŠ¡å°†ä¼šæ’é˜Ÿç­‰å€™ï¼Œç›´åˆ°æœ‰æ–°çš„workerå¯ç”¨ã€‚
 *
 * è¯¥å‡½æ•°æœ‰å¤šä¸ªç‚¹å¯ä¾›å›è°ƒï¼Œå¦‚workerç”¨å®Œæ—¶ã€æ— ç­‰å€™ä»»åŠ¡æ—¶ã€å…¨éƒ¨æ‰§è¡Œå®Œæ—¶ç­‰ã€‚
 */</span>
<span class="token comment" spellcheck="true">// queue(worker, concurrency)</span>

<span class="token comment" spellcheck="true">/**
 * å®šä¹‰ä¸€ä¸ªqueueï¼Œè®¾workeræ•°é‡ä¸º2
 */</span>
<span class="token keyword">var</span> q <span class="token operator">=</span> <span class="token keyword">async</span><span class="token punctuation">.</span><span class="token function">queue</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span>task<span class="token punctuation">,</span> callback<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'worker is processing task: '</span><span class="token punctuation">,</span> task<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    task<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span>callback<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">/**
 * ç›‘å¬ï¼šå¦‚æœæŸæ¬¡pushæ“ä½œåï¼Œä»»åŠ¡æ•°å°†è¾¾åˆ°æˆ–è¶…è¿‡workeræ•°é‡æ—¶ï¼Œå°†è°ƒç”¨è¯¥å‡½æ•°
 */</span>
q<span class="token punctuation">.</span>saturated <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'all workers to be used'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">/**
 * ç›‘å¬ï¼šå½“æœ€åä¸€ä¸ªä»»åŠ¡äº¤ç»™workeræ—¶ï¼Œå°†è°ƒç”¨è¯¥å‡½æ•°
 */</span>
q<span class="token punctuation">.</span>empty <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'no more tasks wating'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">/**
 * ç›‘å¬ï¼šå½“æ‰€æœ‰ä»»åŠ¡éƒ½æ‰§è¡Œå®Œä»¥åï¼Œå°†è°ƒç”¨è¯¥å‡½æ•°
 */</span>
q<span class="token punctuation">.</span>drain <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'all tasks have been processed'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">/**
* ç‹¬ç«‹åŠ å…¥2ä¸ªä»»åŠ¡
*/</span>
q<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span>name<span class="token punctuation">:</span><span class="token string">'t1'</span><span class="token punctuation">,</span> run<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span>cb<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'t1 is running, waiting tasks: '</span><span class="token punctuation">,</span> q<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    t<span class="token punctuation">.</span><span class="token function">fire</span><span class="token punctuation">(</span><span class="token string">'t1'</span><span class="token punctuation">,</span> cb<span class="token punctuation">,</span> <span class="token number">400</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 400msåæ‰§è¡Œ</span>
<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'t1 executed'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'pushed t1, waiting tasks: '</span><span class="token punctuation">,</span> q<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

q<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span>name<span class="token punctuation">:</span><span class="token string">'t2'</span><span class="token punctuation">,</span>run<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span>cb<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'t2 is running, waiting tasks: '</span><span class="token punctuation">,</span> q<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    t<span class="token punctuation">.</span><span class="token function">fire</span><span class="token punctuation">(</span><span class="token string">'t2'</span><span class="token punctuation">,</span> cb<span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 200msåæ‰§è¡Œ</span>
<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'t2 executed'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'pushed t2, waiting tasks: '</span><span class="token punctuation">,</span> q<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">//54.448> pushed t1, waiting tasks: 1</span>
<span class="token comment" spellcheck="true">//54.451> all workers to be used</span>
<span class="token comment" spellcheck="true">//54.452> pushed t2, waiting tasks: 2</span>
<span class="token comment" spellcheck="true">//54.452> worker is processing task: t1</span>
<span class="token comment" spellcheck="true">//54.453> t1 is running, waiting tasks: 1</span>
<span class="token comment" spellcheck="true">//54.455> no more tasks wating</span>
<span class="token comment" spellcheck="true">//54.455> worker is processing task: t2</span>
<span class="token comment" spellcheck="true">//54.455> t2 is running, waiting tasks: 0</span>
<span class="token comment" spellcheck="true">//54.656> t2 executed</span>
<span class="token comment" spellcheck="true">//54.867> t1 executed</span>
<span class="token comment" spellcheck="true">//54.868> all tasks have been processed</span>


<span class="token comment" spellcheck="true">// åŒæ—¶åŠ å…¥å¤šä¸ªä»»åŠ¡</span>
q<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
        name<span class="token punctuation">:</span><span class="token string">'t3'</span><span class="token punctuation">,</span> run<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span>cb<span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'t3 is running, waiting tasks: '</span><span class="token punctuation">,</span> q<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            t<span class="token punctuation">.</span><span class="token function">fire</span><span class="token punctuation">(</span><span class="token string">'t3'</span><span class="token punctuation">,</span> cb<span class="token punctuation">,</span> <span class="token number">300</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 300msåæ‰§è¡Œ</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span>
        name<span class="token punctuation">:</span><span class="token string">'t4'</span><span class="token punctuation">,</span> run<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span>cb<span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'t4 is running, waiting tasks: '</span><span class="token punctuation">,</span> q<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            t<span class="token punctuation">.</span><span class="token function">fire</span><span class="token punctuation">(</span><span class="token string">'t4'</span><span class="token punctuation">,</span> cb<span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 500msåæ‰§è¡Œ</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span>
        name<span class="token punctuation">:</span><span class="token string">'t5'</span><span class="token punctuation">,</span> run<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span>cb<span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'t5 is running, waiting tasks: '</span><span class="token punctuation">,</span> q<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            t<span class="token punctuation">.</span><span class="token function">fire</span><span class="token punctuation">(</span><span class="token string">'t5'</span><span class="token punctuation">,</span> cb<span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 100msåæ‰§è¡Œ</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span>
        name<span class="token punctuation">:</span><span class="token string">'t6'</span><span class="token punctuation">,</span> run<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span>cb<span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'t6 is running, waiting tasks: '</span><span class="token punctuation">,</span> q<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            t<span class="token punctuation">.</span><span class="token function">fire</span><span class="token punctuation">(</span><span class="token string">'t6'</span><span class="token punctuation">,</span> cb<span class="token punctuation">,</span> <span class="token number">400</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 400msåæ‰§è¡Œ</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'err: '</span><span class="token punctuation">,</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'pushed t3,t4,t5,t6 into queue, waiting tasks: '</span><span class="token punctuation">,</span> q<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">//53.755> all workers to be used</span>
<span class="token comment" spellcheck="true">//53.758> pushed t3,t4,t5,t6 into queue, waiting tasks: 4</span>
<span class="token comment" spellcheck="true">//53.759> worker is processing task: t3</span>
<span class="token comment" spellcheck="true">//53.760> t3 is running, waiting tasks: 3</span>
<span class="token comment" spellcheck="true">//53.762> worker is processing task: t4</span>
<span class="token comment" spellcheck="true">//53.762> t4 is running, waiting tasks: 2</span>
<span class="token comment" spellcheck="true">//54.073> err: null</span>
<span class="token comment" spellcheck="true">//54.074> worker is processing task: t5</span>
<span class="token comment" spellcheck="true">//54.076> t5 is running, waiting tasks: 1</span>
<span class="token comment" spellcheck="true">//54.183> err: null</span>
<span class="token comment" spellcheck="true">//54.184> no more tasks wating</span>
<span class="token comment" spellcheck="true">//54.185> worker is processing task: t6</span>
<span class="token comment" spellcheck="true">//54.186> t6 is running, waiting tasks: 0</span>
<span class="token comment" spellcheck="true">//54.265> err: null</span>
<span class="token comment" spellcheck="true">//54.588> err: null</span>
<span class="token comment" spellcheck="true">//54.589> all tasks have been processed</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><a name="reduce"></a><br><br></p>
<h3 id="Reduceä»£ç æ¼”ç¤º"><a href="#Reduceä»£ç æ¼”ç¤º" class="headerlink" title="Reduceä»£ç æ¼”ç¤º"></a><code>Reduce</code>ä»£ç æ¼”ç¤º</h3><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">var</span> <span class="token keyword">async</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'async'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> t <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./t'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> log <span class="token operator">=</span> t<span class="token punctuation">.</span>log<span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">/**
 * Reduceå¯ä»¥è®©æˆ‘ä»¬ç»™å®šä¸€ä¸ªåˆå§‹å€¼ï¼Œç”¨å®ƒä¸é›†åˆä¸­çš„æ¯ä¸€ä¸ªå…ƒç´ åšè¿ç®—ï¼Œæœ€åå¾—åˆ°ä¸€ä¸ªå€¼ã€‚reduceä»å·¦å‘å³æ¥éå†å…ƒç´ ï¼Œå¦‚æœæƒ³ä»å³å‘å·¦ï¼Œå¯ä½¿ç”¨reduceRightã€‚
 */</span>
<span class="token comment" spellcheck="true">//reduce(arr, memo, iterator(memo,item,callback), callback(err,result))</span>
<span class="token comment" spellcheck="true">//alias: inject, foldl</span>

<span class="token keyword">var</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">/**
 * é¡ºåºæ‰§è¡Œ
 */</span>
<span class="token keyword">async</span><span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span>arr<span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>memo<span class="token punctuation">,</span> item<span class="token punctuation">,</span> callback<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.1 enter: '</span> <span class="token operator">+</span> memo <span class="token operator">+</span><span class="token string">', '</span> <span class="token operator">+</span> item<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">callback</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> memo<span class="token operator">+</span>item<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> result<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.1 err: '</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.1 result: '</span><span class="token punctuation">,</span> result<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">// 28.789> 1.1 enter: 100, 1</span>
<span class="token comment" spellcheck="true">// 28.889> 1.1 enter: 101, 3</span>
<span class="token comment" spellcheck="true">// 28.999> 1.1 enter: 104, 5</span>
<span class="token comment" spellcheck="true">// 29.109> 1.1 err:</span>
<span class="token comment" spellcheck="true">// 29.109> 1.1 result: 109</span>

<span class="token comment" spellcheck="true">/**
 * é¡ºåºæ‰§è¡Œè¿‡ç¨‹ä¸­å‡ºé”™ï¼ŒåªæŠŠé”™è¯¯ä¼ ç»™æœ€ç»ˆcallbackï¼Œç»“æœæ˜¯null
 */</span>
<span class="token keyword">async</span><span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span>arr<span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>memo<span class="token punctuation">,</span> item<span class="token punctuation">,</span> callback<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.2 enter: '</span> <span class="token operator">+</span> memo <span class="token operator">+</span><span class="token string">', '</span> <span class="token operator">+</span> item<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>item<span class="token operator">===</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token function">callback</span><span class="token punctuation">(</span><span class="token string">'myerr'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">else</span> <span class="token function">callback</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> memo<span class="token operator">+</span>item<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> result<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.2 err: '</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.2 result: '</span><span class="token punctuation">,</span> result<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">// 05.541> 1.2 enter: 100, 1</span>
<span class="token comment" spellcheck="true">// 05.649> 1.2 enter: 101, 3</span>
<span class="token comment" spellcheck="true">// 05.760> 1.2 err: myerr</span>
<span class="token comment" spellcheck="true">// 05.760> 1.2 result:</span>

<span class="token comment" spellcheck="true">/**
 * é¡ºåºæ‰§è¡Œä»å³å‘å·¦
 *
 * alias: foldr
 */</span>
<span class="token keyword">async</span><span class="token punctuation">.</span><span class="token function">reduceRight</span><span class="token punctuation">(</span>arr<span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>memo<span class="token punctuation">,</span> item<span class="token punctuation">,</span> callback<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.3 enter: '</span> <span class="token operator">+</span> memo <span class="token operator">+</span><span class="token string">', '</span> <span class="token operator">+</span> item<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">callback</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> memo<span class="token operator">+</span>item<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> result<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.3 err: '</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.3 result: '</span><span class="token punctuation">,</span> result<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">// 28.789> 1.3 enter: 100, 5</span>
<span class="token comment" spellcheck="true">// 28.889> 1.3 enter: 105, 3</span>
<span class="token comment" spellcheck="true">// 28.999> 1.3 enter: 108, 1</span>
<span class="token comment" spellcheck="true">// 29.109> 1.3 err:</span>
<span class="token comment" spellcheck="true">// 29.109> 1.3 result: 109</span>

<span class="token comment" spellcheck="true">/**
 *  é€šè¿‡t.incåšä¸€ä¸ªç´¯åŠ å™¨ï¼Œå‚ä¸reduceçš„è®¡ç®—
 */</span>
<span class="token keyword">async</span><span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span>arr<span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>memo<span class="token punctuation">,</span>item<span class="token punctuation">,</span>callback<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.4 enter: '</span><span class="token operator">+</span>memo<span class="token operator">+</span><span class="token string">','</span><span class="token operator">+</span>item<span class="token punctuation">)</span><span class="token punctuation">;</span>
    t<span class="token punctuation">.</span><span class="token function">inc</span><span class="token punctuation">(</span>item<span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span>n<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.4 handle: '</span><span class="token punctuation">,</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">callback</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> memo<span class="token operator">+</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span>result<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.4 err: '</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.4 result: '</span><span class="token punctuation">,</span> result<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">// 28.789> 1.4 enter: 100,1</span>
<span class="token comment" spellcheck="true">// 28.999> 1.4 handle: 2</span>
<span class="token comment" spellcheck="true">// 28.999> 1.4 enter: 102,3</span>
<span class="token comment" spellcheck="true">// 29.209> 1.4 handle: 4</span>
<span class="token comment" spellcheck="true">// 29.209> 1.4 enter: 106,5</span>
<span class="token comment" spellcheck="true">// 29.409> 1.4 handle: 6</span>
<span class="token comment" spellcheck="true">// 29.409> 1.4 err:</span>
<span class="token comment" spellcheck="true">// 29.409> 1.4 result: 112</span>
<span class="token comment" spellcheck="true">// --> spent 0.62s</span>

<span class="token comment" spellcheck="true">/**
 *  é€šè¿‡t.incåšä¸€ä¸ªç´¯åŠ å™¨ï¼Œå¹¶å®ç°å¯¹mapçš„ç»“æœé›†åšreduce
 */</span>
<span class="token keyword">async</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>arr<span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>item<span class="token punctuation">,</span> callback<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.5 enter: '</span><span class="token punctuation">,</span> item<span class="token punctuation">)</span><span class="token punctuation">;</span>
    t<span class="token punctuation">.</span><span class="token function">inc</span><span class="token punctuation">(</span>item<span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span>n<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.5 handle: '</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">callback</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
<span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> results<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.5 err: '</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.5 results: '</span><span class="token punctuation">,</span> results<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> sum <span class="token operator">=</span> results<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span>memo<span class="token punctuation">,</span> item<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> memo <span class="token operator">+</span> item<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.5 sum: '</span><span class="token punctuation">,</span> sum<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">// 28.789> 1.5 enter: 1</span>
<span class="token comment" spellcheck="true">// 28.789> 1.5 enter: 3</span>
<span class="token comment" spellcheck="true">// 28.789> 1.5 enter: 5</span>
<span class="token comment" spellcheck="true">// 28.999> 1.5 handle: 2</span>
<span class="token comment" spellcheck="true">// 28.999> 1.5 handle: 4</span>
<span class="token comment" spellcheck="true">// 28.999> 1.5 handle: 6</span>
<span class="token comment" spellcheck="true">// 28.999> 1.5 err:</span>
<span class="token comment" spellcheck="true">// 28.999> 1.5 results: [ 2, 4, 6 ]</span>
<span class="token comment" spellcheck="true">// 28.999> 1.5 sum: 112</span>
<span class="token comment" spellcheck="true">// --> spent 0.21</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><a name="series"></a><br><br></p>
<h3 id="seriesä»£ç æ¼”ç¤º"><a href="#seriesä»£ç æ¼”ç¤º" class="headerlink" title="seriesä»£ç æ¼”ç¤º"></a><code>series</code>ä»£ç æ¼”ç¤º</h3><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">var</span> <span class="token keyword">async</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'async'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> t <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./t'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> log <span class="token operator">=</span> t<span class="token punctuation">.</span>log<span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">/**
 * ä¸²è¡Œæ‰§è¡Œï¼Œä¸€ä¸ªå‡½æ•°æ•°ç»„ä¸­çš„æ¯ä¸ªå‡½æ•°ï¼Œæ¯ä¸€ä¸ªå‡½æ•°æ‰§è¡Œå®Œæˆä¹‹åæ‰èƒ½æ‰§è¡Œä¸‹ä¸€ä¸ªå‡½æ•°ã€‚
 *
 * å¦‚æœä»»ä½•ä¸€ä¸ªå‡½æ•°å‘å®ƒçš„å›è°ƒå‡½æ•°ä¸­ä¼ äº†ä¸€ä¸ªerrorï¼Œåˆ™åé¢çš„å‡½æ•°éƒ½ä¸ä¼šè¢«æ‰§è¡Œï¼Œå¹¶ä¸”ä¼šç«‹åˆ»å°†è¯¥errorä»¥åŠå·²ç»æ‰§è¡Œäº†çš„å‡½æ•°çš„ç»“æœï¼Œä¼ ç»™seriesä¸­æœ€åé‚£ä¸ªcallbackã€‚
 * å½“æ‰€æœ‰çš„å‡½æ•°æ‰§è¡Œå®Œåï¼ˆæ²¡æœ‰å‡ºé”™ï¼‰ï¼Œåˆ™ä¼šæŠŠæ¯ä¸ªå‡½æ•°ä¼ ç»™å…¶å›è°ƒå‡½æ•°çš„ç»“æœåˆå¹¶ä¸ºä¸€ä¸ªæ•°ç»„ï¼Œä¼ ç»™seriesæœ€åçš„é‚£ä¸ªcallbackã€‚
 * è¿˜å¯ä»¥jsonçš„å½¢å¼æ¥æä¾›tasksã€‚æ¯ä¸€ä¸ªå±æ€§éƒ½ä¼šè¢«å½“ä½œå‡½æ•°æ¥æ‰§è¡Œï¼Œå¹¶ä¸”ç»“æœä¹Ÿä¼šä»¥jsonå½¢å¼ä¼ ç»™seriesæœ€åçš„é‚£ä¸ªcallbackã€‚è¿™ç§æ–¹å¼å¯è¯»æ€§æ›´é«˜ä¸€äº›ã€‚
 */</span>
<span class="token comment" spellcheck="true">// series(tasks, [callback])</span>

<span class="token comment" spellcheck="true">/**
 * å…¨éƒ¨å‡½æ•°éƒ½æ­£å¸¸æ‰§è¡Œã€‚æ¯ä¸ªå‡½æ•°äº§ç”Ÿçš„å€¼å°†æŒ‰é¡ºåºåˆå¹¶ä¸ºä¸€ä¸ªæ•°ç»„ï¼Œä¼ ç»™æœ€ç»ˆçš„callbackã€‚
 */</span>
<span class="token comment" spellcheck="true">// 1.1</span>
<span class="token keyword">async</span><span class="token punctuation">.</span><span class="token function">series</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
    <span class="token keyword">function</span><span class="token punctuation">(</span>cb<span class="token punctuation">)</span> <span class="token punctuation">{</span> t<span class="token punctuation">.</span><span class="token function">inc</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> cb<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token keyword">function</span><span class="token punctuation">(</span>cb<span class="token punctuation">)</span> <span class="token punctuation">{</span> t<span class="token punctuation">.</span><span class="token function">inc</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span> cb<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token keyword">function</span><span class="token punctuation">(</span>cb<span class="token punctuation">)</span> <span class="token punctuation">{</span> t<span class="token punctuation">.</span><span class="token function">inc</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> cb<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> results<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.1 err: '</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.1 results: '</span><span class="token punctuation">,</span> results<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">//05.155> 1.1 err: null</span>
<span class="token comment" spellcheck="true">//05.156> 1.1 results: [ 4, 9, 3 ]</span>

<span class="token comment" spellcheck="true">/**
 * ä¸­é—´æœ‰å‡½æ•°å‡ºé”™ã€‚å‡ºé”™ä¹‹åçš„å‡½æ•°ä¸ä¼šæ‰§è¡Œï¼Œé”™è¯¯åŠä¹‹å‰æ­£å¸¸æ‰§è¡Œçš„å‡½æ•°ç»“æœå°†ä¼ ç»™æœ€ç»ˆçš„callbackã€‚
 */</span>
<span class="token comment" spellcheck="true">// 1.2</span>
<span class="token keyword">async</span><span class="token punctuation">.</span><span class="token function">series</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
    <span class="token keyword">function</span><span class="token punctuation">(</span>cb<span class="token punctuation">)</span> <span class="token punctuation">{</span> t<span class="token punctuation">.</span><span class="token function">inc</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> cb<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token keyword">function</span><span class="token punctuation">(</span>cb<span class="token punctuation">)</span> <span class="token punctuation">{</span> t<span class="token punctuation">.</span><span class="token function">err</span><span class="token punctuation">(</span><span class="token string">'test_err'</span><span class="token punctuation">,</span> cb<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token keyword">function</span><span class="token punctuation">(</span>cb<span class="token punctuation">)</span> <span class="token punctuation">{</span> t<span class="token punctuation">.</span><span class="token function">inc</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span> cb<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>err<span class="token punctuation">,</span> results<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.2 err: '</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.2 results: '</span><span class="token punctuation">,</span> results<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">//04.964> 1.2 err: test_err</span>
<span class="token comment" spellcheck="true">//04.973> 1.2 results: [ 4, undefined ]</span>

<span class="token comment" spellcheck="true">/**
 * å¦‚æœæŸä¸ªå‡½æ•°ä¼ çš„æ•°æ®æ˜¯undefined, null, {}, []ç­‰ï¼Œå®ƒä»¬ä¼šåŸæ ·ä¼ ç»™æœ€ç»ˆcallbackã€‚
 */</span>
<span class="token comment" spellcheck="true">// 1.3</span>
<span class="token keyword">async</span><span class="token punctuation">.</span><span class="token function">series</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
    <span class="token keyword">function</span><span class="token punctuation">(</span>cb<span class="token punctuation">)</span> <span class="token punctuation">{</span> t<span class="token punctuation">.</span><span class="token function">fire</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> cb<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token keyword">function</span><span class="token punctuation">(</span>cb<span class="token punctuation">)</span> <span class="token punctuation">{</span> t<span class="token punctuation">.</span><span class="token function">fire</span><span class="token punctuation">(</span>undefined<span class="token punctuation">,</span> cb<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token keyword">function</span><span class="token punctuation">(</span>cb<span class="token punctuation">)</span> <span class="token punctuation">{</span> t<span class="token punctuation">.</span><span class="token function">fire</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> cb<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token keyword">function</span><span class="token punctuation">(</span>cb<span class="token punctuation">)</span> <span class="token punctuation">{</span> t<span class="token punctuation">.</span><span class="token function">fire</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> cb<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token keyword">function</span><span class="token punctuation">(</span>cb<span class="token punctuation">)</span> <span class="token punctuation">{</span> t<span class="token punctuation">.</span><span class="token function">fire</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> cb<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token keyword">function</span><span class="token punctuation">(</span>cb<span class="token punctuation">)</span> <span class="token punctuation">{</span> t<span class="token punctuation">.</span><span class="token function">fire</span><span class="token punctuation">(</span><span class="token string">'abc'</span><span class="token punctuation">,</span> cb<span class="token punctuation">)</span> <span class="token punctuation">}</span>
<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> results<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.3 err: '</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.3 results: '</span><span class="token punctuation">,</span> results<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">//05.794> 1.3 err: null</span>
<span class="token comment" spellcheck="true">//05.795> 1.3 results: [ 3, undefined, null, {}, [], 'abc' ]</span>

<span class="token comment" spellcheck="true">/**
 * ä»¥jsonå½¢å¼ä¼ å…¥tasksã€‚å…¶ç»“æœä¹Ÿå°†ä»¥jsonå½¢å¼ä¼ ç»™æœ€ç»ˆcallbackã€‚
 */</span>
<span class="token keyword">async</span><span class="token punctuation">.</span><span class="token function">series</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    a<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span>cb<span class="token punctuation">)</span> <span class="token punctuation">{</span> t<span class="token punctuation">.</span><span class="token function">inc</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> cb<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    b<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span>cb<span class="token punctuation">)</span> <span class="token punctuation">{</span> t<span class="token punctuation">.</span><span class="token function">fire</span><span class="token punctuation">(</span>undefined<span class="token punctuation">,</span> cb<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    c<span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>cb<span class="token punctuation">)</span> <span class="token punctuation">{</span> t<span class="token punctuation">.</span><span class="token function">err</span><span class="token punctuation">(</span><span class="token string">'myerr'</span><span class="token punctuation">,</span> cb<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    d<span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>cb<span class="token punctuation">)</span> <span class="token punctuation">{</span> t<span class="token punctuation">.</span><span class="token function">inc</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span> cb<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>err<span class="token punctuation">,</span> results<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.4 err: '</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.4 results: '</span><span class="token punctuation">,</span> results<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">//05.178> 1.4 err: myerr</span>
<span class="token comment" spellcheck="true">//05.179> 1.4 results: { a: 4, b: undefined, c: undefined }</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><a name="some"></a><br><br></p>
<h3 id="someä»£ç æ¼”ç¤º"><a href="#someä»£ç æ¼”ç¤º" class="headerlink" title="someä»£ç æ¼”ç¤º"></a><code>some</code>ä»£ç æ¼”ç¤º</h3><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">var</span> <span class="token keyword">async</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'async'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> t <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./t'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> log <span class="token operator">=</span> t<span class="token punctuation">.</span>log<span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">/**
 * å½“é›†åˆä¸­æ˜¯å¦æœ‰è‡³å°‘ä¸€ä¸ªå…ƒç´ æ»¡è¶³æ¡ä»¶æ—¶ï¼Œæœ€ç»ˆcallbackå¾—åˆ°çš„å€¼ä¸ºtrueï¼Œå¦åˆ™ä¸ºfalse.
 */</span>
<span class="token comment" spellcheck="true">// some(arr, iterator(item,callback(test)), callback(result))</span>
<span class="token comment" spellcheck="true">//alias: any</span>

<span class="token keyword">var</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">/**
 * ä¸²è¡Œæ‰§è¡Œï¼Œé›†åˆä¸­è‡³å°‘æœ‰ä¸€ä¸ªå…ƒç´ &lt;=3ï¼Œæ‰€ä»¥ç»“æœä¸ºtrue
 */</span>
<span class="token comment" spellcheck="true">// 1.1</span>
<span class="token keyword">async</span><span class="token punctuation">.</span><span class="token function">some</span><span class="token punctuation">(</span>arr<span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>item<span class="token punctuation">,</span>callback<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.1 enter: '</span><span class="token punctuation">,</span>item<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.1 handle: '</span><span class="token punctuation">,</span>item<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">callback</span><span class="token punctuation">(</span>item<span class="token operator">&lt;=</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.1 result: '</span><span class="token punctuation">,</span> result<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">// 36.165> 1.1 enter: 1</span>
<span class="token comment" spellcheck="true">// 36.165> 1.1 enter: 2</span>
<span class="token comment" spellcheck="true">// 36.165> 1.1 enter: 3</span>
<span class="token comment" spellcheck="true">// 36.165> 1.1 enter: 6</span>
<span class="token comment" spellcheck="true">// 36.275> 1.1 handle: 1</span>
<span class="token comment" spellcheck="true">// 36.275> 1.1 result: true</span>
<span class="token comment" spellcheck="true">// 36.275> 1.1 handle: 2</span>
<span class="token comment" spellcheck="true">// 36.275> 1.1 handle: 3</span>
<span class="token comment" spellcheck="true">// 36.275> 1.1 handle: 6</span>


<span class="token comment" spellcheck="true">/**
 * ä¸²è¡Œæ‰§è¡Œï¼Œé›†åˆä¸­æ²¡æœ‰ä¸€ä¸ªå…ƒç´ >10ï¼Œæ‰€ä»¥ç»“æœä¸ºfalse
 */</span>
<span class="token keyword">async</span><span class="token punctuation">.</span><span class="token function">some</span><span class="token punctuation">(</span>arr<span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>item<span class="token punctuation">,</span>callback<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.2 enter: '</span><span class="token punctuation">,</span>item<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.2 handle: '</span><span class="token punctuation">,</span>item<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">callback</span><span class="token punctuation">(</span>item<span class="token operator">></span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.2 result: '</span><span class="token punctuation">,</span> result<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">// 36.165> 1.2 enter: 1</span>
<span class="token comment" spellcheck="true">// 36.165> 1.2 enter: 2</span>
<span class="token comment" spellcheck="true">// 36.165> 1.2 enter: 3</span>
<span class="token comment" spellcheck="true">// 36.165> 1.2 enter: 6</span>
<span class="token comment" spellcheck="true">// 36.275> 1.2 handle: 1</span>
<span class="token comment" spellcheck="true">// 36.275> 1.2 handle: 2</span>
<span class="token comment" spellcheck="true">// 36.275> 1.2 handle: 3</span>
<span class="token comment" spellcheck="true">// 36.275> 1.2 handle: 6</span>
<span class="token comment" spellcheck="true">// 36.275> 1.2 result: false</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><a name="sortBy"></a><br><br></p>
<h3 id="sortByä»£ç æ¼”ç¤º"><a href="#sortByä»£ç æ¼”ç¤º" class="headerlink" title="sortByä»£ç æ¼”ç¤º"></a><code>sortBy</code>ä»£ç æ¼”ç¤º</h3><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">var</span> <span class="token keyword">async</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'async'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> t <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./t'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> log <span class="token operator">=</span> t<span class="token punctuation">.</span>log<span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">/**
 * å¯¹é›†åˆå†…çš„å…ƒç´ è¿›è¡Œæ’åºï¼Œä¾æ®æ¯ä¸ªå…ƒç´ è¿›è¡ŒæŸå¼‚æ­¥æ“ä½œåäº§ç”Ÿçš„å€¼ï¼Œä»å°åˆ°å¤§æ’åºã€‚
 */</span>
<span class="token comment" spellcheck="true">// sortBy(array, iterator(item,callback(err,result)), callback(err,results))</span>

<span class="token keyword">var</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">/**
 * é€šè¿‡å¼‚æ­¥è¿­ä»£å™¨ï¼Œå¯¹é›†åˆè¿›è¡Œæ’åº
 */</span>
<span class="token keyword">async</span><span class="token punctuation">.</span><span class="token function">sortBy</span><span class="token punctuation">(</span>arr<span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>item<span class="token punctuation">,</span> callback<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">callback</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span>item<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span>results<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.1 err: '</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.1 results: '</span><span class="token punctuation">,</span> results<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">// 26.562> 1.1 err: null</span>
<span class="token comment" spellcheck="true">// 26.562> 1.1 results: [ 1, 3, 6 ]</span>

<span class="token comment" spellcheck="true">/**
 * è¿­ä»£å‡ºé”™ï¼Œcallbackè¿”å›errï¼Œæ²¡æœ‰results
 */</span>
<span class="token keyword">async</span><span class="token punctuation">.</span><span class="token function">sortBy</span><span class="token punctuation">(</span>arr<span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>item<span class="token punctuation">,</span> callback<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>item<span class="token operator">===</span><span class="token number">6</span><span class="token punctuation">)</span> <span class="token function">callback</span><span class="token punctuation">(</span><span class="token string">'myerr'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">else</span> <span class="token function">callback</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span>item<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span>results<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.2 err: '</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.2 results: '</span><span class="token punctuation">,</span> results<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">// 26.572> 1.2 err: myerr</span>
<span class="token comment" spellcheck="true">// 26.572> 1.2 results:</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><a name="t.js"></a><br><br></p>
<h3 id="t-jsä»£ç æ¼”ç¤º"><a href="#t-jsä»£ç æ¼”ç¤º" class="headerlink" title="t.jsä»£ç æ¼”ç¤º"></a><code>t.js</code>ä»£ç æ¼”ç¤º</h3><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token comment" spellcheck="true">// å…¶å®è¿™ä¸ªæ–‡ä»¶åçš„'t'æˆ‘ä¸æ˜¯å¾ˆæ˜ç™½åŸä½œè€…freewindçš„æ„æ€ï¼Œæˆ‘è§‰å¾—å«åš'lib.js'æˆ–è€…</span>
<span class="token comment" spellcheck="true">// 'helper.js'æ¯”è¾ƒåˆé€‚ï¼Œå› ä¸ºè¿™é‡Œé¢éƒ½æ˜¯äº›è¾…åŠ©å‡½æ•°ã€‚</span>

<span class="token keyword">var</span> moment <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'moment'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

exports<span class="token punctuation">.</span>inc <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> callback<span class="token punctuation">,</span> timeout<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment" spellcheck="true">//å°†å‚æ•°nè‡ªå¢1ä¹‹åçš„ç»“æœè¿”å›ç»™async</span>
    timeout <span class="token operator">=</span> timeout <span class="token operator">||</span> <span class="token number">200</span><span class="token punctuation">;</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">callback</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> n<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> timeout<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

exports<span class="token punctuation">.</span>fire <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> callback<span class="token punctuation">,</span> timeout<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment" spellcheck="true">//ç›´æ¥å°†objçš„å†…å®¹è¿”å›ç»™async</span>
    timeout <span class="token operator">=</span> timeout <span class="token operator">||</span> <span class="token number">200</span><span class="token punctuation">;</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">callback</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> obj<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> timeout<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

exports<span class="token punctuation">.</span>err <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>errMsg<span class="token punctuation">,</span> callback<span class="token punctuation">,</span> timeout<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment" spellcheck="true">//æ¨¡æ‹Ÿä¸€ä¸ªé”™è¯¯çš„äº§ç”Ÿï¼Œè®©asyncå„ä¸ªå‡½æ•°æœ«å°¾çš„callbackæ¥æ”¶åˆ°ã€‚</span>
    timeout <span class="token operator">=</span> timeout <span class="token operator">||</span> <span class="token number">200</span><span class="token punctuation">;</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">callback</span><span class="token punctuation">(</span>errMsg<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> timeout<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">// utils</span>
exports<span class="token punctuation">.</span>log <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>msg<span class="token punctuation">,</span> obj<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment" spellcheck="true">//å¯¹console.logè¿›è¡Œäº†å°è£…ã€‚ä¸»è¦æ˜¯å¢åŠ äº†ç§’é’Ÿçš„è¾“å‡ºï¼Œé€šè¿‡ç§’æ•°çš„å·®å€¼æ–¹ä¾¿å¤§å®¶å¯¹asyncçš„ç†è§£ã€‚</span>
    process<span class="token punctuation">.</span>stdout<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token function">moment</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">'ss.SSS'</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">'> '</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>obj<span class="token operator">!==</span>undefined<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        process<span class="token punctuation">.</span>stdout<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">;</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

exports<span class="token punctuation">.</span>wait <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>mils<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment" spellcheck="true">//åˆ»æ„ç­‰å¾…milsçš„æ—¶é—´ï¼Œmilsçš„å•ä½æ˜¯æ¯«ç§’ã€‚</span>
    <span class="token keyword">var</span> now <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span> <span class="token operator">-</span> now <span class="token operator">&lt;=</span> mils<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><a name="times"></a><br><br></p>
<h3 id="times-timesSeriesä»£ç æ¼”ç¤º"><a href="#times-timesSeriesä»£ç æ¼”ç¤º" class="headerlink" title="times timesSeriesä»£ç æ¼”ç¤º"></a><code>times</code> <code>timesSeries</code>ä»£ç æ¼”ç¤º</h3><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">var</span> <span class="token keyword">async</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'async'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> t <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./t'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> log <span class="token operator">=</span> t<span class="token punctuation">.</span>log<span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">/**
* å¼‚æ­¥è¿è¡Œ,timeså¯ä»¥æŒ‡å®šè°ƒç”¨å‡ æ¬¡ï¼Œå¹¶æŠŠç»“æœåˆå¹¶åˆ°æ•°ç»„ä¸­è¿”å›
*/</span>
<span class="token comment" spellcheck="true">// times(n, callback)</span>

<span class="token keyword">function</span> <span class="token function">delay</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">return</span> <span class="token punctuation">(</span>n<span class="token operator">+</span><span class="token number">12</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">7</span> <span class="token operator">*</span><span class="token number">100</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
<span class="token keyword">var</span> createUser <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>id<span class="token punctuation">,</span> callback<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">callback</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
        id<span class="token punctuation">:</span> <span class="token string">'user'</span> <span class="token operator">+</span> id<span class="token punctuation">,</span>
        delay<span class="token punctuation">:</span><span class="token function">delay</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">/**
 * å¼‚æ­¥æ‰§è¡Œï¼Œè°ƒç”¨3æ¬¡createUserå‡½æ•°ï¼Œç»“æœè¢«åˆå¹¶åˆ°æ•°ç»„è¿”å›
 */</span>
<span class="token comment" spellcheck="true">//1.1</span>
<span class="token keyword">async</span><span class="token punctuation">.</span><span class="token function">times</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> callback<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"1.1 enter: "</span><span class="token operator">+</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.1 handler: '</span><span class="token punctuation">,</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">createUser</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> user<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">callback</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> user<span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token function">delay</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> users<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.1 err: '</span><span class="token punctuation">,</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.1 result: '</span><span class="token punctuation">,</span>users<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">//07.397> 1.1 enter: 0</span>
<span class="token comment" spellcheck="true">//07.400> 1.1 enter: 1</span>
<span class="token comment" spellcheck="true">//07.401> 1.1 enter: 2</span>
<span class="token comment" spellcheck="true">//07.412> 1.1 handler: 2</span>
<span class="token comment" spellcheck="true">//07.912> 1.1 handler: 0</span>
<span class="token comment" spellcheck="true">//08.009> 1.1 handler: 1</span>
<span class="token comment" spellcheck="true">//08.010> 1.1 err: null</span>
<span class="token comment" spellcheck="true">//08.011> 1.1 result: [ { id: 'user0', delay: 500 },</span>
<span class="token comment" spellcheck="true">//    { id: 'user1', delay: 600 },</span>
<span class="token comment" spellcheck="true">//    { id: 'user2', delay: 0 } ]</span>

<span class="token comment" spellcheck="true">/**
*  timesSeriesä¸timeå”¯ä¸€ä¸åŒçš„æ˜¯ï¼ŒåŒæ­¥æ‰§è¡Œ
*/</span>
<span class="token comment" spellcheck="true">//timesSeries(n, callback)</span>

<span class="token comment" spellcheck="true">/**
 * åŒæ­¥æ‰§è¡Œï¼Œè°ƒç”¨3æ¬¡createUserå‡½æ•°ï¼Œç»“æœè¢«åˆå¹¶åˆ°æ•°ç»„è¿”å›
 */</span>
<span class="token comment" spellcheck="true">//1.2</span>
<span class="token keyword">async</span><span class="token punctuation">.</span><span class="token function">timesSeries</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> callback<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"1.2 enter: "</span><span class="token operator">+</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.2 handler: '</span><span class="token punctuation">,</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">createUser</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> user<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">callback</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> user<span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token function">delay</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> users<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.2 err: '</span><span class="token punctuation">,</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.2 result: '</span><span class="token punctuation">,</span>users<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">//16.642> 1.2 enter: 0</span>
<span class="token comment" spellcheck="true">//17.159> 1.2 handler: 0</span>
<span class="token comment" spellcheck="true">//17.162> 1.2 enter: 1</span>
<span class="token comment" spellcheck="true">//17.763> 1.2 handler: 1</span>
<span class="token comment" spellcheck="true">//17.767> 1.2 enter: 2</span>
<span class="token comment" spellcheck="true">//17.778> 1.2 handler: 2</span>
<span class="token comment" spellcheck="true">//17.779> 1.2 err: null</span>
<span class="token comment" spellcheck="true">//17.780> 1.2 result: [ { id: 'user0', delay: 500 },</span>
<span class="token comment" spellcheck="true">//    { id: 'user1', delay: 600 },</span>
<span class="token comment" spellcheck="true">//    { id: 'user2', delay: 0 } ]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><a name="util.js"></a><br><br></p>
<h3 id="unmemoize-noConflict-memoize-log-dir-ä»£ç æ¼”ç¤º"><a href="#unmemoize-noConflict-memoize-log-dir-ä»£ç æ¼”ç¤º" class="headerlink" title="unmemoize noConflict memoize log dir ä»£ç æ¼”ç¤º"></a><code>unmemoize</code> <code>noConflict</code> <code>memoize</code> <code>log</code> <code>dir</code> ä»£ç æ¼”ç¤º</h3><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">var</span> <span class="token keyword">async</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'async'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> t <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./t'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> log <span class="token operator">=</span> t<span class="token punctuation">.</span>log<span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">/**
* è®©æŸä¸€ä¸ªå‡½æ•°åœ¨å†…å­˜ä¸­ç¼“å­˜å®ƒçš„è®¡ç®—ç»“æœã€‚å¯¹äºç›¸åŒçš„å‚æ•°ï¼Œåªè®¡ç®—ä¸€æ¬¡ï¼Œä¸‹æ¬¡å°±ç›´æ¥æ‹¿åˆ°ä¹‹å‰ç®—å¥½çš„ç»“æœã€‚
* hasherå¯ä»¥è®©æˆ‘ä»¬è‡ªå®šä¹‰å¦‚ä½•æ ¹æ®å‚æ•°æ¥åˆ¤æ–­å®ƒæ˜¯å¦å·²ç»åœ¨ç¼“å­˜ä¸­äº†ã€‚
*/</span>
<span class="token comment" spellcheck="true">// memoize(fn, [hasher])</span>
<span class="token comment" spellcheck="true">//1.1</span>
<span class="token keyword">var</span> slow_fn <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> callback<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.1 start working for: '</span> <span class="token operator">+</span> x<span class="token operator">+</span><span class="token string">','</span><span class="token operator">+</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
    t<span class="token punctuation">.</span><span class="token function">wait</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.1 finished: '</span> <span class="token operator">+</span> x<span class="token operator">+</span><span class="token string">','</span><span class="token operator">+</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">callback</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> x<span class="token operator">+</span><span class="token string">','</span><span class="token operator">+</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> fn <span class="token operator">=</span> <span class="token keyword">async</span><span class="token punctuation">.</span><span class="token function">memoize</span><span class="token punctuation">(</span>slow_fn<span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> x<span class="token operator">+</span>y<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">fn</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">,</span><span class="token string">'b'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> result<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"1.1 first time: "</span><span class="token operator">+</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">fn</span><span class="token punctuation">(</span><span class="token string">'cc'</span><span class="token punctuation">,</span><span class="token string">'d'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> result<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"1.1 first time: "</span><span class="token operator">+</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">fn</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">,</span><span class="token string">'b'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> result<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"1.1 second time: "</span><span class="token operator">+</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">//15.416> 1.1 start working for: a,b</span>
<span class="token comment" spellcheck="true">//15.920> 1.1 finished: a,b</span>
<span class="token comment" spellcheck="true">//15.920> 1.1 first time: a,b</span>
<span class="token comment" spellcheck="true">//15.921> 1.1 start working for: cc,d</span>
<span class="token comment" spellcheck="true">//16.423> 1.1 finished: cc,d</span>
<span class="token comment" spellcheck="true">//16.423> 1.1 first time: cc,d</span>
<span class="token comment" spellcheck="true">//16.424> 1.1 second time: a,b</span>


<span class="token comment" spellcheck="true">/**
* è®©å·²ç»è¢«ç¼“å­˜çš„å‡½æ•°ï¼Œè¿”å›ä¸ç¼“å­˜çš„å‡½æ•°å¼•ç”¨ã€‚
*/</span>
<span class="token comment" spellcheck="true">// unmemoize(fn)</span>
<span class="token comment" spellcheck="true">//1.2</span>
<span class="token keyword">var</span> slow_fn2 <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> callback<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.2 start working for: '</span> <span class="token operator">+</span> x<span class="token operator">+</span><span class="token string">','</span><span class="token operator">+</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
    t<span class="token punctuation">.</span><span class="token function">wait</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.2 finished: '</span> <span class="token operator">+</span> x<span class="token operator">+</span><span class="token string">','</span><span class="token operator">+</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">callback</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> x<span class="token operator">+</span><span class="token string">','</span><span class="token operator">+</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> fn2 <span class="token operator">=</span> <span class="token keyword">async</span><span class="token punctuation">.</span><span class="token function">memoize</span><span class="token punctuation">(</span>slow_fn2<span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> x<span class="token operator">+</span>y<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">fn2</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">,</span><span class="token string">'b'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span>result<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"1.2 first time: "</span><span class="token operator">+</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> unFn2 <span class="token operator">=</span><span class="token keyword">async</span><span class="token punctuation">.</span><span class="token function">unmemoize</span><span class="token punctuation">(</span>fn2<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.2 unmemoized'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">unFn2</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">,</span><span class="token string">'b'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span>result<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"1.2 second time: "</span><span class="token operator">+</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">//16.424> 1.2 start working for: a,b</span>
<span class="token comment" spellcheck="true">//16.926> 1.2 finished: a,b</span>
<span class="token comment" spellcheck="true">//16.926> 1.2 first time: a,b</span>
<span class="token comment" spellcheck="true">//16.927> 1.2 unmemoized</span>
<span class="token comment" spellcheck="true">//16.927> 1.2 start working for: a,b</span>
<span class="token comment" spellcheck="true">//17.428> 1.2 finished: a,b</span>
<span class="token comment" spellcheck="true">//17.428> 1.2 second time: a,b</span>

<span class="token comment" spellcheck="true">/**
* æ‰§è¡ŒæŸå¼‚æ­¥å‡½æ•°ï¼Œå¹¶è®°å½•å®ƒçš„è¿”å›å€¼ã€‚è¯•éªŒå‡½æ•°æ—¶å¾ˆæ–¹ä¾¿ï¼Œä¸ç”¨å†™é‚£äº›å›ºå®šæ¨¡å¼çš„ä»£ç ã€‚
* å¦‚æœè¯¥å‡½æ•°å‘å›è°ƒä¸­ä¼ å…¥äº†å¤šä¸ªå‚æ•°ï¼Œåˆ™æ¯è¡Œè®°å½•ä¸€ä¸ªã€‚
*/</span>
<span class="token comment" spellcheck="true">// log(function, arguments)</span>
<span class="token comment" spellcheck="true">//1.3</span>
<span class="token keyword">var</span> x <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">'bsspirit'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> hello <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> callback<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">callback</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span>
            <span class="token string">'first '</span> <span class="token operator">+</span> name<span class="token punctuation">,</span>
            <span class="token string">'second '</span><span class="token operator">+</span> name<span class="token punctuation">,</span>
            x<span class="token punctuation">,</span>
            <span class="token punctuation">{</span>a<span class="token punctuation">:</span><span class="token string">'123'</span><span class="token punctuation">}</span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"1.3 handler"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">async</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>hello<span class="token punctuation">,</span> <span class="token string">'time'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">//37.620> 1.3 handler</span>
<span class="token comment" spellcheck="true">//first time</span>
<span class="token comment" spellcheck="true">//second time</span>
<span class="token comment" spellcheck="true">//[Function]</span>
<span class="token comment" spellcheck="true">//{ a: '123' }</span>

<span class="token comment" spellcheck="true">/**
* dirä¸logéƒ½æ˜¯æ‰“å°å‡ºè¾“ï¼Œåœ¨nodejsç¯å¢ƒä¸­æ²¡æœ‰åˆ†åˆ«ã€‚
* dirçš„ä¸åŒä¹‹å¤„åœ¨äºï¼Œä¼šè°ƒç”¨æµè§ˆå™¨çš„console.dir()å‡½æ•°ï¼Œæ˜¾ç¤ºä¸ºDOMè§†å›¾ã€‚
*
* http://stackoverflow.com/questions/10636866/whats-the-difference-between-async-log-and-async-dir
*/</span>
<span class="token comment" spellcheck="true">//1.4</span>
<span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"1.4 handler"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">async</span><span class="token punctuation">.</span><span class="token function">dir</span><span class="token punctuation">(</span>hello<span class="token punctuation">,</span> <span class="token string">'world'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">//37.620> 1.4 handler</span>
<span class="token comment" spellcheck="true">//first time</span>
<span class="token comment" spellcheck="true">//second time</span>
<span class="token comment" spellcheck="true">//[Function]</span>
<span class="token comment" spellcheck="true">//{ a: '123' }</span>

<span class="token comment" spellcheck="true">/**
* noConflict()ä»…ä»…ç”¨äºæµè§ˆå™¨ç«¯ï¼Œåœ¨nodejsä¸­æ²¡ç”¨ï¼Œè¿™é‡Œæ— æ³•æ¼”ç¤ºã€‚
*
* å®ƒçš„ä½œç”¨æ˜¯ï¼šå¦‚æœä¹‹å‰å·²ç»åœ¨å…¨å±€åŸŸä¸­å®šä¹‰äº†asyncå˜é‡ï¼Œå½“å¯¼å…¥æœ¬async.jsæ—¶ï¼Œä¼šå…ˆæŠŠä¹‹å‰çš„asyncå˜é‡ä¿å­˜èµ·æ¥ï¼Œç„¶åè¦†ç›–å®ƒã€‚
 * ç”¨å®Œä¹‹åï¼Œè°ƒç”¨noConflict()æ–¹æ³•ï¼Œå°±ä¼šå½’è¿˜è¯¥å€¼ã€‚åŒæ—¶è¿”å›asyncæœ¬èº«ä¾›æ¢åä½¿ç”¨ã€‚
*/</span>
<span class="token comment" spellcheck="true">// noConflict()</span>
<span class="token comment" spellcheck="true">/*
    // global on the server, window in the browser
    var root = this,
        previous_async = root.async;

    if (typeof module !== 'undefined' &amp;&amp; module.exports) {
        module.exports = async;
    }
    else {
        root.async = async;
    }

    async.noConflict = function () {
        root.async = previous_async;
        return async;
    };
*/</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><a name="waterfall"></a><br><br></p>
<h3 id="waterfallä»£ç æ¼”ç¤º"><a href="#waterfallä»£ç æ¼”ç¤º" class="headerlink" title="waterfallä»£ç æ¼”ç¤º"></a><code>waterfall</code>ä»£ç æ¼”ç¤º</h3><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">var</span> <span class="token keyword">async</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'async'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> t <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./t'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> log <span class="token operator">=</span> t<span class="token punctuation">.</span>log<span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">/**
 * æŒ‰é¡ºåºä¾æ¬¡æ‰§è¡Œä¸€ç»„å‡½æ•°ã€‚æ¯ä¸ªå‡½æ•°äº§ç”Ÿçš„å€¼ï¼Œéƒ½å°†ä¼ ç»™ä¸‹ä¸€ä¸ªã€‚
 * å¦‚æœä¸­é€”å‡ºé”™ï¼Œåé¢çš„å‡½æ•°å°†ä¸ä¼šè¢«æ‰§è¡Œã€‚é”™è¯¯ä¿¡æ¯å°†ä¼ ç»™waterfallæœ€ç»ˆçš„callbackã€‚ä¹‹å‰äº§ç”Ÿçš„ç»“æœè¢«ä¸¢å¼ƒã€‚
 *
 * è¿™ä¸ªå‡½æ•°åä¸ºwaterfall(ç€‘å¸ƒ)ï¼Œå¯ä»¥æƒ³åƒç€‘å¸ƒä»ä¸Šåˆ°ä¸‹ï¼Œä¸­é€”å†²è¿‡ä¸€å±‚å±‚çªèµ·çš„çŸ³å¤´ã€‚
 *
 * æ³¨æ„ï¼Œè¯¥å‡½æ•°ä¸æ”¯æŒjsonæ ¼å¼çš„tasks
 */</span>
<span class="token comment" spellcheck="true">// async.waterfall(tasks, [callback]);</span>

<span class="token comment" spellcheck="true">/**
 * æ‰€æœ‰å‡½æ•°æ­£å¸¸æ‰§è¡Œï¼Œæ¯ä¸ªå‡½æ•°çš„ç»“æœéƒ½å°†å˜ä¸ºä¸‹ä¸€ä¸ªå‡½æ•°çš„å‚æ•°ã€‚
 *
 * æ³¨æ„ï¼Œæ‰€æœ‰çš„callbackéƒ½å¿…é¡»å½¢å¦‚callback(err, result)ï¼Œä½†errå‚æ•°åœ¨å‰é¢å„å‡½æ•°ä¸­æ— éœ€å£°æ˜ï¼Œå®ƒè¢«è‡ªåŠ¨å¤„ç†ã€‚
 */</span>
<span class="token comment" spellcheck="true">// 1.1</span>
<span class="token keyword">async</span><span class="token punctuation">.</span><span class="token function">waterfall</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
    <span class="token keyword">function</span><span class="token punctuation">(</span>cb<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.1.1: '</span><span class="token punctuation">,</span> <span class="token string">'start'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">cb</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token keyword">function</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> cb<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.1.2: '</span><span class="token punctuation">,</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span> t<span class="token punctuation">.</span><span class="token function">inc</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> cb<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token keyword">function</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> cb<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.1.3: '</span><span class="token punctuation">,</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span> t<span class="token punctuation">.</span><span class="token function">fire</span><span class="token punctuation">(</span>n<span class="token operator">*</span>n<span class="token punctuation">,</span> cb<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>err<span class="token punctuation">,</span> result<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.1 err: '</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.1 result: '</span><span class="token punctuation">,</span> result<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">//31.749> 1.1.1: start</span>
<span class="token comment" spellcheck="true">//31.752> 1.1.2: 3</span>
<span class="token comment" spellcheck="true">//31.953> 1.1.3: 4</span>
<span class="token comment" spellcheck="true">//32.156> 1.1 err: null</span>
<span class="token comment" spellcheck="true">//32.159> 1.1 result: 16</span>

<span class="token comment" spellcheck="true">/**
* ä¸­é€”æœ‰å‡½æ•°å‡ºé”™ï¼Œå…¶errç›´æ¥ä¼ ç»™æœ€ç»ˆcallbackï¼Œç»“æœè¢«ä¸¢å¼ƒï¼Œåé¢çš„å‡½æ•°ä¸å†æ‰§è¡Œã€‚
*/</span>
<span class="token comment" spellcheck="true">// 1.2</span>
<span class="token keyword">async</span><span class="token punctuation">.</span><span class="token function">waterfall</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
    <span class="token keyword">function</span><span class="token punctuation">(</span>cb<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.2.1: '</span><span class="token punctuation">,</span> <span class="token string">'start'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">cb</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token keyword">function</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> cb<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.2.2: '</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span> t<span class="token punctuation">.</span><span class="token function">inc</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> cb<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token keyword">function</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> cb<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.2.3: '</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span> t<span class="token punctuation">.</span><span class="token function">err</span><span class="token punctuation">(</span><span class="token string">'myerr'</span><span class="token punctuation">,</span> cb<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token keyword">function</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> cb<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.2.4: '</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span> t<span class="token punctuation">.</span><span class="token function">fire</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> cb<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>err<span class="token punctuation">,</span> result<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.2 err: '</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.2 result: '</span><span class="token punctuation">,</span> result<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">//44.935> 1.2.1: start</span>
<span class="token comment" spellcheck="true">//44.939> 1.2.2: 3</span>
<span class="token comment" spellcheck="true">//45.140> 1.2.3: 4</span>
<span class="token comment" spellcheck="true">//45.344> 1.2 err: myerr</span>
<span class="token comment" spellcheck="true">//45.348> 1.2 result:</span>

<span class="token comment" spellcheck="true">/**
* æ³¨æ„ï¼š ä»¥jsonå½¢å¼ä¼ å…¥tasksï¼Œå°†ä¸ä¼šè¢«æ‰§è¡Œ!!
*/</span>
<span class="token keyword">async</span><span class="token punctuation">.</span><span class="token function">waterfall</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    a<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span>cb<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.3.1: '</span><span class="token punctuation">,</span> <span class="token string">'start'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">cb</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    b<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> cb<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.3.2: '</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span> t<span class="token punctuation">.</span><span class="token function">inc</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> cb<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    c<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> cb<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.3.3: '</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span> t<span class="token punctuation">.</span><span class="token function">fire</span><span class="token punctuation">(</span>n<span class="token operator">*</span>n<span class="token punctuation">,</span> cb<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>err<span class="token punctuation">,</span> result<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.3 err: '</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.3 result: '</span><span class="token punctuation">,</span> result<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">//49.222> 1.3 err: [Error: First argument to waterfall must be an array of functions]</span>
<span class="token comment" spellcheck="true">//49.228> 1.3 result:</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><a name="whilst"></a><br><br></p>
<h3 id="whilst-until-doUntil-foreverå’Œ-doWhilstä»£ç æ¼”ç¤º"><a href="#whilst-until-doUntil-foreverå’Œ-doWhilstä»£ç æ¼”ç¤º" class="headerlink" title="whilst until doUntil foreverå’Œ doWhilstä»£ç æ¼”ç¤º"></a><code>whilst</code> <code>until</code> <code>doUntil</code> <code>forever</code>å’Œ <code>doWhilst</code>ä»£ç æ¼”ç¤º</h3><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">var</span> <span class="token keyword">async</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'async'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> t <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./t'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> log <span class="token operator">=</span> t<span class="token punctuation">.</span>log<span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">/**
 * ç›¸å½“äºwhileï¼Œä½†å…¶ä¸­çš„å¼‚æ­¥è°ƒç”¨å°†åœ¨å®Œæˆåæ‰ä¼šè¿›è¡Œä¸‹ä¸€æ¬¡å¾ªç¯ã€‚
 *
 * å®ƒç›¸å½“äºï¼š
 * try {
 *   whilst(test) {
 *     fn();
 *   }
 *   callback();
 * } catch (err) {
 *   callback(err);
 * }
 *
 * è¯¥å‡½æ•°çš„åŠŸèƒ½æ¯”è¾ƒç®€å•ï¼Œæ¡ä»¶å˜é‡é€šå¸¸å®šä¹‰åœ¨å¤–é¢ï¼Œå¯ä¾›æ¯ä¸ªå‡½æ•°è®¿é—®ã€‚åœ¨å¾ªç¯ä¸­ï¼Œå¼‚æ­¥è°ƒç”¨æ—¶äº§ç”Ÿçš„å€¼å®é™…ä¸Šè¢«ä¸¢å¼ƒäº†ï¼Œå› ä¸ºæœ€åé‚£ä¸ªcallbackåªèƒ½ä¼ å…¥é”™è¯¯ä¿¡æ¯ã€‚
 *
 * å¦å¤–ï¼Œç¬¬äºŒä¸ªå‡½æ•°fnéœ€è¦èƒ½æ¥å—ä¸€ä¸ªå‡½æ•°cbï¼Œè¿™ä¸ªcbæœ€ç»ˆå¿…é¡»è¢«æ‰§è¡Œï¼Œç”¨äºè¡¨ç¤ºå‡ºé”™æˆ–æ­£å¸¸ç»“æŸã€‚
 */</span>
<span class="token comment" spellcheck="true">// whilst(test, fn, callback)</span>

<span class="token comment" spellcheck="true">/**
* æ­£å¸¸æƒ…å†µï¼Œæ²¡æœ‰å‡ºé”™ã€‚ç¬¬äºŒä¸ªå‡½æ•°è™½ç„¶æ˜¯å¼‚æ­¥è°ƒç”¨ï¼Œä½†è¢«åŒæ­¥æ‰§è¡Œã€‚æ‰€ä»¥ç¬¬ä¸‰ä¸ªå‡½æ•°è¢«è°ƒç”¨æ—¶ï¼Œå·²ç»è¿‡äº†3ç§’ã€‚
*/</span>
<span class="token comment" spellcheck="true">// 1.1</span>
<span class="token keyword">var</span> count1 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">async</span><span class="token punctuation">.</span><span class="token function">whilst</span><span class="token punctuation">(</span>
    <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> count1 <span class="token operator">&lt;</span> <span class="token number">3</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token keyword">function</span><span class="token punctuation">(</span>cb<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.1 count: '</span><span class="token punctuation">,</span> count1<span class="token punctuation">)</span><span class="token punctuation">;</span>
        count1<span class="token operator">++</span><span class="token punctuation">;</span>
        <span class="token function">setTimeout</span><span class="token punctuation">(</span>cb<span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token keyword">function</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment" spellcheck="true">// 3s have passed</span>
        <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.1 err: '</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">//10.318> 1.1 count: 0</span>
<span class="token comment" spellcheck="true">//11.330> 1.1 count: 1</span>
<span class="token comment" spellcheck="true">//12.342> 1.1 count: 2</span>
<span class="token comment" spellcheck="true">//13.356> 1.1 err:</span>


<span class="token comment" spellcheck="true">/**
* ä¸­é€”å‡ºé”™ã€‚å‡ºé”™åç«‹åˆ»è°ƒç”¨ç¬¬ä¸‰ä¸ªå‡½æ•°ã€‚
*/</span>
<span class="token comment" spellcheck="true">// 1.2</span>
<span class="token keyword">var</span> count2 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">async</span><span class="token punctuation">.</span><span class="token function">whilst</span><span class="token punctuation">(</span>
    <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> count2 <span class="token operator">&lt;</span> <span class="token number">3</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token keyword">function</span><span class="token punctuation">(</span>cb<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.2 count: '</span><span class="token punctuation">,</span> count2<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>count2<span class="token operator">===</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            t<span class="token punctuation">.</span><span class="token function">err</span><span class="token punctuation">(</span><span class="token string">'myerr'</span><span class="token punctuation">,</span> cb<span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            count2<span class="token operator">++</span><span class="token punctuation">;</span>
            <span class="token function">setTimeout</span><span class="token punctuation">(</span>cb<span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token keyword">function</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment" spellcheck="true">// 2s have passed</span>
        <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.2 err: '</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">//12.805> 1.2 count: 0</span>
<span class="token comment" spellcheck="true">//13.824> 1.2 count: 1</span>
<span class="token comment" spellcheck="true">//14.026> 1.2 err: myerr</span>

<span class="token comment" spellcheck="true">/**
* ç¬¬äºŒä¸ªå‡½æ•°å³ä½¿äº§ç”Ÿå€¼ï¼Œä¹Ÿä¼šè¢«å¿½ç•¥ã€‚ç¬¬ä¸‰ä¸ªå‡½æ•°åªèƒ½å¾—åˆ°errã€‚
*/</span>
<span class="token comment" spellcheck="true">// 1.3</span>
<span class="token keyword">var</span> count3 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">async</span><span class="token punctuation">.</span><span class="token function">whilst</span><span class="token punctuation">(</span>
    <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token keyword">return</span> count3 <span class="token operator">&lt;</span> <span class="token number">3</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token keyword">function</span><span class="token punctuation">(</span>cb<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.3 count: '</span><span class="token punctuation">,</span> count3<span class="token punctuation">)</span><span class="token punctuation">;</span>
        t<span class="token punctuation">.</span><span class="token function">inc</span><span class="token punctuation">(</span>count3<span class="token operator">++</span><span class="token punctuation">,</span> cb<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token keyword">function</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span>result<span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token comment" spellcheck="true">// resultæ²¡æœ‰ç”¨</span>
        <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.3 err: '</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.3 result: '</span><span class="token punctuation">,</span> result<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">//45.311> 1.3 count: 0</span>
<span class="token comment" spellcheck="true">//45.514> 1.3 count: 1</span>
<span class="token comment" spellcheck="true">//45.718> 1.3 count: 2</span>
<span class="token comment" spellcheck="true">//45.920> 1.3 err:</span>
<span class="token comment" spellcheck="true">//45.923> 1.3 result:</span>

<span class="token comment" spellcheck="true">/**
*  doWhilstäº¤æ¢äº†fn,testçš„å‚æ•°ä½ç½®ï¼Œå…ˆæ‰§è¡Œä¸€æ¬¡å¾ªç¯ï¼Œå†åšteståˆ¤æ–­ã€‚ å’Œjavascriptä¸­do..whileè¯­æ³•ä¸€è‡´ã€‚
*/</span>
<span class="token comment" spellcheck="true">// doWhilst(fn, test, callback)</span>
<span class="token comment" spellcheck="true">//1.4</span>
<span class="token keyword">var</span> count4 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">async</span><span class="token punctuation">.</span><span class="token function">doWhilst</span><span class="token punctuation">(</span>
    <span class="token keyword">function</span><span class="token punctuation">(</span>cb<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.4 count: '</span><span class="token punctuation">,</span> count4<span class="token punctuation">)</span><span class="token punctuation">;</span>
        t<span class="token punctuation">.</span><span class="token function">inc</span><span class="token punctuation">(</span>count4<span class="token operator">++</span><span class="token punctuation">,</span> cb<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"1.4 test"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">return</span> count4 <span class="token operator">&lt;</span> <span class="token number">3</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token keyword">function</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span>result<span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token comment" spellcheck="true">// resultæ²¡æœ‰ç”¨</span>
        <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.4 err: '</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.4 result: '</span><span class="token punctuation">,</span> result<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">//33.643> 1.4 count: 0</span>
<span class="token comment" spellcheck="true">//33.848> 1.4 test</span>
<span class="token comment" spellcheck="true">//33.850> 1.4 count: 1</span>
<span class="token comment" spellcheck="true">//34.054> 1.4 test</span>
<span class="token comment" spellcheck="true">//34.057> 1.4 count: 2</span>
<span class="token comment" spellcheck="true">//34.269> 1.4 test</span>
<span class="token comment" spellcheck="true">//34.270> 1.4 err:</span>
<span class="token comment" spellcheck="true">//34.270> 1.4 result:</span>

<span class="token comment" spellcheck="true">/**
* untilä¸whilstæ­£å¥½ç›¸åï¼Œå½“testä¸ºfalseæ—¶å¾ªç¯ï¼Œä¸trueæ—¶è·³å‡ºã€‚å…¶å®ƒç‰¹æ€§ä¸€è‡´ã€‚
*/</span>
<span class="token comment" spellcheck="true">// 1.5</span>
<span class="token keyword">var</span> count5 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">async</span><span class="token punctuation">.</span><span class="token function">until</span><span class="token punctuation">(</span>
    <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> count5<span class="token operator">></span><span class="token number">3</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token keyword">function</span><span class="token punctuation">(</span>cb<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.5 count: '</span><span class="token punctuation">,</span> count5<span class="token punctuation">)</span><span class="token punctuation">;</span>
        count5<span class="token operator">++</span><span class="token punctuation">;</span>
        <span class="token function">setTimeout</span><span class="token punctuation">(</span>cb<span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token keyword">function</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment" spellcheck="true">// 4s have passed</span>
        <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.5 err: '</span><span class="token punctuation">,</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">//42.498> 1.5 count: 0</span>
<span class="token comment" spellcheck="true">//42.701> 1.5 count: 1</span>
<span class="token comment" spellcheck="true">//42.905> 1.5 count: 2</span>
<span class="token comment" spellcheck="true">//43.107> 1.5 count: 3</span>
<span class="token comment" spellcheck="true">//43.313> 1.5 err:</span>

<span class="token comment" spellcheck="true">/**
* doUntilä¸doWhilstæ­£å¥½ç›¸åï¼Œå½“testä¸ºfalseæ—¶å¾ªç¯ï¼Œä¸trueæ—¶è·³å‡ºã€‚å…¶å®ƒç‰¹æ€§ä¸€è‡´ã€‚
*/</span>
<span class="token comment" spellcheck="true">// doUntil(fn, test, callback)</span>
<span class="token comment" spellcheck="true">// 1.6</span>
<span class="token keyword">var</span> count6 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">async</span><span class="token punctuation">.</span><span class="token function">doUntil</span><span class="token punctuation">(</span>
    <span class="token keyword">function</span><span class="token punctuation">(</span>cb<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.6 count: '</span><span class="token punctuation">,</span> count6<span class="token punctuation">)</span><span class="token punctuation">;</span>
        count6<span class="token operator">++</span><span class="token punctuation">;</span>
        <span class="token function">setTimeout</span><span class="token punctuation">(</span>cb<span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.6 test'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span> count6<span class="token operator">></span><span class="token number">3</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token keyword">function</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment" spellcheck="true">// 4s have passed</span>
        <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.6 err: '</span><span class="token punctuation">,</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">//41.831> 1.6 count: 0</span>
<span class="token comment" spellcheck="true">//42.035> 1.6 test</span>
<span class="token comment" spellcheck="true">//42.037> 1.6 count: 1</span>
<span class="token comment" spellcheck="true">//42.241> 1.6 test</span>
<span class="token comment" spellcheck="true">//42.244> 1.6 count: 2</span>
<span class="token comment" spellcheck="true">//42.456> 1.6 test</span>
<span class="token comment" spellcheck="true">//42.457> 1.6 count: 3</span>
<span class="token comment" spellcheck="true">//42.660> 1.6 test</span>
<span class="token comment" spellcheck="true">//42.661> 1.6 err:</span>

<span class="token comment" spellcheck="true">/**
 * foreverï¼Œæ— è®ºæ¡ä»¶å¾ªç¯æ‰§è¡Œï¼Œå¦‚æœä¸å‡ºé”™ï¼Œcallbackæ°¸è¿œä¸è¢«æ‰§è¡Œ
 */</span>
<span class="token comment" spellcheck="true">//forever(fn, callback)</span>
<span class="token comment" spellcheck="true">//1.7</span>
<span class="token keyword">var</span> count7 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">async</span><span class="token punctuation">.</span><span class="token function">forever</span><span class="token punctuation">(</span>
    <span class="token keyword">function</span><span class="token punctuation">(</span>cb<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.7 count: '</span><span class="token punctuation">,</span> count7<span class="token punctuation">)</span><span class="token punctuation">;</span>
        count7<span class="token operator">++</span><span class="token punctuation">;</span>
        <span class="token function">setTimeout</span><span class="token punctuation">(</span>cb<span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token keyword">function</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.7 err: '</span><span class="token punctuation">,</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">//52.770> 1.7 count: 0</span>
<span class="token comment" spellcheck="true">//52.973> 1.7 count: 1</span>
<span class="token comment" spellcheck="true">//53.175> 1.7 count: 2</span>
<span class="token comment" spellcheck="true">//53.377> 1.7 count: 3</span>
<span class="token comment" spellcheck="true">//53.583> 1.7 count: 4</span>
<span class="token comment" spellcheck="true">//53.785> 1.7 count: 5</span>
<span class="token comment" spellcheck="true">//53.987> 1.7 count: 6</span>
<span class="token comment" spellcheck="true">//54.189> 1.7 count: 7</span>
<span class="token comment" spellcheck="true">//54.391> 1.7 count: 8</span>
<span class="token comment" spellcheck="true">//54.593> 1.7 count: 9</span>
<span class="token comment" spellcheck="true">//54.795> 1.7 count: 10</span>
<span class="token comment" spellcheck="true">//54.997> 1.7 count: 11</span>
<span class="token comment" spellcheck="true">//55.199> 1.7 count: 12</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
]]></content>
      
        <categories>
            
            <category> æœåŠ¡å™¨ </category>
            
        </categories>
        
        
        <tags>
            
            <tag> nodejs </tag>
            
            <tag> async </tag>
            
        </tags>
        
    </entry>
    
  
  
</search>
